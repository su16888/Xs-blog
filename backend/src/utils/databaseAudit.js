function _0x_0x59b1e8(_0x3b9d2e,_0x4cf51b,_0x549a86,_0x3b7166){return _0x_0x1666(_0x4cf51b- -0x1d,_0x3b7166);}(function(_0x3e756d,_0x1d003e){function _0x4cc7d2(_0x423c5f,_0x432b41,_0x1844db,_0xfbfd13){return _0x_0x1666(_0x432b41-0x204,_0x423c5f);}function _0x4b7268(_0x278c3e,_0x5850bd,_0x53c930,_0x23b9ec){return _0x_0x1666(_0x5850bd- -0xf6,_0x53c930);}const _0x22b56a=_0x3e756d();while(!![]){try{const _0x31b10b=-parseInt(_0x4b7268(0x74,0x8d,0x99,0x97))/(0x10*-0xb7+-0x6e7+0x1*0x1258)+-parseInt(_0x4b7268(0xad,0xb1,0xbb,0xb8))/(0x210b+-0x130f+-0xdfa)*(-parseInt(_0x4b7268(0x86,0x7f,0x9f,0x78))/(0x1de3+0x1d7*0xd+-0x35cb))+-parseInt(_0x4b7268(0xc8,0xb8,0xb3,0xb6))/(0x346*-0x2+-0x26f*-0x1+0x97*0x7)+parseInt(_0x4cc7d2(0x3b3,0x38e,0x379,0x37b))/(0x445+-0x251c+-0x837*-0x4)+parseInt(_0x4b7268(0xc5,0xaa,0xb9,0xa6))/(-0xb*0x39+-0xc88*0x2+0x1b89)*(parseInt(_0x4cc7d2(0x360,0x377,0x37d,0x353))/(0x13f6+0x7f7*0x2+-0x23dd))+-parseInt(_0x4b7268(0xa9,0x81,0x5b,0x99))/(-0x802+-0x18a7+0x20b1)*(parseInt(_0x4b7268(0xb0,0xbc,0xb0,0xbe))/(0x102a*0x1+-0xbdd+-0x444))+-parseInt(_0x4b7268(0xb4,0xb3,0xd9,0xc3))/(0x988+-0x12b+-0x853)*(-parseInt(_0x4cc7d2(0x393,0x388,0x3a2,0x38c))/(-0x1*0x14c3+0x26fe+-0x1230));if(_0x31b10b===_0x1d003e)break;else _0x22b56a['push'](_0x22b56a['shift']());}catch(_0x1831b4){_0x22b56a['push'](_0x22b56a['shift']());}}}(_0x_0x2e6d,0x11bb4*-0x3+0x5f0*-0xc2+0x163224));const _0x_0x1ac320=(function(){let _0x4a9cd3=!![];return function(_0x501a3b,_0x2cee64){function _0x5705d9(_0x298b40,_0x2a7f80,_0x39fbe4,_0x590b1a){return _0x_0x1666(_0x39fbe4- -0x19e,_0x298b40);}function _0x44cd61(_0x346d44,_0x119e90,_0x46a6be,_0x153152){return _0x_0x1666(_0x153152- -0xf1,_0x119e90);}if(_0x44cd61(0xb1,0xb7,0x9d,0xae)===_0x5705d9(0x10,-0x15,0x1,0x28)){const _0x3c3925=_0x4a9cd3?function(){function _0x567a3f(_0x9c22eb,_0x49d266,_0x33174a,_0x2960d5){return _0x5705d9(_0x2960d5,_0x49d266-0x18f,_0x33174a- -0x20,_0x2960d5-0x39);}if(_0x2cee64){const _0x42f082=_0x2cee64[_0x567a3f(-0xa,-0x10,-0x1c,-0x1c)](_0x501a3b,arguments);return _0x2cee64=null,_0x42f082;}}:function(){};return _0x4a9cd3=![],_0x3c3925;}else{const _0x47ab64=_0x2fc775[_0x44cd61(0x8b,0xd7,0xab,0xb1)](_0x4b20a8,arguments);return _0x4cfc32=null,_0x47ab64;}};}()),_0x_0x2b2a6d=_0x_0x1ac320(this,function(){function _0x4befa0(_0x54e096,_0x3be6cc,_0x2321fb,_0x39dc28){return _0x_0x1666(_0x3be6cc-0x1a4,_0x2321fb);}function _0x2663d4(_0x348616,_0x69aba9,_0x53d6a6,_0x1e9aab){return _0x_0x1666(_0x53d6a6-0xc7,_0x1e9aab);}return _0x_0x2b2a6d[_0x4befa0(0x34f,0x35c,0x381,0x344)]()[_0x4befa0(0x30a,0x331,0x313,0x31a)](_0x4befa0(0x337,0x33f,0x322,0x33b))[_0x4befa0(0x35d,0x35c,0x362,0x33b)]()[_0x4befa0(0x32d,0x349,0x35c,0x34a)](_0x_0x2b2a6d)[_0x4befa0(0x315,0x331,0x34e,0x346)](_0x2663d4(0x255,0x23e,0x262,0x27d));});_0x_0x2b2a6d();function _0x_0x2e6d(){const _0x3e8eef=['mJq5mZK4mePUzufota','uevstuLtu0LptL9dsefor0u','lI4VlI4VBg9NCY9KyxrHyMfZzv9HDwrPDc5SB2C','B3bLCMf0Aw9U','mte5nJy5nJDdv3POyNi','BgvUz3rO','ihWGsva6ia','zxjYB3i','zw5ZDxjLtg9NrgLYzwn0B3j5','C3rYAw5NAwz5','Dg9tDhjPBMC','z2v0qxvKAxrmB2DZ','BwTKAxjtEw5J','tuvesvvn','ioADOEAxP+wUOEIUOEAxPEw/LW','sva6ia','6k+75y+w5A6H6k6H5PEL5B+x5AsX6lsLoG','yxbWzw5KrMLSzvn5BMm','yxvKAxrmB2DqyxrO','y2XLyw51Ce9SzeXVz3m','n1vPrwPuDa','C3bSAxq','odq2mJfLr2vdvgC','te9hsu5Fqvruru1qva','og1mzgr1Ea','DxnLCKLK','Bg9NqNvSA09WzxjHDgLVBG','Bg9Nt3bLCMf0Aw9U','vxnLCJOG','Dg9ju09tDhjPBMC','sLf6C3K','vu1kBvm','ihWG','C2v0rgf0zq','ihWGvxnLCJOG','vw5RBM93BG','mtq5mde5n0POAfrtEa','mZa4rgvdAhLm','Bg9Ntg9NAw5bDhrLBxb0','zxHWB3j0CW','zgLYBMfTzq','w0rcief1zgL0xsa','BwfW','mZu2mZqXnwLls1byva','u0vou0Lusvzfx0fdq0vtuW','5BEY5RIf55cgia','C2vHCMnO','DxnLCNm','DxrMoa','Bg9Nu2vUC2L0AxzLqwnJzxnZ','zxHPC3rZu3LUyW','DgLTzxn0yw1W','zgv2zwXVCg1LBNq','DhjPBq','5RIf55cg5A6H6k6H5PEL5B+x5AsX6lsLoG','zgv0ywLSCW','Bg9NugvYBwLZC2LVBKnOyw5Nzq','DxnLCKfNzw50','seLhsa','zMLSDgvY','kcGOlISPkYKRksSK','te9x','CMvHzezPBgvtEw5J','CunoDeq','B3rwuKK','otmZnZu2mfDnt2Dcsa','AM9PBG','yxbWBhK','DgfIBgu','ihWGrgv0ywLSCZOG','y29UC3rYDwn0B3i','zw52','odHbtujTBxC','CMvWBgfJzq','mZeYntyWrNzzwLDl','rgv0ywLSCZOG','Evnjyvu','revmrvrf','Bg9N'];_0x_0x2e6d=function(){return _0x3e8eef;};return _0x_0x2e6d();}function _0x_0x1666(_0x46aee5,_0x547a81){_0x46aee5=_0x46aee5-(0x21eb+-0x1990+-0x6f0);const _0x782e1b=_0x_0x2e6d();let _0x3e4c09=_0x782e1b[_0x46aee5];if(_0x_0x1666['UIETTA']===undefined){var _0x53164a=function(_0x33dc80){const _0x528cf3='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3b1b1b='',_0x41ed5f='',_0x43abd3=_0x3b1b1b+_0x53164a;for(let _0x3d599c=-0x1*0x109+-0x25ed+0x26f6,_0x21c8a3,_0x386b2a,_0x2bdb5a=-0x2441+0x175c+-0x1*-0xce5;_0x386b2a=_0x33dc80['charAt'](_0x2bdb5a++);~_0x386b2a&&(_0x21c8a3=_0x3d599c%(0xb*0x257+-0x7*0x43f+0x400)?_0x21c8a3*(0x89e*-0x2+0x13d9+-0x25d)+_0x386b2a:_0x386b2a,_0x3d599c++%(0x5*0x5e9+0x2278+-0x4001))?_0x3b1b1b+=_0x43abd3['charCodeAt'](_0x2bdb5a+(-0xdc+-0x52*0x44+0x16ae))-(0xeb*-0x1+-0x2571+0x2666)!==0xe5*0x13+0x13*0x1+-0x1112?String['fromCharCode'](-0xe48+0x1*0x7b1+-0x2*-0x3cb&_0x21c8a3>>(-(-0x1099*-0x1+0xee8*-0x2+0x1*0xd39)*_0x3d599c&-0x62*0x56+0x395+0x1d5d)):_0x3d599c:0xd1*-0x29+-0x82+0x21fb){_0x386b2a=_0x528cf3['indexOf'](_0x386b2a);}for(let _0x38141c=-0x376*0x4+0x16bb+-0x1c7*0x5,_0x51f35e=_0x3b1b1b['length'];_0x38141c<_0x51f35e;_0x38141c++){_0x41ed5f+='%'+('00'+_0x3b1b1b['charCodeAt'](_0x38141c)['toString'](0x1*-0xccf+0x118c*-0x2+0xffd*0x3))['slice'](-(-0x238+-0xc0c+-0x723*-0x2));}return decodeURIComponent(_0x41ed5f);};_0x_0x1666['wTrlar']=_0x53164a,_0x_0x1666['ibsAeG']={},_0x_0x1666['UIETTA']=!![];}const _0x52c389=_0x782e1b[0x20e6+-0xc3a+-0x14ac],_0x2140c7=_0x46aee5+_0x52c389,_0x2ea43a=_0x_0x1666['ibsAeG'][_0x2140c7];if(!_0x2ea43a){const _0x79a59f=function(_0xede7c){this['IOpKOH']=_0xede7c,this['URThot']=[0x61f+-0x1195*-0x1+-0x17b3,-0xa4d+-0x1*-0x11e5+-0x798,0x2d9+-0x4a5+0x1cc],this['bpTCMx']=function(){return'newState';},this['DSeLDD']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['tQjrFw']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x79a59f['prototype']['pAoBuV']=function(){const _0x37a12f=new RegExp(this['DSeLDD']+this['tQjrFw']),_0x186817=_0x37a12f['test'](this['bpTCMx']['toString']())?--this['URThot'][0xbbe+0x1c01+-0x27be]:--this['URThot'][-0x1ba+-0x714*0x5+0x251e];return this['gaRGRi'](_0x186817);},_0x79a59f['prototype']['gaRGRi']=function(_0x2c090f){if(!Boolean(~_0x2c090f))return _0x2c090f;return this['nRDjeu'](this['IOpKOH']);},_0x79a59f['prototype']['nRDjeu']=function(_0x45d44a){for(let _0x50bda6=0x1227+0x29*-0xd9+-0x55*-0x32,_0x8064cc=this['URThot']['length'];_0x50bda6<_0x8064cc;_0x50bda6++){this['URThot']['push'](Math['round'](Math['random']())),_0x8064cc=this['URThot']['length'];}return _0x45d44a(this['URThot'][-0x1bc7+0x4c*0x15+0x158b]);},new _0x79a59f(_0x_0x1666)['pAoBuV'](),_0x3e4c09=_0x_0x1666['wTrlar'](_0x3e4c09),_0x_0x1666['ibsAeG'][_0x2140c7]=_0x3e4c09;}else _0x3e4c09=_0x2ea43a;return _0x3e4c09;}const fs=require('fs'),path=require('path');class DatabaseAudit{constructor(){this['auditLogPath']=path[_0x4cd31d(0x20,0xf,0x1b,0x9)](__dirname,_0x30509f(0x1b,0x18,0xb,0x2e));function _0x30509f(_0x4660f8,_0x2d034a,_0x3fd051,_0x301fd9){return _0x_0x1666(_0x2d034a- -0x198,_0x4660f8);}function _0x4cd31d(_0x3e7f57,_0x11b092,_0x534054,_0x256186){return _0x_0x1666(_0x256186- -0x198,_0x534054);}this[_0x4cd31d(0x1a,0x41,0x27,0x1e)]();}['ensureLogDirectory'](){function _0x540e9e(_0x349dcf,_0x575b54,_0x22266e,_0x564ee0){return _0x_0x1666(_0x22266e- -0x279,_0x575b54);}function _0x487709(_0x858f31,_0x499e9c,_0x82746d,_0x367390){return _0x_0x1666(_0x82746d-0x3e,_0x499e9c);}const _0x131b24=path[_0x540e9e(-0x103,-0x110,-0xf2,-0xec)](this['auditLogPath']);!fs[_0x540e9e(-0xea,-0xca,-0xe8,-0xf2)](_0x131b24)&&fs[_0x487709(0x1b9,0x193,0x1a9,0x198)](_0x131b24,{'recursive':!![]});}['logOperation'](_0x11adbc,_0x30199a,_0x11a98f,_0x56907f,_0xc7abd5={}){function _0x4102ab(_0x59ff8b,_0x1448c3,_0x172dbb,_0x3983c2){return _0x_0x1666(_0x172dbb-0x18a,_0x59ff8b);}const _0x3f66a6=new Date()[_0x4102ab(0x2fa,0x2e0,0x306,0x301)](),_0x32e13c={'timestamp':_0x3f66a6,'operation':_0x11adbc,'table':_0x30199a,'userId':_0x11a98f,'ipAddress':_0x56907f,'details':_0xc7abd5,'userAgent':_0xc7abd5[_0x4102ab(0x323,0x32f,0x322,0x322)]||_0x3e2884(0x515,0x518,0x4fc,0x4fc)},_0x48bfd4=_0x3f66a6+_0x4102ab(0x2e3,0x31b,0x309,0x2f3)+_0x11adbc+_0x4102ab(0x2f3,0x30c,0x309,0x319)+_0x30199a+_0x4102ab(0x2e8,0x2ea,0x30b,0x2e5)+_0x11a98f+_0x3e2884(0x52b,0x54d,0x50e,0x52e)+_0x56907f+_0x3e2884(0x51e,0x536,0x541,0x51e)+JSON[_0x3e2884(0x54c,0x51e,0x546,0x531)](_0xc7abd5)+'\x0a';fs[_0x3e2884(0x50d,0x4c5,0x4e9,0x4ea)](this['auditLogPath'],_0x48bfd4,_0x3e2884(0x508,0x512,0x526,0x509));function _0x3e2884(_0x5b6840,_0x331b43,_0x976b8e,_0x1a0509){return _0x_0x1666(_0x1a0509-0x37a,_0x5b6840);}return process[_0x4102ab(0x314,0x320,0x330,0x358)]['NODE_ENV']===_0x3e2884(0x50f,0x534,0x523,0x50d)&&console[_0x4102ab(0x34d,0x354,0x337,0x320)](_0x3e2884(0x522,0x4e3,0x4f5,0x502)+_0x48bfd4[_0x3e2884(0x525,0x520,0x51f,0x50e)]()),_0x32e13c;}[_0x_0x59b1e8(0x166,0x173,0x14d,0x16b)](_0x219e52,_0x2a4ccf,_0x5ed484,_0x2a2a41,_0x5f5804='Unknown'){function _0x44e2f5(_0x1293e9,_0x138fd9,_0x24e994,_0x4383bf){return _0x_0x59b1e8(_0x1293e9-0x15c,_0x24e994- -0xa5,_0x24e994-0x12d,_0x1293e9);}function _0x30f667(_0xf40443,_0x1d343f,_0x24e1b6,_0x34bd30){return _0x_0x59b1e8(_0xf40443-0x11e,_0xf40443-0x25b,_0x24e1b6-0xdb,_0x1d343f);}return this[_0x30f667(0x3b8,0x3c7,0x391,0x3b9)](_0x44e2f5(0xab,0xd8,0xc9,0xc5),_0x219e52,_0x2a4ccf,_0x5ed484,{'accessedFields':_0x2a2a41,'userAgent':_0x5f5804,'severity':'HIGH'});}['logDataModification'](_0x401948,_0x320950,_0x407f9d,_0x350c41,_0x1148d2,_0x5ef905,_0x303101=_0x_0x59b1e8(0x16f,0x165,0x144,0x179)){function _0x51ec7b(_0x40f867,_0x1916a0,_0x5ae99e,_0x2330ab){return _0x_0x1edea7(_0x5ae99e,_0x1916a0-0x13f,_0x5ae99e-0xd3,_0x2330ab-0x15e);}function _0x91adf(_0x59156c,_0x4deabc,_0x28774b,_0x2c6ff2){return _0x_0x59b1e8(_0x59156c-0x1,_0x28774b-0x1dc,_0x28774b-0x1a4,_0x59156c);}return this[_0x91adf(0x330,0x339,0x339,0x315)](_0x401948,_0x320950,_0x407f9d,_0x350c41,{'recordId':_0x1148d2,'changes':_0x5ef905,'userAgent':_0x303101,'severity':_0x401948===_0x91adf(0x34d,0x34c,0x36b,0x35d)?_0x51ec7b(0x573,0x574,0x577,0x57c):_0x51ec7b(0x56c,0x576,0x576,0x54f)});}[_0x_0x1edea7(0x3de,0x40b,0x3de,0x3fe)](_0x4da36a,_0x1f0230,_0x69d7f6,_0x274724,_0x108bba,_0x1a6dde,_0x1c8f42=_0x_0x59b1e8(0x18b,0x165,0x167,0x141)){function _0x27cc68(_0x520098,_0x2fe7e2,_0x3dc06a,_0x163150){return _0x_0x1edea7(_0x3dc06a,_0x2fe7e2-0x1c0,_0x3dc06a-0x92,_0x2fe7e2- -0x2e0);}return this['logOperation'](_0x4da36a,_0x1f0230,_0x69d7f6,_0x274724,{'affectedCount':_0x108bba,'criteria':_0x1a6dde,'userAgent':_0x1c8f42,'severity':_0x27cc68(0x129,0x111,0x133,0x105)});}[_0x_0x59b1e8(0x15a,0x168,0x186,0x159)](_0x3b69d5,_0x15012f,_0x17ec32,_0x3855ea='',_0x4ad523='Unknown'){function _0x2da26b(_0x394480,_0x5321c4,_0x520be0,_0x504438){return _0x_0x1edea7(_0x5321c4,_0x5321c4-0x130,_0x520be0-0x186,_0x520be0- -0x58c);}function _0x4a82f9(_0x4695fd,_0x899155,_0x1da9f2,_0x27ff88){return _0x_0x59b1e8(_0x4695fd-0x127,_0x4695fd-0x48,_0x1da9f2-0xbb,_0x1da9f2);}return this[_0x2da26b(-0x176,-0x1a7,-0x18d,-0x17c)](_0x2da26b(-0x17d,-0x177,-0x191,-0x1a7),_0x4a82f9(0x1b9,0x1ac,0x1b6,0x1e0),_0x3b69d5,_0x15012f,{'success':_0x17ec32,'reason':_0x3855ea,'userAgent':_0x4ad523,'severity':_0x17ec32?_0x2da26b(-0x17d,-0x17c,-0x16b,-0x16c):_0x2da26b(-0x1b7,-0x19e,-0x19b,-0x1ad)});}[_0x_0x59b1e8(0x173,0x17a,0x18b,0x161)](_0x1e95e7,_0xb740ff,_0x48b109,_0x3832d7,_0x466b06=_0x_0x1edea7(0x42c,0x402,0x401,0x407)){function _0x14bc21(_0x5c00b8,_0x4e147d,_0x5ef7cc,_0x36ce3a){return _0x_0x1edea7(_0x36ce3a,_0x4e147d-0x1aa,_0x5ef7cc-0xd3,_0x4e147d- -0x438);}function _0x2f2ed3(_0x28afd0,_0xa344d6,_0x3a461a,_0x3fcb26){return _0x_0x1edea7(_0x3a461a,_0xa344d6-0x8e,_0x3a461a-0xf8,_0x28afd0-0xe0);}return this[_0x14bc21(-0x4c,-0x39,-0x40,-0x22)](_0x2f2ed3(0x514,0x4fa,0x525,0x52f),'users',_0xb740ff,_0x48b109,{'targetUserId':_0x1e95e7,'permissions':_0x3832d7,'userAgent':_0x466b06,'severity':_0x14bc21(-0x4,-0x1a,0xc,-0xb)});}['getAuditLogs'](_0x34554f={}){function _0x10a876(_0x3ffedb,_0x3fd854,_0x3b4491,_0x36db83){return _0x_0x1edea7(_0x3ffedb,_0x3fd854-0xd1,_0x3b4491-0x1a4,_0x36db83- -0x34);}function _0x27c3db(_0x2aae44,_0x187211,_0x538c90,_0x329570){return _0x_0x59b1e8(_0x2aae44-0xdf,_0x187211-0x3c6,_0x538c90-0x26,_0x538c90);}const {startDate:_0x1fb4da,endDate:_0x532c5d,operation:_0x1ab786,table:_0x5a00c2,userId:_0xae3908,limit:limit=0x1c6a+0xab6+0x1*-0x26bc}=_0x34554f;try{if(!fs[_0x10a876(0x3f8,0x3c5,0x409,0x3e2)](this[_0x10a876(0x3a5,0x3a4,0x3b5,0x3c2)]))return _0x27c3db(0x515,0x527,0x547,0x532)==='UMJmS'?[]:this[_0x27c3db(0x4fd,0x523,0x511,0x536)](_0x5452a2,_0xb4293,_0x56e40e,_0x42fe72,{'affectedCount':_0x5b92f1,'criteria':_0x15beca,'userAgent':_0xdc9343,'severity':_0x10a876(0x3ae,0x3af,0x3a4,0x3bd)});const _0x3f9bbe=fs[_0x27c3db(0x54e,0x546,0x51f,0x53e)](this[_0x10a876(0x3b4,0x3b4,0x3dc,0x3c2)],_0x10a876(0x3f9,0x3c5,0x400,0x3e0)),_0x33b985=_0x3f9bbe[_0x27c3db(0x4fe,0x51d,0x528,0x4fb)]('\x0a')[_0x27c3db(0x551,0x543,0x558,0x527)](_0x56eccd=>_0x56eccd[_0x27c3db(0x53e,0x53d,0x51d,0x52a)]());let _0x2f54ba=_0x33b985[_0x27c3db(0x513,0x532,0x535,0x52f)](_0x2a169f=>{function _0x275c04(_0x5b9fd5,_0x2f1be7,_0x38b63c,_0x1c12af){return _0x27c3db(_0x5b9fd5-0x1ea,_0x5b9fd5- -0x16a,_0x38b63c,_0x1c12af-0x19);}function _0x321cc0(_0x1927f9,_0x843445,_0xfa94a2,_0x593adb){return _0x10a876(_0xfa94a2,_0x843445-0x91,_0xfa94a2-0xfc,_0x593adb- -0x33e);}if(_0x321cc0(0x72,0x87,0x97,0x90)===_0x321cc0(0x97,0x97,0x86,0x90)){const _0xa71b7=_0x2a169f['split'](_0x321cc0(0x83,0x82,0xae,0x92));if(_0xa71b7['length']>=-0x962*-0x4+-0x876*0x2+-0x1496)return{'timestamp':_0xa71b7[-0x2*-0x819+0x86e+-0x18a0],'operation':_0xa71b7[0x4c7*-0x1+-0x1c73+0x213b],'table':_0xa71b7[0xfd1+-0x3*-0x794+-0x1*0x268b],'userId':_0xa71b7[-0x885*-0x3+0x1fad+0x303*-0x13]['replace'](_0x321cc0(0x9c,0x9b,0xa4,0x8e),''),'ipAddress':_0xa71b7[0x5cd+-0x68b+-0x2*-0x61][_0x275c04(0x3e7,0x3e1,0x402,0x404)](_0x275c04(0x3ad,0x3bc,0x388,0x3a0),''),'details':JSON['parse'](_0xa71b7[-0x258c+-0x19+0x25aa][_0x321cc0(0xa9,0xc4,0x95,0xbb)](_0x321cc0(0xdb,0xe0,0xc4,0xbd),''))};return null;}else return this['logOperation'](_0x275c04(0x3ca,0x3dc,0x3e0,0x3d0),_0x4525b3,_0x68c082,_0x50ab18,{'accessedFields':_0x3ace07,'userAgent':_0x17d5cb,'severity':_0x321cc0(0xb6,0xae,0xce,0xac)});})[_0x27c3db(0x539,0x543,0x55a,0x53b)](_0x41b74a=>_0x41b74a!==null);return _0x1fb4da&&(_0x2f54ba=_0x2f54ba['filter'](_0x30adc9=>new Date(_0x30adc9[_0x27c3db(0x539,0x53b,0x561,0x548)])>=new Date(_0x1fb4da))),_0x532c5d&&(_0x2f54ba=_0x2f54ba['filter'](_0x12408=>new Date(_0x12408[_0x10a876(0x3d7,0x3db,0x3db,0x3e3)])<=new Date(_0x532c5d))),_0x1ab786&&(_0x2f54ba=_0x2f54ba['filter'](_0x5578c2=>_0x5578c2['operation']===_0x1ab786)),_0x5a00c2&&(_0x2f54ba=_0x2f54ba['filter'](_0x223cdd=>_0x223cdd['table']===_0x5a00c2)),_0xae3908&&('SyLHd'===_0x27c3db(0x547,0x554,0x567,0x544)?console[_0x10a876(0x3db,0x413,0x3df,0x3fe)]('[DB\x20Audit]\x20'+_0x57d806[_0x27c3db(0x552,0x53d,0x53c,0x554)]()):_0x2f54ba=_0x2f54ba[_0x27c3db(0x555,0x543,0x549,0x529)](_0x1ee23b=>_0x1ee23b[_0x27c3db(0x528,0x521,0x53c,0x52d)]===_0xae3908)),_0x2f54ba['slice'](0x2*-0xc29+0x1303+0x54f,limit);}catch(_0x5efe03){return console[_0x10a876(0x412,0x40a,0x3f7,0x406)](_0x10a876(0x3d2,0x3c1,0x3e6,0x3c0),_0x5efe03),[];}}[_0x_0x59b1e8(0x145,0x155,0x179,0x140)](_0x4143cd=-0x15*0x4b+-0x9c6+-0x56d*-0x3){function _0x18397b(_0x446956,_0x283a28,_0x2112b9,_0x51aa01){return _0x_0x59b1e8(_0x446956-0x57,_0x446956- -0xe6,_0x2112b9-0xda,_0x2112b9);}function _0x122573(_0x54bc3d,_0x20217f,_0x34db23,_0x46eb83){return _0x_0x59b1e8(_0x54bc3d-0x16d,_0x20217f- -0x1ae,_0x34db23-0x15,_0x34db23);}try{if(!fs[_0x122573(-0x20,-0x3a,-0x3c,-0x5d)](this['auditLogPath']))return;const _0x19b2da=new Date();_0x19b2da[_0x122573(-0x5d,-0x4b,-0x5e,-0x5a)](_0x19b2da['getDate']()-_0x4143cd);const _0x3f69b9=this[_0x122573(-0x20,-0x12,0x1,-0x2a)](),_0x49d7a3=_0x3f69b9[_0x18397b(0x97,0x8f,0x79,0x91)](_0x3be3da=>new Date(_0x3be3da[_0x122573(-0x2b,-0x39,-0x12,-0x57)])>_0x19b2da),_0x5e8090=_0x49d7a3[_0x18397b(0x86,0x9d,0x98,0x95)](_0x48e576=>_0x48e576[_0x122573(-0x5c,-0x39,-0x14,-0x3e)]+_0x122573(-0x5b,-0x4c,-0x5d,-0x56)+_0x48e576[_0x122573(-0x2f,-0x1a,-0x16,-0x39)]+'\x20|\x20'+_0x48e576[_0x18397b(0xa0,0xc7,0xa0,0xa4)]+_0x18397b(0x7e,0x67,0x6b,0x87)+_0x48e576[_0x122573(-0x3d,-0x53,-0x2e,-0x63)]+_0x122573(0x3,-0x17,-0x35,-0x2b)+_0x48e576['ipAddress']+'\x20|\x20Details:\x20'+JSON[_0x122573(0x1,-0x14,-0x18,-0x1e)](_0x48e576[_0x122573(-0xd,-0x35,-0xe,-0x4f)]))[_0x18397b(0x9e,0x92,0xb0,0x87)]('\x0a')+'\x0a';fs['writeFileSync'](this['auditLogPath'],_0x5e8090,_0x18397b(0x8c,0x9f,0xb4,0x97)),console[_0x122573(-0x5,-0x1e,-0x14,-0x40)](_0x18397b(0x89,0x91,0x86,0x7c)+(_0x3f69b9['length']-_0x49d7a3[_0x122573(-0x13,-0x18,0x4,-0x31)])+_0x122573(-0x5a,-0x5e,-0x62,-0x5f));}catch(_0x4bf169){_0x122573(-0x27,-0x2d,-0x31,-0x16)===_0x122573(-0x1b,-0x2d,-0x41,-0x4b)?console['error'](_0x122573(-0x5b,-0x36,-0xf,-0x44),_0x4bf169):_0x3577a9[_0x122573(-0x63,-0x60,-0x7d,-0x78)](_0x781bdc,{'recursive':!![]});}}}function _0x_0x1edea7(_0xc43719,_0x8a478a,_0x52d370,_0xc57f5a){return _0x_0x1666(_0xc57f5a-0x285,_0xc43719);}module[_0x_0x59b1e8(0x168,0x169,0x155,0x165)]=new DatabaseAudit();