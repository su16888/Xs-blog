function _0x_0x464084(_0x42e308,_0x375c38,_0x3341f2,_0x268c0c){return _0x_0x4ae6(_0x375c38-0x250,_0x42e308);}(function(_0x5d3b98,_0x2c7195){function _0x4df740(_0x46e3f2,_0x5a0ea3,_0xfdd6fc,_0x3603a9){return _0x_0x4ae6(_0x5a0ea3-0x17f,_0xfdd6fc);}const _0x73ff17=_0x5d3b98();function _0x2b75d5(_0x2d0718,_0x5564c6,_0x59c1c0,_0x5cfb13){return _0x_0x4ae6(_0x2d0718- -0x177,_0x59c1c0);}while(!![]){try{const _0x256e02=parseInt(_0x4df740(0x2b8,0x2db,0x2e7,0x2e5))/(-0x113*0x1f+-0x23b1+0x44ff)+parseInt(_0x4df740(0x2e9,0x2f4,0x308,0x2e3))/(0x9d9*0x3+-0x18ee+-0x49b*0x1)*(-parseInt(_0x4df740(0x2f9,0x31b,0x330,0x304))/(-0x1dc3+0x1*-0x119a+0x2*0x17b0))+parseInt(_0x4df740(0x321,0x326,0x33b,0x315))/(0x8f*0x13+0x16d6+-0x216f)*(-parseInt(_0x2b75d5(0x33,0xb,0x9,0x1c))/(0xaaa+-0x371*-0x9+-0x299e))+-parseInt(_0x2b75d5(0x2e,0x5,0x56,0x13))/(-0x1*-0xa12+-0x1f1e+-0x2*-0xa89)*(-parseInt(_0x4df740(0x2dd,0x2d4,0x2f5,0x2ab))/(0x3a*0x4+0x1a46+0x15*-0x14b))+-parseInt(_0x4df740(0x2ee,0x2e5,0x2d9,0x2d2))/(-0x52a+-0xb87+0x10b9)*(-parseInt(_0x4df740(0x2e4,0x2e1,0x2f0,0x2c3))/(-0xab6+-0xdd3+0x1892))+parseInt(_0x2b75d5(0x8,-0x22,0x25,-0xb))/(0x1461+0x142e+-0x2885)+-parseInt(_0x2b75d5(0x4,0x16,0x2a,0xf))/(-0x1b66+-0x1*0xac+0x1*0x1c1d)*(parseInt(_0x2b75d5(-0x1e,-0x19,-0x3c,-0x3b))/(-0x13*-0x6d+-0x2*0x10cd+0x198f));if(_0x256e02===_0x2c7195)break;else _0x73ff17['push'](_0x73ff17['shift']());}catch(_0x27f3bf){_0x73ff17['push'](_0x73ff17['shift']());}}}(_0x_0x4490,0xa*0xe363+0x9fe84+-0x1*0xaddd2));const _0x_0x391899=(function(){let _0xb9ec58=!![];return function(_0x117ae3,_0x25ca50){const _0x5a13fc=_0xb9ec58?function(){if(_0x25ca50){const _0x3116e3=_0x25ca50['apply'](_0x117ae3,arguments);return _0x25ca50=null,_0x3116e3;}}:function(){};return _0xb9ec58=![],_0x5a13fc;};}()),_0x_0x7e85cf=_0x_0x391899(this,function(){function _0x1ae76f(_0x4b45d4,_0x1cc215,_0x242843,_0x22d7dd){return _0x_0x4ae6(_0x1cc215- -0x329,_0x4b45d4);}function _0x4d56d3(_0x19b6ed,_0x36113d,_0x4daf04,_0x17403e){return _0x_0x4ae6(_0x17403e-0x1ef,_0x19b6ed);}return _0x_0x7e85cf[_0x1ae76f(-0x1a3,-0x1c5,-0x1cb,-0x1a8)]()[_0x1ae76f(-0x1a2,-0x18a,-0x18c,-0x19b)](_0x4d56d3(0x3a7,0x36a,0x392,0x381))['toString']()[_0x1ae76f(-0x1aa,-0x18f,-0x184,-0x189)](_0x_0x7e85cf)[_0x1ae76f(-0x171,-0x18a,-0x182,-0x171)]('(((.+)+)+)+$');});function _0x_0x4ae6(_0x9e2de5,_0x31fb3e){const _0x4e71d7=_0x_0x4490();return _0x_0x4ae6=function(_0x3bb426,_0xe1dbea){_0x3bb426=_0x3bb426-(-0x17eb+-0x2502+0x1a*0x265);let _0x392d19=_0x4e71d7[_0x3bb426];if(_0x_0x4ae6['NsVHdu']===undefined){var _0x3c145d=function(_0x28d2c1){const _0x6faf1e='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x142a53='',_0x59f04d='',_0x2d9445=_0x142a53+_0x3c145d;for(let _0x1405d9=0x164c+-0x2377+0xd2b,_0x53e929,_0x3f0a76,_0x45112c=-0x1f3*0xb+0x1893+-0x322;_0x3f0a76=_0x28d2c1['charAt'](_0x45112c++);~_0x3f0a76&&(_0x53e929=_0x1405d9%(0x16c5+-0xd72*-0x1+-0x2433)?_0x53e929*(0x1*-0x279+0x1cfe+0x5*-0x541)+_0x3f0a76:_0x3f0a76,_0x1405d9++%(-0x17*-0x141+-0xa*0x21+-0x85*0x35))?_0x142a53+=_0x2d9445['charCodeAt'](_0x45112c+(0x2477+0x7e0+-0x1*0x2c4d))-(0x1876+-0xa86*0x1+0x2*-0x6f3)!==-0x5b*0x62+0x2*0x648+0x1646?String['fromCharCode'](-0x1*-0x1e54+-0xf31*-0x2+-0x1*0x3bb7&_0x53e929>>(-(0x1*0x22c6+0x3*-0x196+-0xf01*0x2)*_0x1405d9&0x4e2+-0x2099+0x1b*0x107)):_0x1405d9:-0x5e*-0x5c+0x1c69*-0x1+-0x55f){_0x3f0a76=_0x6faf1e['indexOf'](_0x3f0a76);}for(let _0x12c7b7=-0x20e+0x1*0x8af+-0x1*0x6a1,_0xc45a13=_0x142a53['length'];_0x12c7b7<_0xc45a13;_0x12c7b7++){_0x59f04d+='%'+('00'+_0x142a53['charCodeAt'](_0x12c7b7)['toString'](0x425+0x20f9+-0x2*0x1287))['slice'](-(-0x7f9+-0x1d*0x67+0x13a6*0x1));}return decodeURIComponent(_0x59f04d);};_0x_0x4ae6['LJToSe']=_0x3c145d,_0x9e2de5=arguments,_0x_0x4ae6['NsVHdu']=!![];}const _0x3c5ca4=_0x4e71d7[0x14e3+-0x18+-0x14cb],_0x5a5e91=_0x3bb426+_0x3c5ca4,_0x1dbb21=_0x9e2de5[_0x5a5e91];if(!_0x1dbb21){const _0x507ea9=function(_0x24db58){this['Mkrzys']=_0x24db58,this['xGrfcj']=[-0x1*-0x19c+-0x4*0x53+-0x4f,0x1d7f*0x1+-0x12c7+-0xab8,-0x1*-0x128e+0x1859*-0x1+0x5cb*0x1],this['CbqvTK']=function(){return'newState';},this['nStDPZ']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['ruCcyV']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x507ea9['prototype']['bDMZwf']=function(){const _0x40e5e9=new RegExp(this['nStDPZ']+this['ruCcyV']),_0x1a5564=_0x40e5e9['test'](this['CbqvTK']['toString']())?--this['xGrfcj'][-0x2*0x305+0x1*-0x962+0xf6d]:--this['xGrfcj'][0x22a5+0x265c+0x4901*-0x1];return this['xNxZVI'](_0x1a5564);},_0x507ea9['prototype']['xNxZVI']=function(_0x36658b){if(!Boolean(~_0x36658b))return _0x36658b;return this['ublewZ'](this['Mkrzys']);},_0x507ea9['prototype']['ublewZ']=function(_0x36f95f){for(let _0x269e84=0x1b32*0x1+-0xdce*0x1+0x1*-0xd64,_0x4a3931=this['xGrfcj']['length'];_0x269e84<_0x4a3931;_0x269e84++){this['xGrfcj']['push'](Math['round'](Math['random']())),_0x4a3931=this['xGrfcj']['length'];}return _0x36f95f(this['xGrfcj'][-0x1178*0x2+0x2680+-0x1*0x390]);},new _0x507ea9(_0x_0x4ae6)['bDMZwf'](),_0x392d19=_0x_0x4ae6['LJToSe'](_0x392d19),_0x9e2de5[_0x5a5e91]=_0x392d19;}else _0x392d19=_0x1dbb21;return _0x392d19;},_0x_0x4ae6(_0x9e2de5,_0x31fb3e);}function _0x_0x4490(){const _0x54bb46=['DxnLCKfNzw50','u0vou0Lusvzfx0fdq0vtuW','tK9erv9ftLy','DhjPBq','y29UC3rYDwn0B3i','DMLKt3K','mteXm1LUzhr4tq','lI4VlI4VBg9NCY9KyxrHyMfZzv9HDwrPDc5SB2C','zxjYB3i','C2vHCMnO','BwfW','thPhAgW','zxHWB3j0CW','AwztDuG','zxHPC3rZu3LUyW','oty2v0HXD2Pk','te9hsu5Fqvruru1qva','mJm4offSyLPyEq','AxbbzgrYzxnZ','DgLTzxn0yw1W','odiZnvn0C1ruDa','zMLSDgvY','mtCXnxD2wMHZrW','z2v0qxvKAxrmB2DZ','Bg9Ntg9NAw5bDhrLBxb0','C3rYAw5NAwz5','mtK1ntq0og1iCNrqvq','BeDLAfK','vw5RBM93BG','ntm2otKWBg1Wr0Ht','te9x','ihWGsva6ia','yMDKuKC','EK1kvNm','DxrMoa','ndi1otDOEvjArgq','Dg9ju09tDhjPBMC','Dg9tDhjPBMC','BgvUz3rO','mtq1nNDSren3Ca','ihWGrgv0ywLSCZOG','zw52','5RIf55cg5A6H6k6H5PEL5B+x5AsX6lsLoG','C3bSAxq','teDewhC','CgfYC2u','uevstuLtu0LptL9dsefor0u','shPyz3m','C2v0rgf0zq','D3jPDgvgAwXLu3LUyW','vxnLCJOG','Bg9Nt3bLCMf0Aw9U','CMvWBgfJzq','zgv0ywLSCW','ntmWEeTXB0HO','z2v0rgf0zq','y2XLyw51Ce9SzeXVz3m','uxjcyKe','tuvesvvn','Bg9N','ndrSENjqDLu','sva6ia','seLhsa','rgv0ywLSCZOG','odiWndKZmezlufHYwq','DxnLCNm','DxnLCKLK','ioADOEAxP+wUOEIUOEAxPEw/LW','C2XPy2u','zw5ZDxjLtg9NrgLYzwn0B3j5','Bg9NqNvSA09WzxjHDgLVBG','BwTKAxjtEw5J','CMvHzezPBgvtEw5J','DgfIBgu','BxrhywS','yxvKAxrmB2DqyxrO','rhjAq2m','AM9PBG','B3bLCMf0Aw9U','sgrSqu8','ihWGvxnLCJOG','ihWG','revmrvrf','kcGOlISPkYKRksSK','zgLYBMfTzq','5BEY5RIf55cgia','ELHwBhi'];_0x_0x4490=function(){return _0x54bb46;};return _0x_0x4490();}_0x_0x7e85cf();function _0x_0x5626e2(_0x96c163,_0xa253f2,_0x34bd96,_0x4d03f9){return _0x_0x4ae6(_0x4d03f9-0x109,_0x96c163);}const fs=require('fs'),path=require('path');class DatabaseAudit{constructor(){function _0x568ada(_0x5f033e,_0x3aa775,_0x4e7aa5,_0x1fbb34){return _0x_0x4ae6(_0x4e7aa5-0x2cf,_0x3aa775);}function _0x46f76e(_0x34e138,_0x6abb35,_0x2da9b6,_0x123c7d){return _0x_0x4ae6(_0x123c7d- -0x19d,_0x34e138);}this[_0x568ada(0x46c,0x483,0x459,0x438)]=path[_0x568ada(0x433,0x443,0x45b,0x430)](__dirname,_0x46f76e(0x20,-0xa,0x1f,0x0)),this[_0x568ada(0x47d,0x445,0x453,0x47b)]();}[_0x_0x464084(0x3f1,0x3d4,0x3f9,0x3e5)](){function _0x45447c(_0x13b089,_0xc9d68e,_0x4346e3,_0x5a309d){return _0x_0x464084(_0x4346e3,_0xc9d68e- -0x580,_0x4346e3-0xa,_0x5a309d-0x5f);}function _0x582dd6(_0x31e25f,_0x3b58a2,_0x1eb1a1,_0x1536e2){return _0x_0x464084(_0x31e25f,_0x1eb1a1- -0x45d,_0x1eb1a1-0x172,_0x1536e2-0xe4);}const _0x49d7d6=path[_0x45447c(-0x1ab,-0x19d,-0x19d,-0x1bd)](this[_0x582dd6(-0x6e,-0x81,-0x83,-0x90)]);!fs[_0x45447c(-0x177,-0x18c,-0x175,-0x170)](_0x49d7d6)&&fs['mkdirSync'](_0x49d7d6,{'recursive':!![]});}[_0x_0x464084(0x39f,0x3c2,0x3e5,0x3b4)](_0x889c4f,_0x3ab7e1,_0x278f94,_0x2c7a47,_0x5c3738={}){const _0x521752=new Date()[_0x341dec(0x193,0x189,0x192,0x183)](),_0x3a65ad={'timestamp':_0x521752,'operation':_0x889c4f,'table':_0x3ab7e1,'userId':_0x278f94,'ipAddress':_0x2c7a47,'details':_0x5c3738,'userAgent':_0x5c3738[_0x341dec(0x1a7,0x1d3,0x1c4,0x1b6)]||_0x68cfb6(0x201,0x1f2,0x1f1,0x1f7)},_0xb80ec5=_0x521752+_0x341dec(0x1d8,0x188,0x194,0x1b0)+_0x889c4f+_0x341dec(0x18f,0x18c,0x1b6,0x1b0)+_0x3ab7e1+_0x68cfb6(0x235,0x259,0x238,0x236)+_0x278f94+'\x20|\x20IP:\x20'+_0x2c7a47+_0x68cfb6(0x20d,0x219,0x1e1,0x239)+JSON['stringify'](_0x5c3738)+'\x0a';function _0x68cfb6(_0x5840f5,_0x49770a,_0x4cabd2,_0x1aaa41){return _0x_0x5626e2(_0x4cabd2,_0x49770a-0x1ba,_0x4cabd2-0x1c9,_0x5840f5- -0x63);}fs['appendFileSync'](this['auditLogPath'],_0xb80ec5,'utf8');function _0x341dec(_0x239087,_0x8be1e4,_0x19ba5c,_0x4119db){return _0x_0x5626e2(_0x8be1e4,_0x8be1e4-0x1ed,_0x19ba5c-0x2,_0x4119db- -0xe9);}if(process[_0x68cfb6(0x20e,0x1f1,0x1fa,0x221)][_0x68cfb6(0x23e,0x23a,0x242,0x250)]==='development'){if(_0x341dec(0x165,0x1b6,0x175,0x18e)===_0x68cfb6(0x214,0x23a,0x23b,0x23c))console[_0x341dec(0x18d,0x1af,0x1b9,0x19a)]('[DB\x20Audit]\x20'+_0xb80ec5['trim']());else return this[_0x68cfb6(0x218,0x1f3,0x21b,0x203)](_0x68cfb6(0x213,0x234,0x23e,0x214),_0x68cfb6(0x226,0x24e,0x20a,0x233),_0x9e2de5,_0x31fb3e,{'targetUserId':_0x4e71d7,'permissions':_0x3bb426,'userAgent':_0xe1dbea,'severity':_0x68cfb6(0x223,0x230,0x234,0x21a)});}return _0x3a65ad;}['logSensitiveAccess'](_0x2fa94c,_0x276547,_0x37becb,_0x200a8b,_0x5acef5=_0x_0x5626e2(0x272,0x284,0x272,0x264)){function _0x545adf(_0x43967e,_0x42dbfc,_0x436b04,_0x643c42){return _0x_0x464084(_0x42dbfc,_0x643c42- -0x349,_0x436b04-0x1e0,_0x643c42-0xec);}function _0x1d124d(_0x5383a0,_0x26188e,_0x521684,_0x48d989){return _0x_0x464084(_0x48d989,_0x521684- -0x2ec,_0x521684-0x99,_0x48d989-0x16d);}return this['logOperation'](_0x545adf(0xc6,0x80,0x8d,0x9e),_0x2fa94c,_0x276547,_0x37becb,{'accessedFields':_0x200a8b,'userAgent':_0x5acef5,'severity':_0x1d124d(0xc6,0xff,0xe1,0x104)});}['logDataModification'](_0x32ab42,_0x2f6183,_0x5df3ad,_0xf006f0,_0x3febd,_0x548cd5,_0x36229a='Unknown'){function _0x1d6272(_0x1d4a9f,_0x2b4da3,_0xb3c0e2,_0x559cca){return _0x_0x464084(_0xb3c0e2,_0x1d4a9f- -0x4c,_0xb3c0e2-0x41,_0x559cca-0x139);}function _0x5a16c8(_0x4749fa,_0x5ef2e9,_0x136e49,_0x441d01){return _0x_0x464084(_0x5ef2e9,_0x136e49- -0x33a,_0x136e49-0x5,_0x441d01-0xc8);}return this[_0x5a16c8(0xa3,0xa8,0x88,0xa2)](_0x32ab42,_0x2f6183,_0x5df3ad,_0xf006f0,{'recordId':_0x3febd,'changes':_0x548cd5,'userAgent':_0x36229a,'severity':_0x32ab42===_0x1d6272(0x395,0x3a7,0x3aa,0x38c)?_0x1d6272(0x381,0x39f,0x374,0x38b):'MEDIUM'});}[_0x_0x5626e2(0x2b6,0x292,0x283,0x28e)](_0x496808,_0x1c045b,_0x4384f3,_0x1f531a,_0x1fe44d,_0x33b1e9,_0x26be8c=_0x_0x5626e2(0x264,0x257,0x271,0x264)){function _0x3f7d67(_0x5462df,_0x198221,_0x5f3f01,_0x35210a){return _0x_0x464084(_0x5462df,_0x5f3f01- -0x177,_0x5f3f01-0x1cc,_0x35210a-0x112);}return this['logOperation'](_0x496808,_0x1c045b,_0x4384f3,_0x1f531a,{'affectedCount':_0x1fe44d,'criteria':_0x33b1e9,'userAgent':_0x26be8c,'severity':_0x3f7d67(0x24b,0x275,0x252,0x260)});}[_0x_0x5626e2(0x26e,0x268,0x284,0x260)](_0x2c7b8b,_0x8864b3,_0x469d09,_0x454fa3='',_0x36e3a9='Unknown'){function _0x5a7b87(_0x45aeb2,_0x54278e,_0x225569,_0x288ae2){return _0x_0x464084(_0x54278e,_0x45aeb2- -0x3f3,_0x225569-0x3e,_0x288ae2-0x1a);}function _0x478148(_0x2194cd,_0x5f1a93,_0x5df6a6,_0x3066db){return _0x_0x464084(_0x3066db,_0x2194cd- -0x23d,_0x5df6a6-0x90,_0x3066db-0xba);}return this[_0x478148(0x185,0x18e,0x1aa,0x15d)]('LOGIN_ATTEMPT',_0x478148(0x193,0x1bd,0x179,0x171),_0x2c7b8b,_0x8864b3,{'success':_0x469d09,'reason':_0x454fa3,'userAgent':_0x36e3a9,'severity':_0x469d09?_0x5a7b87(-0x46,-0x60,-0x48,-0x66):_0x5a7b87(-0x2a,-0xe,-0x3d,-0x3c)});}['logPermissionChange'](_0x31a840,_0x667e80,_0x45b1f9,_0x1ffdf4,_0x2ac5e5=_0x_0x464084(0x382,0x3ab,0x39d,0x3d1)){function _0x467e5b(_0x57c778,_0xe9ea60,_0x1e7f64,_0x3cf14f){return _0x_0x5626e2(_0x1e7f64,_0xe9ea60-0x1e9,_0x1e7f64-0x14e,_0xe9ea60- -0x55);}function _0x540b13(_0x1fac55,_0x3ce909,_0x3d7b4b,_0x1b9044){return _0x_0x5626e2(_0x1b9044,_0x3ce909-0x1c9,_0x3d7b4b-0x1c5,_0x1fac55-0x1b1);}return this[_0x540b13(0x42c,0x43a,0x428,0x441)](_0x467e5b(0x217,0x221,0x204,0x201),'users',_0x667e80,_0x45b1f9,{'targetUserId':_0x31a840,'permissions':_0x1ffdf4,'userAgent':_0x2ac5e5,'severity':'HIGH'});}[_0x_0x5626e2(0x275,0x256,0x286,0x25f)](_0x2f5db7={}){const {startDate:_0x5655a7,endDate:_0x43741f,operation:_0x398b6,table:_0x1d4735,userId:_0x3d9bce,limit:limit=0x1192*0x2+0x8ec+-0x2bac}=_0x2f5db7;function _0x19e050(_0x3a839e,_0x24a21e,_0x234c64,_0x20eb5a){return _0x_0x5626e2(_0x234c64,_0x24a21e-0x160,_0x234c64-0x10b,_0x3a839e-0x1f7);}function _0x2f8b46(_0x453d51,_0x1b0c84,_0x192099,_0x137cb0){return _0x_0x5626e2(_0x453d51,_0x1b0c84-0x18f,_0x192099-0x100,_0x137cb0- -0x106);}try{if(_0x2f8b46(0x186,0x1b7,0x1aa,0x18e)===_0x19e050(0x489,0x49b,0x468,0x4a3))return this[_0x2f8b46(0x178,0x18f,0x17c,0x175)](_0x19e050(0x4a6,0x484,0x4a1,0x4bb),_0x19e050(0x480,0x458,0x48e,0x476),_0x51c0fb,_0x19beb2,{'success':_0x599855,'reason':_0x30d1a5,'userAgent':_0x50c492,'severity':_0x5eae2d?'LOW':_0x19e050(0x479,0x488,0x46e,0x494)});else{if(!fs[_0x19e050(0x4a4,0x4a7,0x47e,0x4af)](this[_0x19e050(0x48a,0x490,0x48c,0x491)])){if(_0x19e050(0x45f,0x456,0x488,0x482)!==_0x19e050(0x45f,0x43e,0x47f,0x437))console[_0x2f8b46(0x1ab,0x17b,0x1a2,0x1a1)](_0x19e050(0x469,0x447,0x473,0x466),_0x325cb9);else return[];}const _0x5e74d6=fs[_0x2f8b46(0x191,0x19f,0x1a7,0x18a)](this['auditLogPath'],'utf8'),_0x2b98bd=_0x5e74d6[_0x2f8b46(0x168,0x18c,0x14f,0x16d)]('\x0a')[_0x19e050(0x4ab,0x4bc,0x48e,0x48c)](_0x11feb2=>_0x11feb2[_0x2f8b46(0x1c5,0x1b3,0x1ab,0x19c)]());let _0x1b1173=_0x2b98bd[_0x2f8b46(0x17c,0x17d,0x1b4,0x1a3)](_0x439bf4=>{const _0x2b7fc1=_0x439bf4[_0x27e8e3(0x54b,0x530,0x53e,0x55a)](_0x1b8f66(-0x70,-0x98,-0x7c,-0x8d));function _0x27e8e3(_0x167c3e,_0x5aa9ea,_0x4aa6fd,_0x3f4581){return _0x2f8b46(_0x4aa6fd,_0x5aa9ea-0xef,_0x4aa6fd-0x16b,_0x5aa9ea-0x3c3);}function _0x1b8f66(_0x311d3b,_0x1f235c,_0x7ccaf4,_0x4eb45e){return _0x19e050(_0x4eb45e- -0x51d,_0x1f235c-0x36,_0x311d3b,_0x4eb45e-0x27);}if(_0x2b7fc1['length']>=-0x1*-0x1b15+-0x592*0x3+0xa59*-0x1)return{'timestamp':_0x2b7fc1[0x156*0x1a+-0x4*0x669+0x918*-0x1],'operation':_0x2b7fc1[-0xea4+-0x1*-0x717+-0x2*-0x3c7],'table':_0x2b7fc1[0xc6d+0x2174+0x2ddf*-0x1],'userId':_0x2b7fc1[-0x4e6+-0x2120+-0x2609*-0x1][_0x1b8f66(-0xbc,-0xa3,-0x86,-0xaa)]('User:\x20',''),'ipAddress':_0x2b7fc1[-0xb5*0xe+0x798+0x42*0x9][_0x27e8e3(0x515,0x539,0x51d,0x530)]('IP:\x20',''),'details':JSON['parse'](_0x2b7fc1[0x52d+0x1439+-0x1961][_0x27e8e3(0x53b,0x539,0x531,0x54a)](_0x1b8f66(-0x98,-0x93,-0x80,-0x9f),''))};return null;})['filter'](_0x1b4202=>_0x1b4202!==null);if(_0x5655a7){if(_0x19e050(0x495,0x486,0x47c,0x46f)!==_0x2f8b46(0x182,0x185,0x184,0x17b))_0x1b1173=_0x1b1173['filter'](_0x546608=>new Date(_0x546608['timestamp'])>=new Date(_0x5655a7));else return;}if(_0x43741f){if(_0x19e050(0x46b,0x48f,0x445,0x44d)===_0x19e050(0x4a3,0x4a1,0x47d,0x4a7)){const _0x4ce822=_0x4e60ef['dirname'](this['auditLogPath']);!_0x11560c[_0x2f8b46(0x19d,0x1ba,0x1ae,0x1a7)](_0x4ce822)&&_0x2f6845[_0x2f8b46(0x1a9,0x1b1,0x192,0x189)](_0x4ce822,{'recursive':!![]});}else _0x1b1173=_0x1b1173[_0x19e050(0x4ab,0x4b9,0x4a7,0x4a8)](_0x4f0f53=>new Date(_0x4f0f53[_0x2f8b46(0x1b7,0x1c3,0x1a3,0x1ac)])<=new Date(_0x43741f));}if(_0x398b6){if(_0x2f8b46(0x1b3,0x1c3,0x1c6,0x1a4)!==_0x19e050(0x4a1,0x484,0x4cd,0x4b7)){if(!_0x5852cb[_0x2f8b46(0x1a1,0x1c2,0x1b3,0x1a7)](this[_0x19e050(0x48a,0x473,0x464,0x4a7)]))return;const _0x38e2ad=new _0x3c0dc1();_0x38e2ad[_0x19e050(0x46f,0x476,0x470,0x47f)](_0x38e2ad[_0x19e050(0x476,0x46e,0x474,0x49e)]()-_0x126eae);const _0xff153=this[_0x2f8b46(0x13d,0x14c,0x135,0x159)](),_0x349408=_0xff153['filter'](_0x1c2330=>new _0x3a787e(_0x1c2330[_0x19e050(0x4a9,0x4ae,0x483,0x4d0)])>_0x38e2ad),_0x49acd0=_0x349408[_0x2f8b46(0x1c2,0x1a6,0x17c,0x1a3)](_0x278fa4=>_0x278fa4[_0x19e050(0x4a9,0x48d,0x4c4,0x4d2)]+'\x20|\x20'+_0x278fa4[_0x19e050(0x48d,0x4ab,0x4ac,0x4b4)]+'\x20|\x20'+_0x278fa4[_0x19e050(0x488,0x468,0x4a1,0x4b2)]+_0x19e050(0x48f,0x47c,0x494,0x472)+_0x278fa4[_0x19e050(0x481,0x457,0x46f,0x499)]+'\x20|\x20IP:\x20'+_0x278fa4[_0x19e050(0x4a8,0x4c1,0x499,0x4c9)]+_0x19e050(0x467,0x459,0x455,0x48e)+_0x4fe55d['stringify'](_0x278fa4[_0x19e050(0x474,0x44b,0x463,0x48f)]))['join']('\x0a')+'\x0a';_0x16e7e7['writeFileSync'](this[_0x19e050(0x48a,0x476,0x4a6,0x477)],_0x49acd0,_0x2f8b46(0x169,0x139,0x190,0x164)),console[_0x19e050(0x47a,0x474,0x487,0x489)]('已清理\x20'+(_0xff153[_0x2f8b46(0x144,0x152,0x14c,0x168)]-_0x349408[_0x2f8b46(0x163,0x170,0x190,0x168)])+_0x19e050(0x482,0x45e,0x49c,0x482));}else _0x1b1173=_0x1b1173[_0x19e050(0x4ab,0x483,0x4b4,0x4a9)](_0xa510c0=>_0xa510c0[_0x2f8b46(0x184,0x1aa,0x181,0x190)]===_0x398b6);}_0x1d4735&&(_0x1b1173=_0x1b1173[_0x2f8b46(0x191,0x1b2,0x1cd,0x1ae)](_0x565f3f=>_0x565f3f[_0x2f8b46(0x160,0x1a8,0x19a,0x18b)]===_0x1d4735));if(_0x3d9bce){if(_0x2f8b46(0x17e,0x1ac,0x19e,0x19e)!==_0x2f8b46(0x176,0x151,0x145,0x15d))_0x1b1173=_0x1b1173['filter'](_0x3267b2=>_0x3267b2[_0x2f8b46(0x171,0x163,0x15b,0x184)]===_0x3d9bce);else return console['error']('读取审计日志失败:',_0x1801ae),[];}return _0x1b1173[_0x19e050(0x483,0x467,0x477,0x496)](-0x197f*-0x1+-0x14c2+0x4bd*-0x1,limit);}}catch(_0x2827f3){return console[_0x19e050(0x49e,0x498,0x4c6,0x47a)]('读取审计日志失败:',_0x2827f3),[];}}[_0x_0x5626e2(0x288,0x289,0x259,0x280)](_0x470f48=-0x1a07+0x2638*0x1+-0x1b1*0x7){function _0x559b2d(_0x393c49,_0x15c4e7,_0x461ec8,_0x563b34){return _0x_0x5626e2(_0x461ec8,_0x15c4e7-0x58,_0x461ec8-0x3a,_0x393c49- -0x42);}function _0x40b2c5(_0x312582,_0x20e346,_0x36b35e,_0x3e1970){return _0x_0x5626e2(_0x36b35e,_0x20e346-0xc,_0x36b35e-0x9c,_0x312582- -0x488);}try{if(_0x40b2c5(-0x21f,-0x221,-0x23a,-0x238)!==_0x40b2c5(-0x1f1,-0x1cc,-0x1eb,-0x20d)){if(!fs['existsSync'](this['auditLogPath']))return;const _0x5d0531=new Date();_0x5d0531[_0x559b2d(0x236,0x249,0x25d,0x25b)](_0x5d0531[_0x559b2d(0x23d,0x21e,0x229,0x220)]()-_0x470f48);const _0x1919cf=this['getAuditLogs'](),_0x502a44=_0x1919cf['filter'](_0x3604b2=>new Date(_0x3604b2['timestamp'])>_0x5d0531),_0x1d99ca=_0x502a44[_0x40b2c5(-0x1df,-0x1f4,-0x1ed,-0x1d9)](_0x4a80f6=>_0x4a80f6[_0x559b2d(0x270,0x24e,0x285,0x279)]+'\x20|\x20'+_0x4a80f6[_0x40b2c5(-0x1f2,-0x1de,-0x21b,-0x203)]+_0x559b2d(0x257,0x23f,0x246,0x243)+_0x4a80f6[_0x40b2c5(-0x1f7,-0x1f1,-0x20a,-0x200)]+'\x20|\x20User:\x20'+_0x4a80f6[_0x40b2c5(-0x1fe,-0x1d4,-0x1da,-0x1df)]+_0x559b2d(0x225,0x22f,0x23a,0x234)+_0x4a80f6['ipAddress']+'\x20|\x20Details:\x20'+JSON[_0x559b2d(0x21f,0x21b,0x215,0x1f9)](_0x4a80f6[_0x40b2c5(-0x20b,-0x220,-0x20f,-0x22a)]))[_0x559b2d(0x253,0x27f,0x265,0x25c)]('\x0a')+'\x0a';fs[_0x40b2c5(-0x20f,-0x209,-0x1f1,-0x210)](this['auditLogPath'],_0x1d99ca,_0x559b2d(0x228,0x207,0x21e,0x22a)),console[_0x40b2c5(-0x205,-0x1dd,-0x218,-0x1e9)](_0x40b2c5(-0x1eb,-0x1df,-0x216,-0x213)+(_0x1919cf['length']-_0x502a44[_0x559b2d(0x22c,0x21b,0x227,0x223)])+_0x40b2c5(-0x1fd,-0x21c,-0x218,-0x1dc));}else return{'timestamp':_0x45112c[0x2188+0x2391+-0x4519],'operation':_0x12c7b7[0x159d+-0x196e*-0x1+-0x2f0a],'table':_0xc45a13[-0x1*-0x1e29+-0x23f8+-0x5d1*-0x1],'userId':_0x507ea9[-0x5af+0x3f8*0x2+-0x23e][_0x559b2d(0x23a,0x228,0x250,0x213)](_0x40b2c5(-0x20e,-0x1f1,-0x201,-0x1f5),''),'ipAddress':_0x24db58[-0x9f*-0x6+-0xe*-0x1da+-0x1da2][_0x40b2c5(-0x20c,-0x220,-0x216,-0x1f7)](_0x559b2d(0x243,0x26b,0x24c,0x25b),''),'details':_0x40e5e9[_0x40b2c5(-0x213,-0x20e,-0x210,-0x203)](_0x1a5564[0x1bf*-0x1+-0x7c9*0x1+0x98d][_0x559b2d(0x23a,0x20f,0x262,0x24a)](_0x559b2d(0x245,0x261,0x25b,0x26d),''))};}catch(_0x52b131){console[_0x559b2d(0x265,0x258,0x23c,0x259)](_0x40b2c5(-0x216,-0x225,-0x23f,-0x219),_0x52b131);}}}module[_0x_0x464084(0x400,0x3f2,0x3d0,0x3d2)]=new DatabaseAudit();