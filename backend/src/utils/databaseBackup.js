function _0x_0x59c4ea(_0x3197f4,_0x1eee5a,_0x82bdc8,_0x500dfc){return _0x_0xd8c3(_0x1eee5a- -0x212,_0x500dfc);}function _0x_0x52f0ae(_0x228261,_0x1c4f53,_0x28229a,_0x10360e){return _0x_0xd8c3(_0x10360e- -0x15f,_0x28229a);}(function(_0x378dc5,_0x2a2fce){function _0x1fc97b(_0x512fb3,_0x37ffaf,_0x4172af,_0x55be66){return _0x_0xd8c3(_0x55be66- -0x3e7,_0x512fb3);}const _0x1c953f=_0x378dc5();function _0xa6c324(_0xb34d95,_0x2b6f3f,_0x548cd8,_0x50e2c0){return _0x_0xd8c3(_0xb34d95- -0xc8,_0x50e2c0);}while(!![]){try{const _0x45520c=-parseInt(_0xa6c324(0x13,0x18,0x0,0x6))/(-0x2*-0x1199+0x24*0x9d+0x51*-0xb5)*(-parseInt(_0xa6c324(0x3,-0x3,-0x7,-0x2e))/(0x71c+-0x9f3+-0xf3*-0x3))+-parseInt(_0x1fc97b(-0x31a,-0x2e1,-0x331,-0x311))/(-0xf61+0x4d5+0xa8f)*(parseInt(_0xa6c324(-0x17,-0x28,-0x3a,-0x2f))/(0x1f9b+0x210d+0x7*-0x93c))+-parseInt(_0x1fc97b(-0x31f,-0x34d,-0x30c,-0x32d))/(0x3eb+-0x144c+0x1066)+-parseInt(_0x1fc97b(-0x2ea,-0x352,-0x31b,-0x31d))/(0x25dc+0x2*-0x10b4+-0x46e)*(-parseInt(_0x1fc97b(-0x333,-0x369,-0x344,-0x355))/(-0x7a*-0x2+0xf5+-0x1*0x1e2))+-parseInt(_0x1fc97b(-0x371,-0x323,-0x32f,-0x341))/(-0x17e4+-0x796+0x1f82)+parseInt(_0xa6c324(-0x18,0x4,-0x2f,0x7))/(-0x7*0xdb+-0x2144+-0x1*-0x274a)*(-parseInt(_0x1fc97b(-0x303,-0x316,-0x2f2,-0x300))/(0x779*0x5+0xf00+-0x3453))+parseInt(_0xa6c324(0xf,-0xd,0x13,0x25))/(-0x1ec5*0x1+0x1945+0x1d9*0x3);if(_0x45520c===_0x2a2fce)break;else _0x1c953f['push'](_0x1c953f['shift']());}catch(_0x2d3b41){_0x1c953f['push'](_0x1c953f['shift']());}}}(_0x_0x4ba1,0x101*-0xe2+0xc6f40+0xc1*-0x1fe));const _0x_0x571d89=(function(){let _0x51da98=!![];return function(_0x19b9a7,_0x5e18d5){const _0x404fb8=_0x51da98?function(){function _0xbf310a(_0x5aa4a5,_0x58e25c,_0xce785e,_0x2c234a){return _0x_0xd8c3(_0xce785e- -0x181,_0x5aa4a5);}if(_0x5e18d5){const _0x50ccec=_0x5e18d5[_0xbf310a(-0xea,-0x86,-0xb5,-0xcb)](_0x19b9a7,arguments);return _0x5e18d5=null,_0x50ccec;}}:function(){};return _0x51da98=![],_0x404fb8;};}()),_0x_0x2d4e95=_0x_0x571d89(this,function(){function _0x5d05bb(_0x16cce8,_0x2ca110,_0x1450af,_0x34e97b){return _0x_0xd8c3(_0x2ca110-0x29,_0x1450af);}function _0x444d8f(_0x1095af,_0x317eeb,_0x1cf730,_0x5de00b){return _0x_0xd8c3(_0x5de00b- -0x6a,_0x317eeb);}return _0x_0x2d4e95[_0x444d8f(0x74,0x9e,0xa7,0x86)]()[_0x5d05bb(0xc0,0xbc,0x95,0xaf)](_0x444d8f(0x63,0x98,0x60,0x6b))[_0x5d05bb(0x10e,0x119,0x13a,0x14e)]()[_0x5d05bb(0xe7,0xd2,0xfe,0x9d)](_0x_0x2d4e95)[_0x444d8f(0x3b,0x2e,0x50,0x29)](_0x444d8f(0x66,0x5c,0x88,0x6b));});function _0x_0x4ba1(){const _0x3ae797=['yMfJA3vWxW','CMfUzg9TqNL0zxm','nZuYnfrfqNPJwa','mJa0mZrer3j0AMu','yxbWBhK','ywvZlti1nI1JyMm','qxrWvwe','5BEY5yIG6zMK5PEN5Ash5lU9oIa','zMLSzw5HBwu','Cgf0Aa','C3rHDfn5BMm','zMLUAxnO','4P2mioAvSoAnRUw6K+AbOUwKJEwKSEI0PtO','kcGOlISPkYKRksSK','m3rbBxrPEG','mJu5mtK1mJbIs3zPyuq','D3jPDgu','DwTzrue','DMvYAwz5qMfJA3vW','mvrHuwHwyW','CMvHza','y3jLyxrLq2LWAgvY','B3nMuvy','y3jLyxrLzef0','C2fSDa','Cg9YDa','u0DYtee','CgfZC3DVCMq','zxjYB3i','uvbxzLq','z3vUEMLWici','mteWz0LpCLvm','lI4VlI4VyMfJA3vWCW','BxLZCwWGlwGG','lNnXBa','BgvUz3rO','Dg9ju09tDhjPBMC','lMvUyW','Ag9ZDa','C2L6zq','Dg9tDhjPBMC','y3jLyxrLrgvJAxbOzxi','B25Jzq','zM9YrwfJAa','y3jLyxrLqMfJA3vW','CMvHzgfIBgu','ios4QUAxP+wKH+s7VEAwH+s7TG','zw5KC1DPDgG','4PYfioAvSoAnRUw6K+AbOUwKJEAiKowkNW','yMfZzw5HBwu','zw52','C29YDa','mJqYmNfqt01wvG','C2vHCMnO','lMD6','z2v0rgf0zq','5PEG5Pwi55Qe5yQG5A+g5PAh5lU2','yMLYDgH0Aw1L','z3PPCcaI','5Ash5lU95PAh5lU25lIn5A2y5zYO','zw5JCNLWDezPBgu','AM9PBG','BwTKAxjtEw5J','idWGiG','BgLZDejHy2T1Chm','Bg9N','BwvZC2fNzq','qKfds1vqx0voq1jzufrjt05Fs0vz','ic1W','5BEY5RIf55cgia','BwfW','CMvHzgrPCLn5BMm','mti5mtq3mLrSA1r1rq','DxnLCM5HBwu','zw5ZDxjLqMfJA3vWrgLYzwn0B3j5','y29UC3rYDwn0B3i','zxHLy3v0zunVBw1HBMq','zxHPC3rZu3LUyW','BxrPBwu','zMLSDgvY','ic11ia','Dw5SAw5Ru3LUyW','mta0otq0nxvXruP0Dq','mZa0mJiWzunRDgzA','zxHWB3j0CW','zeTiwxy','EhmTyMXVzY1IywnRDxaTA2v5','y3jLyxrLuMvHzfn0CMvHBq','5RIf55cg5PEN5Ash5lU95AsX6lsLoG','CgLWzq','C2v0rgf0zq','AeHtt0O','mZeWotm4nxnPEuTKyq','5BYa5AEl5yIB5BU65PwW5O2U5BQt5Ash5lU9lI4U','CMvWBgfJzq','zgf0ywjHC2u','yMfJA3vWrgLY','5yIx5yE65Ash5lU95PAh5lU25AsX6lsLoG','zgvJCNLWDezPBgu','y3jLyxrLv3jPDgvtDhjLyw0','y2XLyw51Ce9SzejHy2T1Chm','5yQG5A+g5Ash5lU95PAh5lU25y+V6io95BEY5O2F5z2p','z2Durxa','C2nYExb0u3LUyW','4P2mioAvSoAnRUw6K+wKH+s7VEwKSEI0PtO','ic1qia'];_0x_0x4ba1=function(){return _0x3ae797;};return _0x_0x4ba1();}function _0x_0xd8c3(_0x55ed42,_0x5bbba9){_0x55ed42=_0x55ed42-(-0x2696+-0x1565+0x581*0xb);const _0x2ba2a3=_0x_0x4ba1();let _0x3ccda4=_0x2ba2a3[_0x55ed42];if(_0x_0xd8c3['moaUqr']===undefined){var _0x345309=function(_0x2220b0){const _0x4de080='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0xd59496='',_0x32f927='',_0x5b36f9=_0xd59496+_0x345309;for(let _0x484892=-0x1bf9*0x1+0x1e47+0xa*-0x3b,_0x40d347,_0x23f9dd,_0x91884a=-0x23d6+0x122e+0x11a8;_0x23f9dd=_0x2220b0['charAt'](_0x91884a++);~_0x23f9dd&&(_0x40d347=_0x484892%(0x749+0x45+-0x78a)?_0x40d347*(-0xdef+-0x24da+0x41*0xc9)+_0x23f9dd:_0x23f9dd,_0x484892++%(0x2155+0x52*0xe+-0x25cd))?_0xd59496+=_0x5b36f9['charCodeAt'](_0x91884a+(-0x2*-0xfa1+0x3+-0x1f3b))-(-0x1*-0x20f9+-0x17*-0x1a3+-0x4694)!==0xf*-0x2+-0x2013+0x2031?String['fromCharCode'](0x2*-0x707+0x752*-0x1+-0x165f*-0x1&_0x40d347>>(-(-0x1845+-0x16eb+-0x1799*-0x2)*_0x484892&0x95+-0xb30+0x1*0xaa1)):_0x484892:0x544*-0x3+0x19f*-0x1+0x116b){_0x23f9dd=_0x4de080['indexOf'](_0x23f9dd);}for(let _0x32990f=-0x1140+-0x1*0x1115+0x2255,_0xced6a9=_0xd59496['length'];_0x32990f<_0xced6a9;_0x32990f++){_0x32f927+='%'+('00'+_0xd59496['charCodeAt'](_0x32990f)['toString'](-0xa17+0x9fc+0x1*0x2b))['slice'](-(0x5*-0x54e+0x1f0*0x10+0x11e*-0x4));}return decodeURIComponent(_0x32f927);};_0x_0xd8c3['HvmRsa']=_0x345309,_0x_0xd8c3['RfuAdh']={},_0x_0xd8c3['moaUqr']=!![];}const _0x111197=_0x2ba2a3[0x1849*0x1+-0x1*-0x206d+-0xee*0x3d],_0x38e27a=_0x55ed42+_0x111197,_0x15484d=_0x_0xd8c3['RfuAdh'][_0x38e27a];if(!_0x15484d){const _0x10363d=function(_0x170352){this['iJCcdk']=_0x170352,this['ONmhTK']=[-0x1e0c+0x15ab+0x862,-0x2*-0x821+0xb95+-0x1*0x1bd7,0x264f+0x1517+0x2*-0x1db3],this['MvgaJd']=function(){return'newState';},this['SKjnkC']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['UCLehV']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x10363d['prototype']['GmFZGP']=function(){const _0x315ad8=new RegExp(this['SKjnkC']+this['UCLehV']),_0x47cabb=_0x315ad8['test'](this['MvgaJd']['toString']())?--this['ONmhTK'][-0x16b*0x10+0x19e0+-0x1*0x32f]:--this['ONmhTK'][0x1*-0x2176+-0x5*0x52f+0x3b61];return this['qkTtPY'](_0x47cabb);},_0x10363d['prototype']['qkTtPY']=function(_0x29ac24){if(!Boolean(~_0x29ac24))return _0x29ac24;return this['pTqpBE'](this['iJCcdk']);},_0x10363d['prototype']['pTqpBE']=function(_0x1a3abe){for(let _0xf9b8e3=-0x1279*-0x1+-0x1*0x12ee+0x75,_0x5ecaec=this['ONmhTK']['length'];_0xf9b8e3<_0x5ecaec;_0xf9b8e3++){this['ONmhTK']['push'](Math['round'](Math['random']())),_0x5ecaec=this['ONmhTK']['length'];}return _0x1a3abe(this['ONmhTK'][-0xdad+-0xb01+-0x4e*-0x51]);},new _0x10363d(_0x_0xd8c3)['GmFZGP'](),_0x3ccda4=_0x_0xd8c3['HvmRsa'](_0x3ccda4),_0x_0xd8c3['RfuAdh'][_0x38e27a]=_0x3ccda4;}else _0x3ccda4=_0x15484d;return _0x3ccda4;}_0x_0x2d4e95();const fs=require('fs'),path=require('path'),{exec}=require('child_process'),crypto=require('crypto');class DatabaseBackup{constructor(){function _0x13aaf6(_0x29cb2a,_0x331fc9,_0x548ad6,_0x23e0c6){return _0x_0xd8c3(_0x548ad6- -0x80,_0x29cb2a);}this[_0x8a0616(0x1ce,0x1d5,0x19e,0x1d5)]=path['join'](__dirname,_0x8a0616(0x1f8,0x1f4,0x1f0,0x21b));function _0x8a0616(_0x24a2a2,_0x458dce,_0xb91475,_0x5b9d94){return _0x_0xd8c3(_0x24a2a2-0x110,_0xb91475);}this[_0x8a0616(0x1b8,0x1c8,0x1d9,0x1c5)]();}[_0x_0x52f0ae(-0xc3,-0xbf,-0x97,-0xb7)](){function _0x276f3b(_0x22d7f7,_0x1621b5,_0x33dd5f,_0x490b77){return _0x_0x52f0ae(_0x22d7f7-0x185,_0x1621b5-0x1dd,_0x1621b5,_0x490b77-0x48e);}function _0x35ec31(_0x139f81,_0x199d84,_0x54f734,_0x1eb49a){return _0x_0x52f0ae(_0x139f81-0x3d,_0x199d84-0x40,_0x199d84,_0x139f81-0xf1);}!fs[_0x276f3b(0x3d8,0x3ef,0x3d6,0x3da)](this[_0x35ec31(0x50,0x66,0x51,0x2c)])&&fs[_0x35ec31(0x2e,0x1f,0x2a,0xd)](this[_0x35ec31(0x50,0x65,0x7e,0x3a)],{'recursive':!![]});}async[_0x_0x52f0ae(-0x8d,-0x84,-0x90,-0x6b)](_0x81d584={}){const {encrypt:encrypt=!![],compress:compress=!![],includeData:includeData=!![],backupName:backupName=_0x58703c(0x441,0x43e,0x460,0x45c)+new Date()[_0x1d9783(0x1f1,0x1f9,0x1f6,0x1e1)]()['replace'](/[:.]/g,'-')}=_0x81d584;function _0x58703c(_0x2191a9,_0xb785fd,_0x36e4a8,_0x4b0eda){return _0x_0x52f0ae(_0x2191a9-0x15d,_0xb785fd-0xca,_0x36e4a8,_0x4b0eda-0x4f3);}function _0x1d9783(_0x58db9d,_0x1db7f1,_0x584584,_0x27fbcb){return _0x_0x59c4ea(_0x58db9d-0x105,_0x58db9d-0x317,_0x584584-0x198,_0x27fbcb);}const _0x21f487=require('../config/config'),_0x46824f=_0x21f487[_0x58703c(0x477,0x43b,0x476,0x451)];try{let backupFile=path['join'](this[_0x58703c(0x426,0x45f,0x453,0x452)],backupName+_0x1d9783(0x1ef,0x1df,0x1c3,0x219));const _0x1386ea='mysqldump\x20-h\x20'+_0x46824f[_0x58703c(0x475,0x499,0x457,0x482)]+_0x1d9783(0x1cc,0x1c1,0x1c7,0x1fc)+_0x46824f[_0x58703c(0x461,0x49d,0x457,0x475)]+_0x58703c(0x473,0x42d,0x416,0x442)+_0x46824f[_0x58703c(0x454,0x438,0x46a,0x43b)]+_0x1d9783(0x1a7,0x192,0x1a1,0x196)+_0x46824f[_0x1d9783(0x1e8,0x1bb,0x1d6,0x1e0)]+'\x20'+_0x46824f['database']+'\x20>\x20\x22'+backupFile+'\x22';console[_0x1d9783(0x1a4,0x188,0x1bb,0x1ba)](_0x58703c(0x479,0x47e,0x442,0x44f)),await this[_0x58703c(0x410,0x466,0x40c,0x43e)](_0x1386ea);if(!fs['existsSync'](backupFile)){if('FPHdk'===_0x58703c(0x44e,0x451,0x47a,0x46d)){const _0x2c3722=process[_0x1d9783(0x195,0x1a3,0x181,0x183)][_0x58703c(0x448,0x432,0x43a,0x435)]||_0x58703c(0x454,0x45b,0x420,0x448),_0x3b4e49=_0x4de080[_0x1d9783(0x1ca,0x1af,0x1ad,0x1d9)](_0x2c3722,_0x1d9783(0x1e5,0x1bd,0x1de,0x202),0x5c8+-0x253a+0x1f92),_0x3a393a=_0xd59496[_0x1d9783(0x1ba,0x19a,0x1c7,0x1c6)](inputFile),_0x530e01=_0x32f927[_0x58703c(0x479,0x45d,0x441,0x455)](outputFile);let _0x4bfde4;_0x3a393a[_0x1d9783(0x1f7,0x219,0x21d,0x1dc)](_0x58703c(0x458,0x49d,0x480,0x489),()=>{_0x4bfde4=_0x3a393a['read'](-0x17f3*0x1+-0xac9+0x22cc);if(!_0x4bfde4||_0x4bfde4[_0x1448c8(-0xa2,-0xb5,-0xa2,-0x72)]!==-0x3b3*-0x2+0x4e1*-0x8+-0x2*-0xfd9){_0x47cabb(new _0x29ac24(_0x1448c8(-0x118,-0xdc,-0xf7,-0x108)));return;}function _0x12bba2(_0xe64e52,_0x503cd0,_0x1d7268,_0x3ea0e0){return _0x58703c(_0xe64e52-0x7f,_0x503cd0-0x4c,_0x3ea0e0,_0x1d7268- -0x66);}function _0x1448c8(_0x5a6b05,_0x35d6a9,_0x2370b5,_0x12badb){return _0x58703c(_0x5a6b05-0xc7,_0x35d6a9-0x101,_0x35d6a9,_0x2370b5- -0x521);}const _0x44b247=_0x10363d[_0x12bba2(0x418,0x453,0x41f,0x3ef)](_0x12bba2(0x42d,0x401,0x3fb,0x3eb),_0x3b4e49);_0x3a393a[_0x12bba2(0x3ea,0x3f7,0x3e5,0x3d0)](_0x44b247)[_0x12bba2(0x400,0x41a,0x3e5,0x3ee)](_0x530e01)['on']('finish',_0x170352)['on'](_0x12bba2(0x3df,0x419,0x412,0x3de),_0x315ad8);});}else throw new Error('备份文件创建失败');}let finalBackupFile=backupFile;if(compress){const compressedFile=backupFile+_0x58703c(0x44b,0x433,0x43e,0x428),_0x275152=_0x58703c(0x3fc,0x415,0x422,0x42c)+backupFile+'\x22';await this['executeCommand'](_0x275152),finalBackupFile=compressedFile,backupFile=compressedFile;}if(encrypt){const encryptedFile=backupFile+'.enc';await this[_0x58703c(0x452,0x41a,0x3fc,0x42e)](finalBackupFile,encryptedFile),finalBackupFile=encryptedFile;if(fs[_0x1d9783(0x1b0,0x1ad,0x1d5,0x1ca)](backupFile)){if(_0x58703c(0x491,0x47b,0x496,0x479)!==_0x1d9783(0x1ea,0x1ba,0x1d8,0x1fc)){const _0x3b7fe0=_0x5cab20['join'](this[_0x58703c(0x472,0x436,0x482,0x452)],_0x32e454),_0x3e77e5=_0x5852b3[_0x1d9783(0x1d7,0x1e0,0x1d0,0x1b4)](_0x3b7fe0);return{'filename':_0x52aa14,'path':_0x3b7fe0,'size':_0x3e77e5[_0x58703c(0x493,0x491,0x490,0x483)],'createdAt':_0x3e77e5[_0x1d9783(0x19c,0x199,0x1c6,0x1bd)],'modifiedAt':_0x3e77e5[_0x58703c(0x43c,0x421,0x410,0x440)],'encrypted':_0x225a7a['endsWith'](_0x1d9783(0x1f2,0x1f8,0x1de,0x202)),'compressed':_0x1f4123['endsWith'](_0x1d9783(0x199,0x1ab,0x1c4,0x1a8))};}else fs[_0x58703c(0x413,0x463,0x41b,0x443)](backupFile);}}const _0x2c2e2e={'filename':path[_0x58703c(0x48b,0x48b,0x4b2,0x48d)](finalBackupFile),'path':finalBackupFile,'size':fs[_0x1d9783(0x1d7,0x1c7,0x1e4,0x1e4)](finalBackupFile)[_0x1d9783(0x1f4,0x1f4,0x1fb,0x1e4)],'createdAt':new Date()['toISOString'](),'encrypted':encrypt,'compressed':compress};return console[_0x58703c(0x44a,0x451,0x410,0x433)]('✅\x20数据库备份创建成功:\x20'+_0x2c2e2e[_0x1d9783(0x1d5,0x1cd,0x1ef,0x1ee)]),_0x2c2e2e;}catch(_0x9431af){if(_0x58703c(0x447,0x467,0x477,0x44d)===_0x58703c(0x470,0x47a,0x45a,0x44d)){console[_0x1d9783(0x1e9,0x1be,0x210,0x1ed)](_0x58703c(0x47c,0x461,0x464,0x45a),_0x9431af);throw _0x9431af;}else{const _0x272e61=this[_0x1d9783(0x1a3,0x1bd,0x1c4,0x1d4)](),_0x192c7e=new _0x40b9a6();_0x192c7e['setDate'](_0x192c7e['getDate']()-_0x39754e);const _0x1c1329=_0x272e61[_0x58703c(0x45d,0x459,0x415,0x441)](_0x2650cd=>new _0xb8e163(_0x2650cd[_0x58703c(0x443,0x46f,0x47b,0x473)])<_0x192c7e);return _0x1c1329[_0x58703c(0x496,0x468,0x4a5,0x487)](_0x2072d4=>{function _0x37a04d(_0x401798,_0x31132b,_0x2aa62f,_0x45f0d6){return _0x1d9783(_0x401798- -0x158,_0x31132b-0xfe,_0x2aa62f-0x13f,_0x45f0d6);}_0x3da354[_0x116cbf(0x13b,0x126,0x14f,0x147)](_0x2072d4['path']);function _0x116cbf(_0x59c8ba,_0x1c3470,_0x2c6583,_0x3f20d2){return _0x58703c(_0x59c8ba-0x39,_0x1c3470-0xd5,_0x3f20d2,_0x1c3470- -0x31d);}console['log'](_0x37a04d(0x7c,0x7a,0x9d,0x62)+_0x2072d4[_0x116cbf(0x136,0x147,0x117,0x12e)]);}),console[_0x1d9783(0x1a4,0x1d6,0x1ce,0x1a9)](_0x58703c(0x437,0x455,0x40e,0x437)+_0x1c1329['length']+_0x58703c(0x493,0x4a3,0x46d,0x48a)),_0x1c1329[_0x58703c(0x462,0x4b4,0x4a6,0x47f)];}}}async['restoreBackup'](backupFile,_0x59f56a={}){const {decrypt:decrypt=!![],decompress:decompress=!![]}=_0x59f56a;function _0x319abf(_0x2edb02,_0xb14c73,_0x449545,_0x305280){return _0x_0x52f0ae(_0x2edb02-0x5f,_0xb14c73-0x1e1,_0x305280,_0x449545- -0x1e7);}function _0x4f8c77(_0x3b5d69,_0x18c82b,_0x5f52c8,_0x1d6dc5){return _0x_0x59c4ea(_0x3b5d69-0x1ce,_0x18c82b-0x5d9,_0x5f52c8-0x49,_0x5f52c8);}const _0x49e5e6=require('../config/config'),_0x46ec8b=_0x49e5e6[_0x4f8c77(0x4b1,0x484,0x491,0x4b8)];try{const _0x439cf6=path['isAbsolute'](backupFile)?backupFile:path[_0x4f8c77(0x486,0x462,0x447,0x44b)](this[_0x319abf(-0x268,-0x26e,-0x288,-0x298)],backupFile);if(!fs[_0x319abf(-0x2ad,-0x2b2,-0x29b,-0x2be)](_0x439cf6))throw new Error(_0x4f8c77(0x479,0x460,0x444,0x43f));let restoreFile=_0x439cf6;if(decrypt&&_0x439cf6[_0x319abf(-0x231,-0x27b,-0x24f,-0x27a)]('.enc')){const decryptedFile=_0x439cf6[_0x4f8c77(0x469,0x483,0x4ae,0x4ad)](_0x4f8c77(0x491,0x4b4,0x4de,0x486),'');await this[_0x4f8c77(0x468,0x487,0x47a,0x496)](_0x439cf6,decryptedFile),restoreFile=decryptedFile;}if(decompress&&restoreFile[_0x4f8c77(0x4ca,0x4be,0x4ea,0x492)]('.gz')){const decompressedFile=restoreFile[_0x319abf(-0x27e,-0x2a1,-0x28a,-0x297)]('.gz',''),_0x246c95=_0x319abf(-0x233,-0x263,-0x260,-0x280)+restoreFile+'\x22';await this[_0x319abf(-0x2b6,-0x28c,-0x29c,-0x287)](_0x246c95),restoreFile=decompressedFile;}const _0x575405=_0x319abf(-0x245,-0x27f,-0x25d,-0x28e)+_0x46ec8b[_0x319abf(-0x223,-0x273,-0x258,-0x282)]+_0x4f8c77(0x474,0x48e,0x465,0x4b8)+_0x46ec8b[_0x319abf(-0x27c,-0x290,-0x265,-0x23b)]+_0x4f8c77(0x457,0x475,0x48f,0x464)+_0x46ec8b[_0x319abf(-0x276,-0x283,-0x29f,-0x275)]+_0x4f8c77(0x48e,0x469,0x455,0x48d)+_0x46ec8b[_0x4f8c77(0x484,0x4aa,0x4b8,0x4d3)]+'\x20'+_0x46ec8b[_0x319abf(-0x2b6,-0x2ae,-0x289,-0x2b7)]+_0x319abf(-0x2d2,-0x298,-0x2a9,-0x2ce)+restoreFile+'\x22';return console[_0x4f8c77(0x48f,0x466,0x485,0x44b)]('开始恢复数据库...'),await this['executeCommand'](_0x575405),restoreFile!==_0x439cf6&&fs[_0x319abf(-0x2be,-0x2b6,-0x297,-0x276)](restoreFile),console[_0x319abf(-0x273,-0x282,-0x2a7,-0x2b1)](_0x4f8c77(0x4da,0x4bf,0x499,0x4b3)),{'success':!![]};}catch(_0x39eff4){console['error'](_0x319abf(-0x280,-0x267,-0x272,-0x276),_0x39eff4);throw _0x39eff4;}}async['encryptFile'](inputFile,outputFile){return new Promise((_0x4508c6,_0x4f2cd8)=>{function _0x706e2b(_0x2560cb,_0x5cb35f,_0x3f2a0d,_0x3b9ed7){return _0x_0xd8c3(_0x2560cb- -0x25d,_0x3f2a0d);}function _0x17eb2e(_0x2d2cde,_0x89d1d7,_0x21f0d2,_0x1e9e0b){return _0x_0xd8c3(_0x1e9e0b-0x16,_0x21f0d2);}if(_0x17eb2e(0xfa,0xa3,0xb9,0xc9)!=='EpbDe'){const _0x25f388=process[_0x17eb2e(0x7a,0x73,0xbc,0xa6)][_0x706e2b(-0x1bc,-0x1bf,-0x19b,-0x189)]||_0x17eb2e(0xc6,0xe1,0xa8,0xca),_0x1acdff=crypto['scryptSync'](_0x25f388,_0x17eb2e(0xc7,0xd6,0xd9,0xf6),-0x139+-0x17c9+-0x1922*-0x1),_0x7c9df5=crypto[_0x706e2b(-0x194,-0x176,-0x18f,-0x19c)](-0x1*-0x2404+0xe5*0x13+-0x34f3),_0x3b3480=crypto[_0x706e2b(-0x180,-0x193,-0x150,-0x19d)](_0x706e2b(-0x190,-0x161,-0x17d,-0x196),_0x1acdff),_0x4cef5c=fs[_0x706e2b(-0x1a8,-0x1be,-0x1bf,-0x17f)](inputFile),_0x4889c9=fs[_0x17eb2e(0xd5,0xfb,0xca,0xd7)](outputFile);_0x4889c9[_0x706e2b(-0x185,-0x198,-0x16f,-0x186)](_0x7c9df5),_0x4cef5c[_0x706e2b(-0x1a6,-0x17a,-0x178,-0x1c1)](_0x3b3480)[_0x17eb2e(0xec,0xde,0xf7,0xcd)](_0x4889c9)['on'](_0x706e2b(-0x18a,-0x186,-0x173,-0x17d),_0x4508c6)['on']('error',_0x4f2cd8);}else return new _0x3bdfc6((_0x3c3c82,_0x468c8e)=>{const _0x2cf1cc=process['env']['BACKUP_ENCRYPTION_KEY']||'xs-blog-backup-key',_0x5b95a2=_0x558607['scryptSync'](_0x2cf1cc,_0x59d98c(-0x267,-0x25b,-0x23d,-0x24e),-0x70d+0xeb2+-0x19*0x4d);function _0x2c3d5a(_0xcfb005,_0x152611,_0x54d487,_0xe23204){return _0x706e2b(_0xcfb005-0x392,_0x152611-0x72,_0x152611,_0xe23204-0x1a7);}const _0x38598c=_0x565cfc[_0x2c3d5a(0x1fe,0x206,0x227,0x1df)](-0x152*-0x4+0x1833+-0x1d6b),_0xc65c85=_0x384cc3[_0x59d98c(-0x237,-0x254,-0x240,-0x261)](_0x2c3d5a(0x202,0x234,0x21d,0x209),_0x5b95a2),_0x92554f=_0x36f74b[_0x2c3d5a(0x1ea,0x1d4,0x21d,0x217)](inputFile),_0x2d6f64=_0x5262a0[_0x2c3d5a(0x1f6,0x226,0x1d4,0x1f1)](outputFile);_0x2d6f64[_0x59d98c(-0x274,-0x219,-0x245,-0x251)](_0x38598c);function _0x59d98c(_0xbf7f6a,_0x43ed8d,_0x1f7b44,_0x59a935){return _0x706e2b(_0x1f7b44- -0xc0,_0x43ed8d-0x166,_0x43ed8d,_0x59a935-0xf1);}_0x92554f[_0x59d98c(-0x254,-0x274,-0x266,-0x28a)](_0xc65c85)[_0x2c3d5a(0x1ec,0x218,0x1d1,0x207)](_0x2d6f64)['on'](_0x59d98c(-0x21c,-0x228,-0x24a,-0x27c),_0x3c3c82)['on'](_0x2c3d5a(0x219,0x213,0x23f,0x215),_0x468c8e);});});}async[_0x_0x59c4ea(-0x126,-0x152,-0x167,-0x186)](inputFile,outputFile){return new Promise((_0x162992,_0x3c0495)=>{function _0x3d86fa(_0x2d1390,_0x3b5f0c,_0xbe6944,_0xb8656){return _0x_0xd8c3(_0x3b5f0c-0x248,_0xbe6944);}const _0x29ae71=process[_0x3d86fa(0x2e8,0x2d8,0x305,0x2c9)][_0x3d86fa(0x2fc,0x2e9,0x30d,0x2be)]||_0x3d86fa(0x31b,0x2fc,0x318,0x2f2),_0x114bb7=crypto[_0x130395(-0xa7,-0xb4,-0x7f,-0x74)](_0x29ae71,_0x130395(-0x74,-0x56,-0x64,-0x5f),-0x1938+-0x98f+0x22e7),_0x37328d=fs[_0x3d86fa(0x319,0x2fd,0x2cb,0x2da)](inputFile);function _0x130395(_0x212948,_0x432b44,_0x2741d1,_0x54e8db){return _0x_0xd8c3(_0x2741d1- -0x144,_0x432b44);}const _0x4ff391=fs[_0x3d86fa(0x31b,0x309,0x333,0x2f6)](outputFile);let _0x419752;_0x37328d[_0x130395(-0x2b,-0x6a,-0x52,-0x5a)](_0x3d86fa(0x36b,0x33d,0x330,0x351),()=>{_0x419752=_0x37328d['read'](-0x53*0x71+-0x11af+0x3662);if(!_0x419752||_0x419752[_0x58d721(-0x281,-0x2a9,-0x289,-0x289)]!==-0x21b*0xd+0x1*0x16f7+-0x34*-0x16){_0x3c0495(new Error(_0x131a13(0x227,0x24e,0x225,0x218)));return;}const _0x2db960=crypto[_0x58d721(-0x261,-0x25d,-0x283,-0x2af)](_0x131a13(0x25e,0x27d,0x272,0x265),_0x114bb7);function _0x131a13(_0x743d72,_0x4b5ad1,_0x3ac7cc,_0x4aeab2){return _0x130395(_0x743d72-0x1bb,_0x4b5ad1,_0x743d72-0x2d5,_0x4aeab2-0x89);}function _0x58d721(_0x1101fd,_0x14b5ec,_0x1ada2a,_0x3cdc3e){return _0x130395(_0x1101fd-0x134,_0x14b5ec,_0x1ada2a- -0x230,_0x3cdc3e-0x1d8);}_0x37328d['pipe'](_0x2db960)[_0x131a13(0x248,0x238,0x234,0x21b)](_0x4ff391)['on'](_0x131a13(0x264,0x244,0x231,0x26a),_0x162992)['on']('error',_0x3c0495);});});}[_0x_0x52f0ae(-0xd1,-0xbc,-0x8c,-0xb5)](_0x17fde2){return new Promise((_0x19d65c,_0x3a314b)=>{exec(_0x17fde2,(_0x237d18,_0x35f115,_0x406c4f)=>{function _0x38191c(_0x402cb0,_0x5a52e8,_0x449d67,_0x22cfc3){return _0x_0xd8c3(_0x22cfc3- -0x2e5,_0x449d67);}if(_0x237d18){_0x3a314b(new Error('命令执行失败:\x20'+(_0x406c4f||_0x237d18[_0x38191c(-0x266,-0x268,-0x27a,-0x245)])));return;}_0x19d65c(_0x35f115);});});}[_0x_0x52f0ae(-0xb8,-0x90,-0xc9,-0xc1)](){function _0x5994e7(_0x1682c2,_0x1cd92d,_0x38ee34,_0x57349c){return _0x_0x52f0ae(_0x1682c2-0xfe,_0x1cd92d-0xad,_0x38ee34,_0x57349c- -0x5e);}function _0x39ed69(_0x5bf63e,_0x2eed10,_0x78bbd0,_0x4e4722){return _0x_0x52f0ae(_0x5bf63e-0x30,_0x2eed10-0x13b,_0x78bbd0,_0x2eed10-0x340);}try{if(!fs[_0x5994e7(-0x12f,-0x10b,-0x145,-0x112)](this['backupDir']))return[];const _0x3ba8e6=fs[_0x39ed69(0x284,0x286,0x279,0x276)](this[_0x39ed69(0x29f,0x29f,0x286,0x29e)])[_0x39ed69(0x289,0x28e,0x296,0x27b)](_0x336e7a=>_0x336e7a[_0x5994e7(-0xca,-0xb8,-0xf3,-0xc6)](_0x5994e7(-0xf3,-0xb4,-0x101,-0xd3))||_0x336e7a[_0x5994e7(-0x99,-0xd5,-0xe7,-0xc6)]('.gz')||_0x336e7a[_0x5994e7(-0xef,-0x98,-0xca,-0xc6)](_0x5994e7(-0xf0,-0xdb,-0xd2,-0xd0)))[_0x5994e7(-0x11e,-0x14c,-0xfe,-0x119)](_0x288846=>{const _0x171c2c=path[_0x5bf11e(0x242,0x229,0x24e,0x23a)](this['backupDir'],_0x288846),_0x1ee539=fs['statSync'](_0x171c2c);function _0x36e0ce(_0x285fb1,_0x2a74b6,_0x5298f8,_0x5c67a6){return _0x39ed69(_0x285fb1-0x127,_0x5298f8-0x105,_0x5c67a6,_0x5c67a6-0x1af);}function _0x5bf11e(_0x44d849,_0x396cf7,_0x57f28c,_0x1cfd4f){return _0x39ed69(_0x44d849-0x26,_0x396cf7- -0x53,_0x57f28c,_0x1cfd4f-0x36);}return{'filename':_0x288846,'path':_0x171c2c,'size':_0x1ee539['size'],'createdAt':_0x1ee539[_0x5bf11e(0x1fb,0x225,0x240,0x240)],'modifiedAt':_0x1ee539[_0x36e0ce(0x375,0x3ab,0x392,0x35f)],'encrypted':_0x288846[_0x36e0ce(0x3b7,0x3e2,0x3dd,0x3d7)](_0x36e0ce(0x3a2,0x3e4,0x3d3,0x3ec)),'compressed':_0x288846[_0x5bf11e(0x272,0x285,0x285,0x27d)](_0x5bf11e(0x220,0x222,0x249,0x239))};})[_0x39ed69(0x283,0x272,0x263,0x25f)]((_0x405e4f,_0x5cb919)=>new Date(_0x5cb919[_0x39ed69(0x2e2,0x2c0,0x2bb,0x2a5)])-new Date(_0x405e4f[_0x39ed69(0x2a4,0x2c0,0x2cd,0x2f0)]));return _0x3ba8e6;}catch(_0x2326df){return console['error'](_0x39ed69(0x2c0,0x2a0,0x277,0x2ac),_0x2326df),[];}}[_0x_0x59c4ea(-0x160,-0x150,-0x177,-0x16b)](_0x41f32d=-0x256b+-0xe68+0x33f1){function _0x443f87(_0x3675ca,_0x31e4b7,_0x2b7d6e,_0xfdb34e){return _0x_0x52f0ae(_0x3675ca-0x35,_0x31e4b7-0x3f,_0x3675ca,_0xfdb34e-0x22f);}function _0x587ce1(_0x286f8a,_0x1493f4,_0x175d61,_0x3d3f5a){return _0x_0x52f0ae(_0x286f8a-0x190,_0x1493f4-0x83,_0x1493f4,_0x286f8a-0x4cb);}try{const _0x5f59a9=this[_0x443f87(0x1a0,0x155,0x171,0x16e)](),_0x5ce4c3=new Date();_0x5ce4c3[_0x443f87(0x1a8,0x177,0x1ae,0x188)](_0x5ce4c3[_0x443f87(0x17a,0x15c,0x15c,0x165)]()-_0x41f32d);const _0x5c203c=_0x5f59a9[_0x443f87(0x152,0x1ab,0x172,0x17d)](_0x1e609b=>new Date(_0x1e609b['createdAt'])<_0x5ce4c3);return _0x5c203c['forEach'](_0x20583f=>{function _0x5b614c(_0x4b1fb7,_0x13762c,_0x17eafc,_0x56c0b8){return _0x587ce1(_0x4b1fb7- -0x40e,_0x56c0b8,_0x17eafc-0x12e,_0x56c0b8-0x149);}fs[_0x5b614c(0xd,0x3b,-0x1b,0x34)](_0x20583f[_0x33615d(0x2ab,0x294,0x29e,0x27b)]);function _0x33615d(_0x368055,_0x214238,_0x4b841d,_0x5876a9){return _0x443f87(_0x368055,_0x214238-0x11d,_0x4b841d-0xd9,_0x214238-0xf3);}console[_0x5b614c(-0x3,-0x14,0x19,-0x9)](_0x33615d(0x284,0x292,0x27f,0x2ac)+_0x20583f[_0x5b614c(0x2e,0x34,0x45,0x3f)]);}),console[_0x587ce1(0x40b,0x3df,0x432,0x3e1)](_0x443f87(0x161,0x169,0x13f,0x173)+_0x5c203c[_0x443f87(0x1d9,0x1b9,0x1cd,0x1bb)]+_0x587ce1(0x462,0x453,0x447,0x43b)),_0x5c203c[_0x443f87(0x1d0,0x1db,0x187,0x1bb)];}catch(_0x303ed7){return console[_0x443f87(0x1ca,0x1a2,0x1ba,0x1b4)](_0x587ce1(0x422,0x44b,0x438,0x416),_0x303ed7),0x2393+0xaab+-0x2e3e;}}[_0x_0x59c4ea(-0x13b,-0x138,-0x11a,-0x16b)](backupFile){function _0x31f970(_0x166150,_0x915a3c,_0x2e869b,_0x1b61bf){return _0x_0x59c4ea(_0x166150-0x8b,_0x166150- -0x122,_0x2e869b-0x7a,_0x1b61bf);}const _0x2e8b7c=path['isAbsolute'](backupFile)?backupFile:path[_0x31f970(-0x299,-0x280,-0x280,-0x2c1)](this[_0x39a2c2(-0x24e,-0x24e,-0x231,-0x273)],backupFile);function _0x39a2c2(_0x45c567,_0x5f3a65,_0x73512d,_0x25d9b2){return _0x_0x59c4ea(_0x45c567-0x1c1,_0x45c567- -0xfa,_0x73512d-0x1d8,_0x25d9b2);}if(!fs[_0x31f970(-0x289,-0x2ba,-0x260,-0x258)](_0x2e8b7c))return _0x39a2c2(-0x22a,-0x243,-0x22d,-0x24f)!==_0x31f970(-0x252,-0x26d,-0x26f,-0x24a)?[]:{'valid':![],'error':_0x39a2c2(-0x273,-0x293,-0x277,-0x268)};try{const _0x36f303=fs[_0x31f970(-0x262,-0x22e,-0x26f,-0x276)](_0x2e8b7c),_0x8c90ab=_0x36f303['size'];if(_0x8c90ab<0x101e*-0x1+-0x2517+0x3599)return{'valid':![],'error':'备份文件可能已损坏（文件大小异常）'};if(_0x2e8b7c['endsWith']('.enc')){if(_0x31f970(-0x256,-0x231,-0x256,-0x237)===_0x39a2c2(-0x22e,-0x211,-0x24d,-0x25b)){const _0x11c9b7=fs['readFileSync'](_0x2e8b7c,{'start':0x0,'end':0x10});if(_0x11c9b7[_0x31f970(-0x249,-0x222,-0x231,-0x26b)]!==0x5*-0x2bd+0x1c*0xb0+0x43*-0x15){if(_0x39a2c2(-0x23e,-0x20f,-0x24d,-0x24d)!==_0x31f970(-0x270,-0x25e,-0x245,-0x29d))return{'valid':![],'error':_0x31f970(-0x271,-0x276,-0x265,-0x258)};else{_0x4521c1=_0x25e167[_0x31f970(-0x258,-0x250,-0x22d,-0x232)](0x72d+-0x4*-0x8f3+-0x2ae9);if(!_0x14422e||_0x417d69[_0x31f970(-0x249,-0x24e,-0x240,-0x237)]!==-0x619*0x1+-0x3a1+0x9ca){_0x2ea443(new _0x5a72bf(_0x31f970(-0x29e,-0x26d,-0x273,-0x26a)));return;}const _0x4885d7=_0x102796['createDecipher'](_0x31f970(-0x267,-0x238,-0x256,-0x26b),_0x344570);_0x5a4004[_0x39a2c2(-0x255,-0x289,-0x238,-0x23b)](_0x4885d7)[_0x31f970(-0x27d,-0x263,-0x24c,-0x2b0)](_0x24ed48)['on'](_0x39a2c2(-0x239,-0x25a,-0x24a,-0x20d),_0x3cd45e)['on'](_0x39a2c2(-0x228,-0x23c,-0x21f,-0x1f4),_0x5ed1b9);}}}else{console[_0x31f970(-0x250,-0x258,-0x27f,-0x22b)](_0x39a2c2(-0x238,-0x209,-0x219,-0x21e),_0x1b1670);throw _0x1aa276;}}return{'valid':!![],'size':_0x8c90ab,'createdAt':_0x36f303[_0x39a2c2(-0x275,-0x29c,-0x272,-0x24f)]};}catch(_0x4014da){return{'valid':![],'error':_0x4014da['message']};}}}module[_0x_0x52f0ae(-0x8f,-0xae,-0x92,-0xad)]=new DatabaseBackup();