(function(_0x4b8e9b,_0x20fc5d){function _0x1e5867(_0x3afc44,_0x79578a,_0x147132,_0x23e7c4){return _0x_0x3c2d(_0x23e7c4- -0x89,_0x3afc44);}const _0x539955=_0x4b8e9b();function _0x41a192(_0x16142e,_0xaf1cfa,_0x19c388,_0x3c336c){return _0x_0x3c2d(_0xaf1cfa- -0x43,_0x3c336c);}while(!![]){try{const _0x95f8f9=-parseInt(_0x41a192(0x1ba,0x1c2,0x1b7,0x1c7))/(-0x379*-0x1+-0x1647+0x5*0x3c3)*(-parseInt(_0x41a192(0x1de,0x1c7,0x1c9,0x1d5))/(-0x43*-0x41+0x76*-0x4d+0x127d))+parseInt(_0x1e5867(0x18c,0x174,0x198,0x186))/(-0x878+0x252a+-0x1caf)*(-parseInt(_0x41a192(0x1c0,0x1ba,0x1bd,0x1bb))/(-0x6ee*-0x1+0x24ca*0x1+-0x2bb4))+parseInt(_0x1e5867(0x190,0x191,0x184,0x18c))/(0x23b1+-0x4*0x7b2+-0x4e4)*(parseInt(_0x41a192(0x1e8,0x1d4,0x1d8,0x1d2))/(0x1*-0x203b+-0x1202+0x3243))+parseInt(_0x1e5867(0x17c,0x163,0x182,0x177))/(0x158f*-0x1+-0x59*-0xf+0x7f*0x21)+parseInt(_0x1e5867(0x170,0x164,0x181,0x176))/(0xe*-0x2b7+0x25f*-0x9+0x3b61)*(parseInt(_0x1e5867(0x18e,0x1a7,0x1aa,0x192))/(0x1d2e+0x17f5+-0x1*0x351a))+parseInt(_0x41a192(0x1e3,0x1d3,0x1bd,0x1d0))/(0xec6+0x1390+-0x224c)+-parseInt(_0x1e5867(0x158,0x167,0x17b,0x170))/(-0xc11*-0x3+-0x2071+-0x3b7)*(parseInt(_0x1e5867(0x19b,0x18e,0x19d,0x195))/(0x1129+-0xaf7*0x3+0xfc8));if(_0x95f8f9===_0x20fc5d)break;else _0x539955['push'](_0x539955['shift']());}catch(_0x85532a){_0x539955['push'](_0x539955['shift']());}}}(_0x_0x45ca,-0x277bd*-0x3+-0xd025*-0x8+-0x848fa));const _0x_0x5e6827=(function(){let _0x4bbc58=!![];return function(_0x523379,_0x5f56d7){const _0xe4ab61=_0x4bbc58?function(){function _0x1c32ce(_0x5c9af6,_0x5f4ebb,_0x26f178,_0xe0d1c0){return _0x_0x3c2d(_0x5c9af6-0x2ea,_0x26f178);}if(_0x5f56d7){const _0x14dcfa=_0x5f56d7[_0x1c32ce(0x4de,0x4d8,0x4e0,0x4eb)](_0x523379,arguments);return _0x5f56d7=null,_0x14dcfa;}}:function(){};return _0x4bbc58=![],_0xe4ab61;};}()),_0x_0x4a25b1=_0x_0x5e6827(this,function(){function _0x10ebc3(_0x1fadbe,_0x43ef32,_0x280a9f,_0x3123b5){return _0x_0x3c2d(_0x3123b5-0x291,_0x280a9f);}function _0x87c97(_0x33fa2f,_0x39044b,_0x3cc265,_0x62b06a){return _0x_0x3c2d(_0x33fa2f- -0x284,_0x39044b);}return _0x_0x4a25b1[_0x10ebc3(0x4aa,0x4c0,0x4a6,0x4aa)]()[_0x87c97(-0x89,-0x90,-0xa1,-0x71)](_0x87c97(-0x86,-0x9d,-0x70,-0x93))[_0x10ebc3(0x4a2,0x4ad,0x4b4,0x4aa)]()[_0x10ebc3(0x4b7,0x4bf,0x4a3,0x4b2)](_0x_0x4a25b1)['search']('(((.+)+)+)+$');});function _0x_0x3c2d(_0x5c4da4,_0x156a5e){_0x5c4da4=_0x5c4da4-(-0x152f+0x1006*-0x1+0x5*0x7d5);const _0x4bbc58=_0x_0x45ca();let _0x523379=_0x4bbc58[_0x5c4da4];if(_0x_0x3c2d['MDivZn']===undefined){var _0x5f56d7=function(_0x55c0ff){const _0x4a7472='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x6b44cf='',_0x49a5fc='',_0x2e4573=_0x6b44cf+_0x5f56d7;for(let _0x2c3e12=-0x3ab*0x1+0x1a47+0xb4e*-0x2,_0x48b2ef,_0x26d465,_0x4d292b=-0x1*0xca7+-0xcf8+0x199f;_0x26d465=_0x55c0ff['charAt'](_0x4d292b++);~_0x26d465&&(_0x48b2ef=_0x2c3e12%(0x5bf*-0x5+-0x34*-0x8d+-0x9*-0x3)?_0x48b2ef*(-0x5bd*-0x1+-0x1775*0x1+0x11f8)+_0x26d465:_0x26d465,_0x2c3e12++%(-0x561+0x22ec+0x1*-0x1d87))?_0x6b44cf+=_0x2e4573['charCodeAt'](_0x4d292b+(0xf50+-0x105c+0x2*0x8b))-(-0x1*0x3f4+-0x1*-0x139a+-0xf9c)!==0xab5*0x2+0x16e9+-0x655*0x7?String['fromCharCode'](-0x14c7+-0x491*-0x1+-0x5*-0x371&_0x48b2ef>>(-(0x121c+-0x12af+0x95)*_0x2c3e12&-0xb78*-0x3+-0x2470+0x20e)):_0x2c3e12:-0x16*-0xa3+0x245+-0x1047){_0x26d465=_0x4a7472['indexOf'](_0x26d465);}for(let _0x668a4c=-0x1a2f+-0x19b2+-0x33e1*-0x1,_0x3cc47a=_0x6b44cf['length'];_0x668a4c<_0x3cc47a;_0x668a4c++){_0x49a5fc+='%'+('00'+_0x6b44cf['charCodeAt'](_0x668a4c)['toString'](0xb*-0x255+-0xf08+0x28bf))['slice'](-(0x9*0x95+-0x34d*-0x7+-0x4e*0x5d));}return decodeURIComponent(_0x49a5fc);};_0x_0x3c2d['cWHtMr']=_0x5f56d7,_0x_0x3c2d['MEweeW']={},_0x_0x3c2d['MDivZn']=!![];}const _0xe4ab61=_0x4bbc58[-0x5c0+0x3*-0x1b+0x611],_0x14dcfa=_0x5c4da4+_0xe4ab61,_0x21b57f=_0x_0x3c2d['MEweeW'][_0x14dcfa];if(!_0x21b57f){const _0x5ed5bf=function(_0x5ddd5f){this['pIjsqH']=_0x5ddd5f,this['YfllyQ']=[-0x151*0xf+-0x3*0x49d+0x2197,0x4cb+0x99b+-0x13*0xc2,0x945*0x2+-0x13f3+0x169],this['TZnalg']=function(){return'newState';},this['CzvvjP']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['RnSJKy']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x5ed5bf['prototype']['TNgktd']=function(){const _0x2c5235=new RegExp(this['CzvvjP']+this['RnSJKy']),_0x9a3379=_0x2c5235['test'](this['TZnalg']['toString']())?--this['YfllyQ'][0x12a*0xb+0x1a71+-0x273e]:--this['YfllyQ'][0x1337+-0x1*-0x949+0x10*-0x1c8];return this['eBuFbf'](_0x9a3379);},_0x5ed5bf['prototype']['eBuFbf']=function(_0x150abf){if(!Boolean(~_0x150abf))return _0x150abf;return this['BraPmW'](this['pIjsqH']);},_0x5ed5bf['prototype']['BraPmW']=function(_0x31904c){for(let _0x264b54=0x3*-0x3f5+-0x2b*0x2f+0x13c4,_0x8af615=this['YfllyQ']['length'];_0x264b54<_0x8af615;_0x264b54++){this['YfllyQ']['push'](Math['round'](Math['random']())),_0x8af615=this['YfllyQ']['length'];}return _0x31904c(this['YfllyQ'][0x2e5+0xf8d+-0x1272]);},new _0x5ed5bf(_0x_0x3c2d)['TNgktd'](),_0x523379=_0x_0x3c2d['cWHtMr'](_0x523379),_0x_0x3c2d['MEweeW'][_0x14dcfa]=_0x523379;}else _0x523379=_0x21b57f;return _0x523379;}_0x_0x4a25b1();const sharp=require('sharp'),path=require('path'),fs=require('fs').promises,THUMBNAIL_CONFIG={'width':0x190,'height':0x190,'quality':0x50,'suffix':'_thumb'};function getThumbnailFilename(originalFilename){const _0x21b57f=path[_0x4faf07(0x5be,0x5c7,0x5ba,0x5bf)](originalFilename),_0x55c0ff=path[_0x4faf07(0x5a1,0x5b4,0x5c5,0x5c8)](originalFilename,_0x21b57f);function _0x4d999b(_0x32f3d2,_0x3706c9,_0xcc08a4,_0x485a6f){return _0x_0x3c2d(_0x3706c9-0x3af,_0xcc08a4);}function _0x4faf07(_0x2d4070,_0x2116bf,_0x237a0a,_0x45e132){return _0x_0x3c2d(_0x2116bf-0x3ba,_0x237a0a);}return''+_0x55c0ff+THUMBNAIL_CONFIG[_0x4faf07(0x5e3,0x5d4,0x5e7,0x5d8)]+_0x4d999b(0x5bf,0x5b5,0x5a4,0x5b8);}function getThumbnailPath(_0x4a7472){if(!_0x4a7472)return _0x4a7472;const _0x6b44cf=path['dirname'](_0x4a7472);function _0x213da5(_0x1ce6f2,_0x4a284a,_0x2f942c,_0x16b6db){return _0x_0x3c2d(_0x2f942c- -0x151,_0x1ce6f2);}const _0x49a5fc=path[_0x213da5(0xa9,0xb4,0xbc,0xb8)](_0x4a7472);function _0x250c2e(_0x2485b2,_0x1cc950,_0x569166,_0x561a63){return _0x_0x3c2d(_0x1cc950- -0x48,_0x2485b2);}const _0x2e4573=path[_0x250c2e(0x1c0,0x1b2,0x1bb,0x19f)](_0x4a7472,_0x49a5fc);return _0x6b44cf+'/'+_0x2e4573+THUMBNAIL_CONFIG[_0x213da5(0xc7,0xb1,0xc9,0xb6)]+_0x250c2e(0x1c1,0x1be,0x1c4,0x1be);}function _0x_0x1fc3f2(_0x15970a,_0x4d79e7,_0x4a236d,_0x4ff38d){return _0x_0x3c2d(_0x4ff38d- -0x26e,_0x15970a);}function isImageFile(_0x2c3e12){function _0x37d9f3(_0x5bb10e,_0x2f7a68,_0x198d87,_0x2c6774){return _0x_0x3c2d(_0x2f7a68-0x251,_0x5bb10e);}function _0x31b315(_0x38499f,_0x9b1cba,_0x5ba354,_0xeccaa5){return _0x_0x3c2d(_0x9b1cba-0x318,_0x38499f);}const _0x48b2ef=[_0x37d9f3(0x465,0x457,0x464,0x447),_0x37d9f3(0x455,0x448,0x43c,0x458),'.png','.gif',_0x37d9f3(0x45e,0x465,0x479,0x463)],_0x26d465=path['extname'](_0x2c3e12)[_0x37d9f3(0x44e,0x447,0x45f,0x45b)]();return _0x48b2ef['includes'](_0x26d465);}async function generateThumbnail(_0x4d292b,_0x668a4c,_0x3cc47a={}){function _0x1ed39c(_0x3efa84,_0x1286d2,_0x32cd9f,_0x2a5712){return _0x_0x3c2d(_0x32cd9f-0x18f,_0x2a5712);}function _0x5231a0(_0x46fab1,_0x58d302,_0x1b653a,_0x674a5e){return _0x_0x3c2d(_0x58d302- -0x118,_0x46fab1);}try{if('DGbjG'!==_0x1ed39c(0x386,0x38f,0x391,0x383)){const _0x5ed5bf={...THUMBNAIL_CONFIG,..._0x3cc47a};await fs['access'](_0x4d292b);const _0x5ddd5f=path[_0x5231a0(0x106,0x10b,0x111,0x115)](_0x668a4c);return await fs['mkdir'](_0x5ddd5f,{'recursive':!![]}),await sharp(_0x4d292b)[_0x1ed39c(0x3ac,0x3a4,0x3af,0x39f)](_0x5ed5bf[_0x1ed39c(0x38b,0x3a8,0x39d,0x391)],_0x5ed5bf[_0x5231a0(0xfc,0xf3,0x106,0xf5)],{'fit':_0x1ed39c(0x395,0x3a5,0x3a2,0x38c),'position':_0x5231a0(0x102,0x105,0x119,0x104)})['jpeg']({'quality':_0x5ed5bf[_0x5231a0(0xe2,0xe4,0xf9,0xfa)]})['toFile'](_0x668a4c),!![];}else return console['error'](_0x5231a0(0xef,0x100,0x111,0x113),_0x3614d2['message']),null;}catch(_0x9a3379){if(_0x5231a0(0xf8,0xf9,0xe9,0xf6)===_0x5231a0(0xfc,0xf9,0x102,0x10e))return console[_0x5231a0(0xda,0xe0,0xdc,0xdd)]('生成缩略图失败:\x20'+_0x4d292b,_0x9a3379[_0x1ed39c(0x39d,0x398,0x39b,0x3b0)]),![];else{const _0x31904c=_0x124aa9[_0x1ed39c(0x38d,0x391,0x39c,0x389)](originalFilename),_0x264b54=_0x1653b7[_0x1ed39c(0x38d,0x391,0x389,0x38f)](originalFilename,_0x31904c);return''+_0x264b54+_0x354295[_0x5231a0(0x106,0x102,0x104,0x108)]+'.jpg';}}}async function generateThumbnailForUpload(_0x8af615,moduleName){function _0x1d4adb(_0x4026ed,_0x5b8115,_0x49dbb8,_0x30ded2){return _0x_0x3c2d(_0x5b8115- -0x62,_0x49dbb8);}function _0x5f573c(_0x4847cb,_0x38f50d,_0x2367b7,_0x59e680){return _0x_0x3c2d(_0x59e680- -0x1ff,_0x2367b7);}try{if(!isImageFile(_0x8af615[_0x5f573c(0x16,0x31,0x30,0x23)]))return _0x5f573c(0xf,-0xc,0x1d,0x5)!==_0x1d4adb(0x19b,0x1a2,0x1b1,0x193)?_0x5f573c(0x17,-0xa,0x8,0x4)+moduleName+'/'+thumbnailFilename:null;const _0x57e80a=_0x8af615[_0x5f573c(0xd,0x17,0x12,0x2)],thumbnailFilename=getThumbnailFilename(_0x8af615[_0x5f573c(0x2b,0xe,0xd,0x23)]),_0x387175=path[_0x1d4adb(0x1cd,0x1ba,0x1a8,0x1ad)](path['dirname'](_0x57e80a),thumbnailFilename),_0x2ce3ef=await generateThumbnail(_0x57e80a,_0x387175);if(_0x2ce3ef)return _0x5f573c(0x10,-0x13,-0x7,0x4)+moduleName+'/'+thumbnailFilename;return null;}catch(_0x4c05df){return console[_0x5f573c(0x7,-0xf,0x11,-0x7)](_0x5f573c(0x19,0x31,0x2c,0x19),_0x4c05df[_0x1d4adb(0x1bc,0x1aa,0x1c1,0x1a5)]),null;}}function _0x_0x45ca(){const _0x3060c9=['mZi2mty2v3nRten4','AgvPz2H0','BwvZC2fNzq','zxH0BMfTzq','D2LKDgG','odi1Ehb0txPM','zxHWB3j0CW','uLnPEe0','ChvZAa','y292zxi','lNDLyNa','nxrnv0HTza','mtm4otq0mfvVEuHHza','mtC4mdy5oeDftxzOrq','55sF5OIq5lIk5lYG5PAh5lU257YP55wL5zU+5AsX6lsLoG','Dg9tDhjPBMC','C3vMzML4','mte3v3LttuzO','AM9PBG','y2vUDgvY','mtq2nJuZnJH6qKj2AfC','y29Kzq','CMvZAxPL','y29UC3rYDwn0B3i','zMLSzw5HBwu','zgLYBMfTzq','yxbWBhK','Dw5SAw5R','Dg9mB3DLCKnHC2u','lMPWzwC','zxjYB3i','mtf5CeDVAfO','yMfZzw5HBwu','C2vHCMnO','CxvHBgL0Eq','nJG0neTtyxDvuq','kcGOlISPkYKRksSK','mZCXoteYteHszgnc','mZCYmJuZn1jnA3HMBa','Cgf0Aa','De1Tq1K','l3vWBg9HzhmV','r3n1uuO','m2zkz1bgDG','lMPWzW','CZnvCMW','ru5pru5u','5yIG6zMK57YP55wL5zU+5AsX6lsLoG'];_0x_0x45ca=function(){return _0x3060c9;};return _0x_0x45ca();}async function generateThumbnailsForUploads(_0x4ac311,moduleName){function _0xa9970e(_0x217c5d,_0x12ad30,_0x78a4b7,_0x475cd7){return _0x_0x3c2d(_0x475cd7-0x237,_0x12ad30);}const _0x444d8c=[];function _0x1c2ae1(_0x56b330,_0x40e224,_0x351e37,_0x2c9679){return _0x_0x3c2d(_0x2c9679- -0x210,_0x351e37);}for(const _0x5129cb of _0x4ac311){const _0x2e7e37=_0x5129cb[_0xa9970e(0x42b,0x42f,0x449,0x43e)]||_0xa9970e(0x434,0x436,0x428,0x43a)+moduleName+'/'+_0x5129cb['filename'],_0x373a45=await generateThumbnailForUpload(_0x5129cb,moduleName);_0x444d8c[_0xa9970e(0x454,0x450,0x45b,0x449)]({'original':_0x2e7e37,'thumbnail':_0x373a45||_0x2e7e37});}return _0x444d8c;}async function deleteThumbnail(_0x5ef737,_0xcc410b){function _0x3c9034(_0x473251,_0x41d10a,_0xd18127,_0x3d80b0){return _0x_0x3c2d(_0x3d80b0- -0x2d8,_0xd18127);}function _0x48aaad(_0xe29d49,_0x39c99d,_0xff12b7,_0x15c547){return _0x_0x3c2d(_0xe29d49- -0x1c8,_0x15c547);}try{if(!_0x5ef737||!isImageFile(_0x5ef737))return;const _0x4956bd=getThumbnailPath(_0x5ef737),_0x24acbd=path[_0x3c9034(-0xc8,-0xb5,-0xb2,-0xbc)](_0xcc410b,_0x4956bd);await fs[_0x3c9034(-0xf4,-0xea,-0xeb,-0xe3)](_0x24acbd);}catch(_0x22bd98){_0x22bd98[_0x3c9034(-0xac,-0xb3,-0xba,-0xb9)]!==_0x3c9034(-0xd0,-0xcc,-0xd1,-0xd0)&&console[_0x3c9034(-0xd4,-0xdf,-0xd8,-0xe0)](_0x48aaad(0x41,0x48,0x53,0x4c),_0x22bd98[_0x3c9034(-0xb7,-0xb7,-0xda,-0xcc)]);}}module[_0x_0x1fc3f2(-0x5f,-0x68,-0x72,-0x5e)]={'THUMBNAIL_CONFIG':THUMBNAIL_CONFIG,'getThumbnailFilename':getThumbnailFilename,'getThumbnailPath':getThumbnailPath,'isImageFile':isImageFile,'generateThumbnail':generateThumbnail,'generateThumbnailForUpload':generateThumbnailForUpload,'generateThumbnailsForUploads':generateThumbnailsForUploads,'deleteThumbnail':deleteThumbnail};