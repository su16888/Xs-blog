(function(_0x2c0b5b,_0x2fdc64){function _0x399c47(_0x307330,_0x59471a,_0xe118d1,_0x272b66){return _0x_0x2548(_0x272b66- -0x1d7,_0x59471a);}function _0x17ddd7(_0x7c2d8b,_0x247697,_0x159de0,_0x4064f0){return _0x_0x2548(_0x159de0-0x215,_0x4064f0);}const _0x60e94e=_0x2c0b5b();while(!![]){try{const _0xa03ca=parseInt(_0x17ddd7(0x30c,0x2e5,0x2f4,0x2f7))/(0x7*-0x4e8+-0x6*-0x421+-0x331*-0x3)*(parseInt(_0x17ddd7(0x309,0x2d6,0x2f6,0x2d5))/(0x2*-0x313+-0x1eac+0x24d4))+-parseInt(_0x399c47(-0xfb,-0xef,-0xdd,-0xfe))/(-0x1b38+0x1*-0x8e2+0xd7*0x2b)*(parseInt(_0x399c47(-0xea,-0xcf,-0xdb,-0xf2))/(-0xc4*0x29+0x1983*0x1+0x5e5))+-parseInt(_0x17ddd7(0x2bc,0x2ad,0x2c5,0x2c2))/(0x7*-0x383+-0x23e2+0x3c7c)+-parseInt(_0x399c47(-0xfa,-0xe9,-0xef,-0x108))/(0x2674+0x25c8+0x79f*-0xa)*(-parseInt(_0x399c47(-0x131,-0x12e,-0xfa,-0x112))/(-0x2*0x241+0x3*-0xa7b+0x23fa))+-parseInt(_0x17ddd7(0x316,0x31a,0x300,0x2f8))/(-0x1499+-0x8b*0x2b+-0xd*-0x362)+-parseInt(_0x17ddd7(0x2e7,0x2b4,0x2cf,0x2b5))/(0x2*-0xfe8+0x1f43+0x96)+-parseInt(_0x17ddd7(0x2bf,0x2a8,0x2c2,0x2c8))/(0x94e+0x14f*0x9+0x1*-0x150b)*(-parseInt(_0x399c47(-0x11b,-0x113,-0xe3,-0x102))/(-0x203e+0x1e7*0x1+0x1e62));if(_0xa03ca===_0x2fdc64)break;else _0x60e94e['push'](_0x60e94e['shift']());}catch(_0x14660d){_0x60e94e['push'](_0x60e94e['shift']());}}}(_0x_0x4b4c,-0x123be5+0x149d0b+0x951b1));const _0x_0x575e07=(function(){let _0x3295ae=!![];return function(_0x400748,_0x1294be){function _0x4f8954(_0xbf0999,_0x287145,_0x2bf9fb,_0x303f25){return _0x_0x2548(_0x303f25- -0xa,_0x287145);}function _0x20a933(_0x526bd9,_0x208da5,_0x51fa2f,_0x5efd00){return _0x_0x2548(_0x208da5- -0x82,_0x5efd00);}if(_0x4f8954(0xa0,0xd9,0xa8,0xbe)===_0x4f8954(0xbe,0xdf,0xd9,0xbe)){const _0x264892=_0x3295ae?function(){function _0x51bc9f(_0x282d7e,_0x10dbd5,_0xad3268,_0x1434ad){return _0x4f8954(_0x282d7e-0x114,_0x10dbd5,_0xad3268-0x1b5,_0x1434ad- -0x356);}function _0x1bbe41(_0x5310b8,_0x2751a1,_0x4c2710,_0x4b8639){return _0x20a933(_0x5310b8-0xf1,_0x2751a1- -0x31f,_0x4c2710-0xb9,_0x4b8639);}if(_0x1bbe41(-0x2a8,-0x2c3,-0x2e1,-0x2c9)!==_0x1bbe41(-0x2a1,-0x2c3,-0x2c8,-0x2d8))return _0x5b3550['status'](-0x1*0x579+-0x8b*-0x12+0x4*-0xaf)[_0x1bbe41(-0x2c8,-0x2bf,-0x2de,-0x2a7)]({'success':![],'message':_0x1bbe41(-0x2ea,-0x2d7,-0x2bc,-0x2f7)});else{if(_0x1294be){const _0x27f78e=_0x1294be[_0x51bc9f(-0x291,-0x281,-0x262,-0x270)](_0x400748,arguments);return _0x1294be=null,_0x27f78e;}}}:function(){};return _0x3295ae=![],_0x264892;}else _0xda50e1(_0x29e873);};}()),_0x_0x262d41=_0x_0x575e07(this,function(){function _0x1085b3(_0x1ea6e8,_0x3161a4,_0x4b84b2,_0x4f1d09){return _0x_0x2548(_0x4b84b2-0x20d,_0x1ea6e8);}function _0x727d6d(_0x29b519,_0xbdfd5f,_0xe4869a,_0x111ee6){return _0x_0x2548(_0xbdfd5f- -0x128,_0x29b519);}return _0x_0x262d41['toString']()[_0x727d6d(-0x6a,-0x5d,-0x5e,-0x69)](_0x727d6d(-0x93,-0x7a,-0x78,-0x69))[_0x727d6d(-0x8a,-0x70,-0x66,-0x4e)]()[_0x1085b3(0x2bf,0x2e9,0x2c6,0x2c0)](_0x_0x262d41)[_0x1085b3(0x2de,0x2e3,0x2d8,0x2cf)](_0x727d6d(-0x62,-0x7a,-0x9a,-0x5c));});_0x_0x262d41();const bcrypt=require('bcryptjs');function _0x_0x3811a6(_0x5a0a38,_0x954662,_0x3dd5f6,_0x12d52d){return _0x_0x2548(_0x12d52d-0x26d,_0x5a0a38);}const jwt=require('jsonwebtoken'),User=require('../models/User');function _0x_0x4b4c(){const _0x1049c5=['DxbKyxrL','mZqWq1zYyMzZ','C3rHDhvZ','y3jLyxrL','55M75B2v5OIq5yQF','ChjVzhvJDgLVBG','55sO5OI35zcn5OIw5A+g56cb6zsz6k+V','nJmYnJG4oeLpALb5sq','5A+g56cb6zw/5BQMoIa','55sO5OI35lIn5A2y5zYO','Eef5Bvi','C3rHCNrZv2L0Aa','yxbWBhK','DxbKyxrLzef0','Bg9NAw4','mZiWmZiWmJbotxPNEfe','kcGOlISPkYKRksSK','5B2t5yMn5A+g56cb5zkm5PAW5A+g56cb5lIn6io95lI656M6','ndu0odyXmgTYyLj3zG','zw52','z2v0q3vYCMvUDfvZzxi','AgfZAa','AgvHzgvYCW','6yca5yE655M75B2v5OIq5yQF','DxnLCG','55M75B2v6k+35Rgc6lcd6k+v5l+H5OgVoG','Dg9tDhjPBMC','y29UC3rYDwn0B3i','otu3ntmYnw9LC2Xjzq','yM9KEq','y3jLyxrLzef0','5B2t5yMn5A+g56cb5zkm5PAW55sO5OI35zcn5lIn6io95lI656M6','y29TCgfYzq','DxnLCM5HBwu','zMLUzej5ugS','C2vJDxjL','tK9erv9ftLy','AND0','5A+g56cb5PIV5zcM5lULjdjHjow8GowKTdOG','nde1mJe5uwvwrfLV','AezosMi','Ec1MB3j3yxjKzwqTChjVDg8','CuHrvK0','CgfZC3DVCMq','5B2t5yMn5A+g56cb6zsz6k+V','C2vHCMnO','zMLUze9Uzq','zhf4BNy','55sO5OI35zcnoIa','mtjvA3blDha','5RoO5yAm5OIq5yQF','zxHWAxjLC0LU','ywn0AxzL','55sO5OI35zcn5zkm5A+g56cb5lIn6io95lI656M6','55sO5OI35zcn5l+U5Ps55OIq5yQF','mtfVwKv2zwy','qLLjD0m','55sO5OI35zcn5BEY5A2y5zYO','y2HHBMDLvxnLCM5HBwu','ndu0mtDbvNvdwfy','swf4vMO','BgvUz3rO','CM9Szq','5A+g56cb5l+U5Ps55OIq5yQF','rxvZr0S','mKXhu0noBG','Bg9N','mtq5nJe2nLDrtMzQrW','ANnVBG','jdjHja'];_0x_0x4b4c=function(){return _0x1049c5;};return _0x_0x4b4c();}function _0x_0x2548(_0x4ff4c3,_0x3ed61d){_0x4ff4c3=_0x4ff4c3-(0x1417+-0x22e6+0x3df*0x4);const _0xcb2ac=_0x_0x4b4c();let _0x2b0a1a=_0xcb2ac[_0x4ff4c3];if(_0x_0x2548['QUpUJb']===undefined){var _0x566e64=function(_0x199079){const _0x50b50d='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x105cf6='',_0x33a105='',_0x2a351a=_0x105cf6+_0x566e64;for(let _0x314136=-0x3b*0x25+0xc67*0x1+-0x3e0,_0x2cbc86,_0x1637fa,_0x4f14cc=0x1*-0x321+0x1cc*0x5+-0x5db*0x1;_0x1637fa=_0x199079['charAt'](_0x4f14cc++);~_0x1637fa&&(_0x2cbc86=_0x314136%(0x41*0x59+-0x137f+-0x316)?_0x2cbc86*(0x1*0x2a2+-0x12c+-0x1f*0xa)+_0x1637fa:_0x1637fa,_0x314136++%(0xa61+-0x1e02+0x13a5))?_0x105cf6+=_0x2a351a['charCodeAt'](_0x4f14cc+(-0x1*-0x25c0+-0x1e1a+-0x79c))-(0x10b1+0x11eb+-0x2292)!==-0x26b5+0x1*-0xc7d+-0x1999*-0x2?String['fromCharCode'](-0xda0+0xa89+-0x1*-0x416&_0x2cbc86>>(-(0x108b*0x1+-0x2b4*0x9+0x7cb)*_0x314136&-0x15c*0x18+-0x1a0b+0x3ab1)):_0x314136:0x93+0xc*0x278+-0x1e33){_0x1637fa=_0x50b50d['indexOf'](_0x1637fa);}for(let _0x5a3768=0x1f3e+0x1b1*-0xd+-0x67*0x17,_0x577a1c=_0x105cf6['length'];_0x5a3768<_0x577a1c;_0x5a3768++){_0x33a105+='%'+('00'+_0x105cf6['charCodeAt'](_0x5a3768)['toString'](0x5da*-0x6+0x1c6e+-0x35f*-0x2))['slice'](-(0xa3*0x38+-0x63f+0x9cd*-0x3));}return decodeURIComponent(_0x33a105);};_0x_0x2548['yoqbUY']=_0x566e64,_0x_0x2548['bfNutX']={},_0x_0x2548['QUpUJb']=!![];}const _0x11ad5f=_0xcb2ac[0x214d+0x9*0xa3+-0x2708],_0x52971a=_0x4ff4c3+_0x11ad5f,_0x3fc9d4=_0x_0x2548['bfNutX'][_0x52971a];if(!_0x3fc9d4){const _0x529343=function(_0x172c06){this['bMZSdE']=_0x172c06,this['dhVPki']=[0x55e+0x25b3*-0x1+-0x2*-0x102b,-0x100b+-0x206*-0xf+0x9*-0x197,0x3*-0x293+-0xb3b+0x12f4],this['eLtOvD']=function(){return'newState';},this['PpuIyc']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['NWUkuZ']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x529343['prototype']['NScgSs']=function(){const _0xc480b6=new RegExp(this['PpuIyc']+this['NWUkuZ']),_0x27d74f=_0xc480b6['test'](this['eLtOvD']['toString']())?--this['dhVPki'][-0x4*0x10d+0x51*0x15+0x18*-0x1a]:--this['dhVPki'][-0xc15*-0x1+-0xbb2+-0x63];return this['ZnHvAW'](_0x27d74f);},_0x529343['prototype']['ZnHvAW']=function(_0x2e1494){if(!Boolean(~_0x2e1494))return _0x2e1494;return this['GJTopY'](this['bMZSdE']);},_0x529343['prototype']['GJTopY']=function(_0x4b1e81){for(let _0x321b68=0x182c+-0x220e+0x9e2,_0x4c7ebe=this['dhVPki']['length'];_0x321b68<_0x4c7ebe;_0x321b68++){this['dhVPki']['push'](Math['round'](Math['random']())),_0x4c7ebe=this['dhVPki']['length'];}return _0x4b1e81(this['dhVPki'][0x673*-0x1+0x1413+0x6d*-0x20]);},new _0x529343(_0x_0x2548)['NScgSs'](),_0x2b0a1a=_0x_0x2548['yoqbUY'](_0x2b0a1a),_0x_0x2548['bfNutX'][_0x52971a]=_0x2b0a1a;}else _0x2b0a1a=_0x3fc9d4;return _0x2b0a1a;}function _0x_0x2c88f5(_0x34de22,_0x1445f6,_0x2c959c,_0x5b4c17){return _0x_0x2548(_0x1445f6- -0x23c,_0x34de22);}const config=require('../config/config');exports['register']=async(_0x1195e2,_0x37e7b0,_0x58f9cc)=>{function _0x220646(_0x352590,_0x1f3f77,_0x1e5d9e,_0x2fab5d){return _0x_0x2548(_0x1f3f77- -0x212,_0x352590);}function _0x3052ff(_0x3ea538,_0x435108,_0x18fec3,_0x42a872){return _0x_0x2548(_0x18fec3- -0x208,_0x42a872);}try{const {username:_0x130899,password:_0x449b81,email:_0x24b8ca}=_0x1195e2['body'];if(!_0x130899||!_0x449b81)return _0x37e7b0[_0x220646(-0x10f,-0x12c,-0x12f,-0x12c)](-0x1443+0x2*0x1175+-0x1*0xd17)[_0x3052ff(-0x139,-0x105,-0x126,-0x126)]({'success':![],'message':_0x220646(-0x129,-0x13f,-0x14b,-0x11e)});const _0x4fe5e8=await User[_0x220646(-0x158,-0x146,-0x124,-0x160)]({'where':{'username':_0x130899}});if(_0x4fe5e8)return _0x220646(-0x12f,-0x145,-0x15c,-0x137)!==_0x220646(-0x124,-0x145,-0x140,-0x15a)?_0x5e03b2[_0x220646(-0x14c,-0x15a,-0x160,-0x174)]()[_0x220646(-0x161,-0x147,-0x124,-0x134)]('(((.+)+)+)+$')[_0x3052ff(-0x14f,-0x157,-0x150,-0x14e)]()[_0x3052ff(-0x132,-0x166,-0x14f,-0x143)](_0xd2ca88)[_0x220646(-0x12f,-0x147,-0x135,-0x12e)](_0x220646(-0x168,-0x164,-0x162,-0x154)):_0x37e7b0['status'](0x2070*0x1+0xb*-0x74+-0x19e4)[_0x3052ff(-0x110,-0x105,-0x126,-0x145)]({'success':![],'message':'用户名已存在'});const _0x37cf9d=await bcrypt[_0x3052ff(-0x175,-0x173,-0x155,-0x13a)](_0x449b81,-0x15ab+0x1f5f+-0x9aa*0x1),_0x583dc6=await User[_0x220646(-0x128,-0x12b,-0x11d,-0x119)]({'username':_0x130899,'password':_0x37cf9d,'email':_0x24b8ca,'role':_0x220646(-0x15f,-0x15c,-0x178,-0x158),'status':_0x220646(-0x14a,-0x140,-0x160,-0x130)}),_0x4b0e5b=jwt['sign']({'id':_0x583dc6['id'],'username':_0x583dc6['username']},config[_0x220646(-0x148,-0x14f,-0x156,-0x164)]['secret'],{'expiresIn':config['jwt']['expiresIn']});_0x37e7b0['status'](0x625+0x7*0x3fa+-0x1099*0x2)[_0x220646(-0x151,-0x130,-0x13c,-0x11a)]({'success':!![],'message':_0x3052ff(-0x12e,-0x14d,-0x138,-0x152),'data':{'token':_0x4b0e5b,'user':{'id':_0x583dc6['id'],'username':_0x583dc6[_0x220646(-0x158,-0x153,-0x131,-0x15f)],'role':_0x583dc6[_0x220646(-0x12b,-0x136,-0x128,-0x12e)],'status':_0x583dc6[_0x220646(-0x114,-0x12c,-0x135,-0x123)]}}});}catch(_0x3d09d8){_0x58f9cc(_0x3d09d8);}},exports[_0x_0x2c88f5(-0x138,-0x14a,-0x14e,-0x12e)]=async(_0x4f899c,_0x38d0e1,_0x1f2535)=>{function _0x3cfd1b(_0xf974ae,_0x347a6c,_0x4c5ac3,_0x585da1){return _0x_0x2c88f5(_0x4c5ac3,_0xf974ae-0x405,_0x4c5ac3-0xda,_0x585da1-0x176);}function _0x1f9055(_0x31c58e,_0x5ad94e,_0xa635a9,_0x20c0eb){return _0x_0x2c88f5(_0x31c58e,_0x5ad94e-0x1ac,_0xa635a9-0xbf,_0x20c0eb-0x46);}try{if(_0x3cfd1b(0x2b7,0x2a5,0x2d0,0x2af)!==_0x1f9055(0x3d,0x5e,0x52,0x55))_0x501b71(_0x54cad4);else{const {username:_0x51fcd8,password:_0x5b57c4}=_0x4f899c['body'];console[_0x1f9055(0x33,0x50,0x6a,0x55)](_0x3cfd1b(0x280,0x295,0x261,0x261)),console[_0x1f9055(0x35,0x50,0x47,0x60)](_0x1f9055(0x41,0x3e,0x2e,0x3f)+_0x51fcd8),console[_0x1f9055(0x5c,0x50,0x58,0x47)]('收到的密码:\x20'+_0x5b57c4),console[_0x1f9055(0x59,0x50,0x43,0x4f)](_0x3cfd1b(0x2b5,0x2b9,0x2a2,0x2d3)+(_0x5b57c4?_0x5b57c4[_0x1f9055(0x68,0x4b,0x5a,0x34)]:0x7da+0x24ac+0x2c86*-0x1)),console['log'](_0x3cfd1b(0x28d,0x2a3,0x287,0x2aa)+(_0x5b57c4?_0x5b57c4[_0x3cfd1b(0x2b8,0x29f,0x2c2,0x2ad)](_0x3cfd1b(0x2ac,0x2bf,0x2a5,0x2c2)):![]));const _0x44e666=_0x4f899c[_0x1f9055(0x2b,0x31,0x1c,0x2a)]||_0x4f899c[_0x1f9055(0x27,0x24,0x46,0x23)][_0x1f9055(0x4f,0x37,0x15,0x59)]==='https',_0x35cac2=process[_0x3cfd1b(0x27a,0x287,0x267,0x274)][_0x3cfd1b(0x28b,0x283,0x26a,0x296)]===_0x3cfd1b(0x2b2,0x2c1,0x2c1,0x295);if(!_0x51fcd8||!_0x5b57c4)return _0x1f9055(0x5b,0x4a,0x3f,0x6d)===_0x3cfd1b(0x2a3,0x29f,0x287,0x29f)?_0x38d0e1[_0x1f9055(0x58,0x56,0x54,0x53)](0x11*-0x22+-0x362*0x2+0x5*0x21e)[_0x1f9055(0x3c,0x52,0x48,0x75)]({'success':![],'message':_0x3cfd1b(0x29c,0x28a,0x2b2,0x29e)}):_0x55d1df[_0x1f9055(0x50,0x56,0x62,0x67)](0x31*-0x6a+0x23bf+0x1*-0xde5)[_0x1f9055(0x52,0x52,0x60,0x4f)]({'success':![],'message':_0x1f9055(-0x2,0x1f,0x3e,0x1b)});const _0x13965a=await User[_0x3cfd1b(0x295,0x2a3,0x276,0x29f)]({'where':{'username':_0x51fcd8}});if(!_0x13965a)return _0x38d0e1['status'](-0x26d+0xcf*-0x2b+-0x26c3*-0x1)[_0x3cfd1b(0x2ab,0x2b7,0x29b,0x2aa)]({'success':![],'message':_0x1f9055(0x50,0x5a,0x7c,0x51)});const _0x5641f7=await bcrypt['compare'](_0x5b57c4,_0x13965a[_0x3cfd1b(0x292,0x285,0x27f,0x2a3)]);if(!_0x5641f7)return _0x38d0e1[_0x3cfd1b(0x2af,0x2be,0x2a1,0x2b2)](-0x5*-0x23d+-0x24c0*-0x1+-0x2e60)[_0x3cfd1b(0x2ab,0x2cb,0x2ab,0x2a3)]({'success':![],'message':_0x1f9055(0x6d,0x5a,0x69,0x6c)});const _0x2b426c=jwt['sign']({'id':_0x13965a['id'],'username':_0x13965a[_0x1f9055(0x27,0x2f,0x3c,0x10)]},config[_0x3cfd1b(0x28c,0x27e,0x276,0x282)]['secret'],{'expiresIn':config[_0x3cfd1b(0x28c,0x296,0x27c,0x288)][_0x1f9055(0x27,0x41,0x46,0x4b)]});_0x38d0e1[_0x3cfd1b(0x2ab,0x2ce,0x2c7,0x2a5)]({'success':!![],'message':_0x1f9055(0x3a,0x58,0x6a,0x65),'data':{'token':_0x2b426c,'user':{'id':_0x13965a['id'],'username':_0x13965a[_0x3cfd1b(0x288,0x26a,0x283,0x279)],'role':_0x13965a[_0x3cfd1b(0x2a5,0x28f,0x28c,0x293)],'status':_0x13965a[_0x1f9055(0x4c,0x56,0x44,0x70)]}}});}}catch(_0x304e7d){_0x1f2535(_0x304e7d);}},exports[_0x_0x2c88f5(-0x191,-0x18a,-0x198,-0x183)]=async(_0x19722c,_0x21a528,_0x4a6252)=>{function _0x2245f3(_0x1bafde,_0x1ce0c9,_0x5a773b,_0x18068a){return _0x_0x2c88f5(_0x5a773b,_0x1ce0c9-0x1b3,_0x5a773b-0x128,_0x18068a-0xe9);}function _0x3c39a8(_0x372a05,_0x318da5,_0x31608a,_0x43529c){return _0x_0x2c88f5(_0x318da5,_0x31608a-0x454,_0x31608a-0x150,_0x43529c-0x22);}try{if('OBPUb'!==_0x3c39a8(0x2e8,0x2d9,0x2ee,0x2d9)){const _0x236f56=await User[_0x3c39a8(0x2b5,0x2d7,0x2d8,0x2f2)](_0x19722c[_0x3c39a8(0x2c1,0x2c6,0x2ce,0x2ab)]['id'],{'attributes':{'exclude':['password']}});if(!_0x236f56)return _0x21a528[_0x3c39a8(0x317,0x2f2,0x2fe,0x2ea)](-0x356+-0xa39+0xf23)['json']({'success':![],'message':_0x2245f3(0x56,0x64,0x85,0x46)});_0x21a528['json']({'success':!![],'data':{'id':_0x236f56['id'],'username':_0x236f56[_0x2245f3(0x1c,0x36,0x22,0x24)],'role':_0x236f56[_0x2245f3(0x32,0x53,0x4c,0x41)],'status':_0x236f56['status'],'createdAt':_0x236f56[_0x2245f3(0x11,0x33,0x4b,0x12)],'updatedAt':_0x236f56[_0x3c39a8(0x314,0x30c,0x309,0x316)]}});}else{const _0x1535de=_0xdd4bac[_0x2245f3(0x89,0x67,0x8a,0x51)](_0x72697,arguments);return _0x2071f7=null,_0x1535de;}}catch(_0x4c4440){_0x4a6252(_0x4c4440);}},exports['changePassword']=async(_0x1e1846,_0x429e1b,_0x164820)=>{function _0xeac47d(_0x49f905,_0x213ff9,_0x318fd8,_0xd30422){return _0x_0x2c88f5(_0x318fd8,_0xd30422- -0x19c,_0x318fd8-0xe3,_0xd30422-0xe2);}function _0x3b20fc(_0x3ec5e4,_0x3c954a,_0x19abef,_0x275085){return _0x_0x3811a6(_0x275085,_0x3c954a-0x187,_0x19abef-0x4c,_0x3ec5e4- -0xa);}try{const {currentPassword:_0x3fd819,newPassword:_0x39fc7b}=_0x1e1846['body'];if(!_0x3fd819||!_0x39fc7b)return _0x429e1b['status'](-0x615+0x11*0x106+-0x9c1*0x1)['json']({'success':![],'message':_0xeac47d(-0x32a,-0x321,-0x333,-0x329)});const _0x45eda6=await User[_0x3b20fc(0x323,0x326,0x33f,0x335)](_0x1e1846[_0xeac47d(-0x32e,-0x308,-0x319,-0x322)]['id']);if(!_0x45eda6)return _0x429e1b['status'](-0xd2a+0x71b+0x187*0x5)['json']({'success':![],'message':_0xeac47d(-0x2e0,-0x2d7,-0x30b,-0x2eb)});const _0x41ace5=await bcrypt[_0x3b20fc(0x321,0x2ff,0x338,0x313)](_0x3fd819,_0x45eda6[_0x3b20fc(0x32c,0x322,0x329,0x347)]);if(!_0x41ace5)return _0x429e1b[_0x3b20fc(0x349,0x343,0x362,0x326)](-0x197+-0xddd*-0x1+-0xab5)[_0x3b20fc(0x345,0x358,0x34c,0x35d)]({'success':![],'message':_0xeac47d(-0x31a,-0x2f2,-0x30c,-0x30e)});const _0x396371=await bcrypt[_0xeac47d(-0x309,-0x326,-0x311,-0x325)](_0x39fc7b,0xfca+0x13d6+-0x11cb*0x2);await _0x45eda6[_0xeac47d(-0x312,-0x2e2,-0x2f0,-0x2f4)]({'password':_0x396371}),_0x429e1b[_0x3b20fc(0x345,0x325,0x33b,0x336)]({'success':!![],'message':_0x3b20fc(0x340,0x332,0x325,0x32c)});}catch(_0x3d57e2){_0x164820(_0x3d57e2);}},exports[_0x_0x2c88f5(-0x178,-0x164,-0x159,-0x17a)]=async(_0x2da962,_0x4b5103,_0x12513e)=>{function _0x263286(_0x26d3ff,_0x332a4a,_0x10e8e2,_0x2804de){return _0x_0x3811a6(_0x10e8e2,_0x332a4a-0xc5,_0x10e8e2-0xb,_0x2804de- -0x1e1);}function _0x2f7d6b(_0x50b4d1,_0x49c8a4,_0x213439,_0xca55da){return _0x_0x3811a6(_0xca55da,_0x49c8a4-0x48,_0x213439-0x7c,_0x213439- -0x63c);}try{const {currentPassword:_0x29aef1,newUsername:_0x30a5d9}=_0x2da962[_0x2f7d6b(-0x2f9,-0x308,-0x314,-0x324)];if(!_0x29aef1||!_0x30a5d9)return _0x4b5103[_0x263286(0x15b,0x17b,0x193,0x172)](0x9*-0x2ca+0x4f8+0x15b2)[_0x263286(0x161,0x156,0x162,0x16e)]({'success':![],'message':_0x263286(0x153,0x13e,0x137,0x149)});const _0x531e21=await User[_0x263286(0x169,0x164,0x158,0x14c)](_0x2da962['user']['id']);if(!_0x531e21)return _0x4b5103[_0x2f7d6b(-0x2e8,-0x2ec,-0x2e9,-0x2e6)](0xde7*-0x1+-0x1a10+-0xf*-0x2c5)[_0x2f7d6b(-0x30c,-0x2f2,-0x2ed,-0x2fb)]({'success':![],'message':_0x263286(0x178,0x16e,0x187,0x179)});const _0x3d89a6=await bcrypt[_0x2f7d6b(-0x332,-0x301,-0x311,-0x2fc)](_0x29aef1,_0x531e21[_0x2f7d6b(-0x325,-0x319,-0x306,-0x31f)]);if(!_0x3d89a6){if(_0x2f7d6b(-0x2e9,-0x2f7,-0x309,-0x314)!=='hFNJb')_0x36bbb1[_0x263286(0x169,0x188,0x177,0x16e)]({'success':!![],'message':'退出登录成功'});else return _0x4b5103['status'](0x1*-0x1f7b+0x9cc+-0x8*-0x2e8)[_0x2f7d6b(-0x2e4,-0x2e8,-0x2ed,-0x2ec)]({'success':![],'message':'当前密码错误'});}const _0x305722=await User['findOne']({'where':{'username':_0x30a5d9}});if(_0x305722&&_0x305722['id']!==_0x531e21['id'])return _0x4b5103[_0x2f7d6b(-0x2da,-0x308,-0x2e9,-0x2de)](0x893+-0x7*-0x1f0+-0x1493)[_0x2f7d6b(-0x2d8,-0x304,-0x2ed,-0x2fd)]({'success':![],'message':_0x2f7d6b(-0x30c,-0x2f4,-0x2f8,-0x302)});await _0x531e21[_0x263286(0x16a,0x18b,0x165,0x170)]({'username':_0x30a5d9}),_0x4b5103['json']({'success':!![],'message':_0x263286(0x142,0x13f,0x163,0x160)});}catch(_0x29b19d){_0x12513e(_0x29b19d);}},exports['logout']=async(_0x3eb6c2,_0x36a8e8,_0x10b3db)=>{function _0x367c29(_0x5905b6,_0xac9c78,_0xe5dd57,_0x3c7d3d){return _0x_0x3811a6(_0xe5dd57,_0xac9c78-0x163,_0xe5dd57-0xb8,_0xac9c78-0xad);}function _0x1de383(_0x5b7d9d,_0x26fcdb,_0xf55cab,_0x58da41){return _0x_0x2c88f5(_0x26fcdb,_0x5b7d9d-0x38a,_0xf55cab-0x6d,_0x58da41-0x6d);}try{_0x36a8e8[_0x1de383(0x230,0x239,0x241,0x251)]({'success':!![],'message':_0x1de383(0x203,0x1fe,0x219,0x1fe)});}catch(_0x16d670){_0x10b3db(_0x16d670);}};