(function(_0x2da0a1,_0x1921d7){function _0x2289d5(_0x557ab3,_0x3b3223,_0x139fb4,_0x1fe1b6){return _0x_0x5b5b(_0x557ab3-0x3c5,_0x139fb4);}const _0x19210e=_0x2da0a1();function _0x1566b6(_0x36bfca,_0x3aa2d3,_0xf87e17,_0x1136eb){return _0x_0x5b5b(_0x36bfca- -0x2f4,_0xf87e17);}while(!![]){try{const _0x25ef92=-parseInt(_0x1566b6(-0x21c,-0x1fc,-0x21c,-0x22f))/(0x2f*0x53+0x1e9c+-0x2dd8)*(parseInt(_0x1566b6(-0x21d,-0x214,-0x215,-0x213))/(-0xb57+0x1*0x1df5+-0x129c))+parseInt(_0x2289d5(0x4b7,0x49d,0x4d9,0x4af))/(-0x2b*0xce+0xcfb+0x15a2)+-parseInt(_0x1566b6(-0x20b,-0x1f2,-0x227,-0x22a))/(0x2613+-0x11fb*0x2+-0x219)+parseInt(_0x2289d5(0x4bc,0x4c9,0x4ba,0x4da))/(-0x14*-0x17f+-0x7*0x14a+-0x14e1)+-parseInt(_0x2289d5(0x49e,0x497,0x4ab,0x4b7))/(0x1*-0x11ff+-0x14c1+0x26c6)+-parseInt(_0x2289d5(0x4b3,0x4ad,0x498,0x49e))/(-0x224d+0xad0+0xbc2*0x2)+parseInt(_0x2289d5(0x482,0x49d,0x464,0x49d))/(-0x1d44*0x1+0x3*-0x6d5+-0x25f*-0x15)*(parseInt(_0x1566b6(-0x225,-0x23c,-0x229,-0x23d))/(-0x9*-0x377+0x4f5+0xd*-0x2c7));if(_0x25ef92===_0x1921d7)break;else _0x19210e['push'](_0x19210e['shift']());}catch(_0x429609){_0x19210e['push'](_0x19210e['shift']());}}}(_0x_0x5d50,-0x347*-0xdd+-0x7944b+0x9a67f));function _0x_0x5d50(){const _0x3b19dd=['y3jLyxrL','55sO5OI35zcn5BEY5A2y5zYO','kcGOlISPkYKRksSK','ndC1nZm2yLDbBfzu','zxHWAxjLC0LU','yM9KEq','y2HHBMDLugfZC3DVCMq','AND0','y29UC3rYDwn0B3i','5A+g56cb5l+U5Ps55OIq5yQF','Dg9tDhjPBMC','Bg9NB3v0','5Ps25yIW55Qe5A+g56cboIa','Bg9N','CgfZC3DVCMq','Ec1MB3j3yxjKzwqTChjVDg8','DxbKyxrL','vK5TvfG','y2HHBMDLvxnLCM5HBwu','C3n4sNi','C3rHDhvZ','odfzA3PuDfa','t2nKEM0','5A+g56cb5PIV5zcM5lULjdjHjow8GowKTdOG','whr6zuK','C2LNBG','55sO5OI35zcnoIa','rvH5uKG','zMLUze9Uzq','ndCWnJjICNv4wwK','mKzWu1jNAG','mty0mtG1ofbqtMHkzG','55sO5OI35lIn5A2y5zYO','5B2t5yMn5A+g56cb5zkm5PAW55sO5OI35zcn5lIn6io95lI656M6','qMTQvMG','zMLUzej5ugS','tK9erv9ftLy','5B2t5yMn5A+g56cb5zkm5PAW5A+g56cb5lIn6io95lI656M6','DxbKyxrLzef0','v3DJD24','C2vJCMv0','Bg9NAw4','5B2t5yMn5A+g56cb6zsz6k+V','6yca5yE655M75B2v5OIq5yQF','55sO5OI35zcn5zkm5A+g56cb5lIn6io95lI656M6','yMfAwfC','5A+g56cb6zw/5BQMoIa','mtaXodqWnhLdz2vdsa','y29TCgfYzq','zw52','55M75B2v6k+35Rgc6lcd6k+v5l+H5OgVoG','qKDTDKi','nde4mty3ngTJy2XfqW','55sO5OI35zcn5OIw5A+g56cb6zsz6k+V','D1PsA1C','DxnLCG','otKXmZe3t2jvuLrM','ANnVBG','C2vJDxjL','z2v0q3vYCMvUDfvZzxi','55M75B2v5OIq5yQF','mZe0mdK4nvjczMvYCa','ChjVzhvJDgLVBG','uhrusMW','CM9Szq','DxnLCM5HBwu','AgfZAa','y3jLyxrLzef0'];_0x_0x5d50=function(){return _0x3b19dd;};return _0x_0x5d50();}function _0x_0x5b5b(_0x14e7ea,_0x374bd8){const _0x5af9f5=_0x_0x5d50();return _0x_0x5b5b=function(_0x2d19ed,_0x4fe80e){_0x2d19ed=_0x2d19ed-(0x3*0x315+-0x1348+0x560*0x2);let _0x3e27d2=_0x5af9f5[_0x2d19ed];if(_0x_0x5b5b['VZdIjL']===undefined){var _0x489681=function(_0x3b4131){const _0x34afb3='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1e583c='',_0xe2e5='',_0x5ea1b9=_0x1e583c+_0x489681;for(let _0x5b65bd=-0x22*0xb5+-0x1*0x24bc+-0x3cc6*-0x1,_0x59cf0d,_0x572e88,_0x4cda02=-0x1ef5*-0x1+0x898+0x51*-0x7d;_0x572e88=_0x3b4131['charAt'](_0x4cda02++);~_0x572e88&&(_0x59cf0d=_0x5b65bd%(-0x10b*-0x4+-0x481*-0x7+-0x23af)?_0x59cf0d*(-0x217*-0x8+0x2657+-0x36cf)+_0x572e88:_0x572e88,_0x5b65bd++%(-0xdd4+-0x403*-0x1+0x9d5))?_0x1e583c+=_0x5ea1b9['charCodeAt'](_0x4cda02+(0x209*0x2+0x5*-0x9+-0x3db))-(-0x1294+0x2e3+0xfbb)!==-0x123e+0x2b*-0xe5+-0x64d*-0x9?String['fromCharCode'](-0x2*-0x85d+-0x25*-0x10c+-0x3677&_0x59cf0d>>(-(-0xbcf*0x2+0x2c9+0x14d7)*_0x5b65bd&0x1ac2+0x1*0xe95+0x2951*-0x1)):_0x5b65bd:0xc0d+-0x16a3+0xa96){_0x572e88=_0x34afb3['indexOf'](_0x572e88);}for(let _0x519713=-0x20bb+-0x13*-0x17f+-0x1*-0x44e,_0x373fa4=_0x1e583c['length'];_0x519713<_0x373fa4;_0x519713++){_0xe2e5+='%'+('00'+_0x1e583c['charCodeAt'](_0x519713)['toString'](-0x17b5*-0x1+0x7*0x465+-0x4*0xd9a))['slice'](-(0x11e1+-0xb86+-0x659));}return decodeURIComponent(_0xe2e5);};_0x_0x5b5b['qHykPe']=_0x489681,_0x14e7ea=arguments,_0x_0x5b5b['VZdIjL']=!![];}const _0x8919cb=_0x5af9f5[0x53*-0x67+0x83*0x40+0x5*0x21],_0x1a55f9=_0x2d19ed+_0x8919cb,_0x4487ce=_0x14e7ea[_0x1a55f9];if(!_0x4487ce){const _0xb8ada5=function(_0x2f7f0c){this['OdVHsP']=_0x2f7f0c,this['PBNrqs']=[0xa00+0x767+-0x1166,0xff2*0x1+0x1439+-0x242b,-0x4aa+-0x136a+0x1814],this['ZKMLyi']=function(){return'newState';},this['exXMVw']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['TllYTL']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0xb8ada5['prototype']['uWRwbZ']=function(){const _0xd4903=new RegExp(this['exXMVw']+this['TllYTL']),_0x131d59=_0xd4903['test'](this['ZKMLyi']['toString']())?--this['PBNrqs'][0xc7*-0x12+-0x2147+0x2f46]:--this['PBNrqs'][-0x18*0x1+-0x280*0x8+-0x1*-0x1418];return this['oBMWrZ'](_0x131d59);},_0xb8ada5['prototype']['oBMWrZ']=function(_0x541faf){if(!Boolean(~_0x541faf))return _0x541faf;return this['ikZFVZ'](this['OdVHsP']);},_0xb8ada5['prototype']['ikZFVZ']=function(_0x195703){for(let _0x293e74=-0x56*-0x4d+0x26f+-0x5a9*0x5,_0x5e7e23=this['PBNrqs']['length'];_0x293e74<_0x5e7e23;_0x293e74++){this['PBNrqs']['push'](Math['round'](Math['random']())),_0x5e7e23=this['PBNrqs']['length'];}return _0x195703(this['PBNrqs'][0xf9c+-0x1*0x129b+0xd*0x3b]);},new _0xb8ada5(_0x_0x5b5b)['uWRwbZ'](),_0x3e27d2=_0x_0x5b5b['qHykPe'](_0x3e27d2),_0x14e7ea[_0x1a55f9]=_0x3e27d2;}else _0x3e27d2=_0x4487ce;return _0x3e27d2;},_0x_0x5b5b(_0x14e7ea,_0x374bd8);}const _0x_0x2f1b40=(function(){let _0x230398=!![];return function(_0x468d37,_0x34af28){function _0xcc6c1e(_0x4694e7,_0x21f2fc,_0x481580,_0x1e64b0){return _0x_0x5b5b(_0x1e64b0- -0x210,_0x4694e7);}function _0x1be78b(_0x38dead,_0x767385,_0x24aa40,_0x5141d9){return _0x_0x5b5b(_0x38dead- -0x35f,_0x5141d9);}if(_0x1be78b(-0x28f,-0x282,-0x2ae,-0x2a9)!==_0x1be78b(-0x28f,-0x299,-0x2ae,-0x2a6))return _0x116a06['status'](0x9ce+0x1b1a+-0x2f2*0xc)[_0xcc6c1e(-0x111,-0x135,-0x123,-0x11d)]({'success':![],'message':'用户名和密码不能为空'});else{const _0xb2e48=_0x230398?function(){function _0xdbd9f3(_0xb2af5c,_0x3ae8e4,_0x43636f,_0x12b013){return _0x1be78b(_0xb2af5c-0x563,_0x3ae8e4-0x91,_0x43636f-0x105,_0x3ae8e4);}function _0x499915(_0xa189d,_0x1f9a41,_0x4c77bf,_0x607a2b){return _0x1be78b(_0x4c77bf-0x539,_0x1f9a41-0x197,_0x4c77bf-0x12a,_0xa189d);}if(_0x34af28){if(_0xdbd9f3(0x2e5,0x2d3,0x2f4,0x2ee)===_0x499915(0x2a0,0x2ce,0x2bb,0x2a7)){const _0x25c7ec=_0x34af28['apply'](_0x468d37,arguments);return _0x34af28=null,_0x25c7ec;}else return _0x4c9f0d[_0x499915(0x2c5,0x2a9,0x2a8,0x2b3)](0x92+0x6*-0x2da+0x121a)['json']({'success':![],'message':_0x499915(0x2c4,0x2d5,0x2b5,0x2a5)});}}:function(){};return _0x230398=![],_0xb2e48;}};}()),_0x_0x381af2=_0x_0x2f1b40(this,function(){function _0x36aac9(_0x2097f4,_0x12e323,_0xcaae46,_0x14ff25){return _0x_0x5b5b(_0xcaae46- -0x2e8,_0x12e323);}function _0x47f1e5(_0x3ca33c,_0x4b8633,_0xb2e145,_0x2e3813){return _0x_0x5b5b(_0x3ca33c- -0x2f7,_0x4b8633);}return _0x_0x381af2[_0x47f1e5(-0x233,-0x245,-0x248,-0x232)]()['search'](_0x47f1e5(-0x23b,-0x24f,-0x24e,-0x22d))['toString']()[_0x47f1e5(-0x235,-0x229,-0x224,-0x23e)](_0x_0x381af2)['search']('(((.+)+)+)+$');});function _0x_0x4756bf(_0x411e46,_0xc07706,_0x50c801,_0x548f23){return _0x_0x5b5b(_0xc07706-0x35e,_0x50c801);}_0x_0x381af2();const bcrypt=require('bcryptjs'),jwt=require('jsonwebtoken'),User=require('../models/User'),config=require('../config/config');function _0x_0x13ec29(_0x2f8ac0,_0x13b3f0,_0x5da2a5,_0x3b64c2){return _0x_0x5b5b(_0x3b64c2- -0x32f,_0x5da2a5);}exports['register']=async(_0x21b09e,_0x3f11db,_0x5bd535)=>{function _0x3e9afc(_0xdf1d2d,_0x118c7c,_0x55247b,_0x4178e9){return _0x_0x5b5b(_0xdf1d2d- -0x22c,_0x4178e9);}function _0x335371(_0x2bac8c,_0x56b6ef,_0x1d7791,_0x5d0a30){return _0x_0x5b5b(_0x5d0a30-0x20a,_0x56b6ef);}try{if(_0x3e9afc(-0x133,-0x117,-0x12f,-0x143)!==_0x3e9afc(-0x157,-0x14a,-0x146,-0x13e)){const {username:_0x147362,password:_0x529cbf,email:_0x44c73e}=_0x21b09e[_0x3e9afc(-0x16d,-0x161,-0x17e,-0x18b)];if(!_0x147362||!_0x529cbf)return _0x3f11db[_0x335371(0x2ee,0x2e3,0x2d8,0x2d8)](0x1*-0x5e4+0x2*0x503+-0x292)[_0x3e9afc(-0x139,-0x121,-0x141,-0x13d)]({'success':![],'message':'用户名和密码不能为空'});const _0x52a9a2=await User[_0x335371(0x2ce,0x2dc,0x2dc,0x2e0)]({'where':{'username':_0x147362}});if(_0x52a9a2)return _0x3e9afc(-0x13f,-0x160,-0x133,-0x13c)!==_0x3e9afc(-0x13f,-0x12b,-0x151,-0x128)?_0x5261b5['status'](-0x4*-0x875+-0x1b35+-0x50e)[_0x335371(0x31e,0x2e9,0x30b,0x2fd)]({'success':![],'message':_0x335371(0x2fd,0x2e3,0x2e5,0x2ee)}):_0x3f11db[_0x335371(0x2f9,0x2f1,0x2f3,0x2d8)](0x4c*0x2+0x22f8+0x1100*-0x2)['json']({'success':![],'message':_0x335371(0x2e1,0x2d1,0x2e1,0x2c5)});const _0x27043b=await bcrypt['hash'](_0x529cbf,0x2209+-0x383*0xb+0x4a2),_0x4ec97b=await User[_0x335371(0x2cf,0x2e1,0x2c2,0x2c4)]({'username':_0x147362,'password':_0x27043b,'email':_0x44c73e,'role':'user','status':'active'}),_0x2b39a1=jwt[_0x335371(0x2c1,0x2ff,0x2c1,0x2dd)]({'id':_0x4ec97b['id'],'username':_0x4ec97b[_0x335371(0x2d6,0x2a2,0x2b2,0x2c1)]},config[_0x335371(0x2db,0x2dc,0x2d3,0x2cb)][_0x335371(0x2da,0x2e7,0x2e0,0x2ec)],{'expiresIn':config[_0x335371(0x2cf,0x2ec,0x2e9,0x2cb)]['expiresIn']});_0x3f11db[_0x3e9afc(-0x15e,-0x150,-0x13d,-0x168)](-0x1a60+0x1c7b+-0x152)[_0x3e9afc(-0x139,-0x149,-0x14d,-0x127)]({'success':!![],'message':'注册成功','data':{'token':_0x2b39a1,'user':{'id':_0x4ec97b['id'],'username':_0x4ec97b[_0x335371(0x2db,0x2ca,0x2c4,0x2c1)],'role':_0x4ec97b[_0x3e9afc(-0x132,-0x122,-0x135,-0x14f)],'status':_0x4ec97b[_0x3e9afc(-0x15e,-0x14f,-0x16f,-0x150)]}}});}else return _0x56c96e[_0x3e9afc(-0x15e,-0x17b,-0x146,-0x16c)](-0xab*-0x1b+0x196b+-0x5*0x860)['json']({'success':![],'message':'用户不存在'});}catch(_0x5272c2){_0x5bd535(_0x5272c2);}},exports[_0x_0x4756bf(0x42d,0x441,0x451,0x443)]=async(_0xe9b5f7,_0x59e89f,_0x4b5f0a)=>{function _0x56e4c7(_0x4c4a5c,_0x3b03d1,_0x2017a3,_0x265fb6){return _0x_0x4756bf(_0x4c4a5c-0x69,_0x3b03d1- -0x51c,_0x265fb6,_0x265fb6-0x169);}function _0x144114(_0x1dfb15,_0x1bb072,_0x58d483,_0x59169b){return _0x_0x4756bf(_0x1dfb15-0x76,_0x1bb072- -0x81,_0x1dfb15,_0x59169b-0x47);}try{const {username:_0x27e944,password:_0x485eea}=_0xe9b5f7[_0x144114(0x381,0x39c,0x37b,0x38e)];console[_0x56e4c7(-0x110,-0xf7,-0x117,-0x10c)](_0x144114(0x3d0,0x3c9,0x3bc,0x3bd)),console[_0x56e4c7(-0xda,-0xf7,-0xda,-0xfa)](_0x56e4c7(-0xf7,-0xea,-0xf3,-0xcd)+_0x27e944),console[_0x56e4c7(-0xd5,-0xf7,-0x109,-0xeb)](_0x144114(0x3bc,0x3a3,0x39a,0x3a6)+_0x485eea),console[_0x144114(0x3be,0x3a4,0x3a7,0x3b2)](_0x144114(0x3d4,0x3c5,0x3b4,0x3cb)+(_0x485eea?_0x485eea['length']:0x2530+0x1067+0x327*-0x11)),console['log'](_0x144114(0x3bb,0x3ae,0x3cb,0x3b3)+(_0x485eea?_0x485eea['startsWith']('$2a$'):![]));const _0x46a473=_0xe9b5f7[_0x56e4c7(-0xbc,-0xca,-0xaa,-0xe7)]||_0xe9b5f7['headers'][_0x56e4c7(-0xd6,-0xf5,-0xe4,-0xe1)]==='https',_0x481080=process[_0x144114(0x3b8,0x3c8,0x3de,0x3da)][_0x56e4c7(-0xf1,-0xe0,-0xc1,-0xde)]===_0x144114(0x3d9,0x3d5,0x3b4,0x3e1);if(!_0x27e944||!_0x485eea)return'baZXW'===_0x56e4c7(-0xd6,-0xd7,-0xf6,-0xbd)?_0x59e89f[_0x144114(0x3ba,0x3ab,0x3be,0x399)](-0x23dc*0x1+-0x3d*-0x87+0x541)[_0x144114(0x3b0,0x3d0,0x3b7,0x3ca)]({'success':![],'message':'用户名和密码不能为空'}):_0x4b1da0['status'](0x1cd6*-0x1+-0x17e6+0x364d)[_0x144114(0x3e2,0x3d0,0x3f0,0x3c7)]({'success':![],'message':'当前密码错误'});const _0x2a98e0=await User[_0x56e4c7(-0xef,-0xe8,-0xe4,-0xee)]({'where':{'username':_0x27e944}});if(!_0x2a98e0)return _0x59e89f[_0x56e4c7(-0x106,-0xf0,-0xcf,-0xd4)](-0x5*-0x5c3+-0x16a3+0x3*-0x189)[_0x56e4c7(-0xb0,-0xcb,-0xdc,-0xcb)]({'success':![],'message':'用户名或密码错误'});const _0x432406=await bcrypt[_0x56e4c7(-0xe9,-0xd4,-0xf3,-0xc1)](_0x485eea,_0x2a98e0['password']);if(!_0x432406)return _0x59e89f[_0x56e4c7(-0xf7,-0xf0,-0xda,-0x102)](0x1*-0x19da+-0xdb2+-0x291d*-0x1)[_0x56e4c7(-0xe7,-0xcb,-0xe3,-0xbd)]({'success':![],'message':_0x144114(0x3d5,0x3cc,0x3b5,0x3c4)});const _0x2c5fde=jwt[_0x56e4c7(-0xe1,-0xeb,-0xcf,-0xce)]({'id':_0x2a98e0['id'],'username':_0x2a98e0['username']},config[_0x56e4c7(-0xdd,-0xfd,-0x104,-0x101)][_0x56e4c7(-0xe7,-0xdc,-0xf4,-0xf0)],{'expiresIn':config[_0x144114(0x3a3,0x39e,0x3a6,0x390)][_0x56e4c7(-0xe1,-0x100,-0x122,-0x105)]});_0x59e89f[_0x56e4c7(-0xb2,-0xcb,-0xc0,-0xba)]({'success':!![],'message':_0x144114(0x3c3,0x3d3,0x3cc,0x3b8),'data':{'token':_0x2c5fde,'user':{'id':_0x2a98e0['id'],'username':_0x2a98e0[_0x144114(0x372,0x394,0x39a,0x3a4)],'role':_0x2a98e0[_0x144114(0x3e2,0x3d7,0x3bf,0x3c6)],'status':_0x2a98e0[_0x144114(0x3c4,0x3ab,0x3a5,0x3bb)]}}});}catch(_0x1ea838){_0x4b5f0a(_0x1ea838);}},exports[_0x_0x13ec29(-0x23d,-0x21d,-0x248,-0x23a)]=async(_0x9351bf,_0x4389da,_0x180740)=>{function _0x181724(_0x1a19ce,_0x36d000,_0x16d63e,_0x33d4d1){return _0x_0x13ec29(_0x1a19ce-0x152,_0x36d000-0xe8,_0x1a19ce,_0x33d4d1-0x1b9);}function _0x5be808(_0xb64882,_0x46a3fa,_0x1eaa36,_0x395d00){return _0x_0x4756bf(_0xb64882-0xa4,_0x395d00- -0x29e,_0xb64882,_0x395d00-0x84);}try{if(_0x181724(-0x78,-0x7d,-0x89,-0x86)===_0x181724(-0xbb,-0xa9,-0x93,-0xab))return _0x50d9a2['status'](-0x1197+-0x5c*-0x3c+0x269*-0x1)[_0x181724(-0xa4,-0x86,-0x7d,-0x83)]({'success':![],'message':_0x181724(-0x70,-0xa9,-0xa3,-0x90)});else{const _0x46100f=await User[_0x5be808(0x18c,0x188,0x17e,0x19d)](_0x9351bf[_0x181724(-0x64,-0x89,-0x89,-0x85)]['id'],{'attributes':{'exclude':[_0x5be808(0x178,0x184,0x167,0x188)]}});if(!_0x46100f)return _0x4389da[_0x5be808(0x182,0x19e,0x18b,0x18e)](-0x1446+-0x40*-0x3b+0x71a)[_0x5be808(0x194,0x1c2,0x1a8,0x1b3)]({'success':![],'message':_0x181724(-0xb4,-0x99,-0xb8,-0x9c)});_0x4389da[_0x5be808(0x1c4,0x1b1,0x1cc,0x1b3)]({'success':!![],'data':{'id':_0x46100f['id'],'username':_0x46100f[_0x181724(-0xc9,-0xd7,-0xb9,-0xbf)],'role':_0x46100f[_0x181724(-0x84,-0x7a,-0x77,-0x7c)],'status':_0x46100f['status'],'createdAt':_0x46100f[_0x5be808(0x18a,0x165,0x162,0x179)],'updatedAt':_0x46100f[_0x5be808(0x1b7,0x19c,0x1b6,0x1a0)]}});}}catch(_0x16fa01){_0x180740(_0x16fa01);}},exports[_0x_0x13ec29(-0x26a,-0x26d,-0x251,-0x26f)]=async(_0x5001b8,_0x47c553,_0x4e8579)=>{function _0x4b140d(_0x3c3bb1,_0x571c24,_0x57ef45,_0x43e31b){return _0x_0x4756bf(_0x3c3bb1-0x158,_0x43e31b- -0x2b0,_0x57ef45,_0x43e31b-0x26);}function _0x27f533(_0x397cb6,_0xb94562,_0x163dd7,_0x55621a){return _0x_0x13ec29(_0x397cb6-0x19e,_0xb94562-0xe1,_0xb94562,_0x163dd7-0x633);}try{const {currentPassword:_0x10f860,newPassword:_0x67dd97}=_0x5001b8[_0x4b140d(0x161,0x172,0x182,0x16d)];if(!_0x10f860||!_0x67dd97)return _0x47c553[_0x4b140d(0x16d,0x182,0x194,0x17c)](-0xa*0x16d+0x26ea+0x8*-0x2e3)[_0x27f533(0x3f0,0x3e5,0x3f7,0x3df)]({'success':![],'message':_0x27f533(0x3de,0x3dd,0x3e3,0x3f0)});const _0x302c87=await User[_0x4b140d(0x197,0x174,0x1a9,0x18b)](_0x5001b8[_0x4b140d(0x188,0x185,0x189,0x19f)]['id']);if(!_0x302c87)return _0x47c553[_0x27f533(0x3d3,0x3c3,0x3d2,0x3f1)](-0x556+0x1912+0x245*-0x8)['json']({'success':![],'message':_0x27f533(0x3c8,0x3f3,0x3de,0x3fc)});const _0x2fd73f=await bcrypt[_0x27f533(0x401,0x3de,0x3ee,0x3da)](_0x10f860,_0x302c87[_0x27f533(0x3d6,0x3c3,0x3cc,0x3ac)]);if(!_0x2fd73f)return _0x47c553[_0x4b140d(0x174,0x15d,0x172,0x17c)](-0x1909+-0x4*0x3c3+0x29a6)['json']({'success':![],'message':_0x4b140d(0x17a,0x179,0x187,0x192)});const _0x3d70f3=await bcrypt[_0x27f533(0x3d1,0x3a0,0x3bc,0x3d3)](_0x67dd97,-0xe*0xda+0x1*-0x23de+0x2*0x17ea);await _0x302c87['update']({'password':_0x3d70f3}),_0x47c553['json']({'success':!![],'message':_0x4b140d(0x176,0x181,0x16d,0x171)});}catch(_0x32415e){_0x4e8579(_0x32415e);}},exports[_0x_0x4756bf(0x419,0x42a,0x418,0x416)]=async(_0x298d57,_0x3b9dd8,_0x12ab20)=>{function _0x29e53a(_0x5d04b9,_0x2df00f,_0x191e27,_0x59d74f){return _0x_0x4756bf(_0x5d04b9-0x29,_0x59d74f- -0x27c,_0x2df00f,_0x59d74f-0xbc);}function _0x1ab66a(_0xa9d3ba,_0x1334c2,_0x420459,_0x2baa3a){return _0x_0x4756bf(_0xa9d3ba-0x1c8,_0x420459- -0x374,_0x2baa3a,_0x2baa3a-0xef);}try{const {currentPassword:_0x48d8c2,newUsername:_0x1c4007}=_0x298d57[_0x1ab66a(0x9b,0x9f,0xa9,0xa5)];if(!_0x48d8c2||!_0x1c4007)return _0x3b9dd8[_0x29e53a(0x1c3,0x1b1,0x1b3,0x1b0)](-0x3*-0x829+0x109+0x3fe*-0x6)[_0x29e53a(0x1b8,0x1d3,0x1e9,0x1d5)]({'success':![],'message':_0x29e53a(0x1ca,0x1bc,0x1cd,0x1bd)});const _0x97409c=await User[_0x29e53a(0x1d2,0x1e1,0x1a3,0x1bf)](_0x298d57['user']['id']);if(!_0x97409c){if(_0x29e53a(0x1a1,0x1b7,0x1d2,0x1b4)!==_0x1ab66a(0xc3,0xb4,0xb7,0xb2))return _0x3b9dd8['status'](-0x19*0x53+0x17d*0x9+-0x3b6)[_0x29e53a(0x1eb,0x1c1,0x1d7,0x1d5)]({'success':![],'message':_0x1ab66a(0xbc,0xab,0xc4,0xe5)});else _0x3d3793[_0x1ab66a(0xd1,0xff,0xdd,0xfe)]({'success':!![],'message':_0x29e53a(0x1c3,0x1ca,0x1de,0x1c7)});}const _0xbac697=await bcrypt['compare'](_0x48d8c2,_0x97409c[_0x29e53a(0x1ab,0x1ad,0x1c3,0x1aa)]);if(!_0xbac697){if('cmNgG'==='cmNgG')return _0x3b9dd8[_0x29e53a(0x1a5,0x1be,0x1cc,0x1b0)](0x29f+-0x41c*0x9+0x23ee)[_0x29e53a(0x1ce,0x1d0,0x1f5,0x1d5)]({'success':![],'message':_0x29e53a(0x1ab,0x1d7,0x1d1,0x1c6)});else _0x929bd4(_0xfad09b);}const _0xca56c7=await User['findOne']({'where':{'username':_0x1c4007}});if(_0xca56c7&&_0xca56c7['id']!==_0x97409c['id'])return _0x3b9dd8[_0x29e53a(0x1ce,0x18e,0x1a8,0x1b0)](0x2430+-0x265b+0x3bb)[_0x1ab66a(0xd6,0xfe,0xdd,0xc1)]({'success':![],'message':'用户名已存在'});await _0x97409c[_0x29e53a(0x1cc,0x1cd,0x1b4,0x1ac)]({'username':_0x1c4007}),_0x3b9dd8[_0x29e53a(0x1de,0x1c8,0x1ef,0x1d5)]({'success':!![],'message':'用户名修改成功'});}catch(_0x49f7fa){_0x12ab20(_0x49f7fa);}},exports[_0x_0x4756bf(0x43b,0x423,0x422,0x441)]=async(_0x4500ea,_0x247cb9,_0x3804c0)=>{function _0x303ca0(_0x9813d2,_0x4f61c0,_0x5e27d0,_0x8e6f23){return _0x_0x13ec29(_0x9813d2-0x1bf,_0x4f61c0-0xf7,_0x5e27d0,_0x8e6f23-0x99);}function _0x3513f4(_0x273b87,_0x375ee5,_0x3121ff,_0x2a79d4){return _0x_0x4756bf(_0x273b87-0x66,_0x3121ff- -0x23c,_0x375ee5,_0x2a79d4-0xb0);}try{if(_0x303ca0(-0x1ba,-0x1be,-0x1d8,-0x1ba)!=='eiWuW')_0x247cb9[_0x3513f4(0x201,0x206,0x215,0x20d)]({'success':!![],'message':_0x3513f4(0x1f8,0x211,0x207,0x21b)});else try{_0x53f793['json']({'success':!![],'message':'退出登录成功'});}catch(_0x546fdc){_0x4928ae(_0x546fdc);}}catch(_0x3223c0){_0x3804c0(_0x3223c0);}};