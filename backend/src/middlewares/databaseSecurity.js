function _0x_0x870a(_0x5f0d9c,_0x3763b1){_0x5f0d9c=_0x5f0d9c-(-0xe13+-0x1*0x84f+-0x16c9*-0x1);const _0x37e344=_0x_0x42a5();let _0x39cf8e=_0x37e344[_0x5f0d9c];if(_0x_0x870a['SUbvGM']===undefined){var _0x3a94c1=function(_0x4f2489){const _0x288b5c='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1c7be1='',_0x4c38ad='',_0x3accba=_0x1c7be1+_0x3a94c1;for(let _0x227536=-0x17a*-0x2+0x1*-0x1e17+0x1b23,_0x50d671,_0x1b066e,_0x4144a5=0x1609+-0x418+-0x11f1;_0x1b066e=_0x4f2489['charAt'](_0x4144a5++);~_0x1b066e&&(_0x50d671=_0x227536%(-0x1a44+0x96b*-0x1+0x23b3)?_0x50d671*(0x1671+-0x478+-0x11b9)+_0x1b066e:_0x1b066e,_0x227536++%(-0x1909+0x4cd*0x7+0x2da*-0x3))?_0x1c7be1+=_0x3accba['charCodeAt'](_0x4144a5+(0xc03+0x1*0x236d+-0x2f66))-(-0x20ef+-0x1cc5+0x3dbe)!==0x1c41+0xdf*-0x1f+0x14*-0x10?String['fromCharCode'](0x18d*0x3+-0x168+0xc0*-0x3&_0x50d671>>(-(0x84d+-0x1e1f+0x15d4)*_0x227536&0x1f*-0x9e+0x3*-0xb1c+0x1*0x347c)):_0x227536:-0x3*-0x58f+0x1*-0x1627+0x57a){_0x1b066e=_0x288b5c['indexOf'](_0x1b066e);}for(let _0x5008b9=0x43*-0x59+0x2139+-0x9ee,_0x4b0af5=_0x1c7be1['length'];_0x5008b9<_0x4b0af5;_0x5008b9++){_0x4c38ad+='%'+('00'+_0x1c7be1['charCodeAt'](_0x5008b9)['toString'](0xe89+-0x2377*-0x1+0x1*-0x31f0))['slice'](-(0x1b27+0x1*-0x240a+0x9*0xfd));}return decodeURIComponent(_0x4c38ad);};_0x_0x870a['eoIvTi']=_0x3a94c1,_0x_0x870a['jvCpos']={},_0x_0x870a['SUbvGM']=!![];}const _0x2c4adf=_0x37e344[0x301+0x735+-0x1*0xa36],_0x37249f=_0x5f0d9c+_0x2c4adf,_0x57f870=_0x_0x870a['jvCpos'][_0x37249f];if(!_0x57f870){const _0x1d5048=function(_0x57fc63){this['OmvBwV']=_0x57fc63,this['mPYOpq']=[-0x13bc+0x14*-0x2f+0xd*0x1cd,-0x328*-0x4+-0x1*-0xe67+-0x1b07,-0x1d*0xd+0x1be*0x16+-0x24db],this['iJQKhO']=function(){return'newState';},this['ByFDtG']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['dIWHXZ']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x1d5048['prototype']['WvfqOv']=function(){const _0x386cde=new RegExp(this['ByFDtG']+this['dIWHXZ']),_0x5eb8c8=_0x386cde['test'](this['iJQKhO']['toString']())?--this['mPYOpq'][0x1a58+-0x572+-0x14e5]:--this['mPYOpq'][-0x9b*0x8+-0x1d5e+-0x12e*-0x1d];return this['WpnqIS'](_0x5eb8c8);},_0x1d5048['prototype']['WpnqIS']=function(_0x5ad102){if(!Boolean(~_0x5ad102))return _0x5ad102;return this['vopZCW'](this['OmvBwV']);},_0x1d5048['prototype']['vopZCW']=function(_0x4b91c0){for(let _0x32b9cc=-0x8ea+-0x1*-0x22eb+-0x8ab*0x3,_0x16d587=this['mPYOpq']['length'];_0x32b9cc<_0x16d587;_0x32b9cc++){this['mPYOpq']['push'](Math['round'](Math['random']())),_0x16d587=this['mPYOpq']['length'];}return _0x4b91c0(this['mPYOpq'][0xb29*0x3+-0x3*0x3f6+-0x1599]);},new _0x1d5048(_0x_0x870a)['WvfqOv'](),_0x39cf8e=_0x_0x870a['eoIvTi'](_0x39cf8e),_0x_0x870a['jvCpos'][_0x37249f]=_0x39cf8e;}else _0x39cf8e=_0x57f870;return _0x39cf8e;}(function(_0x1daab5,_0x301e6c){function _0x1ea442(_0x19f46c,_0x5d099d,_0xf81d09,_0x547964){return _0x_0x870a(_0x5d099d-0x2a2,_0x19f46c);}function _0xcade86(_0x4de0ac,_0x233236,_0x3282d9,_0x59964d){return _0x_0x870a(_0x4de0ac- -0x32a,_0x233236);}const _0x1d4052=_0x1daab5();while(!![]){try{const _0x3c3ccb=-parseInt(_0x1ea442(0x332,0x30c,0x2e8,0x306))/(0x234f+0x243d*-0x1+-0xef*-0x1)+-parseInt(_0xcade86(-0x280,-0x292,-0x27f,-0x255))/(-0x186b*0x1+-0x4d9+0x1d46)+parseInt(_0x1ea442(0x34d,0x33b,0x34c,0x362))/(-0x4*0x148+0xb11+-0x16*0x45)*(-parseInt(_0x1ea442(0x31a,0x31a,0x30e,0x2fd))/(-0xcd4*0x1+-0xae0+0x17b8))+-parseInt(_0x1ea442(0x31f,0x339,0x31f,0x315))/(-0x572*0x7+0x3*0x5ab+0x1522)*(-parseInt(_0x1ea442(0x38a,0x36c,0x357,0x352))/(0x1*-0x1c7f+0x1a81+0x204))+-parseInt(_0xcade86(-0x27e,-0x26c,-0x297,-0x290))/(-0x941*0x1+-0x1d1a+0x2662)+-parseInt(_0x1ea442(0x343,0x311,0x2f0,0x333))/(-0x1c7a+-0x4a7*-0x1+0x17db)*(-parseInt(_0x1ea442(0x32a,0x340,0x31a,0x33b))/(-0xc40+0x38+-0x1*-0xc11))+parseInt(_0xcade86(-0x26e,-0x274,-0x24d,-0x260))/(0x6bc+-0x3*-0xc3+0x79*-0x13);if(_0x3c3ccb===_0x301e6c)break;else _0x1d4052['push'](_0x1d4052['shift']());}catch(_0x4a9125){_0x1d4052['push'](_0x1d4052['shift']());}}}(_0x_0x42a5,0x4184b+-0x15d5d*0x3+0x2afb0));const _0x_0x2d0057=(function(){let _0x3add74=!![];return function(_0x437c6c,_0x4bccfb){const _0x5737d6=_0x3add74?function(){function _0x31a0db(_0x9dd8b0,_0x480d55,_0x43936f,_0x1d4383){return _0x_0x870a(_0x480d55-0x1fa,_0x43936f);}function _0x388f20(_0xdebe39,_0x44bd1f,_0x4d3bb8,_0x32d9ff){return _0x_0x870a(_0xdebe39-0x4,_0x44bd1f);}if('GArip'!==_0x388f20(0xb9,0xb4,0xd7,0x9d)){if(_0x4bccfb){if(_0x31a0db(0x294,0x292,0x278,0x2b7)===_0x388f20(0x9c,0x89,0x86,0x7d)){const _0x7b3238=_0x4bccfb[_0x31a0db(0x258,0x284,0x253,0x2aa)](_0x437c6c,arguments);return _0x4bccfb=null,_0x7b3238;}else _0x55eb66[_0x31a0db(0x254,0x26a,0x283,0x28a)][_0x19639f]=-0x2*0x12e2+-0x1ac4+-0x811*-0x8;}}else{console[_0x388f20(0x87,0x71,0x5f,0x69)](_0x388f20(0x86,0x56,0x70,0x89),_0x666feb);if(_0x5949bc[_0x388f20(0x6b,0x94,0x3b,0x7e)]===_0x31a0db(0x23e,0x26f,0x29b,0x264))return _0x35123d[_0x388f20(0x8a,0x9e,0xb7,0x81)](-0xf0e+-0x17d1+0x28d6)['json']({'success':![],'message':'数据库连接异常','error':_0x3e4cbb['message']});_0x1f8889[_0x31a0db(0x298,0x2a0,0x27a,0x2c6)]('DATABASE_CONNECTION_ERROR',_0x388f20(0xad,0xb7,0xbc,0x9b),_0x388f20(0x9a,0xb8,0x89,0x81),_0x133586['ip']||_0x1ed658[_0x31a0db(0x27b,0x299,0x28a,0x297)][_0x31a0db(0x2c5,0x29f,0x2b5,0x27e)],{'error':_0x87dac0[_0x31a0db(0x26c,0x277,0x266,0x260)],'userAgent':_0x4cfac7['get'](_0x388f20(0xa8,0xce,0xaf,0xae))}),_0x437226();}}:function(){};return _0x3add74=![],_0x5737d6;};}()),_0x_0x5b7bbd=_0x_0x2d0057(this,function(){function _0x770135(_0x521623,_0x530863,_0x46b643,_0x122baa){return _0x_0x870a(_0x530863- -0x41,_0x521623);}function _0x33b35f(_0x46047f,_0x1adc51,_0x17dcb3,_0x4888e8){return _0x_0x870a(_0x4888e8-0x104,_0x46047f);}return _0x_0x5b7bbd['toString']()['search']('(((.+)+)+)+$')[_0x33b35f(0x19e,0x1b4,0x193,0x1bd)]()[_0x770135(0x42,0x62,0x58,0x35)](_0x_0x5b7bbd)[_0x770135(0x2c,0x48,0x45,0x16)](_0x33b35f(0x18e,0x164,0x1a6,0x189));});function _0x_0xdb205c(_0x3cf868,_0x447b2a,_0x2b810f,_0x2ffc3d){return _0x_0x870a(_0x2ffc3d-0x103,_0x447b2a);}_0x_0x5b7bbd();const databaseEncryption=require('../utils/databaseEncryption'),databaseAudit=require('../utils/databaseAudit');function _0x_0x42a5(){const _0x56260a=['y29UC3rYDwn0B3i','vxnLCI1bz2vUDa','CMvTB3rLqwrKCMvZCW','Bg9Nt3bLCMf0Aw9U','l2fWAs9Hzg1PBI9NywXSzxjPzxm','l2fWAs9Hzg1PBI9KyxrHyMfZzs9IywnRDxa','C3LZDgvT','mtG2mJq0C1zOAxzV','zgf0ywjHC2vpCgvYyxrPB25dB3vUDhm','mtGYndC5nwfLyuHlvG','ue9tva','zKLoEKq','l2fWAs9UB3rLCW','C29Tzq','CM9Szq','5PwW5O2U5BQt6l+E5O6L5BYc5BI4','CKfmA2C','BgfZDfjLC2v0','yxfzr2m','yxv0AgvUDgLJyxrL','z2v0','l2fWAs9HDxrOl3jLz2LZDgvY','Dg9tDhjPBMC','y2fSBa','wwPMAhm','ote2odqYmePjyu9JvG','l2fWAs9Hzg1PBI9KyxrHyMfZzs9IywnRDxbZ','uKfurv9msu1jvf9fwenfrurfra','tK9erv9ftLy','57Y65Bcr5Ash5lU95PAh5lU25y+c5PwW','6zYa6kAb566H55cg5zgy5P2d6zMq','DxnLCG','C3rHCNrZv2L0Aa','BM93','l2fWAs9HDxrOl3bHC3n3B3jK','refuqujbu0vFq09otKvdveLptL9fuLjpuG','AgfZAfbHC3n3B3jK','Bg9Nrgf0yu1VzgLMAwnHDgLVBG','l2fWAs9Hzg1PBI9KyxrHyMfZzs9HDwrPDc1SB2DZ','mZu1nZrUAxL2uMy','Cgf0Aa','CxvLCNK','CMf0zuXPBwL0rgf0ywjHC2vpCgvYyxrPB25Z','mteZmdm2y3jnugPY','ChDcqKe','y2f0y2G','Bwv0Ag9K','zgf0ywjHC2vizwfSDgHdAgvJAW','oejoCLH3ra','B3bLCMf0Aw9UCW','l2fWAs9Hzg1PBI9KyxrHyMfZzs9Yzxn0B3jL','5Ash5lU95yIB5BU65OIq5yQF','zw52','zgvJCNLWDfnLBNnPDgL2zurHDge','l2HLywX0Ac9KyxrHyMfZzq','BgvUz3rO','B3jPz2LUywXcB2r5','mJC2swPfDvfP','zgf0ywjHC2vcywnRDxa','ANnVBG','l2fWAs9Hzg1PBI9Zzxr0Aw5NCY9ZmY90zxn0','Cg9W','BwvZC2fNzq','ANP2u3i','ufvu','5PwW5O2U5BQt6l+E5O6L5Q2J5BI4','zgvJCNLWDfnLBNnPDgL2zuzPzwXKCW','5PwW5O2U5BQt6l+E5O6L5Qoa5P+L5AsX6lsLoG','zxjYB3i','C3rHDhvZq29Kzq','kcGOlISPkYKRksSK','C3rHDhvZ','AeTSu0C','DgHLBG','C2vHCMnO','yxbWBhK','z2v0qxvKAxrmB2DZ','r0vu','C2vUza','ywrTAw4','wfn4whu','CgfZC3DVCMq','B2jQzwn0','AgfZAfbHC3n3B3jKCW','y291BNq','Dg9ju09tDhjPBMC','yxvKAxreyxrHyMfZzvf1zxjPzxm','yw5VBNLTB3vZ','mJvuwvH5wg4','DfbprNq','mtqZndn6t1zQy2O','yM9KEq','uvjPyvO','l2fWAs9NywXSzxjPzxm','D1vpBNK','mJm3mta1uLr4Dhnu','y29UBMvJDgLVBG','vgTnBMu','BgLZDejHy2T1Chm','5Pon5l2C6Akr546h6l+h6AUy77Ym6k+356In5zco5yAn6k+v'];_0x_0x42a5=function(){return _0x56260a;};return _0x_0x42a5();}exports[_0x_0x3c3966(0x52,0x74,0x97,0x5a)]=(_0x4dd91d,_0x4f6044,_0x548aa4)=>{const _0x2af184=_0x4f6044[_0x481f0b(0x36a,0x3a8,0x383,0x3a3)];function _0x518894(_0x1430ac,_0x30cd75,_0x2287ef,_0x48fddd){return _0x_0x3c3966(_0x1430ac-0x6c,_0x30cd75- -0x321,_0x2287ef-0x3b,_0x2287ef);}const _0x246a50=Date[_0x518894(-0x259,-0x27e,-0x256,-0x265)]();_0x4f6044[_0x518894(-0x293,-0x2b5,-0x2a2,-0x2d8)]=function(_0x2d3747){function _0x1d353c(_0x2fed6a,_0xb5268a,_0x242e18,_0x2c846c){return _0x518894(_0x2fed6a-0x92,_0x242e18-0x3fd,_0x2c846c,_0x2c846c-0x5d);}const _0x120806=Date[_0x2b9052(0xcd,0xa4,0xa7,0xce)](),_0x589638=_0x120806-_0x246a50;if(_0x4dd91d[_0x2b9052(0x9f,0x96,0x8e,0x77)]!==_0x2b9052(0x95,0x87,0x90,0x96)){if('tBhze'!==_0x1d353c(0x111,0x162,0x139,0x167)){const _0x1ca425=_0x4dd91d[_0x2b9052(0xdf,0xc7,0xeb,0xcc)]?.['id']||_0x1d353c(0x132,0x147,0x151,0x15d),_0x2d83c5=_0x4dd91d['ip']||_0x4dd91d[_0x1d353c(0x136,0x14a,0x15a,0x13c)][_0x2b9052(0xd6,0xda,0xc6,0xaf)];databaseAudit[_0x2b9052(0xed,0xa1,0xa5,0xd2)](_0x4dd91d['method'],_0x4dd91d[_0x1d353c(0x106,0x114,0x122,0x113)]['split']('/')[_0x2b9052(0x8f,0xa4,0x6b,0x86)]()||'unknown',_0x1ca425,_0x2d83c5,_0x4dd91d['params']['id'],{'duration':_0x589638,'userAgent':_0x4dd91d[_0x1d353c(0x1a3,0x15a,0x172,0x16b)](_0x1d353c(0x181,0x14f,0x15f,0x186)),'statusCode':_0x4f6044[_0x1d353c(0x11f,0x16d,0x13f,0x163)]});}else _0x101d82[_0x2b9052(0x5b,0x7c,0x81,0x84)]({'success':!![],'message':_0x2b9052(0x75,0x7c,0x94,0x7c),'backup':_0x4c414f});}function _0x2b9052(_0x4dcb49,_0x10824c,_0xc17f57,_0x4c40ee){return _0x481f0b(_0x4dcb49-0x179,_0xc17f57,_0x4c40ee- -0x2ec,_0x4c40ee-0xc1);}_0x2af184[_0x1d353c(0x1a2,0x15b,0x175,0x158)](this,_0x2d3747);};function _0x481f0b(_0x4617da,_0x1f094d,_0x6c7ee3,_0x241101){return _0x_0x3c3966(_0x4617da-0x7,_0x6c7ee3-0x317,_0x6c7ee3-0x11f,_0x1f094d);}_0x548aa4();},exports['encryptSensitiveData']=(_0x4510bf,_0x85c2ea,_0x46f410)=>{const _0x322c53=['/api/auth/login',_0x3a8c82(0x344,0x350,0x338,0x368),_0x4f7e95(0x2c2,0x2d7,0x2ca,0x2d4),'/api/auth/username'],_0x49728c=[_0x4f7e95(0x2ac,0x2d2,0x2bd,0x2d4),'/api/admin/notes'];function _0x3a8c82(_0x2884e5,_0x168a53,_0x5658c3,_0x470075){return _0x_0x3c3966(_0x2884e5-0x9b,_0x2884e5-0x2ad,_0x5658c3-0xfa,_0x168a53);}const _0x38f66=[_0x4f7e95(0x299,0x2a8,0x2c9,0x2b9),_0x4f7e95(0x2a4,0x28a,0x2d1,0x2cc)];function _0x4f7e95(_0x45a192,_0x2d2c10,_0x16c711,_0x7ea30e){return _0x_0x3c3966(_0x45a192-0xc4,_0x45a192-0x21e,_0x16c711-0x15f,_0x16c711);}const _0xb63406=['/api/admin/settings/s3/config',_0x4f7e95(0x278,0x265,0x2a4,0x25d)];if(_0x322c53['some'](_0x531434=>_0x4510bf['path']===_0x531434)&&(_0x4510bf[_0x3a8c82(0x2f9,0x2fd,0x2fa,0x2fd)]===_0x3a8c82(0x339,0x360,0x355,0x34e)||_0x4510bf[_0x4f7e95(0x26a,0x28a,0x24e,0x26b)]===_0x3a8c82(0x30b,0x33b,0x303,0x31b))){if(_0x4f7e95(0x2b8,0x2aa,0x2bb,0x2d1)!=='uGaaK')return _0x46f410();else{if(_0x375065[_0x4f7e95(0x264,0x259,0x267,0x244)]===_0x4f7e95(0x272,0x290,0x247,0x2a0))return _0x33108e[_0x4f7e95(0x277,0x260,0x29c,0x275)]({'success':!![],'message':_0x4f7e95(0x27d,0x251,0x297,0x253),'timestamp':new _0x4b02e0()[_0x3a8c82(0x320,0x349,0x326,0x2ee)]()});_0xf19ba();}}if(_0xb63406[_0x3a8c82(0x33c,0x36a,0x31a,0x35c)](_0x15e978=>_0x4510bf[_0x3a8c82(0x2f3,0x2f2,0x325,0x311)]===_0x15e978)&&_0x4510bf[_0x3a8c82(0x2f9,0x328,0x2dc,0x2de)]===_0x4f7e95(0x2aa,0x2c1,0x2d5,0x286))return _0x46f410();if(_0x49728c['some'](_0x2546e9=>_0x4510bf['path'][_0x3a8c82(0x34f,0x32d,0x37d,0x324)](_0x2546e9))&&(_0x4510bf[_0x4f7e95(0x26a,0x255,0x252,0x270)]==='POST'||_0x4510bf['method']===_0x3a8c82(0x30b,0x302,0x2e6,0x315)))return _0x46f410();if(_0x38f66[_0x3a8c82(0x33c,0x30b,0x332,0x328)](_0x1b9bf5=>_0x4510bf[_0x4f7e95(0x264,0x275,0x283,0x284)][_0x4f7e95(0x2c0,0x2be,0x2ad,0x28f)](_0x1b9bf5))&&(_0x4510bf[_0x3a8c82(0x2f9,0x317,0x30a,0x2e6)]==='POST'||_0x4510bf[_0x4f7e95(0x26a,0x27b,0x24d,0x23f)]===_0x3a8c82(0x30b,0x2e8,0x2f4,0x2e8))){if(_0x3a8c82(0x33a,0x310,0x32b,0x366)!==_0x4f7e95(0x2ab,0x2c0,0x2a5,0x2b0))_0xd35d1c[_0x4f7e95(0x297,0x26b,0x298,0x272)][_0x4f7e95(0x28d,0x298,0x2b3,0x287)]=_0x568cbf[_0x4f7e95(0x2c4,0x2d2,0x2ca,0x2f6)](_0x271cf5[_0x3a8c82(0x326,0x309,0x30a,0x31b)]['password']);else return _0x46f410();}_0x4510bf[_0x3a8c82(0x326,0x341,0x324,0x354)]&&Object['keys'](_0x4510bf[_0x4f7e95(0x297,0x272,0x28f,0x27f)])[_0x3a8c82(0x302,0x2db,0x308,0x32a)]>-0x1aa0+-0x59*-0x13+0x19*0xcd&&(_0x4510bf[_0x3a8c82(0x303,0x2d1,0x2f8,0x320)]={..._0x4510bf[_0x3a8c82(0x326,0x30d,0x311,0x30d)]},_0x4510bf[_0x3a8c82(0x326,0x307,0x345,0x33e)]=databaseEncryption['encryptSensitiveFields'](_0x4510bf[_0x4f7e95(0x297,0x2c5,0x2c0,0x2a9)])),_0x46f410();},exports[_0x_0xdb205c(0x18b,0x185,0x153,0x177)]=(_0x12e273,_0x4d9f13,_0x402bdf)=>{function _0x1764b5(_0x501ca8,_0x349c92,_0x54828e,_0x6366fe){return _0x_0xdb205c(_0x501ca8-0xd6,_0x349c92,_0x54828e-0x96,_0x6366fe- -0x1f7);}function _0x4424ee(_0x434bd4,_0x5a0e34,_0x378d30,_0x152666){return _0x_0xdb205c(_0x434bd4-0x16b,_0x152666,_0x378d30-0x156,_0x378d30-0x50);}const _0x486727=_0x4d9f13[_0x1764b5(-0x97,-0xa1,-0x76,-0x7a)];_0x4d9f13[_0x4424ee(0x1e0,0x1fc,0x1cd,0x1db)]=function(_0x125849){function _0x5b68bc(_0x25158d,_0x32e711,_0x4adb66,_0x135bf3){return _0x4424ee(_0x25158d-0xf4,_0x32e711-0x1d5,_0x4adb66- -0x37e,_0x32e711);}function _0x3dac93(_0x3fa972,_0x5d4ccf,_0xff8ceb,_0x42cc67){return _0x4424ee(_0x3fa972-0x100,_0x5d4ccf-0x36,_0x5d4ccf- -0x2f5,_0x3fa972);}_0x125849&&typeof _0x125849===_0x5b68bc(-0x192,-0x171,-0x19a,-0x1bf)&&(_0x125849=databaseEncryption[_0x3dac93(-0x14e,-0x121,-0x121,-0x114)](_0x125849)),_0x486727[_0x3dac93(-0xd7,-0xe8,-0x111,-0xb7)](this,_0x125849);},_0x402bdf();};function _0x_0x3c3966(_0x5d251c,_0x4d20af,_0x1824d0,_0x446545){return _0x_0x870a(_0x4d20af- -0x21,_0x446545);}exports[_0x_0xdb205c(0x1b2,0x180,0x181,0x195)]=(_0x4d4fc2,_0x3d7aae,_0x5a9120)=>{function _0x2b94ae(_0x3410a2,_0x2963d0,_0x8daff7,_0x238700){return _0x_0xdb205c(_0x3410a2-0x160,_0x2963d0,_0x8daff7-0x111,_0x3410a2-0x206);}_0x4d4fc2[_0x42f91c(0x3b2,0x3b0,0x3c0,0x3ab)]&&_0x4d4fc2['body'][_0x42f91c(0x374,0x3a4,0x378,0x3a1)]&&(_0x4d4fc2['body'][_0x2b94ae(0x399,0x3a0,0x37b,0x37b)]=databaseEncryption['hashPassword'](_0x4d4fc2[_0x2b94ae(0x3a3,0x39b,0x3c9,0x39d)][_0x2b94ae(0x399,0x375,0x3c5,0x367)]));function _0x42f91c(_0x1bd2af,_0x347ab4,_0x2dfd1d,_0x4874f9){return _0x_0xdb205c(_0x1bd2af-0xcc,_0x347ab4,_0x2dfd1d-0x44,_0x4874f9-0x20e);}_0x5a9120();},exports[_0x_0x3c3966(0x29,0x48,0x54,0x32)]=(_0x4ec9c6,_0x9e04e4,_0x133dd2)=>{function _0x535e1f(_0x5aa905,_0x3ee2c2,_0x13357d,_0x106b17){return _0x_0xdb205c(_0x5aa905-0x17c,_0x106b17,_0x13357d-0x15e,_0x3ee2c2-0x2a0);}const _0x5400b8=_0x4ec9c6['ip']||_0x4ec9c6['connection'][_0x49de08(0x28e,0x28b,0x267,0x2a6)],_0x229e46=_0x4ec9c6['method'],_0x486190=Date[_0x49de08(0x29b,0x2aa,0x2d3,0x286)]();!global[_0x49de08(0x267,0x291,0x280,0x2a7)]&&(global[_0x535e1f(0x436,0x44e,0x456,0x469)]={});!global[_0x49de08(0x2c3,0x291,0x2b3,0x2b9)][_0x5400b8]&&(global[_0x535e1f(0x447,0x44e,0x474,0x45b)][_0x5400b8]={'count':0x0,'lastReset':_0x486190,'operations':{}});const _0x558219=global[_0x49de08(0x284,0x291,0x298,0x25f)][_0x5400b8];_0x486190-_0x558219[_0x49de08(0x29d,0x29a,0x2c5,0x2c4)]>-0x1*-0x12787+-0x781*0x29+0x8b*0x1c6&&(_0x558219[_0x49de08(0x26b,0x279,0x2ab,0x28f)]=0x1*-0x2231+0x1bdd+0x654,_0x558219[_0x49de08(0x265,0x256,0x22f,0x226)]={},_0x558219['lastReset']=_0x486190);const _0x5ddb79=process[_0x49de08(0x26b,0x259,0x267,0x270)][_0x49de08(0x29b,0x2a5,0x2cc,0x2c1)]==='production'?0x1*0xc61+0xe*0x28+-0xe2d:0x2b7*-0x3+-0x1da*0x7+0x13*0x151;if(_0x558219[_0x49de08(0x268,0x279,0x274,0x27c)]>=_0x5ddb79)return _0x535e1f(0x439,0x440,0x472,0x46f)!==_0x535e1f(0x42b,0x42a,0x44d,0x3fd)?(databaseAudit[_0x535e1f(0x46e,0x449,0x443,0x462)](_0x535e1f(0x45c,0x461,0x45a,0x432),_0x535e1f(0x449,0x44c,0x41d,0x45a),_0x49de08(0x278,0x27c,0x2a2,0x29f),_0x5400b8,{'operationCount':_0x558219['count'],'limit':_0x5ddb79,'userAgent':_0x4ec9c6[_0x535e1f(0x461,0x45a,0x471,0x449)](_0x49de08(0x27a,0x28a,0x29b,0x2b8))}),_0x9e04e4[_0x535e1f(0x42d,0x429,0x437,0x42f)](0x1045+0x89c+-0x1734)[_0x535e1f(0x3fd,0x41d,0x431,0x3f7)]({'success':![],'message':_0x535e1f(0x427,0x445,0x446,0x422)})):_0x355e08[_0x49de08(0x27d,0x29f,0x28f,0x2c0)]()[_0x49de08(0x287,0x26f,0x292,0x277)](_0x535e1f(0x413,0x428,0x459,0x454))[_0x49de08(0x2a7,0x29f,0x298,0x270)]()[_0x535e1f(0x43a,0x446,0x43c,0x429)](_0x2df8b0)['search']('(((.+)+)+)+$');_0x558219[_0x535e1f(0x464,0x436,0x43f,0x444)]++;!_0x558219[_0x49de08(0x262,0x256,0x27e,0x235)][_0x229e46]&&(_0x558219[_0x49de08(0x246,0x256,0x236,0x252)][_0x229e46]=-0x8d+-0x765*-0x4+-0x1d07);_0x558219[_0x49de08(0x224,0x256,0x22b,0x26a)][_0x229e46]++;function _0x49de08(_0x3e2600,_0xde666d,_0x498f18,_0x507341){return _0x_0x3c3966(_0x3e2600-0x15a,_0xde666d-0x207,_0x498f18-0xf0,_0x507341);}_0x133dd2();},exports[_0x_0x3c3966(0x31,0x4d,0x45,0x43)]=(_0x56b38d,_0x3a123a,_0x17ae91)=>{function _0x1afcec(_0x2e2c1b,_0x1e285e,_0x1604ae,_0x1cd426){return _0x_0x3c3966(_0x2e2c1b-0xd8,_0x1e285e- -0x267,_0x1604ae-0x1e5,_0x1604ae);}const {sequelize:_0x9ef29}=require('../config/database');function _0x118423(_0x4bc1c6,_0x5606de,_0x4312bb,_0x3941a7){return _0x_0xdb205c(_0x4bc1c6-0x12b,_0x4bc1c6,_0x4312bb-0x95,_0x5606de-0x156);}_0x9ef29[_0x118423(0x2f6,0x30f,0x308,0x2f6)]()[_0x118423(0x2f1,0x2e1,0x2ca,0x2ea)](()=>{function _0x5e247(_0x2a71d3,_0x3c0d9f,_0xca4217,_0x1db151){return _0x118423(_0x2a71d3,_0x3c0d9f- -0x2d2,_0xca4217-0x1c7,_0x1db151-0x1c9);}function _0x540882(_0x1a8892,_0x23182c,_0x4e887b,_0x219f35){return _0x118423(_0x1a8892,_0x4e887b- -0x3db,_0x4e887b-0x175,_0x219f35-0x9f);}if(_0x56b38d['path']===_0x540882(-0x100,-0xf7,-0x10d,-0x118))return _0x540882(-0xd2,-0x118,-0xf3,-0xec)!==_0x540882(-0xe0,-0xd1,-0xe7,-0xbc)?_0x3a123a[_0x5e247(0x31,0x1,0x18,-0x1a)]({'success':!![],'message':_0x540882(-0x114,-0x105,-0x102,-0xf7),'timestamp':new Date()[_0x540882(-0xc2,-0x111,-0xee,-0x119)]()}):_0x3aaaab();_0x17ae91();})[_0x118423(0x2f3,0x2c5,0x2b3,0x2e5)](_0x2ba9de=>{function _0x411c2f(_0x138477,_0x2113dd,_0x5611b9,_0x129e8f){return _0x118423(_0x138477,_0x5611b9- -0x1d3,_0x5611b9-0xb1,_0x129e8f-0xf2);}console[_0x411c2f(0xe6,0x103,0x109,0x12e)](_0x46331f(-0xbe,-0xf6,-0xe6,-0xc6),_0x2ba9de);if(_0x56b38d[_0x46331f(-0xd1,-0xf9,-0xd1,-0xe1)]===_0x46331f(-0xd1,-0xa3,-0xc8,-0xd3))return _0x3a123a[_0x411c2f(0xdc,0x111,0x10c,0xdb)](0x1*0x200b+0x2131+-0x1517*0x3)[_0x411c2f(0x127,0xd2,0x100,0x12c)]({'success':![],'message':_0x411c2f(0x108,0x13e,0x138,0x109),'error':_0x2ba9de[_0x46331f(-0xe0,-0xa2,-0xbb,-0xcb)]});databaseAudit['logOperation'](_0x411c2f(0x178,0x149,0x14c,0x15a),_0x411c2f(0x14f,0x15e,0x12f,0x159),_0x46331f(-0x94,-0xda,-0xd2,-0xb2),_0x56b38d['ip']||_0x56b38d[_0x46331f(-0xa2,-0xc5,-0x9c,-0xa9)]['remoteAddress'],{'error':_0x2ba9de[_0x46331f(-0xa9,-0xf6,-0xe6,-0xcb)],'userAgent':_0x56b38d[_0x411c2f(0x161,0x169,0x13d,0x125)](_0x411c2f(0x14b,0x11a,0x12a,0x117))});function _0x46331f(_0x2e9a57,_0x12500c,_0x36aa39,_0x226975){return _0x118423(_0x36aa39,_0x226975- -0x3a1,_0x36aa39-0x1b4,_0x226975-0x11c);}_0x17ae91();});},exports[_0x_0xdb205c(0x196,0x168,0x18e,0x17c)]=(_0x1892b8,_0x31866a,_0x46174e)=>{function _0x28e7a9(_0x5091ab,_0x53b115,_0x20e959,_0x20960b){return _0x_0xdb205c(_0x5091ab-0x12,_0x53b115,_0x20e959-0x8b,_0x20e959-0x1de);}const _0x5e7ea7=require('../utils/databaseBackup');function _0x53b52e(_0xed92d6,_0x43ca21,_0x4ce68e,_0x352524){return _0x_0x3c3966(_0xed92d6-0x1ce,_0x4ce68e-0x65,_0x4ce68e-0x113,_0x352524);}if(_0x1892b8[_0x53b52e(0xad,0x99,0xab,0xb2)]===_0x28e7a9(0x35e,0x3b1,0x389,0x3b5)&&_0x1892b8['method']===_0x28e7a9(0x3af,0x3b1,0x38e,0x367)){if(!_0x1892b8[_0x53b52e(0x101,0xf7,0x106,0xd6)]||_0x1892b8[_0x28e7a9(0x372,0x39b,0x3a3,0x3a9)][_0x28e7a9(0x387,0x3b7,0x392,0x37c)]!==_0x53b52e(0xd4,0xf4,0xd2,0xf5))return _0x31866a[_0x53b52e(0xe1,0xd2,0xca,0xe7)](-0x359*0x5+-0x1988+0x2bd8)[_0x53b52e(0xc1,0xd0,0xbe,0xda)]({'success':![],'message':_0x28e7a9(0x389,0x3a5,0x3a2,0x387)});_0x5e7ea7['createBackup'](_0x1892b8[_0x53b52e(0xe2,0xfb,0xde,0xe9)])[_0x28e7a9(0x39b,0x366,0x369,0x33c)](_0x119e26=>{function _0x576bac(_0x247a91,_0x2cb781,_0x342d4e,_0x368596){return _0x28e7a9(_0x247a91-0x17a,_0x247a91,_0x368596- -0x33e,_0x368596-0x6f);}function _0x15e5ea(_0x50719b,_0x3b4703,_0xf107f,_0x17ce91){return _0x28e7a9(_0x50719b-0xbc,_0x3b4703,_0x50719b- -0x70,_0x17ce91-0x9e);}_0x31866a[_0x576bac(0x44,0x4a,-0x11,0x1d)]({'success':!![],'message':_0x576bac(0x3f,0x26,0x6,0x15),'backup':_0x119e26});})[_0x28e7a9(0x35e,0x335,0x34d,0x336)](_0x2e1d31=>{function _0x4ea757(_0x3d9174,_0x5a4368,_0x57cd96,_0x88b1f9){return _0x28e7a9(_0x3d9174-0x75,_0x5a4368,_0x57cd96- -0x9f,_0x88b1f9-0x2d);}function _0x2cf76b(_0x12373c,_0x21d09b,_0x46910f,_0x212954){return _0x28e7a9(_0x12373c-0x89,_0x46910f,_0x12373c- -0x463,_0x212954-0x99);}_0x31866a[_0x4ea757(0x2a1,0x299,0x2c8,0x2e4)](0x216d+0x1e8c+-0x3e05)[_0x4ea757(0x2cd,0x2ee,0x2bc,0x2b4)]({'success':![],'message':'备份创建失败','error':_0x2e1d31[_0x2cf76b(-0x105,-0x115,-0x12a,-0x117)]});});return;}if(_0x1892b8[_0x28e7a9(0x35b,0x31c,0x348,0x346)]===_0x53b52e(0xaa,0xb3,0xb5,0xdb)&&_0x1892b8[_0x53b52e(0xa1,0x87,0xb1,0xce)]===_0x28e7a9(0x3b8,0x3a4,0x38e,0x37d)){if(!_0x1892b8['user']||_0x1892b8['user'][_0x53b52e(0xed,0x106,0xf5,0x118)]!=='admin')return _0x53b52e(0xf3,0xde,0xf7,0xf7)===_0x53b52e(0xfc,0x11f,0xf7,0x111)?_0x31866a['status'](-0xc3c+-0x545+0x1314)[_0x53b52e(0x9b,0xee,0xbe,0xc4)]({'success':![],'message':'需要管理员权限'}):(_0x3c7444['logOperation'](_0x28e7a9(0x39e,0x3b9,0x39f,0x38f),_0x53b52e(0xd9,0x11d,0xed,0xc6),_0x53b52e(0xff,0xb0,0xda,0xe5),_0x12edcf,{'operationCount':_0x3bd5eb[_0x28e7a9(0x37c,0x370,0x374,0x37d)],'limit':_0x26cfe5,'userAgent':_0xdf055[_0x28e7a9(0x370,0x382,0x398,0x36b)](_0x28e7a9(0x369,0x395,0x385,0x388))}),_0x1c8ba7['status'](-0x225e+-0x742+0x2b4d)[_0x28e7a9(0x372,0x38c,0x35b,0x376)]({'success':![],'message':_0x28e7a9(0x3a3,0x36a,0x383,0x35e)}));const {backupFile:backupFile}=_0x1892b8[_0x28e7a9(0x35d,0x384,0x37b,0x3a8)];if(!backupFile)return _0x31866a[_0x28e7a9(0x372,0x359,0x367,0x363)](0x1*-0x2bd+0xc63+-0x816)[_0x53b52e(0xdc,0xe3,0xbe,0x8d)]({'success':![],'message':_0x53b52e(0x135,0xf9,0x104,0x106)});_0x5e7ea7['restoreBackup'](backupFile,_0x1892b8[_0x28e7a9(0x388,0x393,0x37b,0x381)])['then'](_0x4b3820=>{function _0x2208b2(_0x484dbe,_0x1ac76a,_0x16a75c,_0x99e19){return _0x28e7a9(_0x484dbe-0x3e,_0x484dbe,_0x99e19-0x55,_0x99e19-0xe4);}function _0x37ed43(_0x21ae44,_0x47d037,_0x39e968,_0x2ac4ea){return _0x28e7a9(_0x21ae44-0x1b5,_0x39e968,_0x2ac4ea- -0x6c7,_0x2ac4ea-0xed);}if('TkMne'===_0x37ed43(-0x335,-0x378,-0x344,-0x346))_0x31866a[_0x37ed43(-0x33e,-0x33b,-0x375,-0x36c)]({'success':!![],'message':'数据库恢复成功'});else return _0x5ad102();})[_0x53b52e(0xdb,0xb7,0xb0,0xad)](_0xdd56a9=>{function _0x3bd52c(_0x462eb4,_0x107ba2,_0x77bbc6,_0x57b150){return _0x53b52e(_0x462eb4-0x1cb,_0x107ba2-0x1ec,_0x462eb4-0x2e,_0x57b150);}function _0x305268(_0x28de76,_0x46f59a,_0x47505d,_0x193d79){return _0x53b52e(_0x28de76-0x1ea,_0x46f59a-0xd6,_0x28de76- -0x8d,_0x193d79);}_0x31866a[_0x305268(0x3d,0x64,0x21,0x45)](0x137*0xb+0x141f+0xfc4*-0x2)['json']({'success':![],'message':'数据库恢复失败','error':_0xdd56a9[_0x305268(0x34,0x4e,0x1c,0x61)]});});return;}if(_0x1892b8[_0x28e7a9(0x36e,0x34f,0x348,0x32a)]===_0x53b52e(0x10e,0x122,0x101,0x114)&&_0x1892b8[_0x28e7a9(0x32f,0x375,0x34e,0x355)]==='GET'){if('nxKkw'!==_0x28e7a9(0x371,0x37c,0x34c,0x32c)){if(!_0x1892b8[_0x53b52e(0xd5,0xf6,0x106,0x10b)]||_0x1892b8[_0x28e7a9(0x374,0x3c9,0x3a3,0x3d4)][_0x53b52e(0x118,0x100,0xf5,0xf5)]!==_0x28e7a9(0x37b,0x386,0x36f,0x357))return _0x31866a[_0x28e7a9(0x393,0x395,0x367,0x394)](-0x2364+-0xa2c+0x2f23)[_0x53b52e(0xbe,0xed,0xbe,0xce)]({'success':![],'message':_0x28e7a9(0x378,0x395,0x3a2,0x38e)});const _0x2918aa=_0x5e7ea7[_0x28e7a9(0x354,0x380,0x382,0x39f)]();_0x31866a[_0x28e7a9(0x378,0x33c,0x35b,0x32c)]({'success':!![],'backups':_0x2918aa});return;}else{if(!_0x17f86e[_0x53b52e(0x122,0xd6,0x106,0x105)]||_0x5768c4[_0x53b52e(0x12b,0x132,0x106,0x12f)]['role']!==_0x28e7a9(0x349,0x396,0x36f,0x36f))return _0x433615['status'](-0xdc*0x11+0x1a4d*-0x1+0x2a7c)['json']({'success':![],'message':_0x28e7a9(0x3c1,0x377,0x3a2,0x3d1)});_0x5354ff['createBackup'](_0x179226[_0x28e7a9(0x355,0x372,0x37b,0x3a0)])[_0x53b52e(0xb5,0xa7,0xcc,0xb9)](_0x30b03e=>{function _0x3b4b98(_0x36f865,_0x4a881b,_0x4940a5,_0x2536d7){return _0x28e7a9(_0x36f865-0xd6,_0x2536d7,_0x4940a5- -0x523,_0x2536d7-0x1e6);}function _0x1700bd(_0x3030c6,_0x3ddc06,_0x51a691,_0x3b858f){return _0x53b52e(_0x3030c6-0x1e0,_0x3ddc06-0x111,_0x51a691- -0x19,_0x3030c6);}_0x53acce[_0x1700bd(0xba,0xc5,0xa5,0x9f)]({'success':!![],'message':_0x1700bd(0xa6,0xb1,0x9d,0x6f),'backup':_0x30b03e});})['catch'](_0x24c77f=>{function _0x1978c1(_0x508b92,_0x82ee0e,_0x43d041,_0x33496e){return _0x53b52e(_0x508b92-0x17e,_0x82ee0e-0x197,_0x82ee0e- -0x25,_0x508b92);}function _0x2e97a9(_0x3ed7e0,_0x5c76f2,_0x485335,_0x264b5e){return _0x28e7a9(_0x3ed7e0-0x1dd,_0x264b5e,_0x3ed7e0-0x2,_0x264b5e-0x70);}_0x25540a[_0x1978c1(0x7a,0xa5,0xc2,0x7b)](0x1*-0x1aad+0x8*0x3d5+-0x207)[_0x1978c1(0x95,0x99,0x92,0x96)]({'success':![],'message':'备份创建失败','error':_0x24c77f['message']});});return;}}_0x46174e();},exports['getAuditLogs']=(_0x482858,_0xfdbb14,_0x420113)=>{function _0x3ba77b(_0x4abc9c,_0x3db025,_0xf19972,_0x1839d5){return _0x_0x3c3966(_0x4abc9c-0x82,_0xf19972- -0x29,_0xf19972-0x119,_0x4abc9c);}function _0x4ffffe(_0x5a0460,_0x1c9224,_0x1eb7d7,_0x1172bf){return _0x_0x3c3966(_0x5a0460-0x1d4,_0x5a0460- -0x2d6,_0x1eb7d7-0xff,_0x1c9224);}if(_0x482858[_0x4ffffe(-0x290,-0x2af,-0x265,-0x27c)]===_0x3ba77b(0x71,0x99,0x7f,0x55)&&_0x482858[_0x3ba77b(0x55,0x51,0x23,-0xb)]===_0x4ffffe(-0x26b,-0x241,-0x247,-0x28e)){if(!_0x482858[_0x3ba77b(0x76,0x64,0x78,0x9b)]||_0x482858[_0x3ba77b(0x5c,0x95,0x78,0x54)][_0x4ffffe(-0x246,-0x26c,-0x22b,-0x221)]!==_0x4ffffe(-0x269,-0x247,-0x293,-0x29a))return _0xfdbb14['status'](0x35f*0x2+0x1369*-0x2+0x5*0x6bb)[_0x3ba77b(0x40,0x11,0x30,0x4b)]({'success':![],'message':'需要管理员权限'});const _0x1264da=databaseAudit[_0x3ba77b(0x6d,0x31,0x41,0x16)](_0x482858[_0x4ffffe(-0x28f,-0x262,-0x2ad,-0x26d)]);_0xfdbb14[_0x4ffffe(-0x27d,-0x28e,-0x24f,-0x251)]({'success':!![],'logs':_0x1264da});return;}_0x420113();};