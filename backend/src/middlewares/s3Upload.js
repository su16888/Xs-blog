(function(_0x1ddcad,_0x28fa4d){function _0x20902f(_0x419d97,_0x1e2a9f,_0x53b8ef,_0x2a587f){return _0x_0x1abc(_0x1e2a9f- -0x31b,_0x53b8ef);}function _0xc6d0e4(_0x29e088,_0x2d2ff0,_0xf53cdb,_0x1ee56c){return _0x_0x1abc(_0x2d2ff0- -0x146,_0x29e088);}const _0x24610d=_0x1ddcad();while(!![]){try{const _0x2d193d=parseInt(_0xc6d0e4(0x68,0x72,0x7b,0x66))/(0x1703+0x1f01*-0x1+-0x7ff*-0x1)*(-parseInt(_0x20902f(-0x151,-0x169,-0x175,-0x181))/(-0x135+-0x2f*-0x6c+-0x129d))+parseInt(_0x20902f(-0x178,-0x165,-0x166,-0x177))/(-0x205d+-0xa*-0x2f1+0x2f6)*(-parseInt(_0xc6d0e4(0x9c,0x83,0x9f,0x90))/(0x9*-0x211+0x6*-0x196+0x1c21))+parseInt(_0xc6d0e4(0x86,0x9f,0x9f,0xb3))/(0x1c7c+0x65b+-0x22d2)+-parseInt(_0xc6d0e4(0x6d,0x89,0x8a,0x8c))/(0x1975+0x148b*0x1+-0x2dfa)+parseInt(_0xc6d0e4(0x8c,0x78,0x6d,0x60))/(-0xe8*-0x2b+0x1*-0x233e+-0x3b3)+-parseInt(_0x20902f(-0x13e,-0x15a,-0x146,-0x14c))/(0x1*0x2031+0x380+-0x23a9)+parseInt(_0xc6d0e4(0x60,0x7e,0x64,0x83))/(-0x1*0x174+0x2061+-0x1ee4);if(_0x2d193d===_0x28fa4d)break;else _0x24610d['push'](_0x24610d['shift']());}catch(_0x2b1699){_0x24610d['push'](_0x24610d['shift']());}}}(_0x_0x3732,-0x166be+0x4913+0x2f5f6));function _0x_0x36f439(_0x41ad63,_0x1b6112,_0x46a745,_0x48956a){return _0x_0x1abc(_0x1b6112-0x305,_0x46a745);}const _0x_0x3bb9ee=(function(){let _0x3be9e6=!![];return function(_0x1be224,_0xedb443){const _0x2b9a12=_0x3be9e6?function(){function _0x194b43(_0x3d26f5,_0x4c80b3,_0x374f37,_0x3e231c){return _0x_0x1abc(_0x3d26f5- -0x2fe,_0x3e231c);}if(_0xedb443){const _0x4b9df4=_0xedb443[_0x194b43(-0x122,-0x119,-0x135,-0x11e)](_0x1be224,arguments);return _0xedb443=null,_0x4b9df4;}}:function(){};return _0x3be9e6=![],_0x2b9a12;};}()),_0x_0x482e89=_0x_0x3bb9ee(this,function(){function _0x5d5101(_0x369a99,_0x207aba,_0x1ddf72,_0x4c5a39){return _0x_0x1abc(_0x1ddf72-0x36f,_0x207aba);}function _0x38248d(_0x11b786,_0x594631,_0x182404,_0x26b06f){return _0x_0x1abc(_0x26b06f- -0x122,_0x11b786);}return _0x_0x482e89[_0x5d5101(0x531,0x534,0x54e,0x567)]()[_0x38248d(0xb3,0xa4,0xab,0xaf)](_0x5d5101(0x54e,0x524,0x539,0x53f))[_0x38248d(0xc8,0xa4,0x9f,0xbd)]()[_0x38248d(0xa4,0x98,0xa0,0xa6)](_0x_0x482e89)[_0x5d5101(0x53f,0x54e,0x540,0x53b)](_0x5d5101(0x547,0x52b,0x539,0x547));});function _0x_0x3732(){const _0x11bba8=['t1n5y0S','Axntm0vUywjSzwq','uZpLIkdPMAtOT7pOV4C6','B2v6C3u','qLn0CuK','zMLSzxm','Aw5JBhvKzxm','swj3qNi','vvbmt0fex0rjuG','yxbWBhK','z2v0uZndB25MAwC','C3vIC3rYAw5N','Dg9tDhjPBMC','z2v0rMLSzvvYBa','DxbSB2fKvg9tmW','Bg9N','u2HxCwC','BgvUz3rO','oda3mda1BgvuC1zP','D2fYBG','C3rHCNrZv2L0Aa','CgDYuhq','zxjYB3i','rhvSsuS','BwvZC2fNzq','zxHPC3rZu3LUyW','DxbSB2fKCW','mJaXmLHNrfruAa','yNvJA2v0','5PAh5lU25yIG6zMK6k2M5zgkoG','ww9esu0','ndmYndGZAwf4EeTp','zw5KCg9PBNq','mtaWD2fYEurT','q3LcvLi','yvLytge','zgvSzxrLrNjVBvmZ','zxHWB3j0CW','uZpKUiRKVkdLPitNKiBLPlhOTku6','nJG4mJqWBLLVs3rm','w1mZvxbSB2fKxsbtm+ACQUwqR+EuQo+8Jos9V+EuQoACRowCSowTMowcQa','Cgf0Aa','mte3oteXmNz1zhvtAG','w1mZvxbSB2fKxsbPC1mZrw5HyMXLzdO','thH3CKG','mZiXnJuYoeTsu25ktq','5yIG6zMK5PAh5lU25AsX6lsLoG','AM9PBG','Dw5SAw5Ru3LUyW','y29UC3rYDwn0B3i','nhrrtMvAyq','kcGOlISPkYKRksSK','5PYS5zYW5yIG6zMK5AsX6lsLoIa','CZnvCMW','BwLTzxr5Cgu','z2v0rMLSzvbHDgHgCM9TvxjS','nJi0mZm2vhzfu2jV','y3vZDg9Trg9TywLU','C2vHCMnO','zMLSzw5HBwu'];_0x_0x3732=function(){return _0x11bba8;};return _0x_0x3732();}function _0x_0x1abc(_0x4e6f3f,_0x272160){_0x4e6f3f=_0x4e6f3f-(0xed1+0x3*0x98f+-0x53*0x81);const _0x5159d7=_0x_0x3732();let _0x4fcb9b=_0x5159d7[_0x4e6f3f];if(_0x_0x1abc['qMifFl']===undefined){var _0x248566=function(_0x1a73b6){const _0x928361='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x13df13='',_0x525992='',_0x329a57=_0x13df13+_0x248566;for(let _0x525d94=-0x25bc+0x23*0xc5+0xacd,_0x2316dd,_0x1ec4d1,_0x3f0f34=0x9f9*0x2+0x6ec+0x1ade*-0x1;_0x1ec4d1=_0x1a73b6['charAt'](_0x3f0f34++);~_0x1ec4d1&&(_0x2316dd=_0x525d94%(-0x12a*-0x3+-0x1249*0x1+0xecf)?_0x2316dd*(0x3df*0x2+-0xe18+0x69a)+_0x1ec4d1:_0x1ec4d1,_0x525d94++%(-0x11f0*0x1+0x2590+-0xfb*0x14))?_0x13df13+=_0x329a57['charCodeAt'](_0x3f0f34+(0xc*0x2ce+0x2654+-0x47f2))-(-0x103a+-0x75f*-0x4+0x6*-0x234)!==-0x1fb1+0x160*-0x15+-0x3c91*-0x1?String['fromCharCode'](0x9*-0x3b4+-0x2238+0x448b&_0x2316dd>>(-(-0xe*-0x39+0x739*-0x2+-0x2*-0x5ab)*_0x525d94&0x1711+0x20*0x121+-0x3b2b)):_0x525d94:-0x6bb+-0x1*0x22eb+-0x6*-0x6f1){_0x1ec4d1=_0x928361['indexOf'](_0x1ec4d1);}for(let _0x180922=0x1832+0x3c1+-0x1bf3,_0x481fc6=_0x13df13['length'];_0x180922<_0x481fc6;_0x180922++){_0x525992+='%'+('00'+_0x13df13['charCodeAt'](_0x180922)['toString'](-0x18*-0x2+0x6*0x1+-0x2*0x13))['slice'](-(0x95*0x3+-0x38f+0x1d2));}return decodeURIComponent(_0x525992);};_0x_0x1abc['mgyzJJ']=_0x248566,_0x_0x1abc['tmdMLK']={},_0x_0x1abc['qMifFl']=!![];}const _0x5ecae7=_0x5159d7[-0x11*-0x18f+-0x53f+-0x1540],_0x249e27=_0x4e6f3f+_0x5ecae7,_0x385dd5=_0x_0x1abc['tmdMLK'][_0x249e27];if(!_0x385dd5){const _0x6347bd=function(_0x508f5f){this['fOIuUZ']=_0x508f5f,this['STknkL']=[0x1774+-0x2507+0xd94,0x48b*0x5+-0xc87*0x2+0x257,0x727+-0x824+-0x1*-0xfd],this['ZIWucg']=function(){return'newState';},this['oKjdGe']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['xtyQei']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x6347bd['prototype']['YWkXPP']=function(){const _0x3f3a5d=new RegExp(this['oKjdGe']+this['xtyQei']),_0x36ac55=_0x3f3a5d['test'](this['ZIWucg']['toString']())?--this['STknkL'][0x3c3*-0x9+-0x1403+-0x35df*-0x1]:--this['STknkL'][-0x83*-0x29+-0x3*0x989+0x7a0];return this['mLyQOT'](_0x36ac55);},_0x6347bd['prototype']['mLyQOT']=function(_0x28b482){if(!Boolean(~_0x28b482))return _0x28b482;return this['KPIlAo'](this['fOIuUZ']);},_0x6347bd['prototype']['KPIlAo']=function(_0x32945f){for(let _0x209aa6=-0x6bb*0x4+0x295*0x3+0x132d,_0x295e62=this['STknkL']['length'];_0x209aa6<_0x295e62;_0x209aa6++){this['STknkL']['push'](Math['round'](Math['random']())),_0x295e62=this['STknkL']['length'];}return _0x32945f(this['STknkL'][0x1966+-0x9*0x3fb+0x9d*0x11]);},new _0x6347bd(_0x_0x1abc)['YWkXPP'](),_0x4fcb9b=_0x_0x1abc['mgyzJJ'](_0x4fcb9b),_0x_0x1abc['tmdMLK'][_0x249e27]=_0x4fcb9b;}else _0x4fcb9b=_0x385dd5;return _0x4fcb9b;}_0x_0x482e89();const fs=require('fs'),path=require('path'),s3Service=require('../services/s3Service'),config=require('../config/config'),s3PostUpload=moduleName=>{return async(_0x305880,_0xdfba25,_0xf2e8bf)=>{function _0x29f01c(_0x5c4602,_0x3c3f53,_0x4379db,_0x3544eb){return _0x_0x1abc(_0x3c3f53-0x69,_0x3544eb);}function _0x2b1a3c(_0x5148e9,_0x14b998,_0x2cc6ae,_0x1f432b){return _0x_0x1abc(_0x2cc6ae-0x3c3,_0x14b998);}if(_0x29f01c(0x206,0x217,0x21d,0x209)!==_0x2b1a3c(0x56c,0x58d,0x57c,0x585)){if(!_0x305880['file']&&!_0x305880['files'])return _0xf2e8bf();try{const _0x1e9fed=await s3Service['isS3Enabled']();console[_0x29f01c(0x252,0x24b,0x22e,0x25b)](_0x29f01c(0x230,0x22b,0x212,0x227),_0x1e9fed);if(!_0x1e9fed)return console[_0x2b1a3c(0x5a2,0x5a3,0x5a5,0x59f)](_0x2b1a3c(0x597,0x577,0x582,0x598)),_0xf2e8bf();const _0x573f17=_0x305880[_0x2b1a3c(0x59e,0x5a8,0x59b,0x588)]||[_0x305880['file']];for(const _0x595efe of _0x573f17){if(_0x29f01c(0x21b,0x223,0x20a,0x23b)===_0x29f01c(0x22e,0x21e,0x210,0x21c))_0x4ef69e=_0x6664f6+'/'+_0x49a383[_0x2b1a3c(0x579,0x5a1,0x595,0x5aa)];else{if(!_0x595efe)continue;const _0x3442fa=process['env'][_0x2b1a3c(0x5aa,0x58f,0x59e,0x593)]||_0x2b1a3c(0x592,0x569,0x574,0x583);let _0x1516a5;if(moduleName)_0x1516a5=_0x3442fa+'/'+moduleName+'/'+_0x595efe[_0x2b1a3c(0x5b1,0x58c,0x595,0x591)];else{if(_0x2b1a3c(0x5a8,0x59d,0x59d,0x5a9)!==_0x2b1a3c(0x598,0x596,0x59d,0x58b)){console[_0x2b1a3c(0x579,0x580,0x570,0x57c)]('删除文件失败:',_0x4cb42a);throw _0x524fb1;}else{const _0x12c7a3=_0x595efe['path']['replace'](/\\/g,'/'),_0x11200a=_0x12c7a3['indexOf'](_0x3442fa+'/');if(_0x11200a!==-(-0x1d97+-0x1*-0x65f+0x1739))_0x1516a5=_0x12c7a3[_0x29f01c(0x258,0x247,0x248,0x25b)](_0x11200a);else{if(_0x2b1a3c(0x594,0x586,0x59a,0x598)!==_0x29f01c(0x225,0x240,0x247,0x24d)){const _0x2850b3=_0x32c9fc['apply'](_0x6f1877,arguments);return _0x4ad19d=null,_0x2850b3;}else _0x1516a5=_0x3442fa+'/'+_0x595efe[_0x2b1a3c(0x5a9,0x5ac,0x595,0x58d)];}}}const _0x415434=await s3Service[_0x29f01c(0x243,0x24a,0x256,0x254)](_0x595efe[_0x29f01c(0x22b,0x229,0x211,0x23d)],_0x1516a5,_0x595efe[_0x29f01c(0x23d,0x236,0x220,0x242)]);_0x595efe['s3Url']=_0x415434,_0x595efe['s3Key']=_0x1516a5,fs[_0x2b1a3c(0x55b,0x591,0x573,0x55d)](_0x595efe[_0x29f01c(0x238,0x229,0x221,0x211)])&&fs[_0x29f01c(0x21b,0x230,0x21e,0x246)](_0x595efe['path']);}}_0xf2e8bf();}catch(_0x4419f8){console[_0x29f01c(0x21f,0x216,0x231,0x1fe)](_0x2b1a3c(0x588,0x56a,0x580,0x590),_0x4419f8),_0xf2e8bf();}}else _0x2d0e75=_0x2858e3+'/'+moduleName+'/'+_0x337e1b[_0x2b1a3c(0x591,0x598,0x595,0x5b2)];};},getFileUrl=(_0x2e66e0,_0x380804)=>{function _0x9ccef7(_0x3ddb2e,_0x2c8bd5,_0x16686d,_0x429326){return _0x_0x1abc(_0x16686d-0x50,_0x2c8bd5);}if(_0x2e66e0['s3Url']){if(_0xe52fb5(0xcb,0xdf,0xd0,0xc1)!==_0x9ccef7(0x1eb,0x202,0x1fc,0x207))return _0x2e66e0[_0xe52fb5(0xd2,0xef,0xd9,0xe6)];else _0x1b26a3['unlinkSync'](_0x31d188[_0xe52fb5(0xd5,0xd2,0xcd,0xd3)]);}function _0xe52fb5(_0x450913,_0x274e2b,_0x6c1eb7,_0x586f78){return _0x_0x1abc(_0x6c1eb7- -0xf3,_0x586f78);}return config[_0xe52fb5(0xe2,0xd8,0xed,0xd1)](_0x2e66e0);},deleteFile=async _0x53bdbd=>{function _0x4f8f40(_0x1f2273,_0x533a48,_0x3b40d1,_0x4a57c8){return _0x_0x1abc(_0x1f2273-0x348,_0x533a48);}function _0x1a03c8(_0x1a3380,_0x7b6cc5,_0x549b4e,_0x3eb7f6){return _0x_0x1abc(_0x1a3380-0x9d,_0x549b4e);}if(!_0x53bdbd)return;try{const _0x4ff137=await s3Service[_0x1a03c8(0x271,0x287,0x257,0x275)](),_0x4f89bc=await s3Service[_0x1a03c8(0x27a,0x282,0x267,0x271)](),isS3File=_0x4f89bc['customDomain']&&_0x53bdbd[_0x4f8f40(0x4f3,0x50b,0x4d5,0x4d8)](_0x4f89bc[_0x1a03c8(0x26d,0x287,0x270,0x287)])||_0x4f89bc[_0x1a03c8(0x254,0x255,0x248,0x25c)]&&_0x53bdbd[_0x1a03c8(0x276,0x25c,0x259,0x269)](_0x4f89bc[_0x4f8f40(0x4fb,0x4ee,0x4f7,0x4de)]);if(_0x4ff137&&isS3File)await s3Service[_0x1a03c8(0x258,0x258,0x23a,0x269)](_0x53bdbd);else{const _0x13d936=config['getFilePathFromUrl'](_0x53bdbd);_0x13d936&&fs[_0x1a03c8(0x24d,0x269,0x241,0x22f)](_0x13d936)&&fs['unlinkSync'](_0x13d936);}}catch(_0x332b2f){console['error'](_0x1a03c8(0x262,0x25a,0x253,0x261),_0x332b2f);throw _0x332b2f;}},smartDeleteFile=async _0x14711d=>{if(!_0x14711d)return;const _0x44ed68=[];function _0x5a6a72(_0x502e68,_0x2bd145,_0x59c980,_0x162689){return _0x_0x1abc(_0x162689- -0x20a,_0x502e68);}try{if(_0x5a6a72(-0x2e,-0x1e,-0x30,-0x27)!==_0x1e870f(0x476,0x47d,0x478,0x471)){const _0x5e3946=config[_0x5a6a72(-0x3d,-0x38,-0x33,-0x3c)](_0x14711d);_0x5e3946&&fs[_0x5a6a72(-0x74,-0x64,-0x57,-0x5a)](_0x5e3946)&&fs['unlinkSync'](_0x5e3946);}else return console[_0x1e870f(0x492,0x489,0x48d,0x480)]('[S3Upload]\x20S3未启用，使用本地存储'),_0x70237a();}catch(_0x219b97){_0x44ed68['push'](_0x5a6a72(-0x24,-0x21,-0x49,-0x3f)+_0x219b97[_0x1e870f(0x448,0x449,0x462,0x44d)]);}function _0x1e870f(_0x9d47d,_0x309c69,_0x3d102d,_0x3ce34d){return _0x_0x1abc(_0x3ce34d-0x29e,_0x309c69);}try{const _0x1af57a=await s3Service[_0x1e870f(0x468,0x47f,0x46b,0x472)]();_0x1af57a&&await s3Service[_0x1e870f(0x450,0x455,0x43f,0x459)](_0x14711d);}catch(_0x4b551e){if(_0x5a6a72(-0x17,-0x41,-0x1e,-0x34)!==_0x5a6a72(-0x2a,-0x3a,-0x28,-0x34)){const _0x4bd059=_0x482628[_0x5a6a72(-0x56,-0x31,-0x37,-0x3c)](_0x440c36);_0x4bd059&&_0x741cad['existsSync'](_0x4bd059)&&_0x386aa4['unlinkSync'](_0x4bd059);}else console[_0x5a6a72(-0x34,-0x40,-0x34,-0x28)](_0x1e870f(0x486,0x45a,0x47d,0x473),_0x4b551e['message']);}if(_0x44ed68[_0x5a6a72(-0x23,-0x24,-0x17,-0x26)]>-0x1d12+0x7ae+-0x94*-0x25){if('HwVQE'!=='skDOm')console[_0x1e870f(0x488,0x48a,0x483,0x484)](_0x1e870f(0x439,0x43c,0x44b,0x452),_0x44ed68[_0x1e870f(0x447,0x479,0x44f,0x464)](';\x20'));else{const _0x29fecf=_0xcc651c[_0x1e870f(0x455,0x487,0x470,0x46c)](_0x3db518);_0x29fecf&&_0x14f214['existsSync'](_0x29fecf)&&_0x1b1b64['unlinkSync'](_0x29fecf);}}};module[_0x_0x36f439(0x4ca,0x4c1,0x4ce,0x4ce)]={'s3PostUpload':s3PostUpload,'getFileUrl':getFileUrl,'deleteFile':deleteFile,'smartDeleteFile':smartDeleteFile};