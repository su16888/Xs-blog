function _0x_0x1e90(){const _0x33c1b2=['CgvUzgLUzW','BwvZC2fNzq','zen2u00','odmWB3fzshHA','uerqwMu','lZPPza','6i635y+w55wz6kIa5AsX6lsL','zMLUzefUzenVDw50qwXS','BMfTzq','zMLUzej5ugS','AufTsNe','vxPfvKq','y2vPBa','C2f2zq','ywXSB3DLza','mZG0sKrWqK1Y','5PU05PAW55wz6kIa54Q25Ocb5AsX6lsLoG','wNDXtxy','Dg9ku09o','zfzNrxi','6i635y+w55wz6kIa6k+M5Oof5AsX6lsLoG','5y+r6ycb6ykU5lU26ycA55+L5AsX6lsLoG','ANnVBG','5AEt5zcn44cb6igu57o75PA55BYp5zkm5yAf5A655lIn6io95lI656M6','6i635y+w55wz6kIa5AsX6lsLoG','wg5Nv0m','twvZC2fNzunHDgvNB3j5','Dg9tDhjPBMC','tLblBum','5PU05PAW55wz6kIa54Q25Ocb5AsX6lsL','EeTYBue','mZv6rLbTBhK','ne16vKjPrG','ugjpC1y','AwzYwfC','6i635y+w55wz6kIa6k+M5Oof5AsX6lsL','zxHWB3j0CW','6AQm6k+b56cb5lIn6io95lI656M6','Dgv4Da','5O+q5lQK55wz6kIa5AsX6lsLoG','BuXyBNm','mZm1mtDst1fRzfa','nde3mJeWwK9Zzgni','y2f0zwDVCNLFAwq','CgfYyw1Z','uNvqDMm','EMnpAMK','5O+q5lQK55wz6kIa5AsX6lsL','55wz6kIa5lIn5A2y5zYO','y3jLyxrLzf9HDa','Cg9ZDa','mZG4ntC4s05psvvl','mZKWDerYrK1Y','Cgr5u2q','y29UC3rYDwn0B3i','zgvSzxrL','y29TBwL0','DhjHBNnHy3rPB24','6i635y+w5yIg57g75zcn56EW5AsX6lsLoG','CM9SBgjHy2S','54Q25Ocb5PU05PAW5OIq5yQF','C2vHCMnO','nti4ntaWnfHRuwDdqG','54Q25Ocb5yc85PEG5Pwi','55wz6kIa5O+q5lQK5OIq5yQF77Ym5OIr5lUS5lYA5Bc95B+R5Ase55cg','yxbWBhK','ndiYodi2nxL1veLpva','mtG0nxrytM5ZDa','vxnLCI1bz2vUDa','5yIG6zMK55wz6kIa5AsX6lsL','thvzBKW','vxLcsg8','z2v0','zxjYB3i','55wz6kIa5yIG6zMK5OIq5yQF','C3rHDhvZ','mZu4mhvPtgjTCa','q0TZufm','yM9KEq','EKX3C3a','revtqW','6AQm6k+b56cb6zsz6k+V5OIw5BEY6l+h5PYF','5PYQ5yIg57g7','y3jLyxrL','Aw5JBhvKzxm','kcGOlISPkYKRksSK','y2f0y2G'];_0x_0x1e90=function(){return _0x33c1b2;};return _0x_0x1e90();}(function(_0x1e6fb1,_0x5340c1){const _0x2e2be0=_0x1e6fb1();function _0x2b8af9(_0x52c4b5,_0x2aa1a1,_0x261984,_0x41d9c8){return _0x_0x3ad6(_0x261984- -0x3ce,_0x52c4b5);}function _0x52ee00(_0x1f7892,_0x5ca239,_0x52e46d,_0x3ff8fa){return _0x_0x3ad6(_0x3ff8fa-0x225,_0x52e46d);}while(!![]){try{const _0x40b1ce=parseInt(_0x2b8af9(-0x226,-0x238,-0x248,-0x226))/(-0x2*-0x828+0x67d+-0x16cc)*(parseInt(_0x2b8af9(-0x233,-0x231,-0x25b,-0x27f))/(-0xe60+0x420+0x1a*0x65))+-parseInt(_0x52ee00(0x3ae,0x3a0,0x3a1,0x3ac))/(0x11*-0x133+0x3*-0x315+0x1da5*0x1)*(parseInt(_0x2b8af9(-0x25f,-0x2b2,-0x286,-0x263))/(0x11a7*-0x1+0x1*0xb2b+-0x80*-0xd))+parseInt(_0x52ee00(0x36f,0x34f,0x37d,0x363))/(0x261a*-0x1+0x2337+-0xf8*-0x3)+-parseInt(_0x52ee00(0x376,0x3c3,0x3bd,0x3a2))/(-0x1241*0x1+-0x247c+-0x1241*-0x3)*(parseInt(_0x52ee00(0x3af,0x39f,0x372,0x397))/(0x7*0x46d+0x2322+-0x4216))+-parseInt(_0x52ee00(0x3a3,0x39e,0x3a7,0x387))/(-0x4d2+-0x15*0x97+0x113d)*(-parseInt(_0x52ee00(0x38f,0x36b,0x38f,0x364))/(0x1e28+-0x183c+-0x89*0xb))+parseInt(_0x52ee00(0x359,0x36b,0x367,0x37b))/(-0x3c1*0x3+0x1eca+-0x137d)*(-parseInt(_0x2b8af9(-0x24f,-0x248,-0x252,-0x256))/(0xce*0x1d+0x593*-0x1+-0x237*0x8))+-parseInt(_0x2b8af9(-0x2a8,-0x2b7,-0x294,-0x273))/(0x2386+-0x59f+0x1ddb*-0x1);if(_0x40b1ce===_0x5340c1)break;else _0x2e2be0['push'](_0x2e2be0['shift']());}catch(_0x75d59a){_0x2e2be0['push'](_0x2e2be0['shift']());}}}(_0x_0x1e90,0x974f1+0x2154*0x13+-0x4ad83));const _0x_0x5acfe4=(function(){let _0x2244a6=!![];return function(_0xecd655,_0xa6b65d){function _0x4609b1(_0x152b49,_0x3df183,_0x43cde0,_0x28975b){return _0x_0x3ad6(_0x152b49- -0x10e,_0x3df183);}function _0x5c84c0(_0x2e5d9b,_0x30dc65,_0x5b5803,_0x15d4eb){return _0x_0x3ad6(_0x30dc65-0x3a,_0x15d4eb);}if(_0x4609b1(0x66,0x43,0x44,0x76)===_0x4609b1(0x67,0x91,0x5c,0x72))return console[_0x4609b1(0x37,0x1d,0x63,0x27)]('获取分类名称失败:',_0x2b6adb),_0x5c84c0(0x176,0x188,0x178,0x18d);else{const _0x6e0e45=_0x2244a6?function(){function _0xb76eeb(_0x29878a,_0x451a4b,_0x3ce6f6,_0x20918e){return _0x4609b1(_0x451a4b- -0x14e,_0x3ce6f6,_0x3ce6f6-0x3,_0x20918e-0x20);}function _0x2a6a74(_0x2e787b,_0x36e93f,_0x430f87,_0x4156ce){return _0x4609b1(_0x430f87-0x359,_0x36e93f,_0x430f87-0x140,_0x4156ce-0x1f2);}if(_0xa6b65d){if(_0xb76eeb(-0xd8,-0xfe,-0x115,-0xeb)!==_0x2a6a74(0x3d9,0x3bc,0x3c6,0x3b2)){const _0xdae1b4=_0xa6b65d[_0x2a6a74(0x3a0,0x36d,0x388,0x37a)](_0xecd655,arguments);return _0xa6b65d=null,_0xdae1b4;}else console[_0x2a6a74(0x3b0,0x37f,0x390,0x3ab)]('删除留言失败:',_0x4ad7c1),_0x1516cc['status'](0x5*0x55e+-0x47*0x6b+0x4cb)[_0xb76eeb(-0xed,-0xf3,-0xfd,-0xf5)]({'success':![],'message':_0xb76eeb(-0xf3,-0x11b,-0xef,-0xf5)});}}:function(){};return _0x2244a6=![],_0x6e0e45;}};}()),_0x_0x3a8462=_0x_0x5acfe4(this,function(){function _0x16e772(_0x4863a5,_0xe34d81,_0x1809a2,_0x7f333c){return _0x_0x3ad6(_0x4863a5- -0x38c,_0x7f333c);}function _0x3fad90(_0x5ac556,_0x14aa54,_0x3b0afc,_0x21906e){return _0x_0x3ad6(_0x5ac556-0x2b5,_0x21906e);}return _0x_0x3a8462['toString']()[_0x3fad90(0x3ee,0x411,0x3fb,0x3f2)](_0x3fad90(0x406,0x3e4,0x3fd,0x42d))[_0x16e772(-0x21e,-0x23a,-0x239,-0x205)]()[_0x3fad90(0x43e,0x44f,0x452,0x449)](_0x_0x3a8462)[_0x3fad90(0x3ee,0x408,0x3e4,0x40d)]('(((.+)+)+)+$');});_0x_0x3a8462();function _0x_0x3ad6(_0x4d69b2,_0x40e665){_0x4d69b2=_0x4d69b2-(0x8ed+0x1f4*0x2+-0xb9c);const _0x2d09a6=_0x_0x1e90();let _0x2a990f=_0x2d09a6[_0x4d69b2];if(_0x_0x3ad6['viccXI']===undefined){var _0x425910=function(_0xecc0fb){const _0x30f55b='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x17255f='',_0x41c834='',_0x1eda8d=_0x17255f+_0x425910;for(let _0x442e24=0x922+0x140d+-0x1d2f,_0x129457,_0x5194a1,_0x279e39=-0x1f57+0x11*0x65+0x1*0x18a2;_0x5194a1=_0xecc0fb['charAt'](_0x279e39++);~_0x5194a1&&(_0x129457=_0x442e24%(-0x4*-0x734+-0x5c*0x3+-0x1bb8)?_0x129457*(0x1b1b+0x1*0x1d7f+-0x385a)+_0x5194a1:_0x5194a1,_0x442e24++%(0x5*-0x547+0x1*0x12d5+0x792))?_0x17255f+=_0x1eda8d['charCodeAt'](_0x279e39+(0x9*0x390+0x1d*0x51+-0x2933))-(-0x1dcc+-0x5a8+0x33a*0xb)!==0x1f1c+-0x7*-0x23b+-0x9*0x531?String['fromCharCode'](-0x10*0x38+-0x1ced+0x216c&_0x129457>>(-(0x1671+-0x381+-0x12ee)*_0x442e24&-0xd8*-0x16+0x7a9+-0x1a33)):_0x442e24:0x2f*-0x28+-0x20b*0x9+0x7*0x3ad){_0x5194a1=_0x30f55b['indexOf'](_0x5194a1);}for(let _0x3378d1=-0x7f7+-0x2015*-0x1+0x80a*-0x3,_0x55ab30=_0x17255f['length'];_0x3378d1<_0x55ab30;_0x3378d1++){_0x41c834+='%'+('00'+_0x17255f['charCodeAt'](_0x3378d1)['toString'](-0x1fc7+-0x47*0x21+0x28fe))['slice'](-(0x238b+-0x1*0x2326+0x21*-0x3));}return decodeURIComponent(_0x41c834);};_0x_0x3ad6['vdgjtY']=_0x425910,_0x_0x3ad6['EgDTUt']={},_0x_0x3ad6['viccXI']=!![];}const _0x1fb605=_0x2d09a6[0x5fe*0x1+-0x140e+0xe10],_0x165a2a=_0x4d69b2+_0x1fb605,_0x2fe867=_0x_0x3ad6['EgDTUt'][_0x165a2a];if(!_0x2fe867){const _0x2d5d3e=function(_0x333e84){this['VhmQBR']=_0x333e84,this['YesMAD']=[0x21b6+0x77d+-0x2*0x1499,-0x1*-0x17cb+-0x244d*0x1+0xc82,0xd67*-0x1+0x22ee+-0xa7*0x21],this['NDUcKm']=function(){return'newState';},this['VhvXbJ']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['shOGjU']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x2d5d3e['prototype']['yfFCyI']=function(){const _0x3c9a8e=new RegExp(this['VhvXbJ']+this['shOGjU']),_0x1a2af1=_0x3c9a8e['test'](this['NDUcKm']['toString']())?--this['YesMAD'][0xd8*-0x2d+0x107*-0x23+-0x49ee*-0x1]:--this['YesMAD'][0x2594+0x1f43+-0x44d7];return this['sGGbQI'](_0x1a2af1);},_0x2d5d3e['prototype']['sGGbQI']=function(_0x1d3284){if(!Boolean(~_0x1d3284))return _0x1d3284;return this['XXfIau'](this['VhmQBR']);},_0x2d5d3e['prototype']['XXfIau']=function(_0x452b0f){for(let _0x41f84e=-0x17bb+-0x6*-0x2e3+-0x223*-0x3,_0x5808ed=this['YesMAD']['length'];_0x41f84e<_0x5808ed;_0x41f84e++){this['YesMAD']['push'](Math['round'](Math['random']())),_0x5808ed=this['YesMAD']['length'];}return _0x452b0f(this['YesMAD'][0x247f+0x1447*0x1+-0x38c6]);},new _0x2d5d3e(_0x_0x3ad6)['yfFCyI'](),_0x2a990f=_0x_0x3ad6['vdgjtY'](_0x2a990f),_0x_0x3ad6['EgDTUt'][_0x165a2a]=_0x2a990f;}else _0x2a990f=_0x2fe867;return _0x2a990f;}const express=require('express'),router=express['Router'](),Message=require('../models/Message'),MessageCategory=require('../models/MessageCategory'),authenticateToken=require('../middlewares/auth');function _0x_0x115cc1(_0x5683bd,_0x291681,_0x1ac19f,_0x5f13c5){return _0x_0x3ad6(_0x5f13c5- -0x164,_0x291681);}const {sequelize}=require('../config/database'),{validateCaptcha}=require('../utils/captcha'),{checkIPLimit,recordIPSubmission}=require('../utils/ipLimit'),{sendMessageNotification}=require('../utils/email'),{getClientIP}=require('../utils/ipHelper');async function getCategoryName(_0xfe1815){function _0x3bd320(_0x23a198,_0x5e38bf,_0x2134a4,_0x1e6be6){return _0x_0x3ad6(_0x2134a4- -0x2a9,_0x23a198);}function _0x5f0599(_0x1cae37,_0x466395,_0x9f65b7,_0x5dbc43){return _0x_0x3ad6(_0x1cae37-0x6d,_0x9f65b7);}try{const _0xe72460=await MessageCategory[_0x3bd320(-0x16f,-0x14b,-0x14d,-0x125)](_0xfe1815);return _0xe72460?_0xe72460[_0x3bd320(-0x14e,-0x15a,-0x14e,-0x157)]:_0x3bd320(-0x136,-0x185,-0x15b,-0x16b);}catch(_0x4ac62f){if(_0x3bd320(-0x151,-0x150,-0x152,-0x133)!==_0x5f0599(0x1c4,0x1c5,0x1e0,0x1c2)){const _0x55d15d=_0x2e5f33?function(){if(_0x50c57b){const _0x5cbe74=_0x314f67['apply'](_0x26b996,arguments);return _0xf7c145=null,_0x5cbe74;}}:function(){};return _0x2f5aa4=![],_0x55d15d;}else return console[_0x3bd320(-0x158,-0x148,-0x164,-0x179)](_0x3bd320(-0x10e,-0x12d,-0x11c,-0x143),_0x4ac62f),_0x3bd320(-0x163,-0x140,-0x15b,-0x14c);}}router[_0x_0x4f7064(-0x1cc,-0x192,-0x1ad,-0x1b1)]('/',authenticateToken,async(_0x338e48,_0x2fb21d)=>{function _0x3b199c(_0xc8a88e,_0xbde40e,_0x37f3d1,_0x428b0b){return _0x_0x4f7064(_0xc8a88e-0xf8,_0xbde40e-0x1a2,_0xbde40e-0x261,_0x37f3d1);}function _0x359749(_0x26a999,_0x2827b5,_0x55b2a7,_0x5ee489){return _0x_0x4f7064(_0x26a999-0x1d4,_0x2827b5-0x59,_0x55b2a7-0x29a,_0x26a999);}try{const {page:page=0x183e+-0x2*0x12d4+0xd6b,limit:limit=0x742+-0x90a*-0x1+-0x40e*0x4,status:_0x518d67,category_id:_0x1a1424}=_0x338e48['query'],_0x2f82c7=(page-(0x219*0xd+-0x1*0xdcd+-0xd77))*limit,_0x55f798={};if(_0x518d67)_0x55f798[_0x359749(0x100,0x101,0xf0,0x114)]=_0x518d67;if(_0x1a1424)_0x55f798[_0x359749(0xfc,0x11d,0x127,0x13f)]=_0x1a1424;const {count:_0x487b70,rows:_0x3fc22d}=await Message[_0x359749(0xe1,0x109,0x103,0xf2)]({'where':_0x55f798,'include':[{'model':MessageCategory,'as':_0x359749(0xff,0xec,0x116,0x12d),'attributes':['id',_0x359749(0xeb,0x110,0x104,0xf7)]}],'order':[[_0x359749(0x113,0x115,0x12d,0x10b),_0x3b199c(0xc8,0xbc,0xc4,0xb2)]],'limit':parseInt(limit),'offset':parseInt(_0x2f82c7)});_0x2fb21d[_0x359749(0x11e,0x122,0x112,0x132)]({'success':!![],'data':_0x3fc22d,'pagination':{'page':parseInt(page),'limit':parseInt(limit),'total':_0x487b70,'pages':Math[_0x3b199c(0xc1,0xcf,0xe2,0xb0)](_0x487b70/limit)}});}catch(_0x29e915){if(_0x359749(0x116,0xf1,0xeb,0x100)!=='kYNwI')console['error'](_0x3b199c(0xea,0xdb,0xbd,0xdc),_0x29e915),_0x2fb21d[_0x3b199c(0xb4,0xb7,0xb0,0x91)](0x1*0x1edb+0x50f*-0x5+-0x84*0x7)[_0x3b199c(0xee,0xd9,0xd8,0x103)]({'success':![],'message':_0x359749(0xe9,0x11d,0x102,0x12b)});else return _0x4b1475[_0x3b199c(0x9a,0xb7,0x91,0xaf)](0x1292*0x1+0xd62+-0x288*0xc)['json']({'success':![],'message':_0x3b199c(0xe4,0xf3,0xdd,0x117)});}}),router[_0x_0x115cc1(-0x23,-0xc,-0x3f,-0x20)](_0x_0x4f7064(-0x1b8,-0x19f,-0x199,-0x1b1),authenticateToken,async(_0x451eb2,_0x5534a6)=>{function _0x18bbcb(_0x40f44c,_0x1997af,_0x2538cf,_0x5aa537){return _0x_0x4f7064(_0x40f44c-0xca,_0x1997af-0x109,_0x40f44c-0x2e8,_0x5aa537);}function _0x398e07(_0xd69536,_0x2fda93,_0x47744b,_0x35921d){return _0x_0x115cc1(_0xd69536-0x13a,_0x47744b,_0x47744b-0x1b2,_0xd69536-0x4ff);}try{const {id:_0xac5e24}=_0x451eb2[_0x398e07(0x51a,0x51d,0x51d,0x533)],_0x41244d=await Message[_0x398e07(0x4f7,0x4f7,0x4e2,0x4f0)](_0xac5e24,{'include':[{'model':MessageCategory,'as':_0x18bbcb(0x164,0x159,0x144,0x182),'attributes':['id',_0x18bbcb(0x152,0x174,0x15e,0x128)]}]});if(!_0x41244d)return _0x18bbcb(0x168,0x141,0x163,0x13c)===_0x398e07(0x4f8,0x510,0x51c,0x4da)?_0x56d89f[_0x18bbcb(0x13e,0x146,0x157,0x152)](-0xaf+0x3*0x8dd+-0x1854)[_0x398e07(0x504,0x508,0x513,0x526)]({'success':![],'message':_0x18bbcb(0x17a,0x190,0x161,0x175)}):_0x5534a6[_0x18bbcb(0x13e,0x150,0x163,0x148)](-0x2*-0xa39+-0x199*-0x1+-0x1477)[_0x18bbcb(0x160,0x17e,0x14d,0x16c)]({'success':![],'message':_0x18bbcb(0x17a,0x1a1,0x18d,0x168)});_0x5534a6[_0x398e07(0x504,0x51e,0x507,0x4dc)]({'success':!![],'data':_0x41244d});}catch(_0x2025de){'UyBHo'!==_0x18bbcb(0x13a,0x157,0x164,0x133)?(console[_0x18bbcb(0x13c,0x112,0x13d,0x13f)]('更新留言状态失败:',_0x66f2ba),_0x3ed438[_0x398e07(0x4e2,0x4e2,0x4fa,0x4e8)](0x51f*0x1+-0x26d+-0xbe)['json']({'success':![],'message':'更新留言状态失败'})):(console['error'](_0x398e07(0x502,0x4d7,0x52d,0x50c),_0x2025de),_0x5534a6[_0x398e07(0x4e2,0x50c,0x4be,0x4fb)](0x5f*0x11+0x17f*-0x19+0xf*0x234)['json']({'success':![],'message':_0x18bbcb(0x16d,0x146,0x14b,0x191)}));}});function _0x_0x4f7064(_0x8e49f3,_0x599569,_0x126e8f,_0x4ca250){return _0x_0x3ad6(_0x126e8f- -0x2f1,_0x4ca250);}router[_0x_0x115cc1(0x4a,-0x8,0x2d,0x21)]('/',async(_0x163e4f,_0xdd4d44)=>{const _0x327357=await sequelize[_0x5557e6(0x53a,0x551,0x52b,0x511)]();function _0x5557e6(_0x4c3385,_0x5e9a53,_0xa27bee,_0x14866f){return _0x_0x4f7064(_0x4c3385-0x26,_0x5e9a53-0x177,_0x4c3385-0x69f,_0x14866f);}function _0x493f89(_0x144089,_0x970d20,_0x4c3b70,_0x39c9cd){return _0x_0x4f7064(_0x144089-0x10a,_0x970d20-0x132,_0x39c9cd-0x179,_0x4c3b70);}try{const {name:_0xd182b7,contact:_0x8e2bc9,category_id:_0xcb5de9,content:_0xc81264,attachments:_0x578b5f,captcha:_0x208cd6}=_0x163e4f['body'],_0x427ff1=getClientIP(_0x163e4f),_0x53c763=_0x163e4f[_0x5557e6(0x4f2,0x4fa,0x4f7,0x4cd)](_0x493f89(-0x3b,-0x1e,-0x37,-0x38));if(!_0xd182b7||!_0x8e2bc9||!_0xc81264)return _0x5557e6(0x52e,0x555,0x504,0x505)===_0x5557e6(0x52e,0x557,0x508,0x509)?_0xdd4d44[_0x493f89(-0x44,-0x54,-0x2e,-0x31)](0x2*0x90d+0xad*-0x15+-0x259)[_0x493f89(0x15,0x1,-0x28,-0xf)]({'success':![],'message':_0x493f89(0x15,0x14,-0x2b,-0xe)}):_0x572738[_0x5557e6(0x4f5,0x4f4,0x4ce,0x4f0)](-0x1fe+0x1343+0x4*-0x3e6)['json']({'success':![],'message':_0x48611c[_0x493f89(-0x29,-0x1,-0x8,-0x24)]});if(!_0x208cd6||!_0x208cd6['id']||!_0x208cd6[_0x5557e6(0x527,0x500,0x50f,0x508)])return _0x493f89(0xe,-0xb,0xc,0x9)===_0x493f89(-0x13,-0x25,-0xc,-0x14)?_0x3e5037['status'](-0x1e*-0xbc+-0x3*-0x5c2+-0x25be)[_0x493f89(-0x1d,-0x5,-0x1c,-0xf)]({'success':![],'message':_0x5557e6(0x4e9,0x4ce,0x4e8,0x503)}):_0xdd4d44[_0x493f89(-0xf,-0x26,-0x1c,-0x31)](-0x1046+-0xe*0x1b4+0x29ae)[_0x493f89(0x3,-0x18,-0x3,-0xf)]({'success':![],'message':_0x5557e6(0x526,0x501,0x54a,0x54a)});if(!validateCaptcha(_0x208cd6['id'],_0x208cd6[_0x493f89(0x22,0x13,0x8,0x1)])){if(_0x5557e6(0x4f7,0x4ed,0x50b,0x50f)===_0x5557e6(0x4f7,0x4fe,0x511,0x50f))return _0xdd4d44[_0x5557e6(0x4f5,0x4f1,0x51f,0x4fd)](0x6b1+0xb93*0x1+0x42d*-0x4)[_0x5557e6(0x517,0x4f7,0x513,0x4ff)]({'success':![],'message':'验证码错误或已过期'});else console[_0x5557e6(0x4f3,0x4f6,0x4d5,0x4c9)]('获取留言详情失败:',_0x3396ac),_0x2833d1[_0x5557e6(0x4f5,0x4ed,0x4e7,0x4ce)](-0x189+0x1426+-0x10a9)['json']({'success':![],'message':'获取留言详情失败'});}const _0x1e94a0=await checkIPLimit(_0x427ff1);if(!_0x1e94a0[_0x5557e6(0x50f,0x52c,0x522,0x532)])return _0xdd4d44[_0x5557e6(0x4f5,0x4d4,0x4fa,0x4fc)](0x4b*-0x58+0x72*-0xd+-0xb15*-0x3)[_0x493f89(-0x27,-0x13,-0x1b,-0xf)]({'success':![],'message':_0x1e94a0[_0x493f89(-0xc,-0x47,-0x4b,-0x24)]});const _0x1e7f16=await Message[_0x5557e6(0x4fd,0x50f,0x524,0x500)]({'name':_0xd182b7,'contact':_0x8e2bc9,'category_id':_0xcb5de9||null,'content':_0xc81264,'attachments':_0x578b5f?JSON['stringify'](_0x578b5f):null,'ip_address':_0x427ff1,'user_agent':_0x53c763,'status':_0x493f89(0x6,-0x3f,-0x47,-0x25)},{'transaction':_0x327357});await recordIPSubmission(_0x427ff1);if(sendMessageNotification){if(_0x493f89(-0x2c,-0x3b,-0x8,-0x23)!==_0x5557e6(0x4f9,0x4e3,0x4eb,0x4e8)){const _0x254bb1=_0xcb5de9?await getCategoryName(_0xcb5de9):_0x5557e6(0x4fc,0x4d6,0x524,0x50e);sendMessageNotification({..._0x1e7f16[_0x493f89(-0x17,-0x15,0x0,-0x13)](),'created_at':_0x1e7f16['created_at']},_0x254bb1)[_0x5557e6(0x500,0x503,0x4dc,0x526)](_0x1e25fd=>{function _0x51f500(_0x4fb101,_0x3db614,_0xdbf034,_0x4c963f){return _0x493f89(_0x4fb101-0x124,_0x3db614-0x92,_0x4c963f,_0x4fb101-0x3cd);}console['error'](_0x51f500(0x3bd,0x392,0x3bc,0x39c),_0x1e25fd);});}else console[_0x5557e6(0x4f3,0x4f4,0x503,0x4f3)]('获取留言失败:',_0x1d324c),_0x10e65b[_0x493f89(-0x20,-0x12,-0x48,-0x31)](0x1cab+0x1*-0x6f1+0x13c6*-0x1)[_0x493f89(-0x2d,-0x3b,-0x1b,-0xf)]({'success':![],'message':_0x5557e6(0x507,0x50d,0x4f7,0x51e)});}await _0x327357[_0x493f89(0x3b,0x23,0x37,0x13)](),_0xdd4d44[_0x493f89(-0x1f,-0x41,-0x7,-0x31)](-0xf8a*-0x1+0x5*0x660+0xad*-0x45)[_0x5557e6(0x517,0x538,0x53a,0x522)]({'success':!![],'message':_0x493f89(-0x32,-0x61,-0x4d,-0x3c),'data':{'id':_0x1e7f16['id']}});}catch(_0x5cf613){if(_0x493f89(0x2,-0xc,-0x10,-0x12)!=='dVgEr'){const _0x5d269=_0x31dcdf[_0x5557e6(0x4eb,0x4ec,0x4d2,0x50b)](_0x54b3e9,arguments);return _0x55a7e9=null,_0x5d269;}else await _0x327357[_0x493f89(0x41,0x2f,-0x8,0x16)](),console['error'](_0x493f89(-0x26,0x28,-0xe,0x2),_0x5cf613),_0xdd4d44[_0x493f89(-0x51,-0x16,-0x4b,-0x31)](-0xab2+-0x80d+-0x2f5*-0x7)[_0x493f89(-0x1d,-0x15,-0x21,-0xf)]({'success':![],'message':_0x493f89(0x33,0x19,0x4,0xa)});}}),router['put']('/:id/status',authenticateToken,async(_0x1a7e9c,_0x34b592)=>{function _0x182ecb(_0x12003e,_0x473422,_0x4fec7f,_0x4aab0c){return _0x_0x115cc1(_0x12003e-0xd9,_0x473422,_0x4fec7f-0x198,_0x12003e- -0x237);}function _0x4aebc5(_0x2234bd,_0x4be2dc,_0x221780,_0x1d394d){return _0x_0x115cc1(_0x2234bd-0x1a9,_0x2234bd,_0x221780-0x10c,_0x4be2dc-0x40b);}try{const {id:_0x4d3dee}=_0x1a7e9c[_0x4aebc5(0x408,0x426,0x44e,0x425)],{status:_0x24588b}=_0x1a7e9c[_0x182ecb(-0x251,-0x271,-0x241,-0x232)];if(!['pending','read','replied'][_0x182ecb(-0x24b,-0x26a,-0x231,-0x26f)](_0x24588b))return _0x34b592[_0x4aebc5(0x407,0x3ee,0x40c,0x3e6)](-0x8b1*-0x1+0x2e*-0xba+0x1a4b)[_0x4aebc5(0x406,0x410,0x3ed,0x41c)]({'success':![],'message':_0x182ecb(-0x260,-0x235,-0x25e,-0x26d)});const _0x3459f4=await Message[_0x182ecb(-0x23f,-0x242,-0x22d,-0x23e)](_0x4d3dee);if(!_0x3459f4)return _0x34b592['status'](-0xcd+0x45*-0x50+-0x2a9*-0x9)[_0x4aebc5(0x412,0x410,0x424,0x3f9)]({'success':![],'message':_0x182ecb(-0x218,-0x229,-0x1ee,-0x229)});_0x3459f4[_0x4aebc5(0x3e5,0x3ee,0x3f0,0x3d7)]=_0x24588b,await _0x3459f4[_0x4aebc5(0x421,0x407,0x3fa,0x428)](),_0x34b592['json']({'success':!![],'message':_0x4aebc5(0x41c,0x436,0x451,0x453),'data':_0x3459f4});}catch(_0x1fc001){console['error'](_0x182ecb(-0x238,-0x21a,-0x249,-0x22f),_0x1fc001),_0x34b592[_0x4aebc5(0x409,0x3ee,0x3f7,0x3f5)](0x1102+0xf*-0x22b+0x1177)['json']({'success':![],'message':_0x4aebc5(0x3ff,0x417,0x428,0x3ed)});}}),router[_0x_0x115cc1(0x41,0x33,0x45,0x26)](_0x_0x115cc1(-0xe,-0x27,-0x33,-0xc),authenticateToken,async(_0x22951a,_0x34c289)=>{function _0x21c846(_0x4d301f,_0xddad49,_0x35ff80,_0x13e4d0){return _0x_0x115cc1(_0x4d301f-0x89,_0x4d301f,_0x35ff80-0xb1,_0x13e4d0- -0x64);}function _0x9bc5d6(_0x5c421d,_0x309f23,_0x2fb3fc,_0x332aad){return _0x_0x4f7064(_0x5c421d-0x163,_0x309f23-0x12,_0x309f23-0x68b,_0x2fb3fc);}try{if(_0x21c846(-0x51,-0x4a,-0x56,-0x5c)!==_0x21c846(-0x2e,-0x82,-0x56,-0x59)){const {id:_0x28cfe6}=_0x22951a['params'],_0x3e7e62=await Message['findByPk'](_0x28cfe6);if(!_0x3e7e62)return _0x34c289['status'](-0x2314+0x1efe+0x5aa)[_0x21c846(-0x78,-0x70,-0x68,-0x5f)]({'success':![],'message':'留言不存在'});await _0x3e7e62['destroy'](),_0x34c289[_0x21c846(-0x60,-0x5a,-0x5f,-0x5f)]({'success':!![],'message':_0x9bc5d6(0x4ef,0x4e0,0x507,0x4fd)});}else return _0xa21430['status'](-0x19c1+-0x20a5*-0x1+-0x554)[_0x9bc5d6(0x52a,0x503,0x514,0x4fe)]({'success':![],'message':_0x21c846(-0x86,-0x60,-0x5c,-0x7b)});}catch(_0x3d6b5e){if('cFldo'!==_0x9bc5d6(0x50a,0x522,0x545,0x4fa))console[_0x9bc5d6(0x4dc,0x4df,0x4de,0x4ca)]('删除留言失败:',_0x3d6b5e),_0x34c289['status'](0x16aa+-0x5*-0x4cd+-0x2cb7)[_0x21c846(-0x47,-0x8a,-0x83,-0x5f)]({'success':![],'message':_0x21c846(-0xac,-0x7a,-0x7a,-0x87)});else return _0x8e7ac2[_0x9bc5d6(0x4c7,0x4e1,0x4f4,0x4f2)](-0x1*-0xf1b+0xb1*-0xc+-0x53b)[_0x9bc5d6(0x51e,0x503,0x52d,0x4fd)]({'success':![],'message':_0x9bc5d6(0x539,0x51d,0x521,0x501)});}}),module[_0x_0x4f7064(-0x19c,-0x169,-0x17a,-0x19f)]=router;