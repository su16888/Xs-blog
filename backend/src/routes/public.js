(function(_0x1732b0,_0xf78a73){function _0x2be9ab(_0x3438cc,_0x230be2,_0xc09090,_0x11d475){return _0x_0x3fe0(_0xc09090-0x3a6,_0x3438cc);}function _0xb9bc40(_0x1ec689,_0x5e08f8,_0x8091b0,_0x12438a){return _0x_0x3fe0(_0x1ec689- -0xbd,_0x8091b0);}const _0x330bca=_0x1732b0();while(!![]){try{const _0x59a9e3=parseInt(_0xb9bc40(0x35,0x11,0x24,0x36))/(-0x2410+0x1*-0x7c9+0x2bda)*(-parseInt(_0x2be9ab(0x4bb,0x4a1,0x499,0x494))/(-0x1377+0x1*0x26b0+-0x1337))+parseInt(_0x2be9ab(0x4c5,0x47a,0x49f,0x49d))/(0xb*0x16a+0x2511+0x7*-0x784)*(parseInt(_0x2be9ab(0x4a6,0x4b2,0x4bd,0x4a2))/(-0x306+-0xb9e*-0x3+-0x1fd0))+-parseInt(_0x2be9ab(0x4cf,0x495,0x4b8,0x4d2))/(0x48*-0x1a+-0x1*-0x21fa+-0x1aa5)+-parseInt(_0x2be9ab(0x4cf,0x4a4,0x4c1,0x4bc))/(-0x176e*0x1+-0x16ee+0x2e62)*(parseInt(_0xb9bc40(0x6b,0x3f,0x6a,0x92))/(0xe8f+0xd9*0x2+0x81d*-0x2))+parseInt(_0x2be9ab(0x4e9,0x51f,0x4ef,0x4c1))/(0x3*-0x166+-0x463*-0x3+-0x8ef)*(parseInt(_0xb9bc40(0x89,0x59,0x60,0x8a))/(0x50a+0x1a80+-0x1*0x1f81))+parseInt(_0x2be9ab(0x4cb,0x4ae,0x4a1,0x49c))/(-0x2*0x106f+0x152f*-0x1+0x3617)*(-parseInt(_0xb9bc40(0x80,0x5f,0x66,0xb0))/(0x1892+0x23c6*-0x1+0xb3f))+parseInt(_0xb9bc40(0x3d,0x1e,0x19,0x3d))/(-0x1699+-0x5d*-0x30+0x535);if(_0x59a9e3===_0xf78a73)break;else _0x330bca['push'](_0x330bca['shift']());}catch(_0x38522f){_0x330bca['push'](_0x330bca['shift']());}}}(_0x_0x9772,0x1*-0x73327+-0x73370+-0x1*-0x19098a));function _0x_0x2ba6ff(_0x2993c9,_0x4f4d61,_0x4adaca,_0x5ab916){return _0x_0x3fe0(_0x2993c9-0x313,_0x4adaca);}const _0x_0x2ab2fc=(function(){let _0xdaec20=!![];return function(_0x397e8b,_0x35e91a){const _0x5225bd=_0xdaec20?function(){function _0x42649e(_0x3085e5,_0x3b4ea7,_0x1474bf,_0x46a6dc){return _0x_0x3fe0(_0x3b4ea7-0x224,_0x3085e5);}if(_0x35e91a){const _0x5758a4=_0x35e91a[_0x42649e(0x363,0x349,0x345,0x364)](_0x397e8b,arguments);return _0x35e91a=null,_0x5758a4;}}:function(){};return _0xdaec20=![],_0x5225bd;};}()),_0x_0x52d24b=_0x_0x2ab2fc(this,function(){function _0x45ae48(_0x55b401,_0x6867ec,_0x3512f4,_0x320ebd){return _0x_0x3fe0(_0x55b401-0x162,_0x6867ec);}function _0x5d6902(_0x58a5b4,_0x25a222,_0x379c79,_0x291c43){return _0x_0x3fe0(_0x58a5b4- -0x316,_0x291c43);}return _0x_0x52d24b[_0x5d6902(-0x21e,-0x229,-0x22a,-0x222)]()[_0x5d6902(-0x22d,-0x22d,-0x227,-0x219)](_0x5d6902(-0x1de,-0x1c7,-0x1b5,-0x1fa))['toString']()['constructor'](_0x_0x52d24b)[_0x5d6902(-0x22d,-0x206,-0x203,-0x217)](_0x45ae48(0x29a,0x295,0x28d,0x2af));});_0x_0x52d24b();const express=require('express'),router=express[_0x_0x14548f(-0x267,-0x27f,-0x25a,-0x297)](),settingController=require('../controllers/settingController'),profileController=require('../controllers/profileController');function _0x_0x14548f(_0x46784e,_0x3c9179,_0x2f8540,_0x358ebe){return _0x_0x3fe0(_0x3c9179- -0x373,_0x46784e);}function _0x_0x3fe0(_0x446267,_0x47d47b){const _0x467234=_0x_0x9772();return _0x_0x3fe0=function(_0x4b6283,_0x1b9ca9){_0x4b6283=_0x4b6283-(0x551*-0x1+0x118b+-0xb51);let _0x4f3c88=_0x467234[_0x4b6283];if(_0x_0x3fe0['KGFvOv']===undefined){var _0x24f196=function(_0x4f8c0a){const _0x518c0f='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x2d7eed='',_0x269348='',_0x219fa1=_0x2d7eed+_0x24f196;for(let _0x5567f3=-0xd44*-0x1+-0x2100+0x13bc,_0x57bc4b,_0x350f99,_0x18939f=0xafe+-0x1932+-0x194*-0x9;_0x350f99=_0x4f8c0a['charAt'](_0x18939f++);~_0x350f99&&(_0x57bc4b=_0x5567f3%(-0x9f3+0x17f4+-0xdfd*0x1)?_0x57bc4b*(0xc2a+0x2*-0x110+0x7*-0x166)+_0x350f99:_0x350f99,_0x5567f3++%(0x29*-0x2b+-0x20f1+0x32*0xcc))?_0x2d7eed+=_0x219fa1['charCodeAt'](_0x18939f+(0x204c+0x1d1c+-0x3d5e))-(0x1*0xc97+0x20cb+0x2*-0x16ac)!==-0x97e+-0x1*0x12ab+-0x10b*-0x1b?String['fromCharCode'](0x95+0x1784+-0x171a&_0x57bc4b>>(-(0x17fb+-0x2*0x93f+0x57b*-0x1)*_0x5567f3&0x658+-0x2106*0x1+0x1ab4)):_0x5567f3:0x1647+0xefb*0x1+-0x1*0x2542){_0x350f99=_0x518c0f['indexOf'](_0x350f99);}for(let _0x399c7e=0x255+-0x1*-0x1095+-0x12ea,_0xa9d23d=_0x2d7eed['length'];_0x399c7e<_0xa9d23d;_0x399c7e++){_0x269348+='%'+('00'+_0x2d7eed['charCodeAt'](_0x399c7e)['toString'](0x56*0x2+-0xa1*-0x19+-0x1055))['slice'](-(-0x196d*-0x1+-0x1*0x3f3+-0x1578));}return decodeURIComponent(_0x269348);};_0x_0x3fe0['NWHXmx']=_0x24f196,_0x446267=arguments,_0x_0x3fe0['KGFvOv']=!![];}const _0x37834e=_0x467234[0x2d3*0x1+0xcb3*-0x2+0x1693*0x1],_0x1eeb3c=_0x4b6283+_0x37834e,_0x27a6f0=_0x446267[_0x1eeb3c];if(!_0x27a6f0){const _0x3c0248=function(_0x481dc4){this['dXfcxh']=_0x481dc4,this['npvojj']=[0x1fe4*-0x1+-0x1f08+0x3eed,-0x1b8d+-0x11*-0x122+0x84b,-0xd34+0xd*-0x3d+-0x3*-0x56f],this['SmEEEP']=function(){return'newState';},this['pHsMEQ']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['mANXcO']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x3c0248['prototype']['ljFMdM']=function(){const _0x1bd43b=new RegExp(this['pHsMEQ']+this['mANXcO']),_0x158c9a=_0x1bd43b['test'](this['SmEEEP']['toString']())?--this['npvojj'][0x10d9*0x1+0x1*-0x21d+-0xebb*0x1]:--this['npvojj'][0x247b*-0x1+-0x90*0x2c+0x3d3b];return this['SzPXrk'](_0x158c9a);},_0x3c0248['prototype']['SzPXrk']=function(_0x1f5a2d){if(!Boolean(~_0x1f5a2d))return _0x1f5a2d;return this['rDVwJF'](this['dXfcxh']);},_0x3c0248['prototype']['rDVwJF']=function(_0x40c51f){for(let _0x4117d0=0x1*-0x305+0x1a5*0x7+0x1*-0x87e,_0x5c0078=this['npvojj']['length'];_0x4117d0<_0x5c0078;_0x4117d0++){this['npvojj']['push'](Math['round'](Math['random']())),_0x5c0078=this['npvojj']['length'];}return _0x40c51f(this['npvojj'][-0x1375+0x1*0x1eb3+-0xb3e]);},new _0x3c0248(_0x_0x3fe0)['ljFMdM'](),_0x4f3c88=_0x_0x3fe0['NWHXmx'](_0x4f3c88),_0x446267[_0x1eeb3c]=_0x4f3c88;}else _0x4f3c88=_0x27a6f0;return _0x4f3c88;},_0x_0x3fe0(_0x446267,_0x47d47b);}const socialLinkController=require('../controllers/socialLinkController'),siteController=require('../controllers/siteController'),noteController=require('../controllers/noteController'),metadataRoutes=require('./metadata'),{generateCaptcha,validateCaptcha}=require('../utils/captcha'),Message=require('../models/Message'),MessageCategory=require('../models/MessageCategory'),{sequelize}=require('../config/database'),{checkIPLimit,recordIPSubmission}=require('../utils/ipLimit'),{sendMessageNotification}=require('../utils/email'),{getClientIP,isValidIP,isPrivateIP}=require('../utils/ipHelper');function _0x_0x9772(){const _0x3a5948=['y3jLyxrL','l21LDgfKyxrH','ntm0mJK5mffstwvJuW','DxnL','rvLxzMK','y291BNrYEq','BwvZC2fNzq','ngnRrLvera','l21LC3nHz2uTy2f0zwDVCMLLCW','55sF5OIq6AQm6k+b56cb5AsX6lsLoG','6AQm6k+b56cb6zsz6k+V5OIw5BEY6l+h5PYF','mZaWote4weXHs2rK','Cg9ZDa','C3rYAw5NAwz5','y2L0Eq','vxnLCI1bz2vUDa','CMvNAw9UtMfTzq','l25VDgvZlZPPzc9KAxnRCW','5PYQ5yIg57g7','ChvstwC','DhjHBNnHy3rPB24','yxbWBhK','l2nSAwvUDc1PCa','C3rHDhvZ','mtrYBM9fweS','l3nVy2LHBc1SAw5RCW','55sF5OIq6AQm6k+b56cb5AsX6lsL','qvnd','CgvUzgLUzW','l3nPDgvZ','6i635y+w5A6I5OI356UVsvdLPlhOTku6','z2v0uhvIBgLJu2v0DgLUz3m','vgfKELq','l2nHChrJAge','yM9KEq','z2v0uhvIBgLJu2v0DgLUzW','Ahr0Chm6lY9PCgfWAs5JBY8','l25VDgvZ','BMXdquy','BwXpr2q','kcGOlISPkYKRksSK','zMLUzefSBa','zLv1thq','z2v0u2L0zxnhCM91CgvKqNLdyxrLz29YEq','ywHQueW','mZe5DvffENfZ','z2v0uhvIBgLJtM90zxm','AgPAvuK','CM9SBgjHy2S','vKLyDem','6i635y+w55wz6kIa5yIg57g75AsX6lsL','5O+q5lQK55wz6kIa5AsX6lsL','v1n5svy','5y+r6ycb6ykU5lU26ycA55+L5AsX6lsLoG','ovn6DfHNwG','zMLUzej5ugS','C3vJy2vZCW','mZq5otu5mMzrB3btqq','y291BNrYEv9Uyw1L','5AEt5zcn44cb6igu57o75PA55BYp5zkm5yAf5A655lIn6io95lI656M6','C2vHCMnO','z2v0uhvIBgLJu2L0zxm','zxjYB3i','wxbsuuq','6i635y+w55wz6kIa5yIg57g75AsX6lsLoG','z2v0uhvIBgLJtM90zvrHz1n0yxrZ','6i635y+w5yIg57g75zcn56EW5AsX6lsLoG','CMvNAw9U','BuT0zuy','ndy2mZa5thHuzMzz','ngHRtxPRzq','uM91DgvY','ANnVBG','l3nPDgvZl2DYB3vWzwqVyNKTy2f0zwDVCNK','shbpzem','Dg9tDhjPBMC','mZqYodC4n3v6AfDywa','mtG0mdu1nJrkwgTRuhG','mta4odiWEfjfBNbn','CxHKuLe','Dgv4Da','Bg9N','z2v0','y29TBwL0','z2v0uhvIBgLJuhjVzMLSzq','C29YDf9VCMrLCG','l3nLDhrPBMDZlZPRzxK','55wz6kIa5O+q5lQK5OIq5yQF77Ym5OIr5lUS5lYA5Bc95B+R5Ase55cg','6AQm6k+b56cb5lIn6io95lI656M6','ywXSB3DLza','y2f0y2G','5PQc5PEG5Rov6i635y+w','BMfTzq','6i635y+w5A6I5OI356UVsvdLPlhOTku','tNbSCKO','DMvYAwz5tM90zvbHC3n3B3jK','ywzbu2S','Dg9ku09o','5lI76kAbsvdMN6xOR6lMNi3LIQhLPlhOTkxVViZLSj3OR5xLPiFNLkJMNi3LIQe6'];_0x_0x9772=function(){return _0x3a5948;};return _0x_0x9772();}router['get']('/settings',settingController[_0x_0x14548f(-0x256,-0x244,-0x24b,-0x242)]),router['get'](_0x_0x2ba6ff(0x416,0x3f3,0x41f,0x3e8),settingController[_0x_0x2ba6ff(0x446,0x428,0x41c,0x419)]),router['get']('/profile',profileController[_0x_0x2ba6ff(0x414,0x408,0x439,0x433)]),router['get'](_0x_0x14548f(-0x219,-0x24a,-0x24e,-0x261),socialLinkController['getPublicSocialLinks']),router[_0x_0x14548f(-0x298,-0x274,-0x282,-0x286)](_0x_0x2ba6ff(0x440,0x411,0x467,0x451),siteController[_0x_0x2ba6ff(0x3fd,0x425,0x3ee,0x3cf)]),router[_0x_0x2ba6ff(0x412,0x414,0x405,0x3ee)](_0x_0x14548f(-0x266,-0x27d,-0x291,-0x2a5),siteController[_0x_0x14548f(-0x22e,-0x238,-0x210,-0x258)]),router[_0x_0x2ba6ff(0x412,0x43f,0x42a,0x42b)](_0x_0x2ba6ff(0x448,0x460,0x46a,0x458),noteController[_0x_0x2ba6ff(0x451,0x458,0x454,0x46a)]),router[_0x_0x2ba6ff(0x412,0x410,0x41d,0x3e1)]('/notes/categories/list',noteController['getNoteCategories']),router[_0x_0x14548f(-0x255,-0x274,-0x260,-0x292)]('/notes/tags/stats',noteController[_0x_0x14548f(-0x27a,-0x285,-0x295,-0x29b)]),router[_0x_0x14548f(-0x29a,-0x274,-0x283,-0x26f)]('/notes/:id',noteController['getPublicNoteById']),router[_0x_0x2ba6ff(0x42f,0x41e,0x400,0x450)]('/notes/:id/verify',noteController[_0x_0x14548f(-0x250,-0x267,-0x238,-0x272)]),router[_0x_0x14548f(-0x26f,-0x274,-0x24f,-0x26e)](_0x_0x2ba6ff(0x434,0x44c,0x416,0x416),noteController['getPublicNoteDisks']),router['get'](_0x_0x2ba6ff(0x42b,0x426,0x40f,0x41b),async(_0x10d3c1,_0x546cd8)=>{function _0x4d0c95(_0x1df295,_0x24aee5,_0x501d91,_0x142604){return _0x_0x14548f(_0x142604,_0x1df295-0x12,_0x501d91-0x12f,_0x142604-0x29);}function _0x306795(_0x36c42c,_0x903270,_0x57b637,_0x1d729b){return _0x_0x14548f(_0x36c42c,_0x903270- -0x5b,_0x57b637-0x108,_0x1d729b-0x156);}try{const _0x1979cc=await MessageCategory[_0x4d0c95(-0x228,-0x1fb,-0x21f,-0x24b)]({'order':[[_0x306795(-0x2a2,-0x2cc,-0x2f9,-0x2af),_0x306795(-0x289,-0x2a3,-0x2c7,-0x27b)],[_0x4d0c95(-0x258,-0x26c,-0x236,-0x249),'ASC']]});_0x546cd8[_0x306795(-0x2d8,-0x2d9,-0x2e6,-0x2b6)]({'success':!![],'data':_0x1979cc});}catch(_0x4a6578){console['error'](_0x4d0c95(-0x274,-0x2a3,-0x293,-0x265),_0x4a6578),_0x546cd8[_0x4d0c95(-0x23a,-0x255,-0x238,-0x256)](0x143+0x1dcb+-0x2e9*0xa)['json']({'success':![],'message':_0x306795(-0x25c,-0x28c,-0x296,-0x262)});}});async function getCategoryName(_0x59b6ea){function _0x20c695(_0x45448f,_0x15f5aa,_0x5108c4,_0x493256){return _0x_0x14548f(_0x15f5aa,_0x5108c4-0x6e6,_0x5108c4-0xc6,_0x493256-0x91);}function _0x197c06(_0x52613d,_0x4fb7ec,_0x1c76d8,_0x25f125){return _0x_0x14548f(_0x25f125,_0x52613d-0x4b4,_0x1c76d8-0x161,_0x25f125-0x40);}try{const _0x1ae84b=await MessageCategory[_0x20c695(0x4a0,0x48a,0x4ba,0x4af)](_0x59b6ea);return _0x1ae84b?_0x1ae84b[_0x20c695(0x466,0x44c,0x47c,0x47a)]:_0x197c06(0x263,0x276,0x250,0x284);}catch(_0x396a2f){return console[_0x197c06(0x22c,0x246,0x251,0x24c)](_0x20c695(0x445,0x43a,0x462,0x438),_0x396a2f),'未分类';}}router['post']('/messages',async(_0x43a928,_0x1b2d83)=>{function _0x2fc200(_0x34053f,_0x1194e1,_0x22bd4a,_0x391a7f){return _0x_0x2ba6ff(_0x22bd4a- -0x3a9,_0x1194e1-0x6f,_0x1194e1,_0x391a7f-0xa3);}const _0x1b38e4=await sequelize[_0x331f4f(-0x133,-0x139,-0x12e,-0x12f)]();function _0x331f4f(_0x48b86f,_0x2bbb51,_0x8ff5c1,_0x5fd46f){return _0x_0x14548f(_0x2bbb51,_0x8ff5c1-0x121,_0x8ff5c1-0x1ba,_0x5fd46f-0xb4);}try{if(_0x2fc200(0x80,0x84,0x8d,0x84)===_0x2fc200(0x8b,0x88,0xae,0xb5)){const _0x13afe4=_0x4cec6c?function(){function _0x25e111(_0x31dfaa,_0x53b191,_0x441b30,_0x219148){return _0x331f4f(_0x31dfaa-0x4,_0x53b191,_0x441b30-0x240,_0x219148-0x36);}if(_0x2d1822){const _0x4fdf07=_0x5573c9[_0x25e111(0x13e,0x116,0x113,0x126)](_0x3d3537,arguments);return _0x27487e=null,_0x4fdf07;}}:function(){};return _0x3e898c=![],_0x13afe4;}else{const {name:_0x53c69f,contact:_0x38e992,category_id:_0x2aed91,content:_0x55e911,attachments:_0x36d5b0,captcha:_0x1767f0}=_0x43a928[_0x331f4f(-0xf0,-0x12a,-0x120,-0x10e)],_0x3956d5=getClientIP(_0x43a928),_0x253046=_0x43a928[_0x331f4f(-0x13a,-0x149,-0x153,-0x13f)](_0x331f4f(-0x110,-0x15d,-0x133,-0x14e));if(!_0x53c69f||!_0x38e992||!_0x55e911)return _0x1b2d83[_0x331f4f(-0x116,-0x107,-0x12b,-0x144)](-0x9ad*0x4+0x91+0x27b3)[_0x331f4f(-0x12d,-0x165,-0x15d,-0x17b)]({'success':![],'message':_0x331f4f(-0x12e,-0x11a,-0x107,-0xd7)});if(!_0x1767f0||!_0x1767f0['id']||!_0x1767f0[_0x331f4f(-0x12c,-0x14e,-0x155,-0x17f)])return _0x1b2d83['status'](0x7c+-0x1044+0x1158)[_0x2fc200(0x2f,0x83,0x5f,0x75)]({'success':![],'message':_0x331f4f(-0x14b,-0x172,-0x14d,-0x122)});if(!validateCaptcha(_0x1767f0['id'],_0x1767f0['text']))return _0x1b2d83[_0x2fc200(0x8e,0x94,0x91,0xa0)](0x1c42+-0x67*-0x59+-0x3e81)['json']({'success':![],'message':'验证码错误或已过期'});const _0x5d5703=await checkIPLimit(_0x3956d5);if(!_0x5d5703[_0x2fc200(0x4d,0x99,0x70,0x56)])return _0x1b2d83[_0x331f4f(-0x151,-0x151,-0x12b,-0x150)](-0x1d3*-0x2+0x49*0xb+-0x51c)[_0x331f4f(-0x15d,-0x15f,-0x15d,-0x132)]({'success':![],'message':_0x5d5703[_0x331f4f(-0x142,-0x16c,-0x13c,-0x11d)]});const _0x2c549c=await Message[_0x331f4f(-0x174,-0x13a,-0x142,-0x130)]({'name':_0x53c69f,'contact':_0x38e992,'category_id':_0x2aed91||null,'content':_0x55e911,'attachments':_0x36d5b0?JSON[_0x331f4f(-0x11f,-0x10d,-0x135,-0x150)](_0x36d5b0):null,'ip_address':_0x3956d5,'user_agent':_0x253046,'status':_0x2fc200(0x65,0x8d,0x96,0x9d)},{'transaction':_0x1b38e4});await recordIPSubmission(_0x3956d5);if(sendMessageNotification){const _0x23220d=_0x2aed91?await getCategoryName(_0x2aed91):_0x2fc200(0x6c,0x7b,0x8c,0x6c);sendMessageNotification({..._0x2c549c[_0x2fc200(0x57,0x7e,0x78,0x73)](),'created_at':_0x2c549c['created_at']},_0x23220d)[_0x331f4f(-0x11f,-0x131,-0x14b,-0x157)](_0x3ea018=>{function _0x598c08(_0x11af0,_0x37d02f,_0x33a14a,_0x316311){return _0x2fc200(_0x11af0-0xaf,_0x316311,_0x37d02f-0x307,_0x316311-0x91);}function _0x53e6ef(_0x383a68,_0x18570e,_0x41c63f,_0xc16867){return _0x2fc200(_0x383a68-0x13e,_0x18570e,_0xc16867- -0x6,_0xc16867-0x198);}if(_0x598c08(0x389,0x37c,0x37e,0x35b)!=='NplrJ'){const _0x18ba60=_0x42e0e5();_0x5e3ac9[_0x53e6ef(0x57,0x2f,0x6d,0x59)]({'success':!![],'data':{'id':_0x18ba60['id'],'svg':_0x18ba60['data']}});}else console[_0x598c08(0x32f,0x35c,0x344,0x378)](_0x598c08(0x399,0x3b6,0x393,0x3a5),_0x3ea018);});}await _0x1b38e4[_0x331f4f(-0x184,-0x14f,-0x152,-0x170)](),_0x1b2d83[_0x331f4f(-0xf9,-0x147,-0x12b,-0x109)](0x2290+-0xf28*-0x1+-0x30ef)[_0x2fc200(0x73,0x5a,0x5f,0x4a)]({'success':!![],'message':_0x2fc200(0x3c,0x7f,0x6e,0x5c),'data':{'id':_0x2c549c['id']}});}}catch(_0x43a2a2){await _0x1b38e4[_0x331f4f(-0x113,-0xe9,-0x112,-0x11c)](),console['error']('提交留言失败:',_0x43a2a2),_0x1b2d83[_0x2fc200(0x8f,0x89,0x91,0x76)](-0x3*0xa82+0x2*0x194+0x1*0x1e52)[_0x331f4f(-0x13c,-0x184,-0x15d,-0x13c)]({'success':![],'message':_0x331f4f(-0x141,-0x11d,-0x10f,-0x139)});}}),router[_0x_0x14548f(-0x29b,-0x274,-0x27c,-0x298)](_0x_0x14548f(-0x236,-0x242,-0x22e,-0x253),(_0x5908db,_0xf7ec00)=>{function _0x10f7fd(_0x85c042,_0x45d806,_0x477376,_0x5abfd4){return _0x_0x2ba6ff(_0x477376- -0x3c6,_0x45d806-0x109,_0x45d806,_0x5abfd4-0x1aa);}function _0x16dff6(_0x2659fc,_0x1a9da3,_0x48e058,_0x3d75c6){return _0x_0x2ba6ff(_0x3d75c6- -0x1e4,_0x1a9da3-0x84,_0x48e058,_0x3d75c6-0x154);}try{const _0x23d644=generateCaptcha();_0xf7ec00['json']({'success':!![],'data':{'id':_0x23d644['id'],'svg':_0x23d644['data']}});}catch(_0x2eee95){_0x10f7fd(0x68,0xa9,0x83,0x52)===_0x16dff6(0x22d,0x22a,0x1fe,0x22b)?_0x399b83=_0x17f0ad['country_name']+'\x20'+_0x552847[_0x16dff6(0x21a,0x244,0x203,0x21f)]:(console[_0x16dff6(0x245,0x1ff,0x237,0x21a)]('生成验证码失败:',_0x2eee95),_0xf7ec00[_0x16dff6(0x264,0x271,0x27f,0x256)](0x1230+-0x4b6+-0x5*0x24e)[_0x10f7fd(0x42,0x2a,0x42,0x49)]({'success':![],'message':_0x16dff6(0x263,0x255,0x241,0x259)}));}}),router[_0x_0x2ba6ff(0x412,0x436,0x3f2,0x439)](_0x_0x14548f(-0x243,-0x24d,-0x262,-0x25d),async(_0x203c6f,_0x339be2)=>{function _0x28b403(_0x5d9a94,_0x30bd8b,_0x58b879,_0x891b05){return _0x_0x2ba6ff(_0x5d9a94-0x69,_0x30bd8b-0x195,_0x30bd8b,_0x891b05-0x112);}function _0x508686(_0x44e0b0,_0x1dd43c,_0x1dc832,_0x1f9b36){return _0x_0x14548f(_0x1dc832,_0x44e0b0-0x437,_0x1dc832-0x194,_0x1f9b36-0x52);}try{if(_0x508686(0x1fe,0x1cf,0x21e,0x21c)!==_0x28b403(0x4ac,0x49a,0x483,0x4a7)){const _0x149209=getClientIP(_0x203c6f),_0x420146=isPrivateIP(_0x149209),_0x51b17f=isValidIP(_0x149209);let _0x537372=_0x508686(0x1cc,0x1dc,0x1e4,0x1f5),_0x211668=_0x28b403(0x484,0x481,0x4ab,0x490);if(_0x51b17f&&!_0x420146&&_0x149209!=='unknown'){if(_0x508686(0x1b0,0x1c0,0x1be,0x1d9)!==_0x28b403(0x4b3,0x482,0x486,0x4da))try{const _0x5b17b2=await fetch('http://ip-api.com/json/'+_0x149209+'?lang=zh-CN',{'timeout':0xbb8});if(_0x5b17b2['ok']){if(_0x28b403(0x4bd,0x4c4,0x496,0x48c)!==_0x28b403(0x4bb,0x4ca,0x4a1,0x4df)){const _0xe3d57d=await _0x5b17b2[_0x28b403(0x471,0x451,0x46d,0x45d)]();_0xe3d57d[_0x508686(0x1eb,0x1cb,0x1d9,0x1fa)]===_0x28b403(0x4c4,0x4bf,0x4ca,0x4ef)&&(_0x537372=_0xe3d57d['country']||_0x28b403(0x484,0x490,0x45b,0x484),_0x211668=_0xe3d57d['city']||'暂无法获取',_0xe3d57d[_0x28b403(0x49c,0x494,0x496,0x487)]&&_0xe3d57d[_0x508686(0x1e4,0x1c7,0x20b,0x1b6)]!==_0xe3d57d[_0x508686(0x1e2,0x1b5,0x1f1,0x1b1)]&&('ZoGHF'===_0x28b403(0x4b8,0x4b4,0x4a4,0x4e0)?(console[_0x508686(0x1af,0x194,0x192,0x1a7)]('获取留言分类失败:',_0x11e049),_0x16dd7f[_0x508686(0x1eb,0x1f6,0x1ba,0x1ba)](0x15*-0x55+0x784+0x169)['json']({'success':![],'message':_0x508686(0x206,0x223,0x236,0x1f2)})):_0x537372=_0xe3d57d[_0x508686(0x1d9,0x1db,0x1ec,0x1f9)]+'\x20'+_0xe3d57d[_0x28b403(0x49c,0x4ca,0x492,0x4ad)]));}else return _0x5e7a49[_0x508686(0x1eb,0x1e1,0x1ea,0x209)](-0x651+0xbae+-0x3cd)[_0x508686(0x1b9,0x1b3,0x191,0x197)]({'success':![],'message':_0x508686(0x1de,0x1c4,0x1ed,0x1cd)});}}catch(_0x92c6e7){if(_0x28b403(0x473,0x485,0x47d,0x487)==='BPePW')console[_0x508686(0x1af,0x18a,0x198,0x188)](_0x28b403(0x495,0x492,0x49d,0x48c),_0x1037ea),_0x4eb857[_0x28b403(0x4a3,0x491,0x49b,0x478)](0x1979+0xaef+-0x2274)['json']({'success':![],'message':_0x28b403(0x4a6,0x4ac,0x49d,0x4d6)});else{console[_0x508686(0x1c2,0x1e3,0x1aa,0x1b5)](_0x508686(0x1d3,0x1e3,0x1c4,0x204),_0x92c6e7[_0x28b403(0x492,0x46a,0x491,0x495)]);try{const backupResponse=await fetch(_0x508686(0x1f8,0x221,0x1d9,0x1f3)+_0x149209+'/json/',{'timeout':0xbb8});if(backupResponse['ok']){if(_0x28b403(0x46d,0x45c,0x46d,0x47d)!==_0x508686(0x1b5,0x1e0,0x1a0,0x18e))console[_0x28b403(0x467,0x495,0x482,0x45c)](_0x508686(0x1f2,0x1e9,0x1ec,0x21b),_0x446267),_0x47d47b[_0x28b403(0x4a3,0x477,0x476,0x4b2)](-0x2c7+0x4a*0x61+-0x1cb*0xd)[_0x28b403(0x471,0x45f,0x454,0x440)]({'success':![],'message':_0x508686(0x1ce,0x1c7,0x1c6,0x1fa)});else{const _0x4afbf8=await backupResponse[_0x508686(0x1b9,0x1c3,0x188,0x1e1)]();if(_0x4afbf8[_0x508686(0x1e2,0x1b0,0x1c0,0x1e9)]){_0x537372=_0x4afbf8[_0x28b403(0x4c6,0x4e9,0x4b9,0x4a5)]||_0x28b403(0x484,0x453,0x485,0x49d),_0x211668=_0x4afbf8[_0x28b403(0x49a,0x4c9,0x485,0x46b)]||_0x28b403(0x484,0x45a,0x4ab,0x47b);if(_0x4afbf8['region']&&_0x4afbf8[_0x28b403(0x46c,0x45e,0x476,0x45d)]!==_0x4afbf8[_0x508686(0x1e2,0x1b3,0x1da,0x1f1)]){if(_0x508686(0x1d1,0x1cf,0x1af,0x1ee)===_0x508686(0x1d1,0x1f2,0x1ba,0x1d6))_0x537372=_0x4afbf8[_0x28b403(0x4c6,0x4db,0x4c3,0x4a4)]+'\x20'+_0x4afbf8['region'];else return console[_0x508686(0x1af,0x191,0x191,0x1b1)](_0x28b403(0x46b,0x498,0x47d,0x452),_0x4cf527),_0x508686(0x1e6,0x1b6,0x202,0x1d7);}}}}}catch(_0x5314ee){console['log']('备用IP查询服务也失败:',_0x5314ee[_0x28b403(0x492,0x47f,0x49f,0x463)]);}}}else return _0x19967a['status'](0x3a8*0x9+-0x4f3*-0x3+-0x2e31)[_0x508686(0x1b9,0x1b7,0x1ae,0x1e1)]({'success':![],'message':_0x28b403(0x4c7,0x4a3,0x4bd,0x4d9)});}_0x339be2[_0x28b403(0x471,0x49d,0x45e,0x45c)]({'success':!![],'data':{'ip':_0x149209,'isPrivate':_0x420146,'isValid':_0x51b17f,'location':_0x537372,'city':_0x211668}});}else console[_0x508686(0x1c2,0x1e1,0x19a,0x1bf)]('备用IP查询服务也失败:',_0x4af829[_0x508686(0x1da,0x1b3,0x1f9,0x1a8)]);}catch(_0x4a3401){if(_0x28b403(0x490,0x462,0x479,0x4c0)==='EYWfi')console[_0x508686(0x1af,0x19b,0x1e0,0x1ac)](_0x28b403(0x4aa,0x48c,0x492,0x47c),_0x4a3401),_0x339be2['status'](-0x17ed+-0x7*-0x33b+0x4c*0xb)['json']({'success':![],'message':_0x28b403(0x486,0x4a6,0x490,0x47c)});else{const _0x42dee4=_0x377722[_0x28b403(0x4a1,0x49a,0x487,0x4c1)](_0x241a91,arguments);return _0x18e7ee=null,_0x42dee4;}}}),router[_0x_0x2ba6ff(0x426,0x3f7,0x42a,0x432)](_0x_0x14548f(-0x23c,-0x262,-0x248,-0x280),metadataRoutes),module['exports']=router;