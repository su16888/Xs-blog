# 快速部署指南

## 📋 版本信息

**当前版本**: V3.2.0正式版 (2025-12-17)

---

## 🎯 重要说明

### 代码状态
- ✅ **源码已准备**：可直接部署使用
- ✅ **配置灵活可修改**：通过 .env 文件可修改端口、数据库、API 地址等配置

### 部署限制
- ✅ **支持生产模式**：使用 `npm start` 启动
- ✅ **配置修改后重启生效**：修改 .env 文件后只需重启服务

## 🔧 配置方式

### 后端配置 `backend/.env`

**必须修改的配置**：
```bash
# 数据库密码（必须修改）
DB_PASSWORD=你的MySQL密码

# JWT 密钥（必须修改，生成随机32位）
JWT_SECRET=请运行命令生成随机密钥

# 后端端口（可选修改）
PORT=3001

# 授权码（必填，联系作者获取）
AUTH_CODE=向作者免费索要授权码
```

**生成随机密钥**：
```bash
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

### 前端配置 `frontend/.env.production`

**方式一：自动检测模式（推荐，前后端同服务器）**
```bash
PORT=3000
NEXT_PUBLIC_BACKEND_PORT=3001
```

**方式二：完整 URL（前后端分离部署）**
```bash
PORT=3000
NEXT_PUBLIC_API_URL=http://后端服务器IP:3001/api
```

## 🚀 启动方式


### 生产环境启动
```bash
# 启动后端
cd backend
npm install --production
npm start

# 启动前端（新终端）
cd frontend
npm install --production
npm start
```

### PM2 启动（推荐）
```bash
# 安装 PM2
npm install -g pm2

# 启动后端
cd backend
mkdir -p logs
pm2 start ecosystem.config.js

# 启动前端
cd ../frontend
mkdir -p logs
pm2 start ecosystem.config.js

# 保存配置（开机自启）
pm2 save
pm2 startup
```

## ⚠️ 重要限制说明

### 注意事项

- ❌ 使用不兼容的 Node.js 版本

### 可以执行的操作
- ✅ 修改 .env 配置文件
- ✅ 重启服务应用新配置
- ✅ 使用 PM2 管理进程
- ✅ 修改端口、数据库等配置


## 🔒 安全说明

- ✅ **配置灵活**：通过环境变量保持部署适应性
- ✅ **生产就绪**：专门为正式环境优化
- ✅ **零停机更新**：修改配置只需重启

## 📋 修改配置后的操作

### 修改后端配置后
```bash
pm2 restart xs-blog-backend
```

### 修改前端配置后
```bash
pm2 restart xs-blog-frontend
```

## 📚 详细说明

更多信息请查看以下文档：
- **部署指南.md** - 完整部署指南
- **环境变量配置指南.md** - 详细配置说明
- **常见问题解决方案.md** - 问题排查和解决方案

---

## 🚀 5分钟快速部署

### 第1步：获取源码
```bash
git clone https://github.com/su16888/Xs-blog.git
cd Xs-blog
```

### 第2步：初始化数据库
```bash
# MySQL（推荐）
mysql -u root -p -e "CREATE DATABASE xsblog888 CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"
mysql -u root -p xsblog888 < database/install.sql

# 或 SQLite
mkdir -p backend/database
sqlite3 backend/database/xsblog.db < database/install-sqlite.sql

# 或 PostgreSQL
psql -U postgres -c "CREATE DATABASE xsblog WITH ENCODING 'UTF8';"
psql -U postgres -c "CREATE USER xsblog_user WITH PASSWORD 'your_password';"
psql -U postgres -c "GRANT ALL PRIVILEGES ON DATABASE xsblog TO xsblog_user;"
psql -U xsblog_user -d xsblog -f database/install.sql
```

### 第3步：配置后端
```bash
cd backend
npm install
cp .env.example .env
# 编辑 .env 文件，修改数据库密码和JWT密钥
```

### 第4步：配置前端
```bash
cd ../frontend
npm install
# 编辑 .env.production 文件，配置API地址
```
 **ico图标替换** `frontend/public/favicon.ico`
### 第5步：启动服务
```bash
# 使用 PM2
npm install -g pm2
cd backend && pm2 start ecosystem.config.js
cd ../frontend && pm2 start ecosystem.config.js
pm2 save && pm2 startup
```

### 第6步：访问系统
- 前台：http://localhost:3000
- 后台：http://localhost:3000/admins
- 默认账号：admin / admin123

---

**版本**: V3.2.0正式版
**更新日期**: 2025-12-17