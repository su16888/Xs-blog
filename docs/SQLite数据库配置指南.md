# Xs-Blog SQLite æ•°æ®åº“é…ç½®æŒ‡å—

---



## ğŸ¯ æ•°æ®åº“ç±»å‹å¯¹æ¯”

| ç‰¹æ€§ | MySQL | SQLite |
|------|-------|--------|
| **å®‰è£…éš¾åº¦** | éœ€è¦å®‰è£… MySQL æœåŠ¡ | æ— éœ€å®‰è£…ï¼Œè‡ªåŠ¨åˆ›å»º |
| **é…ç½®å¤æ‚åº¦** | éœ€è¦é…ç½®ç”¨æˆ·ã€å¯†ç ã€æƒé™ | ä»…éœ€æŒ‡å®šæ–‡ä»¶è·¯å¾„ |
| **é€‚ç”¨åœºæ™¯** | ç”Ÿäº§ç¯å¢ƒã€é«˜å¹¶å‘ | å¼€å‘ç¯å¢ƒã€å°å‹åº”ç”¨ |
| **æ€§èƒ½** | é«˜å¹¶å‘æ€§èƒ½å¥½ | é€‚åˆä½å¹¶å‘åœºæ™¯ |
| **å¤‡ä»½** | éœ€è¦å¯¼å‡ºSQL | ç›´æ¥å¤åˆ¶æ–‡ä»¶ |
| **èµ„æºå ç”¨** | ç‹¬ç«‹è¿›ç¨‹ï¼Œå ç”¨å†…å­˜å¤š | åµŒå…¥å¼ï¼Œå ç”¨èµ„æºå°‘ |
| **æ¨èä½¿ç”¨** | ç”Ÿäº§ç¯å¢ƒ | å¼€å‘/æµ‹è¯•/å°å‹éƒ¨ç½² |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šæ–°é¡¹ç›®ä½¿ç”¨ SQLite

#### æ­¥éª¤ 1ï¼šå‡†å¤‡ç¯å¢ƒ

ç¡®ä¿æ‚¨çš„ç³»ç»Ÿå·²å®‰è£…ï¼š
- Node.js >= 18.0.0
- npm >= 9.0.0

#### æ­¥éª¤ 2ï¼šé…ç½®ç¯å¢ƒå˜é‡

ç¼–è¾‘ `backend/.env` æ–‡ä»¶ï¼š

```bash
# æ•°æ®åº“é…ç½®
DB_TYPE=sqlite                             # ä½¿ç”¨ SQLite æ•°æ®åº“
DB_PATH=./database/xsblog.db               # æ•°æ®åº“æ–‡ä»¶è·¯å¾„

```


#### æ­¥éª¤ 3ï¼šåˆå§‹åŒ–æ•°æ®åº“

ä½¿ç”¨å®˜æ–¹ schema è„šæœ¬åˆå§‹åŒ–ï¼š

```bash
# åˆ›å»ºæ•°æ®åº“ç›®å½•
cd backend
mkdir -p database

# åˆå§‹åŒ–æ•°æ®åº“ï¼ˆåŒ…å«æ‰€æœ‰è¡¨ã€ç´¢å¼•ã€åˆå§‹æ•°æ®ï¼‰
sqlite3 database/xsblog.db < ../database/install-sqlite.sql

# éªŒè¯
sqlite3 database/xsblog.db ".tables"
```

**åŒ…å«çš„å†…å®¹**ï¼š
- âœ… æ‰€æœ‰è¡¨ç»“æ„
- âœ… æ€§èƒ½ä¼˜åŒ–ç´¢å¼•
- âœ… é»˜è®¤ç®¡ç†å‘˜è´¦å·ï¼ˆadmin/admin123ï¼‰
- âœ… é»˜è®¤åˆ†ç±»æ•°æ®
- âœ… é»˜è®¤è®¾ç½®

#### æ­¥éª¤ 4ï¼šè®¿é—®ç³»ç»Ÿ

- **å‰å°å±•ç¤º**: http://localhost:3000
- **åå°ç®¡ç†**: http://localhost:3000/admins
- **é»˜è®¤è´¦å·**: `admin` / `admin123`

---

### æ–¹å¼äºŒï¼šä» MySQL è¿ç§»åˆ° SQLite

#### æ­¥éª¤ 1ï¼šå¤‡ä»½ MySQL æ•°æ®

```bash
# å¯¼å‡ºæ•°æ®
mysqldump -u root -p xsblog888 > backup.sql
```

#### æ­¥éª¤ 2ï¼šä¿®æ”¹é…ç½®

ç¼–è¾‘ `backend/.env` æ–‡ä»¶ï¼š

```bash
# å°†æ•°æ®åº“ç±»å‹æ”¹ä¸º sqlite
DB_TYPE=sqlite

# æŒ‡å®šæ•°æ®åº“æ–‡ä»¶è·¯å¾„
DB_PATH=./database/xsblog.db

# æ³¨é‡Šæ‰ MySQL ç›¸å…³é…ç½®
# DB_HOST=localhost
# DB_PORT=3306
# DB_NAME=xsblog888
# DB_USER=root
# DB_PASSWORD=your_password
```

#### æ­¥éª¤ 3ï¼šæ•°æ®è¿ç§»

**æ³¨æ„**ï¼šSQLite å’Œ MySQL çš„ SQL è¯­æ³•æœ‰å·®å¼‚ï¼Œå»ºè®®ä½¿ç”¨ä»¥ä¸‹æ–¹å¼ä¹‹ä¸€ï¼š

**æ–¹å¼ Aï¼šæ‰‹åŠ¨è¿ç§»ï¼ˆæ¨èå°æ•°æ®é‡ï¼‰**

1. ä½¿ç”¨ SQLite å¯åŠ¨ç³»ç»Ÿï¼Œä¼šè‡ªåŠ¨åˆ›å»ºè¡¨ç»“æ„
2. ä» MySQL å¯¼å‡ºæ•°æ®ä¸º CSV æˆ– JSON
3. ç¼–å†™è„šæœ¬å¯¼å…¥åˆ° SQLite

**æ–¹å¼ Bï¼šä½¿ç”¨å·¥å…·è¿ç§»**

- ä½¿ç”¨ [pgloader](https://pgloader.io/) ç­‰æ•°æ®åº“è¿ç§»å·¥å…·
- ä½¿ç”¨ [sqlalchemy](https://www.sqlalchemy.org/) ç¼–å†™è¿ç§»è„šæœ¬

---

## ğŸ“– è¯¦ç»†é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡é…ç½®

#### backend/.env

```bash
# ========================================
# SQLite æ•°æ®åº“é…ç½®
# ========================================

# æ•°æ®åº“ç±»å‹ï¼ˆå¿…é¡»è®¾ç½®ä¸º sqliteï¼‰
DB_TYPE=sqlite

# æ•°æ®åº“æ–‡ä»¶è·¯å¾„ï¼ˆå¯é€‰ï¼‰
# ç›¸å¯¹è·¯å¾„ï¼šç›¸å¯¹äº backend ç›®å½•
# ç»å¯¹è·¯å¾„ï¼šå®Œæ•´çš„æ–‡ä»¶ç³»ç»Ÿè·¯å¾„
DB_PATH=./database/xsblog.db

# ä»¥ä¸‹é…ç½®åœ¨ä½¿ç”¨ SQLite æ—¶ä¸éœ€è¦
# DB_HOST=localhost
# DB_PORT=3306
# DB_NAME=xsblog888
# DB_USER=root
# DB_PASSWORD=your_password
```

### æ•°æ®åº“æ–‡ä»¶è·¯å¾„è¯´æ˜

| è·¯å¾„ç±»å‹ | ç¤ºä¾‹ | è¯´æ˜ |
|---------|------|------|
| **ç›¸å¯¹è·¯å¾„** | `./database/xsblog.db` | ç›¸å¯¹äº backend ç›®å½• |
| **ç›¸å¯¹è·¯å¾„** | `../data/blog.db` | ä¸Šçº§ç›®å½•çš„ data æ–‡ä»¶å¤¹ |
| **ç»å¯¹è·¯å¾„** | `/var/data/xsblog.db` | Linux ç³»ç»Ÿç»å¯¹è·¯å¾„ |
| **ç»å¯¹è·¯å¾„** | `D:\data\xsblog.db` | Windows ç³»ç»Ÿç»å¯¹è·¯å¾„ |
| **å†…å­˜æ•°æ®åº“** | `:memory:` | æ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼ˆé‡å¯åä¸¢å¤±ï¼‰ |

**æ¨èé…ç½®**ï¼š
```bash
# ä½¿ç”¨ç»å¯¹è·¯å¾„
DB_PATH=/var/www/xsblog/database/xsblog.db
```

---

## ğŸ”§ å¸¸è§é—®é¢˜

### 1. å®‰è£… sqlite3 å¤±è´¥ï¼Ÿ

**é”™è¯¯ä¿¡æ¯**ï¼š
```
gyp ERR! find VS could not find Visual Studio
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

**æ–¹æ¡ˆ Aï¼šå®‰è£…æ„å»ºå·¥å…·ï¼ˆWindowsï¼‰**
```bash
# ä½¿ç”¨ç®¡ç†å‘˜æƒé™è¿è¡Œ
npm install --global windows-build-tools
```

**æ–¹æ¡ˆ Bï¼šä½¿ç”¨é¢„ç¼–è¯‘ç‰ˆæœ¬**
```bash
npm install sqlite3 --build-from-source=false
```

**æ–¹æ¡ˆ Cï¼šä½¿ç”¨ MySQL æ›¿ä»£**

å¦‚æœå®‰è£…å›°éš¾ï¼Œå»ºè®®ä½¿ç”¨ MySQL æ•°æ®åº“ã€‚

---

### 2. æ•°æ®åº“æ–‡ä»¶åœ¨å“ªé‡Œï¼Ÿ

**é»˜è®¤ä½ç½®**ï¼š`backend/database/xsblog.db`

**æŸ¥çœ‹æ–¹æ³•**ï¼š
```bash
# æŸ¥çœ‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls backend/database/

# æŸ¥çœ‹æ–‡ä»¶å¤§å°
ls -lh backend/database/xsblog.db
```

---

### 3. å¦‚ä½•å¤‡ä»½ SQLite æ•°æ®åº“ï¼Ÿ

**æ–¹æ³• 1ï¼šç›´æ¥å¤åˆ¶æ–‡ä»¶ï¼ˆæœ€ç®€å•ï¼‰**
```bash
# å¤‡ä»½
cp backend/database/xsblog.db backend/database/xsblog.db.backup

# æ¢å¤
cp backend/database/xsblog.db.backup backend/database/xsblog.db
```

**æ–¹æ³• 2ï¼šä½¿ç”¨ SQLite å‘½ä»¤è¡Œå·¥å…·**
```bash
# å¤‡ä»½
sqlite3 backend/database/xsblog.db ".backup backup.db"

# å¯¼å‡ºä¸º SQL
sqlite3 backend/database/xsblog.db .dump > backup.sql

# ä» SQL æ¢å¤
sqlite3 backend/database/xsblog.db < backup.sql
```

---

### 4. SQLite æ€§èƒ½å¤Ÿç”¨å—ï¼Ÿ

**æ€§èƒ½ç‰¹ç‚¹**ï¼š
- âœ… **è¯»å–æ€§èƒ½**ï¼šå¯¹äºå°å‹ç½‘ç«™ï¼Œæ€§èƒ½å®Œå…¨å¤Ÿç”¨
- âœ… **å†™å…¥æ€§èƒ½**ï¼šé€‚åˆä½å¹¶å‘å†™å…¥åœºæ™¯
- âš ï¸ **å¹¶å‘é™åˆ¶**ï¼šä¸é€‚åˆé«˜å¹¶å‘å†™å…¥åœºæ™¯
- âš ï¸ **æ•°æ®é‡**ï¼šå»ºè®®æ•°æ®åº“æ–‡ä»¶ < 1GB

**æ¨èåœºæ™¯**ï¼š
- âœ… ä¸ªäººåšå®¢ã€ä½œå“å±•ç¤ºç«™
- âœ… å†…éƒ¨å·¥å…·ã€ç®¡ç†ç³»ç»Ÿ
- âœ… å¼€å‘å’Œæµ‹è¯•ç¯å¢ƒ
- âŒ é«˜å¹¶å‘å•†ä¸šç½‘ç«™
- âŒ å¤§æ•°æ®é‡åº”ç”¨

---

### 5. å¦‚ä½•æŸ¥çœ‹ SQLite æ•°æ®åº“å†…å®¹ï¼Ÿ

**æ–¹æ³• 1ï¼šä½¿ç”¨ SQLite å‘½ä»¤è¡Œ**
```bash
# æ‰“å¼€æ•°æ®åº“
sqlite3 backend/database/xsblog.db

# æŸ¥çœ‹æ‰€æœ‰è¡¨
.tables

# æŸ¥çœ‹è¡¨ç»“æ„
.schema users

# æŸ¥è¯¢æ•°æ®
SELECT * FROM users;

# é€€å‡º
.quit
```

**æ–¹æ³• 2ï¼šä½¿ç”¨å›¾å½¢åŒ–å·¥å…·**
- [DB Browser for SQLite](https://sqlitebrowser.org/) - å…è´¹å¼€æº
- [SQLiteStudio](https://sqlitestudio.pl/) - åŠŸèƒ½å¼ºå¤§
- [Navicat](https://www.navicat.com/) - å•†ä¸šè½¯ä»¶
- [DBeaver](https://dbeaver.io/) - å…è´¹å¼€æº

---

### 6. ä» SQLite åˆ‡æ¢å› MySQLï¼Ÿ

ç¼–è¾‘ `backend/.env` æ–‡ä»¶ï¼š

```bash
# æ”¹å› MySQL
DB_TYPE=mysql
DB_HOST=localhost
DB_PORT=3306
DB_NAME=xsblog888
DB_USER=root
DB_PASSWORD=your_password

# æ³¨é‡Šæ‰ SQLite é…ç½®
# DB_PATH=./database/xsblog.db
```

é‡å¯åç«¯æœåŠ¡å³å¯ã€‚

---


## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. å®šæœŸæ¸…ç†å’Œä¼˜åŒ–

```bash
# è¿›å…¥ SQLite å‘½ä»¤è¡Œ
sqlite3 backend/database/xsblog.db

# åˆ†ææŸ¥è¯¢è®¡åˆ’
EXPLAIN QUERY PLAN SELECT * FROM users;

# ä¼˜åŒ–æ•°æ®åº“
VACUUM;

# é‡å»ºç´¢å¼•
REINDEX;

# åˆ†æç»Ÿè®¡ä¿¡æ¯
ANALYZE;
```

### 2. åˆç†ä½¿ç”¨ç´¢å¼•

SQLite ä¼šè‡ªåŠ¨ä¸ºä¸»é”®åˆ›å»ºç´¢å¼•ï¼Œå¯¹äºé¢‘ç¹æŸ¥è¯¢çš„å­—æ®µï¼Œå¯ä»¥æ‰‹åŠ¨æ·»åŠ ç´¢å¼•ï¼š

```sql
-- ä¸ºç”¨æˆ·åæ·»åŠ ç´¢å¼•
CREATE INDEX idx_users_username ON users(username);

-- ä¸ºæ–‡ç« åˆ›å»ºæ—¶é—´æ·»åŠ ç´¢å¼•
CREATE INDEX idx_posts_created_at ON posts(created_at);
```

### 3. å®šæœŸå¤‡ä»½

å»ºè®®æ¯å¤©å¤‡ä»½ä¸€æ¬¡æ•°æ®åº“æ–‡ä»¶ï¼š

```bash
# åˆ›å»ºå¤‡ä»½è„šæœ¬ backup-sqlite.sh
#!/bin/bash
DATE=$(date +%Y%m%d_%H%M%S)
cp backend/database/xsblog.db "backups/xsblog_$DATE.db"

# ä¿ç•™æœ€è¿‘ 7 å¤©çš„å¤‡ä»½
find backups/ -name "xsblog_*.db" -mtime +7 -delete
```

---

## ğŸ”’ å®‰å…¨å»ºè®®

1. **è®¾ç½®æ–‡ä»¶æƒé™**ï¼ˆLinux/Macï¼‰
```bash
# é™åˆ¶æ•°æ®åº“æ–‡ä»¶è®¿é—®æƒé™
chmod 600 backend/database/xsblog.db
chmod 700 backend/database/
```

2. **å®šæœŸå¤‡ä»½**
```bash
# å®šæ—¶å¤‡ä»½ï¼ˆcrontabï¼‰
0 2 * * * /path/to/backup-sqlite.sh
```

3. **ä¸è¦å°†æ•°æ®åº“æ–‡ä»¶æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶**
```bash
# .gitignore
backend/database/*.db
backend/database/*.db-*
```

4. **åŠ å¯†æ•æ„Ÿæ•°æ®**

SQLite æœ¬èº«ä¸æ”¯æŒåŠ å¯†ï¼Œæ•æ„Ÿæ•°æ®åº”è¯¥åœ¨åº”ç”¨å±‚åŠ å¯†ã€‚

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [ç¯å¢ƒå˜é‡é…ç½®æŒ‡å—.md](ç¯å¢ƒå˜é‡é…ç½®æŒ‡å—.md) - å®Œæ•´çš„ç¯å¢ƒå˜é‡é…ç½®è¯´æ˜
- [README.md](../README.md) - é¡¹ç›®æ¦‚è§ˆå’Œå¿«é€Ÿå¼€å§‹
- [å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ.md](å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ.md) - é—®é¢˜æ’æŸ¥å’Œè§£å†³æ–¹æ¡ˆ

---

## ğŸ¯ æ€»ç»“

### SQLite çš„ä¼˜åŠ¿

- âœ… **é›¶é…ç½®**ï¼šæ— éœ€å®‰è£…æ•°æ®åº“æœåŠ¡
- âœ… **ä¾¿æºæ€§**ï¼šæ•°æ®åº“å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶
- âœ… **è½»é‡çº§**ï¼šèµ„æºå ç”¨å°‘
- âœ… **ç®€å•å¤‡ä»½**ï¼šç›´æ¥å¤åˆ¶æ–‡ä»¶
- âœ… **å¼€å‘å‹å¥½**ï¼šå¿«é€Ÿæ­å»ºå¼€å‘ç¯å¢ƒ

### ä½•æ—¶ä½¿ç”¨ SQLite

|          åœºæ™¯           | æ¨èæ•°æ®åº“ |
| ---------------------- | ---------- |
| å¿«é€Ÿéƒ¨ç½²ä½“éªŒ Xs-Blog     | SQLite âœ… |
| ä¸ªäººåšå®¢ï¼ˆæ—¥è®¿é—® < 500ï¼‰ | SQLite âœ… |


### ä» SQLite è¿ç§»åˆ° MySQL

å½“æ‚¨çš„ç½‘ç«™æµé‡å¢é•¿ï¼Œå»ºè®®è¿ç§»åˆ° MySQLï¼š
1. ä½¿ç”¨æ•°æ®å¯¼å‡ºå·¥å…·
2. ä¿®æ”¹ `.env` é…ç½®
3. å¯¼å…¥æ•°æ®åˆ° MySQL
4. é‡å¯æœåŠ¡

---

**ç‰ˆæœ¬**: V3.2.0æ­£å¼ç‰ˆ
**æ›´æ–°æ—¥æœŸ**: 2025-12-17