(()=>{var e={};e.id=62,e.ids=[62],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},58935:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>o,routeModule:()=>u,tree:()=>d}),t(53450),t(43538),t(12523);var r=t(23191),a=t(88716),l=t(37922),n=t.n(l),i=t(95231),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);t.d(s,c);let d=["",{children:["admins",{children:["other",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,53450)),"D:\\360Downloads\\www\\tool-new\\Xs-blog\\frontend\\src\\app\\admins\\other\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,43538)),"D:\\360Downloads\\www\\tool-new\\Xs-blog\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,12523)),"D:\\360Downloads\\www\\tool-new\\Xs-blog\\frontend\\src\\app\\not-found.tsx"]}],o=["D:\\360Downloads\\www\\tool-new\\Xs-blog\\frontend\\src\\app\\admins\\other\\page.tsx"],x="/admins/other/page",m={require:t,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admins/other/page",pathname:"/admins/other",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},49122:(e,s,t)=>{Promise.resolve().then(t.bind(t,41702))},41702:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>o});var r=t(10326),a=t(17577),l=t(35047),n=t(67905),i=t(24052),c=t(14020),d=t(62464);function o(){(0,i.T)("留言管理");let e=(0,l.useRouter)(),[s,t]=(0,a.useState)(null),[o,x]=(0,a.useState)(!0),[m,u]=(0,a.useState)("messages"),[h,p]=(0,a.useState)([]),[g,y]=(0,a.useState)([]),[b,j]=(0,a.useState)(!1),[w,v]=(0,a.useState)(null),[f,N]=(0,a.useState)(""),[k,_]=(0,a.useState)(null),[q,C]=(0,a.useState)({show:!1,type:"success",message:""}),P=async()=>{j(!0);try{let e=await (0,n.yRm)();e.success&&e.data?p(e.data.messages||[]):p([])}catch(e){console.error("Failed to load messages:",e),p([])}finally{j(!1)}},S=async()=>{try{let e=await (0,n.HXp)();e.success&&e.data&&y(e.data)}catch(e){console.error("Failed to load message categories:",e),y([])}},D=async(e,s)=>{try{(await (0,n.Rje)(e,s)).success&&(C({show:!0,type:"success",message:"状态更新成功"}),P())}catch(e){C({show:!0,type:"error",message:e.response?.data?.message||"更新失败"})}},X=async e=>{if(confirm("确定要删除这条留言吗？此操作不可恢复。"))try{(await (0,n.cwm)(e)).success&&(C({show:!0,type:"success",message:"留言删除成功"}),P())}catch(e){C({show:!0,type:"error",message:e.response?.data?.message||"删除失败"})}},E=async()=>{if(!f.trim()){C({show:!0,type:"error",message:"分类名称不能为空"});return}try{(await (0,n.Cxh)({name:f})).success&&(C({show:!0,type:"success",message:"分类创建成功"}),N(""),S())}catch(e){C({show:!0,type:"error",message:e.response?.data?.message||"创建失败"})}},M=async e=>{try{(await (0,n.qEl)(e.id,{name:e.name,sort_order:e.sort_order})).success&&(C({show:!0,type:"success",message:"分类更新成功"}),_(null),S())}catch(e){C({show:!0,type:"error",message:e.response?.data?.message||"更新失败"})}},A=async e=>{if(confirm("确定要删除这个分类吗？此操作不可恢复。"))try{(await (0,n.cnu)(e)).success&&(C({show:!0,type:"success",message:"分类删除成功"}),S())}catch(e){C({show:!0,type:"error",message:e.response?.data?.message||"删除失败"})}},F=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"read":return"bg-blue-100 text-blue-800";case"replied":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return o?null:(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[q.show&&r.jsx(d.Z,{message:q.message,type:q.type,onClose:()=>C({...q,show:!1})}),r.jsx("nav",{className:"bg-white shadow-sm",children:r.jsx("div",{className:"max-w-5xl mx-auto px-4",children:r.jsx("div",{className:"flex items-center justify-between h-16",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[r.jsx("button",{onClick:()=>e.push((0,c.V9)("dashboard")),className:"text-gray-600 hover:text-gray-900",children:"← 返回"}),r.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"留言管理"})]})})})}),r.jsx("div",{className:"container mx-auto px-4 py-8",children:r.jsx("div",{className:"max-w-4xl mx-auto",children:(0,r.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100 mb-6",children:[(0,r.jsxs)("div",{className:"flex space-x-4 border-b border-gray-200",children:[r.jsx("button",{onClick:()=>u("messages"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${"messages"===m?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"留言列表"}),r.jsx("button",{onClick:()=>u("message-categories"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${"message-categories"===m?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"留言分类"})]}),"messages"===m&&(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"留言列表"}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["留言提交页面：",r.jsx("a",{href:"/messages",target:"_blank",className:"text-blue-600 hover:text-blue-800",children:"/messages"})]})]}),b?(0,r.jsxs)("div",{className:"text-center py-8",children:[r.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"加载中..."})]}):0===h.length?r.jsx("div",{className:"text-center py-8 text-gray-500",children:"暂无留言"}):r.jsx("div",{className:"bg-gray-50 rounded-lg border border-gray-200 max-h-96 overflow-y-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-100",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"时间"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"用户"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"分类"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"状态"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:new Date(e.created_at).toLocaleString()}),r.jsx("td",{className:"px-4 py-3",children:(0,r.jsxs)("div",{children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name}),r.jsx("div",{className:"text-sm text-gray-500",children:e.contact}),r.jsx("div",{className:"text-xs text-gray-400 font-mono",children:e.ip_address})]})}),r.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:e.MessageCategory?.name||"未分类"}),r.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,r.jsxs)("select",{value:e.status,onChange:s=>D(e.id,s.target.value),className:`text-xs font-medium rounded-full px-2.5 py-0.5 ${F(e.status)} border-0 focus:ring-0`,children:[r.jsx("option",{value:"pending",children:"待处理"}),r.jsx("option",{value:"read",children:"已读"}),r.jsx("option",{value:"replied",children:"已回复"})]})}),r.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:(0,r.jsxs)("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:()=>v(e),className:"text-blue-600 hover:text-blue-900 text-sm",children:"查看"}),r.jsx("button",{onClick:()=>X(e.id),className:"text-red-600 hover:text-red-900 text-sm",children:"删除"})]})})]},e.id))})]})}),w&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"留言详情"}),r.jsx("button",{onClick:()=>v(null),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"用户称呼"}),r.jsx("div",{className:"bg-gray-50 p-3 rounded",children:w.name})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"联系方式"}),r.jsx("div",{className:"bg-gray-50 p-3 rounded",children:w.contact})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"留言分类"}),r.jsx("div",{className:"bg-gray-50 p-3 rounded",children:w.MessageCategory?.name||"未分类"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"留言内容"}),r.jsx("div",{className:"bg-gray-50 p-3 rounded whitespace-pre-wrap",children:w.content})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"IP地址"}),r.jsx("div",{className:"bg-gray-50 p-3 rounded font-mono",children:w.ip_address})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"提交时间"}),r.jsx("div",{className:"bg-gray-50 p-3 rounded",children:new Date(w.created_at).toLocaleString()})]})]})]})})]}),"message-categories"===m&&(0,r.jsxs)("div",{className:"mt-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"留言分类管理"}),(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[r.jsx("h3",{className:"text-md font-medium text-blue-900 mb-2",children:"添加新分类"}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[r.jsx("input",{type:"text",value:f,onChange:e=>N(e.target.value),placeholder:"输入分类名称",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),r.jsx("button",{onClick:E,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"添加"})]})]}),0===g.length?r.jsx("div",{className:"text-center py-8 text-gray-500",children:"暂无分类"}):r.jsx("div",{className:"bg-gray-50 rounded-lg border border-gray-200",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-100",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"分类名称"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"排序"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-4 py-3",children:k?.id===e.id?r.jsx("input",{type:"text",value:k.name,onChange:e=>_({...k,name:e.target.value}),className:"px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}):r.jsx("span",{className:"text-sm text-gray-900",children:e.name})}),r.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:k?.id===e.id?r.jsx("input",{type:"number",value:k.sort_order,onChange:e=>_({...k,sort_order:parseInt(e.target.value)||0}),className:"w-20 px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0"}):r.jsx("span",{children:e.sort_order})}),r.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:r.jsx("div",{className:"flex space-x-2",children:k?.id===e.id?(0,r.jsxs)(r.Fragment,{children:[r.jsx("button",{onClick:()=>M(k),className:"text-green-600 hover:text-green-900 text-sm",children:"保存"}),r.jsx("button",{onClick:()=>_(null),className:"text-gray-600 hover:text-gray-900 text-sm",children:"取消"})]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx("button",{onClick:()=>_(e),className:"text-blue-600 hover:text-blue-900 text-sm",children:"编辑"}),r.jsx("button",{onClick:()=>A(e.id),className:"text-red-600 hover:text-red-900 text-sm",children:"删除"})]})})})]},e.id))})]})})]})]})})})]})}},53450:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(68570).createProxy)(String.raw`D:\360Downloads\www\tool-new\Xs-blog\frontend\src\app\admins\other\page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[380,804,795,964,551],()=>t(58935));module.exports=r})();