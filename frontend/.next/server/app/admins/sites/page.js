(()=>{var e={};e.id=133,e.ids=[133],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},98674:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>d,routeModule:()=>p,tree:()=>c}),t(8123),t(43538),t(12523);var r=t(23191),a=t(88716),i=t(37922),n=t.n(i),l=t(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);t.d(s,o);let c=["",{children:["admins",{children:["sites",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,8123)),"D:\\360Downloads\\www\\tool-new\\Xs-blog\\frontend\\src\\app\\admins\\sites\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,43538)),"D:\\360Downloads\\www\\tool-new\\Xs-blog\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,12523)),"D:\\360Downloads\\www\\tool-new\\Xs-blog\\frontend\\src\\app\\not-found.tsx"]}],d=["D:\\360Downloads\\www\\tool-new\\Xs-blog\\frontend\\src\\app\\admins\\sites\\page.tsx"],m="/admins/sites/page",x={require:t,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admins/sites/page",pathname:"/admins/sites",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},92700:(e,s,t)=>{Promise.resolve().then(t.bind(t,23451))},23451:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var r=t(10326),a=t(17577),i=t(35047),n=t(67905),l=t(24052),o=t(62464),c=t(14020);function d(){(0,l.T)("网站导航管理");let e=(0,i.useRouter)(),[s,t]=(0,a.useState)(null),[d,m]=(0,a.useState)([]),[x,p]=(0,a.useState)([]),[u,h]=(0,a.useState)(!0),[g,b]=(0,a.useState)("sites"),[y,j]=(0,a.useState)(null),[f,v]=(0,a.useState)(!1),[w,N]=(0,a.useState)({name:"",link:"",description:"",logo:"",sort_order:0,is_frontend_visible:!0,category_id:null,is_recommended:!1,is_dashboard_visible:!1}),[_,k]=(0,a.useState)(null),[C,q]=(0,a.useState)(!1),[L,S]=(0,a.useState)({name:"",description:"",icon:"",sort_order:0,is_visible:!0}),[D,P]=(0,a.useState)(""),[F,A]=(0,a.useState)(!1),[X,$]=(0,a.useState)({show:!1,type:"success",message:""}),G=async()=>{try{let e=await (0,n.f8h)();if(e.success){let s=Array.isArray(e.data)?e.data:[];m(s)}}catch(e){$({show:!0,type:"error",message:"加载网站导航失败"}),m([])}},E=async()=>{try{let e=await (0,n.v5P)();if(e.success){let s=Array.isArray(e.data)?e.data:[];p(s)}}catch(e){console.error("加载导航分类失败:",e),p([])}},I=e=>{let{name:s,value:t,type:r}=e.target,a=e.target.checked,i=t;"checkbox"===r?i=a:"sort_order"===s?i=parseInt(t)||0:"category_id"===s&&(i=""===t?null:parseInt(t)),N({...w,[s]:i})},R=async e=>{let s=e.target.files?.[0];if(s){A(!0);try{let e=await (0,n.CGE)(s);e.success&&(N({...w,logo:e.data.url}),$({show:!0,type:"success",message:"Logo上传成功"}))}catch(e){$({show:!0,type:"error",message:e.response?.data?.message||"Logo上传失败"})}finally{A(!1)}}},M=async()=>{if(w.logo&&w.logo.startsWith("/uploads/"))try{await (0,n.k0S)(w.logo)}catch(e){console.error("删除网站Logo文件失败:",e)}N({...w,logo:""}),$({show:!0,type:"success",message:"Logo删除成功"})},T=async e=>{e.preventDefault();try{y?.id?(await (0,n.kTP)(y.id,w)).success&&($({show:!0,type:"success",message:"网站更新成功"}),await G(),V()):(await (0,n.lip)(w)).success&&($({show:!0,type:"success",message:"网站添加成功"}),await G(),V())}catch(e){$({show:!0,type:"error",message:e.response?.data?.message||"操作失败"})}},B=e=>{j(e),N({name:e.name,link:e.link,description:e.description||"",logo:e.logo||"",sort_order:e.sort_order||0,is_frontend_visible:void 0===e.is_frontend_visible||e.is_frontend_visible,category_id:e.category_id||null,is_recommended:e.is_recommended||!1,is_dashboard_visible:e.is_dashboard_visible||!1}),v(!0)},U=async e=>{if(confirm("确定要删除这个网站吗？"))try{(await (0,n.VX8)(e)).success&&($({show:!0,type:"success",message:"网站删除成功"}),await G())}catch(e){$({show:!0,type:"error",message:e.response?.data?.message||"删除失败"})}},V=()=>{N({name:"",link:"",description:"",logo:"",sort_order:0,is_frontend_visible:!0,category_id:null,is_recommended:!1}),j(null),v(!1)},z=e=>{let{name:s,value:t,type:r}=e.target,a=e.target.checked,i=t;"checkbox"===r?i=a:"sort_order"===s&&(i=parseInt(t)||0),S({...L,[s]:i})},H=async e=>{if(e.preventDefault(),!L.name.trim()){$({show:!0,type:"error",message:"分类名称不能为空"});return}try{_?.id?(await (0,n.vt2)(_.id,L)).success&&($({show:!0,type:"success",message:"分类更新成功"}),await E(),W()):(await (0,n.d24)(L)).success&&($({show:!0,type:"success",message:"分类添加成功"}),await E(),W())}catch(e){$({show:!0,type:"error",message:e.response?.data?.message||"操作失败"})}},J=e=>{k(e),S({name:e.name,description:e.description||"",icon:e.icon||"",sort_order:e.sort_order||0,is_visible:void 0===e.is_visible||e.is_visible}),q(!0)},O=async e=>{if(confirm("确定要删除这个分类吗？如果有站点使用此分类，将无法删除。"))try{(await (0,n.l7u)(e)).success&&($({show:!0,type:"success",message:"分类删除成功"}),await E())}catch(e){$({show:!0,type:"error",message:e.response?.data?.message||"删除失败"})}},W=()=>{S({name:"",description:"",icon:"",sort_order:0,is_visible:!0}),k(null),q(!1)};return u?null:(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx("nav",{className:"bg-white shadow-sm",children:r.jsx("div",{className:"max-w-5xl mx-auto px-4",children:r.jsx("div",{className:"flex items-center justify-between h-16",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[r.jsx("button",{onClick:()=>e.push((0,c.V9)("dashboard")),className:"text-gray-600 hover:text-gray-900",children:"← 返回"}),r.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"网站导航管理"})]})})})}),X.show&&r.jsx(o.Z,{message:X.message,type:X.type,onClose:()=>$({...X,show:!1})}),r.jsx("div",{className:"container mx-auto px-4 py-8",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[r.jsx("div",{className:"mb-6 border-b border-gray-200",children:(0,r.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[r.jsx("button",{onClick:()=>b("sites"),className:`py-4 px-1 border-b-2 font-medium text-sm ${"sites"===g?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"网站导航管理"}),r.jsx("button",{onClick:()=>b("categories"),className:`py-4 px-1 border-b-2 font-medium text-sm ${"categories"===g?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"导航分类管理"})]})}),"sites"===g&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"mb-6",children:r.jsx("button",{onClick:()=>v(!f),className:"btn btn-primary",children:f?"取消":"+ 添加网站"})}),f&&(0,r.jsxs)("div",{className:"card mb-6",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:y?"编辑网站":"添加网站"}),(0,r.jsxs)("form",{onSubmit:T,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"网站名称"}),r.jsx("input",{id:"name",name:"name",type:"text",required:!0,value:w.name,onChange:I,className:"input",placeholder:"例如：GitHub"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"link",className:"block text-sm font-medium text-gray-700 mb-2",children:"网站地址"}),r.jsx("input",{id:"link",name:"link",type:"url",required:!0,value:w.link,onChange:I,className:"input",placeholder:"https://..."})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"描述 (可选)"}),r.jsx("textarea",{id:"description",name:"description",rows:3,value:w.description,onChange:I,className:"input",placeholder:"简单描述这个网站..."})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"logo",className:"block text-sm font-medium text-gray-700 mb-2",children:"Logo (可选)"}),(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[w.logo&&r.jsx("div",{className:"flex-shrink-0 w-16 h-16 flex items-center justify-center bg-gray-50 rounded border border-gray-200",children:r.jsx("img",{src:(0,n.Jn$)(w.logo),alt:"Logo",className:"max-w-full max-h-full object-contain"})}),(0,r.jsxs)("div",{className:"flex-1 flex items-center gap-3",children:[!w.logo&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("input",{type:"file",id:"logoInput",accept:"image/*",onChange:R,disabled:F,className:"hidden"}),r.jsx("label",{htmlFor:"logoInput",className:`px-4 py-2 bg-blue-500 text-white rounded-lg font-medium transition-all duration-300 hover:bg-blue-600 hover:shadow-md text-xs cursor-pointer whitespace-nowrap ${F?"opacity-50 cursor-not-allowed":""}`,children:F?"上传中...":"选择文件"})]}),r.jsx("input",{id:"logo",name:"logo",type:"text",value:w.logo,onChange:I,placeholder:"Logo URL",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white placeholder-gray-400"})]}),w.logo&&r.jsx("button",{type:"button",onClick:M,className:"flex-shrink-0 px-3 py-2 bg-red-500 text-white rounded-lg font-medium transition-all duration-300 hover:bg-red-600 hover:shadow-md text-xs whitespace-nowrap",children:"删除"})]}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"上传Logo图片或输入自定义URL"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"category_id",className:"block text-sm font-medium text-gray-700 mb-2",children:"导航分类"}),(0,r.jsxs)("select",{id:"category_id",name:"category_id",value:w.category_id||"",onChange:I,className:"input",children:[r.jsx("option",{value:"",children:"未分类"}),x.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.icon?`${e.icon} `:"",e.name]},e.id))]}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"选择导航所属的分类，未选择则不会在前台分类展示中显示"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"sort_order",className:"block text-sm font-medium text-gray-700 mb-2",children:"排序 (可选)"}),r.jsx("input",{id:"sort_order",name:"sort_order",type:"number",value:w.sort_order,onChange:I,className:"input",placeholder:"0"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("input",{id:"is_frontend_visible",name:"is_frontend_visible",type:"checkbox",checked:w.is_frontend_visible,onChange:I,className:"w-4 h-4 text-primary-600 bg-gray-100 border-gray-300 rounded focus:ring-primary-500 focus:ring-2"}),r.jsx("label",{htmlFor:"is_frontend_visible",className:"ml-2 text-sm font-medium text-gray-700",children:"在前端展示（勾选后前后台都显示，不勾选只在后台显示）"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("input",{id:"is_recommended",name:"is_recommended",type:"checkbox",checked:w.is_recommended,onChange:I,className:"w-4 h-4 text-primary-600 bg-gray-100 border-gray-300 rounded focus:ring-primary-500 focus:ring-2"}),r.jsx("label",{htmlFor:"is_recommended",className:"ml-2 text-sm font-medium text-gray-700",children:'推荐导航（勾选后会在"导航推荐"区块中显示）'})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("input",{id:"is_dashboard_visible",name:"is_dashboard_visible",type:"checkbox",checked:w.is_dashboard_visible,onChange:I,className:"w-4 h-4 text-primary-600 bg-gray-100 border-gray-300 rounded focus:ring-primary-500 focus:ring-2"}),r.jsx("label",{htmlFor:"is_dashboard_visible",className:"ml-2 text-sm font-medium text-gray-700",children:"在后台首页显示（勾选后会在后台首页的常用导航中显示，最多6个）"})]}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[r.jsx("button",{type:"submit",className:"btn btn-primary",children:y?"更新":"添加"}),r.jsx("button",{type:"button",onClick:V,className:"btn btn-secondary",children:"取消"})]})]})]}),d.length>0&&r.jsx("div",{className:"mb-6",children:r.jsx("input",{type:"text",placeholder:"搜索网站名称、链接或描述...",value:D,onChange:e=>P(e.target.value),className:"input w-full"})}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold mb-4",children:["已添加的网站",D&&d.filter(e=>{let s=D.toLowerCase();return e.name.toLowerCase().includes(s)||e.link.toLowerCase().includes(s)||e.description?.toLowerCase().includes(s)}).length>0&&(0,r.jsxs)("span",{className:"text-sm font-normal text-gray-500 ml-2",children:["(找到 ",d.filter(e=>{let s=D.toLowerCase();return e.name.toLowerCase().includes(s)||e.link.toLowerCase().includes(s)||e.description?.toLowerCase().includes(s)}).length," 个结果)"]})]}),0===d.length?r.jsx("p",{className:"text-gray-500 text-center py-8",children:"还没有添加任何网站"}):(()=>{let e=d.filter(e=>{if(!D.trim())return!0;let s=D.toLowerCase();return e.name.toLowerCase().includes(s)||e.link.toLowerCase().includes(s)||e.description?.toLowerCase().includes(s)});return 0===e.length?(0,r.jsxs)("p",{className:"text-gray-500 text-center py-8",children:['没有找到匹配 "',D,'" 的网站']}):r.jsx("div",{className:"divide-y divide-gray-200",children:e.map(e=>(0,r.jsxs)("div",{className:"flex items-start justify-between py-4 first:pt-0 last:pb-0",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("h3",{className:"font-medium text-gray-900",children:e.name}),void 0!==e.sort_order&&(0,r.jsxs)("span",{className:"text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded",children:["排序: ",e.sort_order]}),r.jsx("span",{className:`text-xs px-2 py-1 rounded ${!1!==e.is_frontend_visible?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:!1!==e.is_frontend_visible?"前后台":"仅后台"})]}),r.jsx("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary-600 hover:underline",children:e.link}),e.description&&r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]}),(0,r.jsxs)("div",{className:"flex space-x-2 ml-4",children:[r.jsx("button",{onClick:()=>B(e),className:"btn btn-secondary text-sm",children:"编辑"}),r.jsx("button",{onClick:()=>e.id&&U(e.id),className:"btn bg-red-600 hover:bg-red-700 text-white text-sm",children:"删除"})]})]},e.id))})})()]})]}),"categories"===g&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"mb-6",children:r.jsx("button",{onClick:()=>q(!C),className:"btn btn-primary",children:C?"取消":"+ 添加分类"})}),C&&(0,r.jsxs)("div",{className:"card mb-6",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:_?"编辑分类":"添加分类"}),(0,r.jsxs)("form",{onSubmit:H,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["分类名称 ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",name:"name",value:L.name,onChange:z,className:"input",placeholder:"例如：开发工具",required:!0})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"分类描述"}),r.jsx("textarea",{name:"description",value:L.description,onChange:z,rows:3,className:"input",placeholder:"分类的详细描述"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"分类图标"}),r.jsx("input",{type:"text",name:"icon",value:L.icon,onChange:z,className:"input",placeholder:"例如：\uD83D\uDCBB 或 emoji 表情"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"可以使用 emoji 表情作为图标"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"排序顺序"}),r.jsx("input",{type:"number",name:"sort_order",value:L.sort_order,onChange:z,className:"input",placeholder:"数字越小越靠前"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",name:"is_visible",checked:L.is_visible,onChange:z,className:"w-4 h-4 text-primary-600 bg-gray-100 border-gray-300 rounded focus:ring-primary-500 focus:ring-2"}),r.jsx("label",{className:"ml-2 text-sm font-medium text-gray-700",children:"前端可见"})]}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[r.jsx("button",{type:"submit",className:"btn btn-primary",children:_?"更新":"添加"}),r.jsx("button",{type:"button",onClick:W,className:"btn btn-secondary",children:"取消"})]})]})]}),(0,r.jsxs)("div",{className:"card overflow-hidden",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4 px-6 pt-6",children:"分类列表"}),r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"图标"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"名称"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"描述"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"排序"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"状态"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:0===x.length?r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-gray-500",children:"暂无分类数据"})}):x.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-2xl",children:e.icon||"\uD83D\uDCC1"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:e.description||"-"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.sort_order}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${e.is_visible?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:e.is_visible?"可见":"隐藏"})}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[r.jsx("button",{onClick:()=>J(e),className:"text-primary-600 hover:text-primary-900 mr-4",children:"编辑"}),r.jsx("button",{onClick:()=>e.id&&O(e.id),className:"text-red-600 hover:text-red-900",children:"删除"})]})]},e.id))})]})})]})]})]})})]})}},8123:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(68570).createProxy)(String.raw`D:\360Downloads\www\tool-new\Xs-blog\frontend\src\app\admins\sites\page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[380,804,795,964,551],()=>t(98674));module.exports=r})();