(()=>{var e={};e.id=474,e.ids=[474],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},32242:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c}),t(59532),t(43538),t(12523);var r=t(23191),a=t(88716),i=t(37922),l=t.n(i),n=t(95231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);t.d(s,o);let c=["",{children:["admins",{children:["social-links",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,59532)),"D:\\360Downloads\\www\\tool-new\\Xs-blog\\frontend\\src\\app\\admins\\social-links\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,43538)),"D:\\360Downloads\\www\\tool-new\\Xs-blog\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,12523)),"D:\\360Downloads\\www\\tool-new\\Xs-blog\\frontend\\src\\app\\not-found.tsx"]}],d=["D:\\360Downloads\\www\\tool-new\\Xs-blog\\frontend\\src\\app\\admins\\social-links\\page.tsx"],u="/admins/social-links/page",p={require:t,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admins/social-links/page",pathname:"/admins/social-links",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},59520:(e,s,t)=>{Promise.resolve().then(t.bind(t,30250))},30250:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var r=t(10326),a=t(17577),i=t(35047),l=t(67905),n=t(24052),o=t(62464),c=t(14020),d=t(51223);function u(){(0,n.T)("社交链接管理");let e=(0,i.useRouter)(),[s,t]=(0,a.useState)(null),[u,p]=(0,a.useState)([]),[m,x]=(0,a.useState)(!0),[h,g]=(0,a.useState)(null),[b,f]=(0,a.useState)(!1),[y,w]=(0,a.useState)({platform:"",account:"",link:"",icon:"",qrcode:"",show_in_profile:!1}),[j,v]=(0,a.useState)({show:!1,type:"success",message:""}),[N,k]=(0,a.useState)(!1),[q,_]=(0,a.useState)(!1),C=async()=>{try{let e=await (0,l.ldR)();if(e.success){let s=Array.isArray(e.data)?e.data:[];p(s)}}catch(e){console.error("Failed to load social links:",e),p([])}},P=e=>{w({...y,[e.target.name]:e.target.value})},S=async e=>{e.preventDefault();try{h?.id?(await (0,l.zlg)(h.id,y)).success&&(v({show:!0,type:"success",message:"社交链接更新成功"}),await C(),A()):(await (0,l.H6F)(y)).success&&(v({show:!0,type:"success",message:"社交链接添加成功"}),await C(),A())}catch(e){v({show:!0,type:"error",message:e.response?.data?.message||"操作失败"})}},F=e=>{g(e),w({platform:e.platform,account:e.account,link:e.link||"",icon:e.icon||"",qrcode:e.qrcode||"",show_in_profile:e.show_in_profile||!1}),f(!0)},D=async e=>{if(confirm("确定要删除这个社交链接吗？"))try{(await (0,l.ZhF)(e)).success&&(v({show:!0,type:"success",message:"社交链接删除成功"}),await C())}catch(e){v({show:!0,type:"error",message:e.response?.data?.message||"删除失败"})}},A=()=>{w({platform:"",account:"",link:"",icon:"",qrcode:"",show_in_profile:!1}),g(null),f(!1)},L=async e=>{let s=e.target.files?.[0];if(s){k(!0);try{let t=await (0,l.TXj)(s);t.success&&(w({...y,icon:t.data.url}),v({show:!0,type:"success",message:"图标上传成功"}),e.target.value="")}catch(e){v({show:!0,type:"error",message:e.response?.data?.message||"图标上传失败"})}finally{k(!1)}}},T=async e=>{let s=e.target.files?.[0];if(s){_(!0);try{let t=await (0,l.PP9)(s);t.success&&(w({...y,qrcode:t.data.url}),v({show:!0,type:"success",message:"二维码上传成功"}),e.target.value="")}catch(e){v({show:!0,type:"error",message:e.response?.data?.message||"二维码上传失败"})}finally{_(!1)}}};return m?null:(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[j.show&&r.jsx(o.Z,{message:j.message,type:j.type,onClose:()=>v({...j,show:!1})}),r.jsx("nav",{className:"bg-white shadow-sm",children:r.jsx("div",{className:"max-w-5xl mx-auto px-4",children:r.jsx("div",{className:"flex items-center justify-between h-16",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[r.jsx("button",{onClick:()=>e.push((0,c.V9)("dashboard")),className:"text-gray-600 hover:text-gray-900",children:"← 返回"}),r.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"社交链接管理"})]})})})}),r.jsx("div",{className:"container mx-auto px-4 py-8",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[r.jsx("div",{className:"mb-6",children:r.jsx("button",{onClick:()=>f(!b),className:"btn btn-primary",children:b?"取消":"+ 添加社交链接"})}),b&&(0,r.jsxs)("div",{className:"card mb-6",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:h?"编辑社交链接":"添加社交链接"}),(0,r.jsxs)("form",{onSubmit:S,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"platform",className:"block text-sm font-medium text-gray-700 mb-2",children:"平台名称"}),r.jsx("input",{id:"platform",name:"platform",type:"text",required:!0,value:y.platform,onChange:P,className:"input",placeholder:"例如：GitHub, Twitter, LinkedIn"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"account",className:"block text-sm font-medium text-gray-700 mb-2",children:"账号/用户名"}),r.jsx("input",{id:"account",name:"account",type:"text",required:!0,value:y.account,onChange:P,className:"input",placeholder:"例如：yourusername"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"link",className:"block text-sm font-medium text-gray-700 mb-2",children:"链接地址 (可选)"}),r.jsx("input",{id:"link",name:"link",type:"url",value:y.link,onChange:P,className:"input",placeholder:"https://..."})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"icon",className:"block text-sm font-medium text-gray-700 mb-2",children:"图标 (可选)"}),(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[y.icon&&r.jsx("div",{className:"flex-shrink-0 w-16 h-16 flex items-center justify-center bg-gray-50 rounded border border-gray-200",children:r.jsx("img",{src:y.icon,alt:"图标",className:"max-w-full max-h-full object-contain"})}),(0,r.jsxs)("div",{className:"flex-1 flex items-center gap-3",children:[!y.icon&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("input",{type:"file",id:"iconInput",accept:".jpg,.jpeg,.png,.gif,.webp,.svg",onChange:L,disabled:N,className:"hidden"}),r.jsx("label",{htmlFor:"iconInput",className:`px-4 py-2 bg-blue-500 text-white rounded-lg font-medium transition-all duration-300 hover:bg-blue-600 hover:shadow-md text-xs cursor-pointer whitespace-nowrap ${N?"opacity-50 cursor-not-allowed":""}`,children:N?"上传中...":"选择文件"})]}),r.jsx("input",{id:"icon",name:"icon",type:"text",value:y.icon,onChange:P,placeholder:"图标 URL",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white placeholder-gray-400"})]}),y.icon&&r.jsx("button",{type:"button",onClick:()=>{w({...y,icon:""}),v({show:!0,type:"success",message:"图标删除成功"})},className:"flex-shrink-0 px-3 py-2 bg-red-500 text-white rounded-lg font-medium transition-all duration-300 hover:bg-red-600 hover:shadow-md text-xs whitespace-nowrap",children:"删除"})]}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"支持 jpg、png、gif、webp、svg 格式"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"qrcode",className:"block text-sm font-medium text-gray-700 mb-2",children:"二维码图片 (可选)"}),r.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"上传二维码后，前台点击社交链接将显示二维码弹窗，不会跳转URL"}),(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[y.qrcode&&r.jsx("div",{className:"flex-shrink-0 w-20 h-20 flex items-center justify-center bg-gray-50 rounded border border-gray-200",children:r.jsx("img",{src:y.qrcode,alt:"二维码",className:"w-full h-full object-contain"})}),(0,r.jsxs)("div",{className:"flex-1 flex items-center gap-3",children:[!y.qrcode&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("input",{type:"file",id:"qrcodeInput",accept:".jpg,.jpeg,.png,.gif,.webp,.svg",onChange:T,disabled:q,className:"hidden"}),r.jsx("label",{htmlFor:"qrcodeInput",className:`px-4 py-2 bg-blue-500 text-white rounded-lg font-medium transition-all duration-300 hover:bg-blue-600 hover:shadow-md text-xs cursor-pointer whitespace-nowrap ${q?"opacity-50 cursor-not-allowed":""}`,children:q?"上传中...":"选择文件"})]}),r.jsx("input",{id:"qrcode",name:"qrcode",type:"text",value:y.qrcode,onChange:P,placeholder:"二维码图片 URL",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white placeholder-gray-400"})]}),y.qrcode&&r.jsx("button",{type:"button",onClick:()=>{w({...y,qrcode:""}),v({show:!0,type:"success",message:"二维码删除成功"})},className:"flex-shrink-0 px-3 py-2 bg-red-500 text-white rounded-lg font-medium transition-all duration-300 hover:bg-red-600 hover:shadow-md text-xs whitespace-nowrap",children:"删除"})]}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"支持 jpg、png、gif、webp、svg 格式"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[r.jsx("input",{type:"checkbox",id:"show_in_profile",name:"show_in_profile",checked:y.show_in_profile||!1,onChange:e=>w({...y,show_in_profile:e.target.checked}),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"在个人资料卡片中显示（最多显示6个），博客模式下建议只选择4个！"})]}),r.jsx("p",{className:"text-xs text-gray-500 mt-1 ml-6",children:"勾选后，此社交链接将显示在博客主题的个人资料卡片下方，图标会根据数量自动调整大小和间距"})]}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[r.jsx("button",{type:"submit",className:"btn btn-primary",children:h?"更新":"添加"}),r.jsx("button",{type:"button",onClick:A,className:"btn btn-secondary",children:"取消"})]})]})]}),(0,r.jsxs)("div",{className:"card",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:"已添加的社交链接"}),0===u.length?r.jsx("p",{className:"text-gray-500 text-center py-8",children:"还没有添加任何社交链接"}):r.jsx("div",{className:"divide-y divide-gray-200",children:u.map((e,s)=>(0,r.jsxs)("div",{className:"flex items-center justify-between py-4 first:pt-0 last:pb-0",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1 mr-3",children:[r.jsx("button",{onClick:async()=>{if(0===s)return;let e=[...u],t=e[s];e[s]=e[s-1],e[s-1]=t,p(e);try{let s=e.map((e,s)=>({id:e.id,sort_order:s}));await (0,d.wz)("/api/admin/social-links/sort/update",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({sortData:s})})}catch(e){console.error("Failed to update sort order:",e)}},disabled:0===s,className:"p-1 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"上移",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),r.jsx("button",{onClick:async()=>{if(s===u.length-1)return;let e=[...u],t=e[s];e[s]=e[s+1],e[s+1]=t,p(e);try{let s=e.map((e,s)=>({id:e.id,sort_order:s}));await (0,d.wz)("/api/admin/social-links/sort/update",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({sortData:s})})}catch(e){console.error("Failed to update sort order:",e)}},disabled:s===u.length-1,className:"p-1 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"下移",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("h3",{className:"font-medium text-gray-900",children:e.platform}),e.show_in_profile&&r.jsx("span",{className:"px-2 py-0.5 text-xs bg-primary-100 text-primary-700 rounded-full",children:"显示在资料卡"})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["账号：",e.account]}),e.link&&r.jsx("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary-600 hover:underline",children:e.link})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:()=>F(e),className:"btn btn-secondary text-sm",children:"编辑"}),r.jsx("button",{onClick:()=>e.id&&D(e.id),className:"btn bg-red-600 hover:bg-red-700 text-white text-sm",children:"删除"})]})]},e.id))})]})]})})]})}},59532:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(68570).createProxy)(String.raw`D:\360Downloads\www\tool-new\Xs-blog\frontend\src\app\admins\social-links\page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[380,804,795,964,551],()=>t(32242));module.exports=r})();