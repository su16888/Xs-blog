module.exports=[957723,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(346271),e=a.i(262036),f=a.i(883706);let g=(0,f.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),h=(0,f.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var i=a.i(633508);function j({show:a,message:f,type:j,duration:k=3e3,onClose:l}){let[m,n]=(0,c.useState)(!1);(0,c.useEffect)(()=>{if(a){n(!0);let a=setTimeout(()=>{n(!1)},k);return()=>clearTimeout(a)}n(!1)},[a,k]),(0,c.useEffect)(()=>{if(!m&&a){let a=setTimeout(l,300);return()=>clearTimeout(a)}},[m,a,l]);let o=(()=>{switch(j){case"success":return{bg:"bg-green-50 border-green-200",text:"text-green-800",icon:(0,b.jsx)(g,{className:"w-5 h-5 text-green-500"})};case"error":return{bg:"bg-red-50 border-red-200",text:"text-red-800",icon:(0,b.jsx)(h,{className:"w-5 h-5 text-red-500"})};default:return{bg:"bg-blue-50 border-blue-200",text:"text-blue-800",icon:(0,b.jsx)(g,{className:"w-5 h-5 text-blue-500"})}}})();return(0,b.jsx)(e.AnimatePresence,{children:m&&(0,b.jsx)(d.motion.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.9},transition:{duration:.2},className:"fixed top-4 right-4 z-[999999] min-w-[300px] max-w-md",children:(0,b.jsxs)("div",{className:`${o.bg} border rounded-lg shadow-lg p-4 flex items-start gap-3`,children:[(0,b.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:o.icon}),(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsx)("p",{className:`${o.text} text-sm font-medium`,children:f})}),(0,b.jsx)("button",{onClick:()=>{n(!1)},className:"flex-shrink-0 text-gray-400 hover:text-gray-600 transition-colors",children:(0,b.jsx)(i.X,{className:"w-4 h-4"})})]})})})}a.s(["default",()=>j],957723)},262036,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(886723),e=a.i(774290),f=a.i(801703),g=a.i(414800),h=a.i(991128),i=c,j=a.i(965802);function k(a,b){if("function"==typeof a)return a(b);null!=a&&(a.current=b)}class l extends i.Component{getSnapshotBeforeUpdate(a){let b=this.props.childRef.current;if(b&&a.isPresent&&!this.props.isPresent){let a=b.offsetParent,c=(0,h.isHTMLElement)(a)&&a.offsetWidth||0,d=this.props.sizeRef.current;d.height=b.offsetHeight||0,d.width=b.offsetWidth||0,d.top=b.offsetTop,d.left=b.offsetLeft,d.right=c-d.width-d.left}return null}componentDidUpdate(){}render(){return this.props.children}}function m({children:a,isPresent:d,anchorX:e,root:f}){let g=(0,i.useId)(),h=(0,i.useRef)(null),m=(0,i.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:n}=(0,i.useContext)(j.MotionConfigContext),o=function(...a){return c.useCallback(function(...a){return b=>{let c=!1,d=a.map(a=>{let d=k(a,b);return c||"function"!=typeof d||(c=!0),d});if(c)return()=>{for(let b=0;b<d.length;b++){let c=d[b];"function"==typeof c?c():k(a[b],null)}}}}(...a),a)}(h,a?.ref);return(0,i.useInsertionEffect)(()=>{let{width:a,height:b,top:c,left:i,right:j}=m.current;if(d||!h.current||!a||!b)return;let k="left"===e?`left: ${i}`:`right: ${j}`;h.current.dataset.motionPopId=g;let l=document.createElement("style");n&&(l.nonce=n);let o=f??document.head;return o.appendChild(l),l.sheet&&l.sheet.insertRule(`
          [data-motion-pop-id="${g}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${b}px !important;
            ${k}px !important;
            top: ${c}px !important;
          }
        `),()=>{o.contains(l)&&o.removeChild(l)}},[d]),(0,b.jsx)(l,{isPresent:d,childRef:h,sizeRef:m,children:i.cloneElement(a,{ref:o})})}let n=({children:a,initial:d,isPresent:f,onExitComplete:h,custom:i,presenceAffectsLayout:j,mode:k,anchorX:l,root:n})=>{let p=(0,e.useConstant)(o),q=(0,c.useId)(),r=!0,s=(0,c.useMemo)(()=>(r=!1,{id:q,initial:d,isPresent:f,custom:i,onExitComplete:a=>{for(let b of(p.set(a,!0),p.values()))if(!b)return;h&&h()},register:a=>(p.set(a,!1),()=>p.delete(a))}),[f,p,h]);return j&&r&&(s={...s}),(0,c.useMemo)(()=>{p.forEach((a,b)=>p.set(b,!1))},[f]),c.useEffect(()=>{f||p.size||!h||h()},[f]),"popLayout"===k&&(a=(0,b.jsx)(m,{isPresent:f,anchorX:l,root:n,children:a})),(0,b.jsx)(g.PresenceContext.Provider,{value:s,children:a})};function o(){return new Map}var p=a.i(120410);let q=a=>a.key||"";function r(a){let b=[];return c.Children.forEach(a,a=>{(0,c.isValidElement)(a)&&b.push(a)}),b}let s=({children:a,custom:g,initial:h=!0,onExitComplete:i,presenceAffectsLayout:j=!0,mode:k="sync",propagate:l=!1,anchorX:m="left",root:o})=>{let[s,t]=(0,p.usePresence)(l),u=(0,c.useMemo)(()=>r(a),[a]),v=l&&!s?[]:u.map(q),w=(0,c.useRef)(!0),x=(0,c.useRef)(u),y=(0,e.useConstant)(()=>new Map),[z,A]=(0,c.useState)(u),[B,C]=(0,c.useState)(u);(0,f.useIsomorphicLayoutEffect)(()=>{w.current=!1,x.current=u;for(let a=0;a<B.length;a++){let b=q(B[a]);v.includes(b)?y.delete(b):!0!==y.get(b)&&y.set(b,!1)}},[B,v.length,v.join("-")]);let D=[];if(u!==z){let a=[...u];for(let b=0;b<B.length;b++){let c=B[b],d=q(c);v.includes(d)||(a.splice(b,0,c),D.push(c))}return"wait"===k&&D.length&&(a=D),C(r(a)),A(u),null}let{forceRender:E}=(0,c.useContext)(d.LayoutGroupContext);return(0,b.jsx)(b.Fragment,{children:B.map(a=>{let c=q(a),d=(!l||!!s)&&(u===B||v.includes(c));return(0,b.jsx)(n,{isPresent:d,initial:(!w.current||!!h)&&void 0,custom:g,presenceAffectsLayout:j,mode:k,root:o,onExitComplete:d?void 0:()=>{if(!y.has(c))return;y.set(c,!0);let a=!0;y.forEach(b=>{b||(a=!1)}),a&&(E?.(),C(x.current),l&&t?.(),i&&i())},anchorX:m,children:a},c)})})};a.s(["AnimatePresence",()=>s],262036)},465763,a=>{"use strict";var b=a.i(572131),c=a.i(182572);let d=null;function e(a,f=!1){let[g,h]=(0,b.useState)(d||""),i=(0,c.useOptionalPageTitleContext)();(0,b.useEffect)(()=>{f&&i&&i.setTitle(a)},[a,f,i]),(0,b.useEffect)(()=>{d?h(d):(async()=>{try{let a=await fetch("/api/settings");if(a.ok){let b=await a.json();if(b.success&&b.data){let a={};b.data.forEach(b=>{a[b.key]=b.value});let c=a.siteTitle||"";d=c,h(c)}}}catch(a){console.error("Failed to fetch site title:",a)}})()},[]),(0,b.useEffect)(()=>{let b=document.title;return f?"仪表盘"===a?document.title=`${g} - 后台管理系统`:document.title=`${a} - ${g}后台管理系统`:document.title=`${a} - ${g}`,()=>{document.title=b}},[a,g,f])}a.s(["usePageTitle",()=>e])},812266,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(50944),e=a.i(711642),f=a.i(119032),g=a.i(465763),h=a.i(957723),i=a.i(368114);function j(){(0,g.usePageTitle)("社交链接管理"),(0,d.useRouter)();let{user:a}=(0,e.useAuth)(),[j,k]=(0,c.useState)([]),[l,m]=(0,c.useState)(!0),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)({platform:"",account:"",link:"",icon:"",qrcode:"",show_in_profile:!1}),[t,u]=(0,c.useState)({show:!1,type:"success",message:""}),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(!1);(0,c.useEffect)(()=>{z()},[]);let z=async()=>{try{let a=await (0,f.getAdminSocialLinks)();if(a.success){let b=Array.isArray(a.data)?a.data:[];k(b)}}catch(a){console.error("加载社交链接失败:",a),k([])}finally{m(!1)}},A=a=>{s({...r,[a.target.name]:a.target.value})},B=async a=>{a.preventDefault();try{n?.id?(await (0,f.updateAdminSocialLink)(n.id,r)).success&&(u({show:!0,type:"success",message:"社交链接更新成功"}),await z(),D()):(await (0,f.createAdminSocialLink)(r)).success&&(u({show:!0,type:"success",message:"社交链接添加成功"}),await z(),D())}catch(a){u({show:!0,type:"error",message:a.response?.data?.message||"操作失败"})}},C=async a=>{if(confirm("确定要删除这个社交链接吗？"))try{(await (0,f.deleteAdminSocialLink)(a)).success&&(u({show:!0,type:"success",message:"社交链接删除成功"}),await z())}catch(a){u({show:!0,type:"error",message:a.response?.data?.message||"删除失败"})}},D=()=>{s({platform:"",account:"",link:"",icon:"",qrcode:"",show_in_profile:!1}),o(null),q(!1)},E=async a=>{let b=a.target.files?.[0];if(b){w(!0);try{let c=await (0,f.uploadAdminSocialLinkIcon)(b);c.success&&(s({...r,icon:c.data.url}),u({show:!0,type:"success",message:"图标上传成功"}),a.target.value="")}catch(a){u({show:!0,type:"error",message:a.response?.data?.message||"图标上传失败"})}finally{w(!1)}}},F=async a=>{let b=a.target.files?.[0];if(b){y(!0);try{let c=await (0,f.uploadAdminSocialLinkQRCode)(b);c.success&&(s({...r,qrcode:c.data.url}),u({show:!0,type:"success",message:"二维码上传成功"}),a.target.value="")}catch(a){u({show:!0,type:"error",message:a.response?.data?.message||"二维码上传失败"})}finally{y(!1)}}};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.default,{show:t.show,message:t.message,type:t.type,onClose:()=>u({...t,show:!1})}),(0,b.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,b.jsx)("div",{className:"mb-6",children:(0,b.jsx)("button",{onClick:()=>q(!p),className:"btn btn-primary",children:p?"取消":"+ 添加社交链接"})}),p&&(0,b.jsxs)("div",{className:"card mb-6",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold mb-4",children:n?"编辑社交链接":"添加社交链接"}),(0,b.jsxs)("form",{onSubmit:B,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"platform",className:"block text-sm font-medium text-gray-700 mb-2",children:"平台名称"}),(0,b.jsx)("input",{id:"platform",name:"platform",type:"text",required:!0,value:r.platform,onChange:A,className:"input",placeholder:"例如：GitHub, Twitter, LinkedIn"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"account",className:"block text-sm font-medium text-gray-700 mb-2",children:"账号/用户名"}),(0,b.jsx)("input",{id:"account",name:"account",type:"text",required:!0,value:r.account,onChange:A,className:"input",placeholder:"例如：yourusername"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"link",className:"block text-sm font-medium text-gray-700 mb-2",children:"链接地址 (可选)"}),(0,b.jsx)("input",{id:"link",name:"link",type:"url",value:r.link,onChange:A,className:"input",placeholder:"https://..."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"icon",className:"block text-sm font-medium text-gray-700 mb-2",children:"图标 (可选)"}),(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[r.icon&&(0,b.jsx)("div",{className:"flex-shrink-0 w-16 h-16 flex items-center justify-center bg-gray-50 rounded border border-gray-200",children:(0,b.jsx)("img",{src:r.icon,alt:"图标",className:"max-w-full max-h-full object-contain"})}),(0,b.jsxs)("div",{className:"flex-1 flex items-center gap-3",children:[!r.icon&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("input",{type:"file",id:"iconInput",accept:".jpg,.jpeg,.png,.gif,.webp,.svg",onChange:E,disabled:v,className:"hidden"}),(0,b.jsx)("label",{htmlFor:"iconInput",className:`px-4 py-2 bg-blue-500 text-white rounded-lg font-medium transition-all duration-300 hover:bg-blue-600 hover:shadow-md text-xs cursor-pointer whitespace-nowrap ${v?"opacity-50 cursor-not-allowed":""}`,children:v?"上传中...":"选择文件"})]}),(0,b.jsx)("input",{id:"icon",name:"icon",type:"text",value:r.icon,onChange:A,placeholder:"图标 URL",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white placeholder-gray-400"})]}),r.icon&&(0,b.jsx)("button",{type:"button",onClick:()=>{s({...r,icon:""}),u({show:!0,type:"success",message:"图标删除成功"})},className:"flex-shrink-0 px-3 py-2 bg-red-500 text-white rounded-lg font-medium transition-all duration-300 hover:bg-red-600 hover:shadow-md text-xs whitespace-nowrap",children:"删除"})]}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"支持 jpg、png、gif、webp、svg 格式"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"qrcode",className:"block text-sm font-medium text-gray-700 mb-2",children:"二维码图片 (可选)"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mb-3",children:"上传二维码后，前台点击社交链接将显示二维码弹窗，不会跳转URL"}),(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[r.qrcode&&(0,b.jsx)("div",{className:"flex-shrink-0 w-20 h-20 flex items-center justify-center bg-gray-50 rounded border border-gray-200",children:(0,b.jsx)("img",{src:r.qrcode,alt:"二维码",className:"w-full h-full object-contain"})}),(0,b.jsxs)("div",{className:"flex-1 flex items-center gap-3",children:[!r.qrcode&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("input",{type:"file",id:"qrcodeInput",accept:".jpg,.jpeg,.png,.gif,.webp,.svg",onChange:F,disabled:x,className:"hidden"}),(0,b.jsx)("label",{htmlFor:"qrcodeInput",className:`px-4 py-2 bg-blue-500 text-white rounded-lg font-medium transition-all duration-300 hover:bg-blue-600 hover:shadow-md text-xs cursor-pointer whitespace-nowrap ${x?"opacity-50 cursor-not-allowed":""}`,children:x?"上传中...":"选择文件"})]}),(0,b.jsx)("input",{id:"qrcode",name:"qrcode",type:"text",value:r.qrcode,onChange:A,placeholder:"二维码图片 URL",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white placeholder-gray-400"})]}),r.qrcode&&(0,b.jsx)("button",{type:"button",onClick:()=>{s({...r,qrcode:""}),u({show:!0,type:"success",message:"二维码删除成功"})},className:"flex-shrink-0 px-3 py-2 bg-red-500 text-white rounded-lg font-medium transition-all duration-300 hover:bg-red-600 hover:shadow-md text-xs whitespace-nowrap",children:"删除"})]}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"支持 jpg、png、gif、webp、svg 格式"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",id:"show_in_profile",name:"show_in_profile",checked:r.show_in_profile||!1,onChange:a=>s({...r,show_in_profile:a.target.checked}),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"在个人资料卡片中显示（最多显示6个），博客模式下建议只选择4个！"})]}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1 ml-6",children:"勾选后，此社交链接将显示在博客主题的个人资料卡片下方，图标会根据数量自动调整大小和间距"})]}),(0,b.jsxs)("div",{className:"flex space-x-4",children:[(0,b.jsx)("button",{type:"submit",className:"btn btn-primary",children:n?"更新":"添加"}),(0,b.jsx)("button",{type:"button",onClick:D,className:"btn btn-secondary",children:"取消"})]})]})]}),(0,b.jsxs)("div",{className:"card",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"已添加的社交链接"}),0===j.length?(0,b.jsx)("p",{className:"text-gray-500 text-center py-8",children:"还没有添加任何社交链接"}):(0,b.jsx)("div",{className:"divide-y divide-gray-200",children:j.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between py-4 first:pt-0 last:pb-0",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-1 mr-3",children:[(0,b.jsx)("button",{onClick:async()=>{if(0===c)return;let a=[...j],b=a[c];a[c]=a[c-1],a[c-1]=b,k(a);try{let b=a.map((a,b)=>({id:a.id,sort_order:b}));await (0,i.safeFetch)("/api/admin/social-links/sort/update",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({sortData:b})})}catch(a){console.error("Failed to update sort order:",a)}},disabled:0===c,className:"p-1 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"上移",children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),(0,b.jsx)("button",{onClick:async()=>{if(c===j.length-1)return;let a=[...j],b=a[c];a[c]=a[c+1],a[c+1]=b,k(a);try{let b=a.map((a,b)=>({id:a.id,sort_order:b}));await (0,i.safeFetch)("/api/admin/social-links/sort/update",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({sortData:b})})}catch(a){console.error("Failed to update sort order:",a)}},disabled:c===j.length-1,className:"p-1 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"下移",children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("h3",{className:"font-medium text-gray-900",children:a.platform}),a.show_in_profile&&(0,b.jsx)("span",{className:"px-2 py-0.5 text-xs bg-primary-100 text-primary-700 rounded-full",children:"显示在资料卡"})]}),(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:["账号：",a.account]}),a.link&&(0,b.jsx)("a",{href:a.link,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary-600 hover:underline",children:a.link})]}),(0,b.jsxs)("div",{className:"flex space-x-2",children:[(0,b.jsx)("button",{onClick:()=>{o(a),s({platform:a.platform,account:a.account,link:a.link||"",icon:a.icon||"",qrcode:a.qrcode||"",show_in_profile:a.show_in_profile||!1}),q(!0)},className:"btn btn-secondary text-sm",children:"编辑"}),(0,b.jsx)("button",{onClick:()=>a.id&&C(a.id),className:"btn bg-red-600 hover:bg-red-700 text-white text-sm",children:"删除"})]})]},a.id))})]})]})})]})}a.s(["default",()=>j])}];

//# sourceMappingURL=_d63f05fd._.js.map