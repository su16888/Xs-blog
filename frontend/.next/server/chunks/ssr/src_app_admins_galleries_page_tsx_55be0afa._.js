module.exports=[8305,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(11642),f=a.i(19032),g=a.i(65763),h=a.i(57723),i=a.i(38632),j=a.i(15618),k=a.i(70106);let l=(0,k.default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var m=a.i(81560),n=a.i(73320),o=a.i(77156),p=a.i(41379),q=a.i(43108);let r=(0,k.default)("folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);function s(){(0,g.usePageTitle)("图库管理",!0),(0,d.useRouter)();let{user:a}=(0,e.useAuth)(),[k,s]=(0,c.useState)([]),[t,u]=(0,c.useState)([]),[v,w]=(0,c.useState)(!0),[x,y]=(0,c.useState)("galleries"),[z,A]=(0,c.useState)(1),[B]=(0,c.useState)(20),[C,D]=(0,c.useState)(!0),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)({title:"",description:"",category_id:null,password:"",is_visible:!0,sort_order:0}),[M,N]=(0,c.useState)(!1),[O,P]=(0,c.useState)(null),[Q,R]=(0,c.useState)(!1),[S,T]=(0,c.useState)({name:"",description:"",icon:"",sort_order:0,is_visible:!0}),[U,V]=(0,c.useState)(!1),[W,X]=(0,c.useState)(null),[Y,Z]=(0,c.useState)(!1),[$,_]=(0,c.useState)(null),[aa,ab]=(0,c.useState)(null),[ac,ad]=(0,c.useState)(null),[ae,af]=(0,c.useState)({show:!1,type:"success",message:""});(0,c.useEffect)(()=>{ag()},[]);let ag=async()=>{w(!0),A(1);try{await Promise.all([ah(1,!0),aj()])}catch(a){console.error("Failed to load data:",a)}finally{w(!1)}},ah=async(a=z,b=!1)=>{try{let c=await (0,f.getAdminGalleries)();if(c.success){let d=c.data,e=(a-1)*B,f=e+B,g=d.slice(e,f);b?s(g):s(a=>{let b=new Set(a.map(a=>a.id)),c=g.filter(a=>!b.has(a.id));return[...a,...c]}),D(f<d.length)}}catch(a){console.error("Failed to fetch galleries:",a)}},ai=async()=>{if(E||!C)return;F(!0);let a=z+1;A(a);try{await ah(a,!1)}catch(a){console.error("Failed to load more galleries:",a)}finally{F(!1)}},aj=async()=>{try{let a=await (0,f.getAdminGalleryCategories)();a.success&&u(a.data)}catch(a){console.error("Failed to fetch categories:",a)}},ak=(a,b)=>{af({show:!0,type:a,message:b})},al=async()=>{if(!K.title.trim())return void ak("error","请输入图册标题");try{G?.id?(await (0,f.updateGallery)(G.id,K)).success&&(ak("success","图册更新成功"),await ah(1,!0),J(!1)):(await (0,f.createGallery)(K)).success&&(ak("success","图册创建成功"),await ah(1,!0),J(!1))}catch(a){ak("error",a.response?.data?.message||"操作失败")}},am=async a=>{if(confirm("确定要删除这个图册吗？这将同时删除图册中的所有图片！"))try{(await (0,f.deleteGallery)(a)).success&&(ak("success","图册删除成功"),await ah(1,!0))}catch(a){ak("error",a.response?.data?.message||"删除失败")}},an=async(a,b)=>{if(b&&0!==b.length){V(!0),X(a);try{let c=new FormData;Array.from(b).forEach(a=>{c.append("images",a)}),(await (0,f.uploadGalleryImages)(a,c)).success&&(ak("success",`成功上传 ${b.length} 张图片`),await ah(1,!0),$?.id===a&&setTimeout(()=>{s(b=>{let c=b.find(b=>b.id===a);return c&&_(c),b})},100))}catch(a){ak("error",a.response?.data?.message||"上传失败")}finally{V(!1),X(null)}}},ao=()=>{if(null===aa||null===ac||!$?.images||aa===ac){ab(null),ad(null);return}let a=[...$.images],[b]=a.splice(aa,1);a.splice(ac,0,b);let c=a.map((a,b)=>({...a,sort_order:b}));_({...$,images:c}),ap($.id,c),ab(null),ad(null)},ap=async(a,b)=>{try{let c=b.map((a,b)=>({id:a.id,sort_order:b}));if((await (0,f.updateGalleryImageOrder)(a,c)).success){ak("success","排序已保存");let c=b.length>0?b[0].path:null;s(b=>b.map(b=>b.id===a?{...b,cover_image:c||void 0}:b)),$?.id===a&&_(a=>a?{...a,cover_image:c||void 0}:null)}}catch(a){ak("error",a.response?.data?.message||"排序保存失败")}},aq=async(a,b)=>{if(confirm("确定要删除这张图片吗？"))try{if((await (0,f.deleteGalleryImage)(a,b)).success)if(ak("success","图片删除成功"),$?.id===a&&$.images){let c=$.images.filter(a=>a.id!==b),d=c.length,e=c.length>0?c[0].path:null;_({...$,images:c,image_count:d,cover_image:e||void 0}),s(b=>b.map(b=>b.id===a?{...b,image_count:d,cover_image:e||void 0}:b))}else await ah(1,!0)}catch(a){ak("error",a.response?.data?.message||"删除失败")}},ar=async()=>{if(!S.name.trim())return void ak("error","请输入分类名称");try{O?.id?(await (0,f.updateGalleryCategory)(O.id,S)).success&&(ak("success","分类更新成功"),await aj(),R(!1)):(await (0,f.createGalleryCategory)(S)).success&&(ak("success","分类创建成功"),await aj(),R(!1))}catch(a){ak("error",a.response?.data?.message||"操作失败")}},as=async a=>{if(confirm("确定要删除这个分类吗？"))try{(await (0,f.deleteGalleryCategory)(a)).success&&(ak("success","分类删除成功"),await aj())}catch(a){ak("error",a.response?.data?.message||"删除失败")}};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.default,{show:ae.show,message:ae.message,type:ae.type,onClose:()=>af({...ae,show:!1})}),(0,b.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,b.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[(0,b.jsxs)("div",{className:"flex space-x-4 border-b border-gray-200",children:[(0,b.jsx)("button",{onClick:()=>y("galleries"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${"galleries"===x?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"图册管理"}),(0,b.jsx)("button",{onClick:()=>y("categories"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${"categories"===x?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"分类管理"})]}),"galleries"===x&&(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,b.jsxs)("div",{className:"text-sm text-gray-500",children:["共 ",k.length," 个图册"]}),(0,b.jsxs)("button",{onClick:()=>{H(null),L({title:"",description:"",category_id:null,password:"",is_visible:!0,sort_order:0}),J(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[(0,b.jsx)(j.Plus,{className:"w-4 h-4"}),"创建图册"]})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[k.map(a=>(0,b.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-md transition-shadow",children:(0,b.jsxs)("div",{className:"flex items-center gap-4 p-4",children:[(0,b.jsxs)("div",{className:"relative w-24 h-24 flex-shrink-0 bg-gradient-to-br from-blue-100 to-blue-200 rounded-lg overflow-hidden",children:[a.cover_image?(0,b.jsx)("img",{src:(0,f.getImageUrl)(a.cover_image),alt:a.title,className:"w-full h-full object-cover"}):(0,b.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,b.jsx)(i.Image,{className:"w-8 h-8 text-blue-400"})}),a.hasPassword&&(0,b.jsx)("div",{className:"absolute top-1 right-1 bg-black/50 backdrop-blur-sm rounded-full p-1",children:(0,b.jsx)(q.Lock,{className:"w-3 h-3 text-white"})}),!a.is_visible&&(0,b.jsx)("div",{className:"absolute top-1 left-1 bg-black/50 backdrop-blur-sm rounded-full px-2 py-0.5 text-xs text-white",children:"未发布"})]}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("h3",{className:"font-medium text-gray-900 mb-1 truncate",children:a.title}),a.description&&(0,b.jsx)("p",{className:"text-sm text-gray-500 line-clamp-2 mb-2",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(i.Image,{className:"w-3 h-3"}),a.image_count||0," 张图片"]}),a.category_id&&t.find(b=>b.id===a.category_id)&&(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(r,{className:"w-3 h-3"}),t.find(b=>b.id===a.category_id)?.name]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[(0,b.jsxs)("label",{className:"cursor-pointer",children:[(0,b.jsx)("input",{type:"file",multiple:!0,accept:"image/*",className:"hidden",onChange:b=>an(a.id,b.target.files),disabled:U&&W===a.id}),(0,b.jsxs)("div",{className:"flex items-center justify-center gap-1 px-3 py-2 bg-green-600 hover:bg-green-700 text-white rounded text-sm transition-colors whitespace-nowrap",children:[(0,b.jsx)(n.Upload,{className:"w-4 h-4"}),U&&W===a.id?"上传中...":"上传"]})]}),(0,b.jsxs)("button",{onClick:()=>{_(a),Z(!0)},className:"flex items-center justify-center gap-1 px-3 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded text-sm transition-colors whitespace-nowrap",title:"管理图片",children:[(0,b.jsx)(i.Image,{className:"w-4 h-4"}),"管理"]}),(0,b.jsx)("button",{onClick:()=>{H(a),L({title:a.title,description:a.description||"",category_id:a.category_id||null,password:"",is_visible:!1!==a.is_visible,sort_order:a.sort_order||0}),J(!0)},className:"flex items-center justify-center gap-1 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm transition-colors",title:"编辑",children:(0,b.jsx)(l,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:()=>am(a.id),className:"flex items-center justify-center gap-1 px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded text-sm transition-colors",title:"删除",children:(0,b.jsx)(m.Trash2,{className:"w-4 h-4"})})]})]})},a.id)),0===k.length&&!v&&(0,b.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,b.jsx)(i.Image,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),(0,b.jsx)("p",{children:"暂无图册"})]}),C&&k.length>0&&(0,b.jsx)("div",{className:"text-center pt-4",children:(0,b.jsx)("button",{onClick:ai,disabled:E,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:E?(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"加载中..."]}):"加载更多"})})]})]}),"categories"===x&&(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,b.jsxs)("div",{className:"text-sm text-gray-500",children:["共 ",t.length," 个分类"]}),(0,b.jsxs)("button",{onClick:()=>{P(null),T({name:"",description:"",icon:"",sort_order:0,is_visible:!0}),R(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[(0,b.jsx)(j.Plus,{className:"w-4 h-4"}),"添加分类"]})]}),0===t.length?(0,b.jsx)("div",{className:"text-center py-8 text-gray-500",children:"暂无分类"}):(0,b.jsx)("div",{className:"bg-gray-50 rounded-lg border border-gray-200 max-h-96 overflow-y-auto",children:(0,b.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,b.jsx)("thead",{className:"bg-gray-100",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"分类名称"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"描述"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"图册数"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"排序"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"状态"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),(0,b.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(a=>(0,b.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsx)("div",{className:"font-medium text-gray-900",children:a.name})}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-500 max-w-xs truncate",children:a.description||"-"}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:a.galleryCount||0}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:a.sort_order}),(0,b.jsx)("td",{className:"px-4 py-3",children:a.is_visible?(0,b.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium bg-green-100 text-green-700 rounded",children:[(0,b.jsx)(o.Eye,{className:"w-3 h-3"}),"可见"]}):(0,b.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium bg-gray-100 text-gray-700 rounded",children:[(0,b.jsx)(p.EyeOff,{className:"w-3 h-3"}),"隐藏"]})}),(0,b.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:(0,b.jsxs)("div",{className:"flex space-x-2",children:[(0,b.jsx)("button",{onClick:()=>{P(a),T({name:a.name,description:a.description||"",icon:a.icon||"",sort_order:a.sort_order||0,is_visible:!1!==a.is_visible}),R(!0)},className:"text-blue-600 hover:text-blue-900 text-sm",children:"编辑"}),(0,b.jsx)("button",{onClick:()=>as(a.id),className:"text-red-600 hover:text-red-900 text-sm",children:"删除"})]})})]},a.id))})]})})]})]})})}),I&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[99999] p-4",children:(0,b.jsx)("div",{className:"bg-white rounded-lg max-w-xl w-full max-h-[90vh] overflow-y-auto",children:(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault(),al()},className:"p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-bold mb-6",children:G?"编辑图册":"创建图册"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["图册标题 ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{type:"text",value:K.title,onChange:a=>L({...K,title:a.target.value}),className:"w-full px-4 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"请输入图册标题"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"图册描述"}),(0,b.jsx)("textarea",{value:K.description,onChange:a=>L({...K,description:a.target.value}),rows:3,className:"w-full px-4 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"请输入图册描述"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"所属分类"}),(0,b.jsxs)("select",{value:K.category_id||"",onChange:a=>L({...K,category_id:a.target.value?Number(a.target.value):null}),className:"w-full px-4 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,b.jsx)("option",{value:"",children:"无分类"}),t.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"访问密码"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{type:M?"text":"password",name:"gallery-password",autoComplete:"off",value:K.password,onChange:a=>L({...K,password:a.target.value}),className:"w-full px-4 py-2 pr-10 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:G?"留空则不修改密码":"留空则无需密码"}),(0,b.jsx)("button",{type:"button",onClick:()=>N(!M),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-tertiary hover:text-text-primary",children:M?(0,b.jsx)(p.EyeOff,{className:"w-4 h-4"}):(0,b.jsx)(o.Eye,{className:"w-4 h-4"})})]}),(0,b.jsx)("p",{className:"text-xs text-text-tertiary mt-1",children:"设置密码后，用户需要输入密码才能查看图片"})]}),(0,b.jsx)("div",{className:"flex items-center gap-4",children:(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:K.is_visible,onChange:a=>L({...K,is_visible:a.target.checked}),className:"w-4 h-4 text-primary-600 border-border-primary rounded focus:ring-2 focus:ring-primary-500"}),(0,b.jsx)("span",{className:"text-sm text-text-primary",children:"前台可见"})]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"排序"}),(0,b.jsx)("input",{type:"number",value:K.sort_order,onChange:a=>L({...K,sort_order:Number(a.target.value)}),className:"w-full px-4 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"数字越小越靠前"})]})]}),(0,b.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,b.jsx)("button",{type:"button",onClick:()=>J(!1),className:"flex-1 px-4 py-2 border border-border-primary rounded-lg hover:bg-bg-secondary transition-colors",children:"取消"}),(0,b.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition-colors",children:"保存"})]})]})})}),Q&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[99999] p-4",children:(0,b.jsx)("div",{className:"bg-white rounded-lg max-w-md w-full",children:(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-bold mb-6",children:O?"编辑分类":"创建分类"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["分类名称 ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{type:"text",value:S.name,onChange:a=>T({...S,name:a.target.value}),className:"w-full px-4 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"请输入分类名称"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"分类描述"}),(0,b.jsx)("textarea",{value:S.description,onChange:a=>T({...S,description:a.target.value}),rows:2,className:"w-full px-4 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"请输入分类描述"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"排序"}),(0,b.jsx)("input",{type:"number",value:S.sort_order,onChange:a=>T({...S,sort_order:Number(a.target.value)}),className:"w-full px-4 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"数字越小越靠前"})]}),(0,b.jsx)("div",{className:"flex items-center gap-4",children:(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:S.is_visible,onChange:a=>T({...S,is_visible:a.target.checked}),className:"w-4 h-4 text-primary-600 border-border-primary rounded focus:ring-2 focus:ring-primary-500"}),(0,b.jsx)("span",{className:"text-sm text-text-primary",children:"前台可见"})]})})]}),(0,b.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,b.jsx)("button",{onClick:()=>R(!1),className:"flex-1 px-4 py-2 border border-border-primary rounded-lg hover:bg-bg-secondary transition-colors",children:"取消"}),(0,b.jsx)("button",{onClick:ar,className:"flex-1 px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition-colors",children:"保存"})]})]})})}),Y&&$&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[99999] p-4",children:(0,b.jsx)("div",{className:"bg-white rounded-lg max-w-5xl w-full max-h-[90vh] overflow-y-auto",children:(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"text-xl font-bold",children:[$.title," - 图片管理"]}),(0,b.jsxs)("p",{className:"text-sm text-text-tertiary mt-1",children:["共 ",$.images?.length||0," 张图片 • 拖拽图片可调整排序 • 第一张为封面"]})]}),(0,b.jsx)("button",{onClick:()=>Z(!1),className:"p-2 hover:bg-bg-secondary rounded-lg transition-colors",children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),$.images&&$.images.length>0?(0,b.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:$.images.map((a,c)=>(0,b.jsxs)("div",{draggable:!0,onDragStart:()=>{ab(c)},onDragOver:a=>{a.preventDefault(),ad(c)},onDragEnd:ao,className:`relative group bg-bg-secondary rounded-lg overflow-hidden cursor-move ${aa===c?"opacity-50":""} ${ac===c?"ring-2 ring-primary-600":""}`,children:[(0,b.jsxs)("div",{className:"relative w-full pt-[100%]",children:[(0,b.jsx)("img",{src:(0,f.getImageUrl)(a.path),alt:a.filename,className:"absolute inset-0 w-full h-full object-cover"}),(0,b.jsxs)("div",{className:"absolute top-2 left-2 bg-black/70 backdrop-blur-sm text-white px-2 py-1 rounded text-xs font-medium",children:["#",c+1,0===c&&(0,b.jsx)("span",{className:"ml-1",children:"封面"})]}),(0,b.jsx)("button",{onClick:()=>aq($.id,a.id),className:"absolute top-2 right-2 bg-red-600 hover:bg-red-700 text-white p-1.5 rounded opacity-0 group-hover:opacity-100 transition-opacity",title:"删除图片",children:(0,b.jsx)(m.Trash2,{className:"w-4 h-4"})})]}),(0,b.jsx)("div",{className:"p-2",children:(0,b.jsx)("p",{className:"text-xs text-text-tertiary truncate",title:a.filename,children:a.filename})})]},a.id))}):(0,b.jsxs)("div",{className:"text-center py-12 text-text-tertiary",children:[(0,b.jsx)(i.Image,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),(0,b.jsx)("p",{children:"暂无图片，请先上传图片"})]}),(0,b.jsx)("div",{className:"flex gap-3 mt-6",children:(0,b.jsx)("button",{onClick:()=>Z(!1),className:"flex-1 px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition-colors",children:"完成"})})]})})})]})}a.s(["default",()=>s],8305)}];

//# sourceMappingURL=src_app_admins_galleries_page_tsx_55be0afa._.js.map