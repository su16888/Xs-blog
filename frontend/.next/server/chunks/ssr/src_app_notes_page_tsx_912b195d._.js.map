{"version":3,"sources":["../../../../src/app/notes/page.tsx"],"sourcesContent":["/**\n * @file notes/page.tsx\n * @description 全部笔记列表页面 - 显示所有已发布的笔记\n * @author Arran\n * @copyright 2025 Arran ( SuMoChen)\n * @version 1.0.0\n * @created 2025-11-09\n */\n\n'use client';\n\nimport { motion } from 'framer-motion';\nimport { Search, X, Clock, Pin, Tag, FolderOpen } from 'lucide-react';\nimport { useEffect, useState } from 'react';\nimport { useRouter, useSearchParams } from 'next/navigation';\nimport api from '@/lib/api';\nimport { getApiBaseUrl } from '@/lib/utils';\nimport BlogNav from '@/components/BlogNav';\nimport { getSettings, getPageText } from '@/lib/api';\nimport Copyright from '@/components/Copyright';\nimport Masonry from 'react-masonry-css';\nimport SEOMeta from '@/components/SEOMeta';\nimport PageBackground from '@/components/PageBackground';\n\nconst API_BASE_URL = getApiBaseUrl();\n\ninterface Note {\n  id: number;\n  title: string;\n  content: string;\n  summary?: string;\n  is_published: boolean;\n  is_pinned?: boolean;\n  published_at?: string;\n  created_at: string;\n  media_type?: 'none' | 'image' | 'video' | 'music';\n  media_urls?: string[];\n  external_link?: string;\n  category?: string;\n  category_id?: number;\n  tags?: string;\n  password?: string;\n  requiresPassword?: boolean;\n  cover_image?: string;\n  Tags?: Array<{\n    id: number;\n    name: string;\n    color?: string;\n  }>;\n}\n\ninterface NoteCategory {\n  id: number;\n  name: string;\n  type?: string;\n  description?: string;\n  icon?: string;\n  sort_order?: number;\n  parent_id?: number;\n  created_at?: string;\n  updated_at?: string;\n}\n\nconst formatDateTime = (dateString: string) => {\n  const date = new Date(dateString);\n  const year = date.getFullYear();\n  const month = String(date.getMonth() + 1).padStart(2, '0');\n  const day = String(date.getDate()).padStart(2, '0');\n  const hours = String(date.getHours()).padStart(2, '0');\n  const minutes = String(date.getMinutes()).padStart(2, '0');\n\n  return `${year}-${month}-${day} ${hours}:${minutes}`;\n};\n\nconst truncate = (str: string, length: number) => {\n  if (str.length <= length) return str;\n  return str.substring(0, length) + '...';\n};\n\n// 过滤markdown符号，返回纯文本内容\nconst stripMarkdown = (markdown: string): string => {\n  if (!markdown) return '';\n\n  let text = markdown;\n\n  // 移除图片语法\n  text = text.replace(/!\\[([^\\]]*)\\]\\(([^)]+)\\)/g, '');\n  text = text.replace(/!\\[([^\\]]*)\\]\\[([^\\]]+)\\]/g, '');\n  text = text.replace(/!\\[([^\\]]+)\\]/g, '');\n  text = text.replace(/!\\s*\\[/g, '');\n\n  // 移除代码块\n  text = text.replace(/```[\\s\\S]*?```/g, '');\n  text = text.replace(/`([^`]+)`/g, '$1');\n  text = text.replace(/`/g, '');\n\n  // 移除标题符号\n  text = text.replace(/^#{1,6}\\s+/gm, '');\n\n  // 移除粗体、斜体、删除线\n  text = text.replace(/\\*\\*([^\\*]+)\\*\\*/g, '$1');\n  text = text.replace(/__([^_]+)__/g, '$1');\n  text = text.replace(/\\*([^\\*]+)\\*/g, '$1');\n  text = text.replace(/_([^_]+)_/g, '$1');\n  text = text.replace(/~~([^~]+)~~/g, '$1');\n\n  // 移除列表符号\n  text = text.replace(/^[\\s]*[-*+]\\s+/gm, '');\n  text = text.replace(/^[\\s]*\\d+\\.\\s+/gm, '');\n\n  // 移除引用符号\n  text = text.replace(/^>\\s+/gm, '');\n\n  // 移除链接符号\n  text = text.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '$1');\n\n  // 移除表格和分割线\n  text = text.replace(/\\|.*\\|/g, '');\n  text = text.replace(/^\\s*[-*_]{3,}\\s*$/gm, '');\n\n  // 清理多余的空格和换行\n  text = text\n    .replace(/\\s+/g, ' ')\n    .replace(/\\n{3,}/g, '\\n\\n')\n    .replace(/\\n\\s*\\n/g, '\\n\\n')\n    .trim();\n\n  return text;\n};\n\nexport default function NotesPage() {\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const [notes, setNotes] = useState<Note[]>([]);\n  const [categories, setCategories] = useState<NoteCategory[]>([]);\n  const [tags, setTags] = useState<string[]>([]);\n  const [selectedCategory, setSelectedCategory] = useState<string>('all');\n  const [selectedTag, setSelectedTag] = useState<string>('all');\n  const [loading, setLoading] = useState(false);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [page, setPage] = useState(1);\n  const [totalPages, setTotalPages] = useState(1);\n\n  // 检测屏幕尺寸\n  const [isDesktop, setIsDesktop] = useState(false);\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsDesktop(window.innerWidth >= 768);\n    };\n\n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n\n    return () => window.removeEventListener('resize', checkScreenSize);\n  }, []);\n\n  // 默认设置（避免加载动画）\n  const defaultSettings = {\n    themeType: 'default',\n    footerCopyright: `© ${new Date().getFullYear()} 个人主页. All rights reserved.`,\n    noteLayoutColumns: '1',\n    showNoteCover: 'true',\n    defaultNoteCover: '',\n    avatarShape: 'circle',\n    noteDisplayMode: 'modal',\n    showTopNavbar: 'true',\n    showWapSidebar: 'true',\n    showNoteTags: 'true',\n    showNoteCategories: 'true'\n  }\n  const [settings, setSettings] = useState<any>(defaultSettings);\n  // 页面文本配置\n  const [pageText, setPageText] = useState({\n    title: '全部笔记',\n    description: '探索所有已发布的笔记内容',\n    browserTitle: '全部笔记',\n    browserSubtitle: ''\n  });\n  const [pageTextLoaded, setPageTextLoaded] = useState(false);\n\n  // 从 URL 参数初始化筛选条件\n  useEffect(() => {\n    const categoryParam = searchParams.get('category');\n    const tagParam = searchParams.get('tag');\n\n    if (categoryParam) {\n      setSelectedCategory(categoryParam);\n    }\n    if (tagParam) {\n      setSelectedTag(tagParam);\n    }\n  }, [searchParams]);\n\n  useEffect(() => {\n    fetchNotes();\n    fetchCategories();\n    fetchTags();\n    loadSettings();\n  }, [page, selectedCategory, selectedTag]);\n\n  // 设置页面标题（仅使用 browserTitle，不受网站标题、副标题影响）\n  useEffect(() => {\n    let title = pageText.browserTitle;\n\n    if (selectedCategory !== 'all') {\n      title = `${selectedCategory} - ${pageText.browserTitle}`;\n    } else if (selectedTag !== 'all') {\n      title = `${selectedTag} - ${pageText.browserTitle}`;\n    }\n\n    document.title = title;\n  }, [selectedCategory, selectedTag, pageText.browserTitle]);\n\n  const loadSettings = async () => {\n    try {\n      // 并行加载设置和页面文本配置\n      const [settingsResponse, pageTextResponse] = await Promise.all([\n        getSettings(),\n        getPageText('notes')\n      ]);\n\n      if (settingsResponse.success && settingsResponse.data) {\n        const settingsObj: any = {};\n        settingsResponse.data.forEach((setting: any) => {\n          settingsObj[setting.key] = setting.value;\n        });\n        setSettings({\n          themeType: settingsObj.themeType || 'default',\n          footerCopyright: settingsObj.footerCopyright || `© ${new Date().getFullYear()} 个人主页. All rights reserved.`,\n          noteLayoutColumns: settingsObj.noteLayoutColumns || '1',\n          showNoteCover: settingsObj.showNoteCover || 'true',\n          defaultNoteCover: settingsObj.defaultNoteCover || '',\n          avatarShape: settingsObj.avatarShape || 'circle',\n          noteDisplayMode: settingsObj.noteDisplayMode || 'modal',\n          showTopNavbar: settingsObj.showTopNavbar || 'true',\n          showWapSidebar: settingsObj.showWapSidebar || 'true',\n          showNoteTags: settingsObj.showNoteTags !== 'false',\n          showNoteCategories: settingsObj.showNoteCategories !== 'false'\n        });\n      }\n\n      // 从新的 page_texts 表加载页面文本配置\n      if (pageTextResponse.success && pageTextResponse.data) {\n        setPageText({\n          title: pageTextResponse.data.title || '全部笔记',\n          description: pageTextResponse.data.description || '探索所有已发布的笔记内容',\n          browserTitle: pageTextResponse.data.browserTitle || '全部笔记',\n          browserSubtitle: pageTextResponse.data.browserSubtitle || ''\n        });\n        setPageTextLoaded(true);\n      }\n    } catch (error) {\n      console.error('Failed to load settings:', error);\n      setPageTextLoaded(true); // 即使失败也标记为已加载，使用默认值\n    }\n  };\n\n  const fetchNotes = async () => {\n    try {\n      const params: any = {\n        is_published: true,\n        page,\n        limit: 12,\n      };\n\n      // 添加筛选参数\n      if (selectedCategory !== 'all') {\n        params.category = selectedCategory;\n      }\n      if (selectedTag !== 'all') {\n        params.tag = selectedTag;\n      }\n\n      const response = await api.get('/notes', { params });\n      const data = response.data?.data;\n      const notesArray = Array.isArray(data?.notes) ? data.notes : [];\n      setNotes(notesArray);\n      setTotalPages(data?.pagination?.totalPages || 1);\n    } catch (error) {\n      console.error('Failed to fetch notes:', error);\n      setNotes([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchCategories = async () => {\n    try {\n      const response = await api.get('/notes/categories/list');\n      const data = response.data?.data;\n      setCategories(Array.isArray(data) ? data : []);\n    } catch (error) {\n      console.error('Failed to fetch categories:', error);\n      setCategories([]);\n    }\n  };\n\n  const fetchTags = async () => {\n    try {\n      const response = await api.get('/notes/tags/stats');\n      const data = response.data?.data;\n      setTags(Array.isArray(data) ? data.map((tag: any) => tag.name) : []);\n    } catch (error) {\n      console.error('Failed to fetch tags:', error);\n      setTags([]);\n    }\n  };\n\n  const handleNoteClick = (noteId: number) => {\n    router.push(`/note/${noteId}`);\n  };\n\n  const handleSearch = (e: React.FormEvent) => {\n    e.preventDefault();\n  };\n\n  const handleClearSearch = () => {\n    setSearchQuery('');\n  };\n\n  // 基于搜索查询过滤笔记\n  const filteredNotes = notes.filter((note) => {\n    if (!searchQuery.trim()) return true;\n\n    const query = searchQuery.toLowerCase();\n    const titleMatch = note.title?.toLowerCase().includes(query);\n    const contentMatch = stripMarkdown(note.content).toLowerCase().includes(query);\n    const categoryMatch = note.category?.toLowerCase().includes(query);\n    const tagsMatch = note.Tags?.some(tag => tag.name.toLowerCase().includes(query)) ||\n                     note.tags?.toLowerCase().includes(query);\n\n    return titleMatch || contentMatch || categoryMatch || tagsMatch;\n  });\n\n  // 创建分类名称到分类对象的映射\n  const categoryMap = new Map(categories.map(cat => [cat.name, cat]));\n\n  // 布局规则辅助函数\n  const columns = parseInt(settings?.noteLayoutColumns) || 1;\n\n  // 是否使用横向布局（封面在左侧）\n  const useHorizontalLayout = () => {\n    if (columns === 1) return true; // 1列：所有设备横向\n    if (columns === 2 || columns === 3) return isDesktop; // 2-3列：电脑端横向，手机端纵向\n    return false; // 4列：所有设备纵向\n  };\n\n  // 是否显示标签和分类\n  const shouldShowTagsAndCategories = () => {\n    if (!isDesktop && columns >= 2) return false; // 手机端2列及以上不显示\n    if (isDesktop && columns === 4) return false; // 电脑端4列不显示\n    return true;\n  };\n\n  // 是否显示摘要\n  const shouldShowSummary = () => {\n    if (!isDesktop && columns >= 2) return false; // 手机端2列不显示\n    if (isDesktop && columns === 4) return false; // 电脑端4列不显示\n    return true;\n  };\n\n  const isHorizontal = useHorizontalLayout();\n  const showTagsAndCats = shouldShowTagsAndCategories() && (settings?.showNoteTags || settings?.showNoteCategories);\n  const showSummary = shouldShowSummary();\n\n  const isBlogTheme = settings?.themeType === 'blog';\n  const showTopNavbar = settings?.showTopNavbar !== 'false';\n  const showWapSidebar = settings?.showWapSidebar !== 'false';\n\n  // 显示搜索结果的提示\n  const showSearchResults = searchQuery.trim() && filteredNotes.length > 0;\n  const showNoResults = searchQuery.trim() && filteredNotes.length === 0;\n\n  return (\n    <main className=\"min-h-screen bg-bg-primary relative flex flex-col hide-scrollbar\">\n      <SEOMeta />\n      {/* 背景图片 */}\n      <PageBackground />\n      {/* 顶部导航栏 - 此页面始终显示 */}\n      <BlogNav showWapSidebar={showWapSidebar} />\n\n      {/* 内容区域 */}\n      <div className=\"relative z-0 flex-1 flex flex-col\">\n        {/* 给导航栏留出空间 */}\n        <div className=\"h-16\"></div>\n\n        <div className=\"container mx-auto px-4 max-w-6xl py-8\">\n          {/* 页面标题 */}\n          <div className=\"text-center mb-8\">\n            <h1 className=\"text-3xl font-bold text-text-primary mb-2\">{pageText.title}</h1>\n            <p className=\"text-text-secondary\">{pageText.description}</p>\n          </div>\n\n          {/* 搜索框 */}\n          <div className=\"mb-6\">\n            <form onSubmit={handleSearch}>\n              <div className=\"relative max-w-2xl mx-auto\">\n                <Search className=\"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-text-tertiary\" />\n                <input\n                  type=\"text\"\n                  placeholder=\"搜索笔记...\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  className=\"w-full pl-12 pr-12 py-3 bg-bg-secondary border border-border-primary rounded-xl text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all\"\n                  autoComplete=\"off\"\n                />\n                {searchQuery && (\n                  <button\n                    type=\"button\"\n                    onClick={handleClearSearch}\n                    className=\"absolute right-4 top-1/2 transform -translate-y-1/2 text-text-tertiary hover:text-text-primary transition-colors\"\n                    aria-label=\"清空搜索\"\n                  >\n                    <X className=\"w-5 h-5\" />\n                  </button>\n                )}\n              </div>\n            </form>\n          </div>\n\n          {/* 搜索结果显示 */}\n          {showSearchResults && (\n            <div className=\"mb-6 p-4 rounded-xl border max-w-2xl mx-auto\" style={{ backgroundColor: 'var(--info-bg)', borderColor: 'var(--info-border)' }}>\n              <div className=\"flex items-center justify-center gap-2\">\n                <span className=\"text-sm\" style={{ color: 'var(--info-text)' }}>\n                  搜索结果: 找到 {filteredNotes.length} 条相关笔记\n                  <span className=\"font-medium ml-1\">\"{searchQuery}\"</span>\n                </span>\n              </div>\n            </div>\n          )}\n\n          {/* 无搜索结果提示 */}\n          {showNoResults && (\n            <div className=\"mb-6 p-4 bg-bg-tertiary rounded-xl border border-border-primary text-center max-w-2xl mx-auto\">\n              <span className=\"text-sm text-text-tertiary\">\n                没有找到包含 \"{searchQuery}\" 的笔记\n              </span>\n            </div>\n          )}\n\n          {/* 筛选器 */}\n          <div className=\"mb-8 space-y-4\">\n            {/* 分类筛选 */}\n            {categories.length > 0 && (\n              <div>\n                <h3 className=\"text-sm font-medium text-text-secondary mb-3 flex items-center gap-2\">\n                  <FolderOpen className=\"w-4 h-4\" />\n                  按分类筛选\n                </h3>\n                <div className=\"flex gap-2 flex-wrap\">\n                  <button\n                    onClick={() => {\n                      setSelectedCategory('all');\n                      setPage(1);\n                    }}\n                    className={`px-4 py-2 rounded-lg text-sm font-medium transition-all ${\n                      selectedCategory === 'all'\n                        ? 'bg-primary-500 text-white shadow-md'\n                        : 'bg-bg-secondary text-text-secondary hover:bg-bg-tertiary border border-border-primary'\n                    }`}\n                  >\n                    全部\n                  </button>\n                  {categories.map((category) => (\n                    <button\n                      key={category.id || category.name}\n                      onClick={() => {\n                        setSelectedCategory(category.name);\n                        setPage(1);\n                      }}\n                      className={`px-4 py-2 rounded-lg text-sm font-medium transition-all ${\n                        selectedCategory === category.name\n                          ? 'bg-primary-500 text-white shadow-md'\n                          : 'bg-bg-secondary text-text-secondary hover:bg-bg-tertiary border border-border-primary'\n                      }`}\n                    >\n                      {category.icon && <span className=\"mr-1.5\">{category.icon}</span>}\n                      {category.name}\n                    </button>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {/* 标签筛选 */}\n            {tags.length > 0 && (\n              <div>\n                <h3 className=\"text-sm font-medium text-text-secondary mb-3 flex items-center gap-2\">\n                  <Tag className=\"w-4 h-4\" />\n                  按标签筛选\n                </h3>\n                <div className=\"flex gap-2 flex-wrap\">\n                  <button\n                    onClick={() => {\n                      setSelectedTag('all');\n                      setPage(1);\n                    }}\n                    className={`px-4 py-2 rounded-lg text-sm font-medium transition-all ${\n                      selectedTag === 'all'\n                        ? 'bg-primary-500 text-white shadow-md'\n                        : 'bg-bg-secondary text-text-secondary hover:bg-bg-tertiary border border-border-primary'\n                    }`}\n                  >\n                    全部\n                  </button>\n                  {tags.slice(0, 10).map((tag) => (\n                    <button\n                      key={tag}\n                      onClick={() => {\n                        setSelectedTag(tag);\n                        setPage(1);\n                      }}\n                      className={`px-4 py-2 rounded-lg text-sm font-medium transition-all ${\n                        selectedTag === tag\n                          ? 'bg-primary-500 text-white shadow-md'\n                          : 'bg-bg-secondary text-text-secondary hover:bg-bg-tertiary border border-border-primary'\n                      }`}\n                    >\n                      {tag}\n                    </button>\n                  ))}\n                </div>\n              </div>\n            )}\n          </div>\n\n          {/* 笔记列表 */}\n          {filteredNotes.length > 0 ? (\n            <Masonry\n              breakpointCols={{\n                default: parseInt(settings?.noteLayoutColumns) || 1,\n                1536: parseInt(settings?.noteLayoutColumns) || 1,\n                1280: parseInt(settings?.noteLayoutColumns) === 4 ? 3 : parseInt(settings?.noteLayoutColumns) || 1,\n                1024: parseInt(settings?.noteLayoutColumns) >= 3 ? 2 : parseInt(settings?.noteLayoutColumns) || 1,\n                768: parseInt(settings?.noteLayoutColumns) > 1 ? 2 : 1,\n                640: parseInt(settings?.noteLayoutColumns) > 1 ? 2 : 1\n              }}\n              className=\"flex -ml-3 w-auto\"\n              columnClassName=\"pl-3 bg-clip-padding\"\n            >\n              {filteredNotes.map((note, index) => {\n                const coverImageUrl = (note.cover_image || settings?.defaultNoteCover || '').startsWith('http')\n                  ? (note.cover_image || settings?.defaultNoteCover)\n                  : `${API_BASE_URL}${note.cover_image || settings?.defaultNoteCover}`;\n\n                return (\n                  <motion.div\n                    key={note.id}\n                    onClick={() => handleNoteClick(note.id)}\n                    className=\"group block rounded-lg shadow-sm hover:shadow-lg hover:-translate-y-0.5 border bg-bg-secondary border-border-primary transition-all duration-300 cursor-pointer overflow-hidden mb-3\"\n                    initial={{ opacity: 0, y: 20 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    transition={{ delay: index * 0.05 }}\n                  >\n                    {/* 横向布局（封面在左侧） - 1列 或 2-3列的电脑端 */}\n                    {isHorizontal ? (\n                      <div className=\"flex gap-3 items-stretch p-3\">\n                        {/* 左侧封面图 - 1:1正方形（仅当有封面图时显示） */}\n                        {(note.cover_image || settings?.defaultNoteCover) && settings?.showNoteCover === 'true' && (\n                          <div className=\"flex-shrink-0 w-24 h-24 rounded-md overflow-hidden bg-bg-tertiary\">\n                            <img\n                              src={coverImageUrl}\n                              alt={note.title || '封面图'}\n                              className=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300\"\n                              onError={(e) => {\n                                const target = e.target as HTMLImageElement;\n                                target.style.display = 'none';\n                              }}\n                            />\n                          </div>\n                        )}\n\n                        {/* 右侧内容 */}\n                        <div className=\"flex-1 flex flex-col justify-center min-w-0\">\n                          {/* 标题和置顶标签 */}\n                          <div className=\"flex items-start gap-2 mb-1\">\n                            {note.title && (\n                              <h3 className=\"text-base font-semibold text-text-primary line-clamp-1 flex-1 group-hover:text-primary-500 transition-colors\">\n                                {note.title}\n                              </h3>\n                            )}\n                            {note.is_pinned && (\n                              <div className=\"flex-shrink-0 px-1.5 py-0.5 rounded text-[10px] font-semibold flex items-center gap-0.5\" style={{ background: 'linear-gradient(to right, var(--pinned-gradient-from), var(--pinned-gradient-to))', color: 'var(--pinned-text)' }}>\n                                <Pin className=\"w-2.5 h-2.5 fill-current\" />\n                              </div>\n                            )}\n                          </div>\n\n                          {/* 摘要/内容预览 */}\n                          {showSummary && (\n                            <p className=\"text-xs text-text-secondary line-clamp-2 mb-2 leading-relaxed\">\n                              {note.summary || (note.content ? truncate(stripMarkdown(note.content), 80) : '暂无内容')}\n                            </p>\n                          )}\n\n                          {/* 底部：时间、分类、标签 */}\n                          <div className=\"flex items-center gap-2 flex-wrap text-[10px]\">\n                            <div className=\"flex items-center gap-1 text-text-tertiary\">\n                              <Clock className=\"w-2.5 h-2.5\" />\n                              <span>{formatDateTime(note.published_at || note.created_at)}</span>\n                            </div>\n\n                            {showTagsAndCats && settings?.showNoteCategories && note.category && (\n                              <span\n                                className=\"px-1.5 py-0.5 bg-primary-100 text-primary-700 rounded-full font-medium cursor-pointer hover:bg-primary-200 transition-colors\"\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  setSelectedCategory(note.category!);\n                                  setPage(1);\n                                }}\n                              >\n                                {categoryMap.get(note.category)?.icon && (\n                                  <span className=\"mr-0.5\">{categoryMap.get(note.category)?.icon}</span>\n                                )}\n                                {note.category}\n                              </span>\n                            )}\n\n                            {showTagsAndCats && settings?.showNoteTags && note.Tags && note.Tags.length > 0 && (\n                              <>\n                                {note.Tags.slice(0, 2).map((tag) => (\n                                  <span\n                                    key={tag.id}\n                                    className=\"px-1.5 py-0.5 rounded-full font-medium cursor-pointer transition-opacity\"\n                                    style={tag.color ? { backgroundColor: `${tag.color}20`, color: tag.color } : { backgroundColor: 'var(--tag-bg)', color: 'var(--tag-text)' }}\n                                    onMouseEnter={(e) => {\n                                      if (!tag.color) {\n                                        e.currentTarget.style.backgroundColor = 'var(--tag-hover-bg)';\n                                      }\n                                    }}\n                                    onMouseLeave={(e) => {\n                                      if (!tag.color) {\n                                        e.currentTarget.style.backgroundColor = 'var(--tag-bg)';\n                                      }\n                                    }}\n                                    onClick={(e) => {\n                                      e.stopPropagation();\n                                      setSelectedTag(tag.name);\n                                      setPage(1);\n                                    }}\n                                  >\n                                    {tag.name}\n                                  </span>\n                                ))}\n                                {note.Tags.length > 2 && (\n                                  <span className=\"px-1.5 py-0.5 rounded-full text-[10px]\" style={{ backgroundColor: 'var(--tag-bg)', color: 'var(--tag-text)' }}>\n                                    +{note.Tags.length - 2}\n                                  </span>\n                                )}\n                              </>\n                            )}\n                          </div>\n                        </div>\n                      </div>\n                    ) : (\n                      /* 纵向布局（封面在上方） - 4列 或 2-3列的手机端 */\n                      <div className=\"flex flex-col\">\n                        {/* 封面图 - 1:1正方形 */}\n                        {(note.cover_image || settings?.defaultNoteCover) && settings?.showNoteCover === 'true' && (\n                          <div className=\"relative w-full pt-[100%] overflow-hidden bg-gradient-to-br from-primary-100 to-primary-200\">\n                            <img\n                              src={coverImageUrl}\n                              alt={note.title || '封面图'}\n                              className=\"absolute inset-0 w-full h-full object-cover group-hover:scale-105 transition-transform duration-300\"\n                              onError={(e) => {\n                                const target = e.target as HTMLImageElement;\n                                target.style.display = 'none';\n                              }}\n                            />\n\n                            {/* 置顶标识 */}\n                            {note.is_pinned && (\n                              <div className=\"absolute top-2 right-2 bg-bg-secondary/90 backdrop-blur-sm rounded-full px-2 py-1 text-[10px] text-text-primary font-semibold flex items-center gap-1 border border-border-primary/50\">\n                                <Pin className=\"w-2.5 h-2.5 fill-current\" />\n                                <span>置顶</span>\n                              </div>\n                            )}\n                          </div>\n                        )}\n\n                        {/* 标题和描述 */}\n                        <div className=\"p-3\">\n                          {note.title && (\n                            <h3 className=\"font-semibold text-base text-text-primary group-hover:text-primary-500 transition-colors line-clamp-2 mb-1\">\n                              {note.title}\n                            </h3>\n                          )}\n\n                          {/* 摘要 */}\n                          {showSummary && (\n                            <p className=\"text-xs text-text-secondary line-clamp-2 leading-relaxed mb-2\">\n                              {note.summary || (note.content ? truncate(stripMarkdown(note.content), 100) : '暂无内容')}\n                            </p>\n                          )}\n\n                          {/* 底部信息 */}\n                          <div className=\"flex items-center justify-between gap-2 text-[10px]\">\n                            <div className=\"flex items-center gap-1 text-text-tertiary\">\n                              <Clock className=\"w-2.5 h-2.5\" />\n                              <span>{formatDateTime(note.published_at || note.created_at)}</span>\n                            </div>\n\n                            {showTagsAndCats && (\n                              <div className=\"flex items-center gap-1 flex-wrap\">\n                                {settings?.showNoteCategories && note.category && (\n                                  <span\n                                    className=\"px-1.5 py-0.5 bg-primary-100 text-primary-700 rounded-full font-medium cursor-pointer hover:bg-primary-200 transition-colors\"\n                                    onClick={(e) => {\n                                      e.stopPropagation();\n                                      setSelectedCategory(note.category!);\n                                      setPage(1);\n                                    }}\n                                  >\n                                    {categoryMap.get(note.category)?.icon && (\n                                      <span className=\"mr-0.5\">{categoryMap.get(note.category)?.icon}</span>\n                                    )}\n                                    {note.category}\n                                  </span>\n                                )}\n\n                                {settings?.showNoteTags && note.Tags && note.Tags.length > 0 && (\n                                  <>\n                                    {note.Tags.slice(0, 1).map((tag) => (\n                                      <span\n                                        key={tag.id}\n                                        className=\"px-1.5 py-0.5 rounded-full font-medium cursor-pointer transition-opacity\"\n                                        style={tag.color ? { backgroundColor: `${tag.color}20`, color: tag.color } : { backgroundColor: 'var(--tag-bg)', color: 'var(--tag-text)' }}\n                                        onMouseEnter={(e) => {\n                                          if (!tag.color) {\n                                            e.currentTarget.style.backgroundColor = 'var(--tag-hover-bg)';\n                                          }\n                                        }}\n                                        onMouseLeave={(e) => {\n                                          if (!tag.color) {\n                                            e.currentTarget.style.backgroundColor = 'var(--tag-bg)';\n                                          }\n                                        }}\n                                        onClick={(e) => {\n                                          e.stopPropagation();\n                                          setSelectedTag(tag.name);\n                                          setPage(1);\n                                        }}\n                                      >\n                                        {tag.name}\n                                      </span>\n                                    ))}\n                                    {note.Tags.length > 1 && (\n                                      <span className=\"px-1.5 py-0.5 rounded-full\" style={{ backgroundColor: 'var(--tag-bg)', color: 'var(--tag-text)' }}>\n                                        +{note.Tags.length - 1}\n                                      </span>\n                                    )}\n                                  </>\n                                )}\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                      </div>\n                    )}\n                  </motion.div>\n                );\n              })}\n            </Masonry>\n          ) : (\n            <div className=\"text-center py-16 text-text-tertiary\">\n              <p className=\"text-lg\">暂无笔记</p>\n            </div>\n          )}\n\n          {/* 分页 */}\n          {totalPages > 1 && (\n            <div className=\"flex justify-center gap-2 pt-8 mt-8\">\n              <button\n                onClick={() => setPage((p) => Math.max(1, p - 1))}\n                disabled={page === 1}\n                className=\"px-4 py-2 rounded-lg bg-bg-secondary text-text-secondary hover:bg-bg-tertiary disabled:opacity-30 disabled:cursor-not-allowed transition-all text-sm border border-border-primary\"\n              >\n                上一页\n              </button>\n\n              <div className=\"flex items-center gap-2\">\n                {Array.from({ length: Math.min(totalPages, 5) }, (_, i) => {\n                  let pageNum;\n                  if (totalPages <= 5) {\n                    pageNum = i + 1;\n                  } else if (page <= 3) {\n                    pageNum = i + 1;\n                  } else if (page >= totalPages - 2) {\n                    pageNum = totalPages - 4 + i;\n                  } else {\n                    pageNum = page - 2 + i;\n                  }\n\n                  const isActive = pageNum === page;\n                  const btnClass = 'w-10 h-10 rounded-lg transition-all text-sm border ' + (isActive ? 'bg-primary-500 text-white border-primary-500' : 'bg-bg-secondary text-text-secondary hover:bg-bg-tertiary border-border-primary');\n\n                  return (\n                    <button\n                      key={pageNum}\n                      onClick={() => setPage(pageNum)}\n                      className={btnClass}\n                    >\n                      {pageNum}\n                    </button>\n                  );\n                })}\n              </div>\n\n              <button\n                onClick={() => setPage((p) => Math.min(totalPages, p + 1))}\n                disabled={page === totalPages}\n                className=\"px-4 py-2 rounded-lg bg-bg-secondary text-text-secondary hover:bg-bg-tertiary disabled:opacity-30 disabled:cursor-not-allowed transition-all text-sm border border-border-primary\"\n              >\n                下一页\n              </button>\n            </div>\n          )}\n        </div>\n\n        {/* 页脚版权 */}\n        <footer className=\"mt-auto border-t border-border-primary py-6 text-center text-sm text-text-tertiary\">\n          <p>{settings.footerCopyright}</p>\n          <Copyright />\n        </footer>\n      </div>\n    </main>\n  );\n}\n"],"names":[],"mappings":"uCAOC,IAAA,EAAA,EAAA,CAAA,CAAA,OAID,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,MAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAEA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAEA,IAAM,EAAe,CAAA,EAAA,EAAA,aAAA,AAAa,IAuC5B,EAAiB,AAAC,IACtB,IAAM,EAAO,IAAI,KAAK,GAChB,EAAO,EAAK,WAAW,GACvB,EAAQ,OAAO,EAAK,QAAQ,GAAK,GAAG,QAAQ,CAAC,EAAG,KAChD,EAAM,OAAO,EAAK,OAAO,IAAI,QAAQ,CAAC,EAAG,KACzC,EAAQ,OAAO,EAAK,QAAQ,IAAI,QAAQ,CAAC,EAAG,KAC5C,EAAU,OAAO,EAAK,UAAU,IAAI,QAAQ,CAAC,EAAG,KAEtD,MAAO,CAAA,EAAG,EAAK,CAAC,EAAE,EAAM,CAAC,EAAE,EAAI,CAAC,EAAE,EAAM,CAAC,EAAE,EAAA,CAAS,AACtD,EAEM,EAAW,CAAC,EAAa,IAC7B,AAAI,EAAI,MAAM,EAAI,EAAe,EAC1B,EAAI,EADe,OACN,CAAC,EAAG,GAAU,MAI9B,EAAiB,AAAD,IACpB,GAAI,CAAC,EAAU,MAAO,GAEtB,IAAI,EAAO,EA4CX,MANO,CAHP,AASO,EAVP,AACO,GADA,CAHP,EAAO,CAHP,EAAO,CAHP,EADA,AACO,GAJP,AAGO,GAHA,CADP,EAAO,CADP,EAAO,CADP,EAAO,CADP,EAAO,CAHP,EAAO,CAHP,EADA,AACO,GADA,CADP,EAAO,CAHP,EAAO,CADP,EAAO,CADP,EAAO,CADP,EAAO,EAAK,OAAO,CAAC,4BAA6B,GAAA,EACrC,OAAO,CAAC,6BAA8B,GAAA,EACtC,OAAO,CAAC,iBAAkB,GAAA,EAC1B,OAAO,CAAC,UAAW,GAAA,EAGnB,OAAO,CAAC,kBAAmB,GAAA,EAC3B,OAAO,CAAC,aAAc,KAAA,EACtB,OAAO,CAAC,KAAM,GAAA,EAGd,OAAO,CAAC,eAAgB,GAAA,EAGxB,OAAO,CAAC,oBAAqB,KAAA,EAC7B,OAAO,CAAC,eAAgB,KAAA,EACxB,OAAO,CAAC,gBAAiB,KAAA,EACzB,OAAO,CAAC,aAAc,KAAA,EACtB,OAAO,CAAC,eAAgB,KAAA,EAGxB,OAAO,CAAC,mBAAoB,GAAA,EAC5B,OAAO,CAAC,mBAAoB,GAAA,EAG5B,OAAO,CAAC,UAAW,GAAA,EAGnB,OAAO,CAAC,2BAA4B,KAAA,EAGpC,OAAO,CAAC,UAAW,GAAA,EACnB,OAAO,CAAC,sBAAuB,GAAA,EAIxC,OAAO,CAAC,OAAQ,KAChB,OAAO,CAAC,UAAW,QACnB,OAAO,CAAC,WAAY,QACpB,IAAI,EAGT,EAEe,SAAS,IACtB,IAAM,EAAS,CAAA,EAAA,EAAA,SAAA,AAAS,IAClB,EAAe,CAAA,EAAA,EAAA,eAAe,AAAf,IACf,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAS,EAAE,EACvC,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAiB,EAAE,EACzD,CAAC,EAAM,EAAQ,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAmB,EAAE,EACvC,CAAC,EAAkB,EAAoB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAS,OAC3D,CAAC,EAAa,EAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAS,OACjD,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjC,CAAC,EAAa,EAAe,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAS,IACzC,CAAC,EAAM,EAAQ,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GAC3B,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GAGvC,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAE3C,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAM,EAAkB,KACtB,EAAa,OAAO,UAAU,EAAI,IACpC,EAKA,OAHA,IACA,OAAO,gBAAgB,CAAC,SAAU,GAE3B,IAAM,OAAO,mBAAmB,CAAC,SAAU,EACpD,EAAG,EAAE,EAGL,IAAM,EAAkB,CACtB,UAAW,UACX,gBAAiB,CAAC,KAAE,EAAE,IAAI,OAAO,WAAW,GAAG,2BAA2B,CAAC,CAC3E,kBAAmB,IACnB,cAAe,OACf,iBAAkB,GAClB,YAAa,SACb,gBAAiB,QACjB,cAAe,OACf,eAAgB,OAChB,aAAc,OACd,mBAAoB,MACtB,EACM,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAM,GAExC,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,CACvC,MAAO,OACP,YAAa,eACb,aAAc,OACd,gBAAiB,EACnB,GACM,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAGrD,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAM,EAAgB,EAAa,GAAG,CAAC,YACjC,EAAW,EAAa,GAAG,CAAC,OAE9B,GACF,EAAoB,GAElB,GACF,EAAe,EAJE,AAMrB,EAAG,CAHa,AAGZ,EAAa,EAEjB,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IACA,IACA,IACA,GACF,EAAG,CAAC,EAAM,EAAkB,EAAY,EAGxC,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAI,EAAQ,EAAS,YAAY,CAER,OAAO,CAA5B,EACF,EAAQ,CAAA,EAAG,EAAiB,GAAG,EAAE,EAAS,YAAY,CAAA,CAAE,CAC/B,OAAO,CAAvB,IACT,EAAQ,CAAA,EAAG,EAAY,GAAG,EAAE,EAAS,YAAY,CAAA,CAAE,AAAF,EAGnD,SAAS,KAAK,CAAG,CACnB,EAAG,CAAC,EAAkB,EAAa,EAAS,YAAY,CAAC,EAEzD,IAAM,EAAe,UACnB,GAAI,CAEF,GAAM,CAAC,EAAkB,EAAiB,CAAG,MAAM,QAAQ,GAAG,CAAC,CAC7D,CAAA,EAAA,EAAA,WAAA,AAAW,IACX,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,SACb,EAED,GAAI,EAAiB,OAAO,EAAI,EAAiB,IAAI,CAAE,CACrD,IAAM,EAAmB,CAAC,EAC1B,EAAiB,IAAI,CAAC,OAAO,CAAC,AAAC,IAC7B,CAAW,CAAC,EAAQ,GAAG,CAAC,CAAG,EAAQ,KAAK,AAC1C,GACA,EAAY,CACV,UAAW,EAAY,SAAS,EAAI,UACpC,gBAAiB,EAAY,eAAe,EAAI,CAAC,KAAE,EAAE,IAAI,OAAO,WAAW,GAAG,2BAA2B,CAAC,CAC1G,kBAAmB,EAAY,iBAAiB,EAAI,IACpD,cAAe,EAAY,aAAa,EAAI,OAC5C,iBAAkB,EAAY,gBAAgB,EAAI,GAClD,YAAa,EAAY,WAAW,EAAI,SACxC,gBAAiB,EAAY,eAAe,EAAI,QAChD,cAAe,EAAY,aAAa,EAAI,OAC5C,eAAgB,EAAY,cAAc,EAAI,OAC9C,aAA2C,UAA7B,EAAY,YAAY,CACtC,mBAAuD,UAAnC,EAAY,kBAAkB,AACpD,EACF,CAGI,EAAiB,OAAO,EAAI,EAAiB,IAAI,EAAE,CACrD,EAAY,CACV,MAAO,EAAiB,IAAI,CAAC,KAAK,EAAI,OACtC,YAAa,EAAiB,IAAI,CAAC,WAAW,EAAI,eAClD,aAAc,EAAiB,IAAI,CAAC,YAAY,EAAI,OACpD,gBAAiB,EAAiB,IAAI,CAAC,eAAe,EAAI,EAC5D,GACA,GAAkB,GAEtB,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,2BAA4B,GAC1C,GAAkB,EACpB,CACF,EAEM,EAJuB,AAIV,UACjB,GAAI,CACF,IAAM,EANuC,AAMzB,CAClB,cAAc,OACd,EACA,MAAO,EACT,EAGyB,OAAO,CAA5B,IACF,EAAO,QAAQ,CAAG,CAAA,EAEA,OAAO,CAAvB,IACF,EAAO,GAAG,CAAG,CAAA,EAGf,IAAM,EAAW,MAAM,EAAA,OAAG,CAAC,GAAG,CAAC,SAAU,CAAE,QAAO,GAC5C,EAAO,EAAS,IAAI,EAAE,KACtB,EAAa,MAAM,OAAO,CAAC,GAAM,OAAS,EAAK,KAAK,CAAG,EAAE,CAC/D,EAAS,GACT,EAAc,GAAM,YAAY,YAAc,EAChD,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,yBAA0B,GACxC,EAAS,EAAE,CACb,QAAU,CACR,GAAW,EACb,CACF,EAEM,EAAkB,UACtB,GAAI,CACF,IAAM,EAAW,MAAM,EAAA,OAAG,CAAC,GAAG,CAAC,0BACzB,EAAO,EAAS,IAAI,EAAE,KAC5B,EAAc,MAAM,OAAO,CAAC,GAAQ,EAAO,EAAE,CAC/C,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,8BAA+B,GAC7C,EAAc,EAAE,CAClB,CACF,EAEM,EAAY,UAChB,GAAI,CACF,IAAM,EAAW,MAAM,EAAA,OAAG,CAAC,GAAG,CAAC,qBACzB,EAAO,EAAS,IAAI,EAAE,KAC5B,EAAQ,MAAM,OAAO,CAAC,GAAQ,EAAK,GAAG,CAAC,AAAC,GAAa,EAAI,IAAI,EAAI,EAAE,CACrE,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,wBAAyB,GACvC,EAAQ,EAAE,CACZ,CACF,EAeM,EAAgB,EAAM,MAAM,CAAC,AAAC,IAClC,GAAI,CAAC,EAAY,IAAI,GAAI,OAAO,EAEhC,IAAM,EAAQ,EAAY,WAAW,GAC/B,EAAa,EAAK,KAAK,EAAE,cAAc,SAAS,GAChD,EAAe,EAAc,EAAK,OAAO,EAAE,WAAW,GAAG,QAAQ,CAAC,GAClE,EAAgB,EAAK,QAAQ,EAAE,cAAc,SAAS,GACtD,EAAY,EAAK,IAAI,EAAE,KAAK,GAAO,EAAI,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,KACxD,EAAK,IAAI,EAAE,cAAc,SAAS,GAEnD,OAAO,GAAc,GAAgB,GAAiB,CACxD,GAGM,GAAc,IAAI,IAAI,EAAW,GAAG,CAAC,GAAO,CAAC,EAAI,IAAI,CAAE,EAAI,GAG3D,GAAU,SAAS,GAAU,oBAAsB,EAuBnD,GAnBJ,AAAgB,GAAG,CAAf,KACY,CADU,EAmBP,CAlBf,GAD4B,KACX,EAAY,GAAG,AAAO,EADC,AAoBxC,GAAkB,EAblB,CAAC,GANiD,EAMpC,MAAW,GAAG,CAC5B,MADmC,CANkC,CAOxD,EAAY,GAAG,AADc,CAaU,CAAD,EAAW,GAZ3B,OAAO,AADc,IAasB,GAAU,IAZnC,cAYmC,CAAkB,CAC1G,KAPA,CAAC,KAAa,GAOA,GAPW,GAAG,EAC5B,GAAyB,EADU,CACP,CAAf,IAQC,CAT4B,CACP,CAQX,MARkB,GADW,CAUrC,GAAU,CADY,GARe,UAU3D,IADkD,AAC5C,GAAiB,GAAU,iBAAmB,QAG9C,GAAoB,EAAY,IAAI,IAAM,EAAc,MAAM,CAAG,EACjE,GAAgB,EAAY,IAAI,IAAM,AAAyB,MAAX,MAAM,CAEhE,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,6EACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAA,GAER,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAc,CAAA,CAAA,GAEf,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,eAAgB,KAGzB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CAEb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,SAEf,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDAEb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6BACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,qDAA6C,EAAS,KAAK,GACzE,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,+BAAuB,EAAS,WAAW,MAI1D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gBACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,SAnFK,AAAC,CAmFI,GAlFxB,EAAE,cAAc,EAClB,WAkFY,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,kFAClB,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,OACL,YAAY,UACZ,MAAO,EACP,SAAU,AAAC,GAAM,EAAe,EAAE,MAAM,CAAC,KAAK,EAC9C,UAAU,6NACV,aAAa,QAEd,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QA7FQ,CA6FC,IA5FzB,EAAe,GACjB,EA4FkB,UAAU,mHACV,aAAW,gBAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAC,CAAA,CAAC,UAAU,qBAQtB,IACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,+CAA+C,MAAO,CAAE,gBAAiB,iBAAkB,YAAa,oBAAqB,WAC1I,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,UAAU,MAAO,CAAE,MAAO,kBAAmB,YAAG,YACpD,EAAc,MAAM,CAAC,SAC/B,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,6BAAmB,IAAE,EAAY,cAOxD,IACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yGACb,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,uCAA6B,WAClC,EAAY,aAM3B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BAEZ,EAAW,MAAM,CAAG,GACnB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAG,UAAU,iFACZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,UAAU,YAAY,WAGpC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iCACb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,KACP,EAAoB,OACpB,EAAQ,EACV,EACA,UAAW,CAAC,wDAAwD,EAC7C,QAArB,EACI,sCACA,wFAAA,CACJ,UACH,OAGA,EAAW,GAAG,CAAC,AAAC,GACf,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAEC,QAAS,KACP,EAAoB,EAAS,IAAI,EACjC,EAAQ,EACV,EACA,UAAW,CAAC,wDAAwD,EAClE,IAAqB,EAAS,IAAI,CAC9B,sCACA,wFAAA,CACJ,WAED,EAAS,IAAI,EAAI,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,kBAAU,EAAS,IAAI,GACxD,EAAS,IAAI,GAZT,EAAS,EAAE,EAAI,EAAS,IAAI,SAoB1C,EAAK,MAAM,CAAG,GACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAG,UAAU,iFACZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,GAAG,CAAA,CAAC,UAAU,YAAY,WAG7B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iCACb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,KACP,EAAe,OACf,EAAQ,EACV,EACA,UAAW,CAAC,wDAAwD,EAClD,QAAhB,EACI,sCACA,wFAAA,CACJ,UACH,OAGA,EAAK,KAAK,CAAC,EAAG,IAAI,GAAG,CAAC,AAAC,GACtB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAEC,QAAS,KACP,EAAe,GACf,EAAQ,EACV,EACA,UAAW,CAAC,wDAAwD,EAClE,IAAgB,EACZ,sCACA,wFAAA,CACJ,UAED,GAXI,aAoBhB,EAAc,MAAM,CAAG,EACtB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CACN,eAAgB,CACd,QAAS,SAAS,GAAU,oBAAsB,EAClD,KAAM,SAAS,GAAU,oBAAsB,EAC/C,KAAgD,IAA1C,SAAS,GAAU,mBAA2B,EAAI,SAAS,GAAU,oBAAsB,EACjG,KAAM,SAAS,GAAU,oBAAsB,EAAI,EAAI,SAAS,GAAU,oBAAsB,EAChG,IAAK,SAAS,GAAU,mBAAqB,EAAI,EAAI,EACrD,IAAK,SAAS,GAAU,mBAAqB,EAAI,EAAI,CACvD,EACA,UAAU,oBACV,gBAAgB,gCAEf,EAAc,GAAG,CAAC,CAAC,EAAM,KACxB,IAAM,EAAgB,CAAC,EAAK,WAAW,EAAI,GAAU,kBAAoB,EAAA,CAAE,CAAE,UAAU,CAAC,QACnF,EAAK,WAAW,EAAI,GAAU,iBAC/B,CAAA,EAAG,EAAA,EAAe,EAAK,WAAW,EAAI,GAAU,iBAAA,CAAkB,CAEtE,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CAET,QAAS,IAAM,cAjPR,EAiPwB,EAAK,EAAE,MAhPtD,EAAO,IAAI,CAAC,CAAC,MAAM,EAAE,EAAA,CAAQ,GAiPb,UAAU,uLACV,QAAS,CAAE,QAAS,EAAG,EAAG,EAAG,EAC7B,QAAS,CAAE,QAAS,EAAG,EAAG,CAAE,EAC5B,WAAY,CAAE,MAAe,IAAR,CAAa,WAGjC,GACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yCAEZ,CAAC,EAAK,WAAW,EAAI,GAAU,gBAAA,CAAgB,EAAK,GAAU,gBAAkB,QAC/E,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,6EACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,IAAK,EACL,IAAK,EAAK,KAAK,EAAI,MACnB,UAAU,qFACV,QAAS,AAAC,IACO,AACf,EADiB,MAAM,CAChB,KAAK,CAAC,OAAO,CAAG,MACzB,MAMN,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wDAEb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wCACZ,EAAK,KAAK,EACT,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,wHACX,EAAK,KAAK,GAGd,EAAK,SAAS,EACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,0FAA0F,MAAO,CAAE,WAAY,oFAAqF,MAAO,oBAAqB,WAC7O,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,GAAG,CAAA,CAAC,UAAU,kCAMpB,IACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yEACV,EAAK,OAAO,GAAK,CAAD,CAAM,OAAO,CAAG,EAAS,EAAc,EAAK,OAAO,EAAG,IAAM,MAAA,CAAM,GAKvF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0DACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,gBACjB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAM,EAAe,EAAK,YAAY,EAAI,EAAK,UAAU,OAG3D,IAAmB,GAAU,oBAAsB,EAAK,QAAQ,EAC/D,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CACC,UAAU,+HACV,QAAS,AAAC,IACR,EAAE,eAAe,GACjB,EAAoB,EAAK,QAAQ,EACjC,EAAQ,EACV,YAEC,GAAY,GAAG,CAAC,EAAK,QAAQ,GAAG,MAC/B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,kBAAU,GAAY,GAAG,CAAC,EAAK,QAAQ,GAAG,OAE3D,EAAK,QAAQ,IAIjB,IAAmB,GAAU,cAAgB,EAAK,IAAI,EAAI,EAAK,IAAI,CAAC,MAAM,CAAG,GAC5E,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACG,EAAK,IAAI,CAAC,KAAK,CAAC,EAAG,GAAG,GAAG,CAAC,AAAC,GAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAEC,UAAU,2EACV,MAAO,EAAI,KAAK,CAAG,CAAE,gBAAiB,CAAA,EAAG,EAAI,KAAK,CAAC,EAAE,CAAC,CAAE,MAAO,EAAI,KAAK,AAAC,EAAI,CAAE,gBAAiB,gBAAiB,MAAO,iBAAkB,EAC1I,aAAe,AAAD,IACP,AAAD,EAAK,KAAK,EAAE,AACd,GAAE,aAAa,CAAC,KAAK,CAAC,eAAe,CAAG,qBAAA,CAE5C,EACA,aAAc,AAAC,IACT,AAAC,EAAI,KAAK,EAAE,CACd,EAAE,aAAa,CAAC,KAAK,CAAC,eAAe,CAAG,eAAA,CAE5C,EACA,QAAS,AAAC,IACR,EAAE,eAAe,GACjB,EAAe,EAAI,IAAI,EACvB,EAAQ,EACV,WAEC,EAAI,IAAI,EAnBJ,EAAI,EAAE,GAsBd,EAAK,IAAI,CAAC,MAAM,CAAG,GAClB,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,yCAAyC,MAAO,CAAE,gBAAiB,gBAAiB,MAAO,iBAAkB,YAAG,IAC5H,EAAK,IAAI,CAAC,MAAM,CAAG,iBAUnC,CAAA,CADA,CACA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,KADgB,qBAG5B,CAAC,EAAK,WAAW,EAAI,GAAU,gBAAA,CAAgB,EAAK,GAAU,gBAAkB,QAC/E,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wGACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,IAAK,EACL,IAAK,EAAK,KAAK,EAAI,MACnB,UAAU,sGACV,QAAS,AAAC,IACO,AACf,EADiB,MAAM,CAChB,KAAK,CAAC,OAAO,CAAG,MACzB,IAID,EAAK,SAAS,EACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kMACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,GAAG,CAAA,CAAC,UAAU,6BACf,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,aAOd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gBACZ,EAAK,KAAK,EACT,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,sHACX,EAAK,KAAK,GAKd,IACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yEACV,EAAK,OAAO,GAAK,CAAD,CAAM,OAAO,CAAG,EAAS,EAAc,EAAK,OAAO,EAAG,KAAO,MAAA,CAAM,GAKxF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gEACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,gBACjB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAM,EAAe,EAAK,YAAY,EAAI,EAAK,UAAU,OAG3D,IACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACZ,GAAU,oBAAsB,EAAK,QAAQ,EAC5C,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CACC,UAAU,+HACV,QAAS,AAAC,IACR,EAAE,eAAe,GACjB,EAAoB,EAAK,QAAQ,EACjC,EAAQ,EACV,YAEC,GAAY,GAAG,CAAC,EAAK,QAAQ,GAAG,MAC/B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,kBAAU,GAAY,GAAG,CAAC,EAAK,QAAQ,GAAG,OAE3D,EAAK,QAAQ,IAIjB,GAAU,cAAgB,EAAK,IAAI,EAAI,EAAK,IAAI,CAAC,MAAM,CAAG,GACzD,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACG,EAAK,IAAI,CAAC,KAAK,CAAC,EAAG,GAAG,GAAG,CAAC,AAAC,GAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAEC,UAAU,2EACV,MAAO,EAAI,KAAK,CAAG,CAAE,gBAAiB,CAAA,EAAG,EAAI,KAAK,CAAC,EAAE,CAAC,CAAE,MAAO,EAAI,KAAK,AAAC,EAAI,CAAE,gBAAiB,gBAAiB,MAAO,iBAAkB,EAC1I,aAAc,AAAC,IACT,AAAC,EAAI,KAAK,EAAE,AACd,GAAE,aAAa,CAAC,KAAK,CAAC,eAAe,CAAG,qBAAA,CAE5C,EACA,aAAc,AAAC,IACT,AAAC,EAAI,KAAK,EAAE,AACd,GAAE,aAAa,CAAC,KAAK,CAAC,eAAe,CAAG,eAAA,CAE5C,EACA,QAAS,AAAC,IACR,EAAE,eAAe,GACjB,EAAe,EAAI,IAAI,EACvB,EAAQ,EACV,WAEC,EAAI,IAAI,EAnBJ,EAAI,EAAE,GAsBd,EAAK,IAAI,CAAC,MAAM,CAAG,GAClB,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,6BAA6B,MAAO,CAAE,gBAAiB,gBAAiB,MAAO,iBAAkB,YAAG,IAChH,EAAK,IAAI,CAAC,MAAM,CAAG,qBAzMpC,EAAK,EAAE,CAsNlB,KAGF,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gDACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,mBAAU,WAK1B,EAAa,GACZ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gDACb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,EAAQ,AAAC,GAAM,KAAK,GAAG,CAAC,EAAG,EAAI,IAC9C,SAAmB,IAAT,EACV,UAAU,6LACX,QAID,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mCACZ,MAAM,IAAI,CAAC,CAAE,OAAQ,KAAK,GAAG,CAAC,EAAY,EAAG,EAAG,CAAC,EAAG,KAYnD,IAXI,EAWE,EAAW,CATf,EADE,GAAc,GAAG,AAEV,EADC,CACO,EACP,CADU,AADN,CAEA,EACL,GAAQ,EAAa,EACpB,CADuB,CACV,EAAI,EAEjB,EAAO,EAAI,KAGM,EAG7B,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAEC,QAAS,IAAM,EAAQ,GACvB,UANa,CAMF,sDAN2D,CAAD,CAAY,+CAAiD,gFAAA,CAAgF,UAQjN,GAJI,EAOX,KAGF,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,EAAQ,AAAC,GAAM,KAAK,GAAG,CAAC,EAAY,EAAI,IACvD,SAAU,IAAS,EACnB,UAAU,6LACX,cAQP,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAAO,UAAU,+FAChB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAG,EAAS,eAAe,GAC5B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAS,CAAA,CAAA,WAKpB"}