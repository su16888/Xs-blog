module.exports=[55098,a=>{"use strict";var b=a.i(87924),c=a.i(46271),d=a.i(87532),e=a.i(33508),f=a.i(41710),g=a.i(1239),h=a.i(33350),i=a.i(96101),j=a.i(72131),k=a.i(50944),l=a.i(19032),m=a.i(68114),n=a.i(11295),o=a.i(70042),p=a.i(30230),q=a.i(46712),r=a.i(78891);let s=(0,m.getApiBaseUrl)(),t=a=>{let b=new Date(a),c=b.getFullYear(),d=String(b.getMonth()+1).padStart(2,"0"),e=String(b.getDate()).padStart(2,"0"),f=String(b.getHours()).padStart(2,"0"),g=String(b.getMinutes()).padStart(2,"0");return`${c}-${d}-${e} ${f}:${g}`},u=(a,b)=>a.length<=b?a:a.substring(0,b)+"...",v=a=>{if(!a)return"";let b=a;return(b=(b=(b=(b=(b=(b=(b=(b=(b=(b=(b=(b=(b=(b=(b=(b=(b=(b=(b=b.replace(/!\[([^\]]*)\]\(([^)]+)\)/g,"")).replace(/!\[([^\]]*)\]\[([^\]]+)\]/g,"")).replace(/!\[([^\]]+)\]/g,"")).replace(/!\s*\[/g,"")).replace(/```[\s\S]*?```/g,"")).replace(/`([^`]+)`/g,"$1")).replace(/`/g,"")).replace(/^#{1,6}\s+/gm,"")).replace(/\*\*([^\*]+)\*\*/g,"$1")).replace(/__([^_]+)__/g,"$1")).replace(/\*([^\*]+)\*/g,"$1")).replace(/_([^_]+)_/g,"$1")).replace(/~~([^~]+)~~/g,"$1")).replace(/^[\s]*[-*+]\s+/gm,"")).replace(/^[\s]*\d+\.\s+/gm,"")).replace(/^>\s+/gm,"")).replace(/\[([^\]]+)\]\(([^)]+)\)/g,"$1")).replace(/\|.*\|/g,"")).replace(/^\s*[-*_]{3,}\s*$/gm,"")).replace(/\s+/g," ").replace(/\n{3,}/g,"\n\n").replace(/\n\s*\n/g,"\n\n").trim()};function w(){let a=(0,k.useRouter)(),m=(0,k.useSearchParams)(),[w,x]=(0,j.useState)([]),[y,z]=(0,j.useState)([]),[A,B]=(0,j.useState)([]),[C,D]=(0,j.useState)("all"),[E,F]=(0,j.useState)("all"),[G,H]=(0,j.useState)(!1),[I,J]=(0,j.useState)(""),[K,L]=(0,j.useState)(1),[M,N]=(0,j.useState)(1),[O,P]=(0,j.useState)(!1);(0,j.useEffect)(()=>{let a=()=>{P(window.innerWidth>=768)};return a(),window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]);let Q={themeType:"default",footerCopyright:`\xa9 ${new Date().getFullYear()} 个人主页. All rights reserved.`,noteLayoutColumns:"1",showNoteCover:"true",defaultNoteCover:"",avatarShape:"circle",noteDisplayMode:"modal",showTopNavbar:"true",showWapSidebar:"true",showNoteTags:"true",showNoteCategories:"true"},[R,S]=(0,j.useState)(Q),[T,U]=(0,j.useState)({title:"全部笔记",description:"探索所有已发布的笔记内容",browserTitle:"全部笔记",browserSubtitle:""}),[V,W]=(0,j.useState)(!1);(0,j.useEffect)(()=>{let a=m.get("category"),b=m.get("tag");a&&D(a),b&&F(b)},[m]),(0,j.useEffect)(()=>{Y(),Z(),$(),X()},[K,C,E]),(0,j.useEffect)(()=>{let a=T.browserTitle;"all"!==C?a=`${C} - ${T.browserTitle}`:"all"!==E&&(a=`${E} - ${T.browserTitle}`),document.title=a},[C,E,T.browserTitle]);let X=async()=>{try{let[a,b]=await Promise.all([(0,l.getSettings)(),(0,l.getPageText)("notes")]);if(a.success&&a.data){let b={};a.data.forEach(a=>{b[a.key]=a.value}),S({themeType:b.themeType||"default",footerCopyright:b.footerCopyright||`\xa9 ${new Date().getFullYear()} 个人主页. All rights reserved.`,noteLayoutColumns:b.noteLayoutColumns||"1",showNoteCover:b.showNoteCover||"true",defaultNoteCover:b.defaultNoteCover||"",avatarShape:b.avatarShape||"circle",noteDisplayMode:b.noteDisplayMode||"modal",showTopNavbar:b.showTopNavbar||"true",showWapSidebar:b.showWapSidebar||"true",showNoteTags:"false"!==b.showNoteTags,showNoteCategories:"false"!==b.showNoteCategories})}b.success&&b.data&&(U({title:b.data.title||"全部笔记",description:b.data.description||"探索所有已发布的笔记内容",browserTitle:b.data.browserTitle||"全部笔记",browserSubtitle:b.data.browserSubtitle||""}),W(!0))}catch(a){console.error("Failed to load settings:",a),W(!0)}},Y=async()=>{try{let a={is_published:!0,page:K,limit:12};"all"!==C&&(a.category=C),"all"!==E&&(a.tag=E);let b=await l.default.get("/notes",{params:a}),c=b.data?.data,d=Array.isArray(c?.notes)?c.notes:[];x(d),N(c?.pagination?.totalPages||1)}catch(a){console.error("Failed to fetch notes:",a),x([])}finally{H(!1)}},Z=async()=>{try{let a=await l.default.get("/notes/categories/list"),b=a.data?.data;z(Array.isArray(b)?b:[])}catch(a){console.error("Failed to fetch categories:",a),z([])}},$=async()=>{try{let a=await l.default.get("/notes/tags/stats"),b=a.data?.data;B(Array.isArray(b)?b.map(a=>a.name):[])}catch(a){console.error("Failed to fetch tags:",a),B([])}},_=w.filter(a=>{if(!I.trim())return!0;let b=I.toLowerCase(),c=a.title?.toLowerCase().includes(b),d=v(a.content).toLowerCase().includes(b),e=a.category?.toLowerCase().includes(b),f=a.Tags?.some(a=>a.name.toLowerCase().includes(b))||a.tags?.toLowerCase().includes(b);return c||d||e||f}),aa=new Map(y.map(a=>[a.name,a])),ab=parseInt(R?.noteLayoutColumns)||1,ac=1===ab||(2===ab||3===ab)&&O,ad=(!!O||!(ab>=2))&&(!O||4!==ab)&&(R?.showNoteTags||R?.showNoteCategories),ae=(!!O||!(ab>=2))&&(!O||4!==ab);R?.themeType,R?.showTopNavbar;let af=R?.showWapSidebar!=="false",ag=I.trim()&&_.length>0,ah=I.trim()&&0===_.length;return(0,b.jsxs)("main",{className:"min-h-screen bg-bg-primary relative flex flex-col hide-scrollbar",children:[(0,b.jsx)(q.default,{}),(0,b.jsx)(r.default,{}),(0,b.jsx)(n.default,{showWapSidebar:af}),(0,b.jsxs)("div",{className:"relative z-0 flex-1 flex flex-col",children:[(0,b.jsx)("div",{className:"h-16"}),(0,b.jsxs)("div",{className:"container mx-auto px-4 max-w-6xl py-8",children:[(0,b.jsxs)("div",{className:"text-center mb-8",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-text-primary mb-2",children:T.title}),(0,b.jsx)("p",{className:"text-text-secondary",children:T.description})]}),(0,b.jsx)("div",{className:"mb-6",children:(0,b.jsx)("form",{onSubmit:a=>{a.preventDefault()},children:(0,b.jsxs)("div",{className:"relative max-w-2xl mx-auto",children:[(0,b.jsx)(d.Search,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-text-tertiary"}),(0,b.jsx)("input",{type:"text",placeholder:"搜索笔记...",value:I,onChange:a=>J(a.target.value),className:"w-full pl-12 pr-12 py-3 bg-bg-secondary border border-border-primary rounded-xl text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all",autoComplete:"off"}),I&&(0,b.jsx)("button",{type:"button",onClick:()=>{J("")},className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-text-tertiary hover:text-text-primary transition-colors","aria-label":"清空搜索",children:(0,b.jsx)(e.X,{className:"w-5 h-5"})})]})})}),ag&&(0,b.jsx)("div",{className:"mb-6 p-4 rounded-xl border max-w-2xl mx-auto",style:{backgroundColor:"var(--info-bg)",borderColor:"var(--info-border)"},children:(0,b.jsx)("div",{className:"flex items-center justify-center gap-2",children:(0,b.jsxs)("span",{className:"text-sm",style:{color:"var(--info-text)"},children:["搜索结果: 找到 ",_.length," 条相关笔记",(0,b.jsxs)("span",{className:"font-medium ml-1",children:['"',I,'"']})]})})}),ah&&(0,b.jsx)("div",{className:"mb-6 p-4 bg-bg-tertiary rounded-xl border border-border-primary text-center max-w-2xl mx-auto",children:(0,b.jsxs)("span",{className:"text-sm text-text-tertiary",children:['没有找到包含 "',I,'" 的笔记']})}),(0,b.jsxs)("div",{className:"mb-8 space-y-4",children:[y.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"text-sm font-medium text-text-secondary mb-3 flex items-center gap-2",children:[(0,b.jsx)(i.FolderOpen,{className:"w-4 h-4"}),"按分类筛选"]}),(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,b.jsx)("button",{onClick:()=>{D("all"),L(1)},className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${"all"===C?"bg-primary-500 text-white shadow-md":"bg-bg-secondary text-text-secondary hover:bg-bg-tertiary border border-border-primary"}`,children:"全部"}),y.map(a=>(0,b.jsxs)("button",{onClick:()=>{D(a.name),L(1)},className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${C===a.name?"bg-primary-500 text-white shadow-md":"bg-bg-secondary text-text-secondary hover:bg-bg-tertiary border border-border-primary"}`,children:[a.icon&&(0,b.jsx)("span",{className:"mr-1.5",children:a.icon}),a.name]},a.id||a.name))]})]}),A.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"text-sm font-medium text-text-secondary mb-3 flex items-center gap-2",children:[(0,b.jsx)(h.Tag,{className:"w-4 h-4"}),"按标签筛选"]}),(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,b.jsx)("button",{onClick:()=>{F("all"),L(1)},className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${"all"===E?"bg-primary-500 text-white shadow-md":"bg-bg-secondary text-text-secondary hover:bg-bg-tertiary border border-border-primary"}`,children:"全部"}),A.slice(0,10).map(a=>(0,b.jsx)("button",{onClick:()=>{F(a),L(1)},className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${E===a?"bg-primary-500 text-white shadow-md":"bg-bg-secondary text-text-secondary hover:bg-bg-tertiary border border-border-primary"}`,children:a},a))]})]})]}),_.length>0?(0,b.jsx)(p.default,{breakpointCols:{default:parseInt(R?.noteLayoutColumns)||1,1536:parseInt(R?.noteLayoutColumns)||1,1280:4===parseInt(R?.noteLayoutColumns)?3:parseInt(R?.noteLayoutColumns)||1,1024:parseInt(R?.noteLayoutColumns)>=3?2:parseInt(R?.noteLayoutColumns)||1,768:parseInt(R?.noteLayoutColumns)>1?2:1,640:parseInt(R?.noteLayoutColumns)>1?2:1},className:"flex -ml-3 w-auto",columnClassName:"pl-3 bg-clip-padding",children:_.map((d,e)=>{let h=(d.cover_image||R?.defaultNoteCover||"").startsWith("http")?d.cover_image||R?.defaultNoteCover:`${s}${d.cover_image||R?.defaultNoteCover}`;return(0,b.jsx)(c.motion.div,{onClick:()=>{var b;return b=d.id,void a.push(`/note/${b}`)},className:"group block rounded-lg shadow-sm hover:shadow-lg hover:-translate-y-0.5 border bg-bg-secondary border-border-primary transition-all duration-300 cursor-pointer overflow-hidden mb-3",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*e},children:ac?(0,b.jsxs)("div",{className:"flex gap-3 items-stretch p-3",children:[(d.cover_image||R?.defaultNoteCover)&&R?.showNoteCover==="true"&&(0,b.jsx)("div",{className:"flex-shrink-0 w-24 h-24 rounded-md overflow-hidden bg-bg-tertiary",children:(0,b.jsx)("img",{src:h,alt:d.title||"封面图",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",onError:a=>{a.target.style.display="none"}})}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col justify-center min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-start gap-2 mb-1",children:[d.title&&(0,b.jsx)("h3",{className:"text-base font-semibold text-text-primary line-clamp-1 flex-1 group-hover:text-primary-500 transition-colors",children:d.title}),d.is_pinned&&(0,b.jsx)("div",{className:"flex-shrink-0 px-1.5 py-0.5 rounded text-[10px] font-semibold flex items-center gap-0.5",style:{background:"linear-gradient(to right, var(--pinned-gradient-from), var(--pinned-gradient-to))",color:"var(--pinned-text)"},children:(0,b.jsx)(g.Pin,{className:"w-2.5 h-2.5 fill-current"})})]}),ae&&(0,b.jsx)("p",{className:"text-xs text-text-secondary line-clamp-2 mb-2 leading-relaxed",children:d.summary||(d.content?u(v(d.content),80):"暂无内容")}),(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap text-[10px]",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1 text-text-tertiary",children:[(0,b.jsx)(f.Clock,{className:"w-2.5 h-2.5"}),(0,b.jsx)("span",{children:t(d.published_at||d.created_at)})]}),ad&&R?.showNoteCategories&&d.category&&(0,b.jsxs)("span",{className:"px-1.5 py-0.5 bg-primary-100 text-primary-700 rounded-full font-medium cursor-pointer hover:bg-primary-200 transition-colors",onClick:a=>{a.stopPropagation(),D(d.category),L(1)},children:[aa.get(d.category)?.icon&&(0,b.jsx)("span",{className:"mr-0.5",children:aa.get(d.category)?.icon}),d.category]}),ad&&R?.showNoteTags&&d.Tags&&d.Tags.length>0&&(0,b.jsxs)(b.Fragment,{children:[d.Tags.slice(0,2).map(a=>(0,b.jsx)("span",{className:"px-1.5 py-0.5 rounded-full font-medium cursor-pointer transition-opacity",style:a.color?{backgroundColor:`${a.color}20`,color:a.color}:{backgroundColor:"var(--tag-bg)",color:"var(--tag-text)"},onMouseEnter:b=>{a.color||(b.currentTarget.style.backgroundColor="var(--tag-hover-bg)")},onMouseLeave:b=>{a.color||(b.currentTarget.style.backgroundColor="var(--tag-bg)")},onClick:b=>{b.stopPropagation(),F(a.name),L(1)},children:a.name},a.id)),d.Tags.length>2&&(0,b.jsxs)("span",{className:"px-1.5 py-0.5 rounded-full text-[10px]",style:{backgroundColor:"var(--tag-bg)",color:"var(--tag-text)"},children:["+",d.Tags.length-2]})]})]})]})]}):(0,b.jsxs)("div",{className:"flex flex-col",children:[(d.cover_image||R?.defaultNoteCover)&&R?.showNoteCover==="true"&&(0,b.jsxs)("div",{className:"relative w-full pt-[100%] overflow-hidden bg-gradient-to-br from-primary-100 to-primary-200",children:[(0,b.jsx)("img",{src:h,alt:d.title||"封面图",className:"absolute inset-0 w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",onError:a=>{a.target.style.display="none"}}),d.is_pinned&&(0,b.jsxs)("div",{className:"absolute top-2 right-2 bg-bg-secondary/90 backdrop-blur-sm rounded-full px-2 py-1 text-[10px] text-text-primary font-semibold flex items-center gap-1 border border-border-primary/50",children:[(0,b.jsx)(g.Pin,{className:"w-2.5 h-2.5 fill-current"}),(0,b.jsx)("span",{children:"置顶"})]})]}),(0,b.jsxs)("div",{className:"p-3",children:[d.title&&(0,b.jsx)("h3",{className:"font-semibold text-base text-text-primary group-hover:text-primary-500 transition-colors line-clamp-2 mb-1",children:d.title}),ae&&(0,b.jsx)("p",{className:"text-xs text-text-secondary line-clamp-2 leading-relaxed mb-2",children:d.summary||(d.content?u(v(d.content),100):"暂无内容")}),(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2 text-[10px]",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1 text-text-tertiary",children:[(0,b.jsx)(f.Clock,{className:"w-2.5 h-2.5"}),(0,b.jsx)("span",{children:t(d.published_at||d.created_at)})]}),ad&&(0,b.jsxs)("div",{className:"flex items-center gap-1 flex-wrap",children:[R?.showNoteCategories&&d.category&&(0,b.jsxs)("span",{className:"px-1.5 py-0.5 bg-primary-100 text-primary-700 rounded-full font-medium cursor-pointer hover:bg-primary-200 transition-colors",onClick:a=>{a.stopPropagation(),D(d.category),L(1)},children:[aa.get(d.category)?.icon&&(0,b.jsx)("span",{className:"mr-0.5",children:aa.get(d.category)?.icon}),d.category]}),R?.showNoteTags&&d.Tags&&d.Tags.length>0&&(0,b.jsxs)(b.Fragment,{children:[d.Tags.slice(0,1).map(a=>(0,b.jsx)("span",{className:"px-1.5 py-0.5 rounded-full font-medium cursor-pointer transition-opacity",style:a.color?{backgroundColor:`${a.color}20`,color:a.color}:{backgroundColor:"var(--tag-bg)",color:"var(--tag-text)"},onMouseEnter:b=>{a.color||(b.currentTarget.style.backgroundColor="var(--tag-hover-bg)")},onMouseLeave:b=>{a.color||(b.currentTarget.style.backgroundColor="var(--tag-bg)")},onClick:b=>{b.stopPropagation(),F(a.name),L(1)},children:a.name},a.id)),d.Tags.length>1&&(0,b.jsxs)("span",{className:"px-1.5 py-0.5 rounded-full",style:{backgroundColor:"var(--tag-bg)",color:"var(--tag-text)"},children:["+",d.Tags.length-1]})]})]})]})]})]})},d.id)})}):(0,b.jsx)("div",{className:"text-center py-16 text-text-tertiary",children:(0,b.jsx)("p",{className:"text-lg",children:"暂无笔记"})}),M>1&&(0,b.jsxs)("div",{className:"flex justify-center gap-2 pt-8 mt-8",children:[(0,b.jsx)("button",{onClick:()=>L(a=>Math.max(1,a-1)),disabled:1===K,className:"px-4 py-2 rounded-lg bg-bg-secondary text-text-secondary hover:bg-bg-tertiary disabled:opacity-30 disabled:cursor-not-allowed transition-all text-sm border border-border-primary",children:"上一页"}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:Array.from({length:Math.min(M,5)},(a,c)=>{let d,e=(d=M<=5||K<=3?c+1:K>=M-2?M-4+c:K-2+c)===K;return(0,b.jsx)("button",{onClick:()=>L(d),className:"w-10 h-10 rounded-lg transition-all text-sm border "+(e?"bg-primary-500 text-white border-primary-500":"bg-bg-secondary text-text-secondary hover:bg-bg-tertiary border-border-primary"),children:d},d)})}),(0,b.jsx)("button",{onClick:()=>L(a=>Math.min(M,a+1)),disabled:K===M,className:"px-4 py-2 rounded-lg bg-bg-secondary text-text-secondary hover:bg-bg-tertiary disabled:opacity-30 disabled:cursor-not-allowed transition-all text-sm border border-border-primary",children:"下一页"})]})]}),(0,b.jsxs)("footer",{className:"mt-auto border-t border-border-primary py-6 text-center text-sm text-text-tertiary",children:[(0,b.jsx)("p",{children:R.footerCopyright}),(0,b.jsx)(o.default,{})]})]})]})}a.s(["default",()=>w])}];

//# sourceMappingURL=src_app_notes_page_tsx_912b195d._.js.map