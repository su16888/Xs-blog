module.exports=[957723,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(346271),e=a.i(262036),f=a.i(883706);let g=(0,f.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),h=(0,f.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var i=a.i(633508);function j({show:a,message:f,type:j,duration:k=3e3,onClose:l}){let[m,n]=(0,c.useState)(!1);(0,c.useEffect)(()=>{if(a){n(!0);let a=setTimeout(()=>{n(!1)},k);return()=>clearTimeout(a)}n(!1)},[a,k]),(0,c.useEffect)(()=>{if(!m&&a){let a=setTimeout(l,300);return()=>clearTimeout(a)}},[m,a,l]);let o=(()=>{switch(j){case"success":return{bg:"bg-green-50 border-green-200",text:"text-green-800",icon:(0,b.jsx)(g,{className:"w-5 h-5 text-green-500"})};case"error":return{bg:"bg-red-50 border-red-200",text:"text-red-800",icon:(0,b.jsx)(h,{className:"w-5 h-5 text-red-500"})};default:return{bg:"bg-blue-50 border-blue-200",text:"text-blue-800",icon:(0,b.jsx)(g,{className:"w-5 h-5 text-blue-500"})}}})();return(0,b.jsx)(e.AnimatePresence,{children:m&&(0,b.jsx)(d.motion.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.9},transition:{duration:.2},className:"fixed top-4 right-4 z-[999999] min-w-[300px] max-w-md",children:(0,b.jsxs)("div",{className:`${o.bg} border rounded-lg shadow-lg p-4 flex items-start gap-3`,children:[(0,b.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:o.icon}),(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsx)("p",{className:`${o.text} text-sm font-medium`,children:f})}),(0,b.jsx)("button",{onClick:()=>{n(!1)},className:"flex-shrink-0 text-gray-400 hover:text-gray-600 transition-colors",children:(0,b.jsx)(i.X,{className:"w-4 h-4"})})]})})})}a.s(["default",()=>j],957723)},262036,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(886723),e=a.i(774290),f=a.i(801703),g=a.i(414800),h=a.i(991128),i=c,j=a.i(965802);function k(a,b){if("function"==typeof a)return a(b);null!=a&&(a.current=b)}class l extends i.Component{getSnapshotBeforeUpdate(a){let b=this.props.childRef.current;if(b&&a.isPresent&&!this.props.isPresent){let a=b.offsetParent,c=(0,h.isHTMLElement)(a)&&a.offsetWidth||0,d=this.props.sizeRef.current;d.height=b.offsetHeight||0,d.width=b.offsetWidth||0,d.top=b.offsetTop,d.left=b.offsetLeft,d.right=c-d.width-d.left}return null}componentDidUpdate(){}render(){return this.props.children}}function m({children:a,isPresent:d,anchorX:e,root:f}){let g=(0,i.useId)(),h=(0,i.useRef)(null),m=(0,i.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:n}=(0,i.useContext)(j.MotionConfigContext),o=function(...a){return c.useCallback(function(...a){return b=>{let c=!1,d=a.map(a=>{let d=k(a,b);return c||"function"!=typeof d||(c=!0),d});if(c)return()=>{for(let b=0;b<d.length;b++){let c=d[b];"function"==typeof c?c():k(a[b],null)}}}}(...a),a)}(h,a?.ref);return(0,i.useInsertionEffect)(()=>{let{width:a,height:b,top:c,left:i,right:j}=m.current;if(d||!h.current||!a||!b)return;let k="left"===e?`left: ${i}`:`right: ${j}`;h.current.dataset.motionPopId=g;let l=document.createElement("style");n&&(l.nonce=n);let o=f??document.head;return o.appendChild(l),l.sheet&&l.sheet.insertRule(`
          [data-motion-pop-id="${g}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${b}px !important;
            ${k}px !important;
            top: ${c}px !important;
          }
        `),()=>{o.contains(l)&&o.removeChild(l)}},[d]),(0,b.jsx)(l,{isPresent:d,childRef:h,sizeRef:m,children:i.cloneElement(a,{ref:o})})}let n=({children:a,initial:d,isPresent:f,onExitComplete:h,custom:i,presenceAffectsLayout:j,mode:k,anchorX:l,root:n})=>{let p=(0,e.useConstant)(o),q=(0,c.useId)(),r=!0,s=(0,c.useMemo)(()=>(r=!1,{id:q,initial:d,isPresent:f,custom:i,onExitComplete:a=>{for(let b of(p.set(a,!0),p.values()))if(!b)return;h&&h()},register:a=>(p.set(a,!1),()=>p.delete(a))}),[f,p,h]);return j&&r&&(s={...s}),(0,c.useMemo)(()=>{p.forEach((a,b)=>p.set(b,!1))},[f]),c.useEffect(()=>{f||p.size||!h||h()},[f]),"popLayout"===k&&(a=(0,b.jsx)(m,{isPresent:f,anchorX:l,root:n,children:a})),(0,b.jsx)(g.PresenceContext.Provider,{value:s,children:a})};function o(){return new Map}var p=a.i(120410);let q=a=>a.key||"";function r(a){let b=[];return c.Children.forEach(a,a=>{(0,c.isValidElement)(a)&&b.push(a)}),b}let s=({children:a,custom:g,initial:h=!0,onExitComplete:i,presenceAffectsLayout:j=!0,mode:k="sync",propagate:l=!1,anchorX:m="left",root:o})=>{let[s,t]=(0,p.usePresence)(l),u=(0,c.useMemo)(()=>r(a),[a]),v=l&&!s?[]:u.map(q),w=(0,c.useRef)(!0),x=(0,c.useRef)(u),y=(0,e.useConstant)(()=>new Map),[z,A]=(0,c.useState)(u),[B,C]=(0,c.useState)(u);(0,f.useIsomorphicLayoutEffect)(()=>{w.current=!1,x.current=u;for(let a=0;a<B.length;a++){let b=q(B[a]);v.includes(b)?y.delete(b):!0!==y.get(b)&&y.set(b,!1)}},[B,v.length,v.join("-")]);let D=[];if(u!==z){let a=[...u];for(let b=0;b<B.length;b++){let c=B[b],d=q(c);v.includes(d)||(a.splice(b,0,c),D.push(c))}return"wait"===k&&D.length&&(a=D),C(r(a)),A(u),null}let{forceRender:E}=(0,c.useContext)(d.LayoutGroupContext);return(0,b.jsx)(b.Fragment,{children:B.map(a=>{let c=q(a),d=(!l||!!s)&&(u===B||v.includes(c));return(0,b.jsx)(n,{isPresent:d,initial:(!w.current||!!h)&&void 0,custom:g,presenceAffectsLayout:j,mode:k,root:o,onExitComplete:d?void 0:()=>{if(!y.has(c))return;y.set(c,!0);let a=!0;y.forEach(b=>{b||(a=!1)}),a&&(E?.(),C(x.current),l&&t?.(),i&&i())},anchorX:m,children:a},c)})})};a.s(["AnimatePresence",()=>s],262036)},465763,a=>{"use strict";var b=a.i(572131),c=a.i(182572);let d=null;function e(a,f=!1){let[g,h]=(0,b.useState)(d||""),i=(0,c.useOptionalPageTitleContext)();(0,b.useEffect)(()=>{f&&i&&i.setTitle(a)},[a,f,i]),(0,b.useEffect)(()=>{d?h(d):(async()=>{try{let a=await fetch("/api/settings");if(a.ok){let b=await a.json();if(b.success&&b.data){let a={};b.data.forEach(b=>{a[b.key]=b.value});let c=a.siteTitle||"";d=c,h(c)}}}catch(a){console.error("Failed to fetch site title:",a)}})()},[]),(0,b.useEffect)(()=>{let b=document.title;return f?"仪表盘"===a?document.title=`${g} - 后台管理系统`:document.title=`${a} - ${g}后台管理系统`:document.title=`${a} - ${g}`,()=>{document.title=b}},[a,g,f])}a.s(["usePageTitle",()=>e])},976737,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(50944),e=a.i(711642),f=a.i(119032),g=a.i(465763),h=a.i(957723);function i(){(0,g.usePageTitle)("留言管理",!0),(0,d.useRouter)();let{user:a}=(0,e.useAuth)(),[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)("messages"),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)([]),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(null),[y,z]=(0,c.useState)({show:!1,type:"success",message:""});(0,c.useEffect)(()=>{"messages"===k?A():"message-categories"===k&&B()},[k]);let A=async()=>{r(!0);try{let a=await (0,f.getAdminMessages)();a.success&&a.data?n(a.data.messages||[]):n([])}catch(a){console.error("Failed to load messages:",a),n([])}finally{r(!1)}},B=async()=>{try{let a=await (0,f.getAdminMessageCategories)();a.success&&a.data&&p(a.data)}catch(a){console.error("Failed to load message categories:",a),p([])}},C=async(a,b)=>{try{(await (0,f.updateAdminMessageStatus)(a,b)).success&&(z({show:!0,type:"success",message:"状态更新成功"}),A())}catch(a){z({show:!0,type:"error",message:a.response?.data?.message||"更新失败"})}},D=async a=>{if(confirm("确定要删除这条留言吗？此操作不可恢复。"))try{(await (0,f.deleteAdminMessage)(a)).success&&(z({show:!0,type:"success",message:"留言删除成功"}),A())}catch(a){z({show:!0,type:"error",message:a.response?.data?.message||"删除失败"})}},E=async()=>{if(!u.trim())return void z({show:!0,type:"error",message:"分类名称不能为空"});try{(await (0,f.createAdminMessageCategory)({name:u})).success&&(z({show:!0,type:"success",message:"分类创建成功"}),v(""),B())}catch(a){z({show:!0,type:"error",message:a.response?.data?.message||"创建失败"})}},F=async a=>{try{(await (0,f.updateAdminMessageCategory)(a.id,{name:a.name,sort_order:a.sort_order})).success&&(z({show:!0,type:"success",message:"分类更新成功"}),x(null),B())}catch(a){z({show:!0,type:"error",message:a.response?.data?.message||"更新失败"})}},G=async a=>{if(confirm("确定要删除这个分类吗？此操作不可恢复。"))try{(await (0,f.deleteAdminMessageCategory)(a)).success&&(z({show:!0,type:"success",message:"分类删除成功"}),B())}catch(a){z({show:!0,type:"error",message:a.response?.data?.message||"删除失败"})}};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.default,{show:y.show,message:y.message,type:y.type,onClose:()=>z({...y,show:!1})}),(0,b.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,b.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100 mb-6",children:[(0,b.jsxs)("div",{className:"flex space-x-4 border-b border-gray-200",children:[(0,b.jsx)("button",{onClick:()=>l("messages"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${"messages"===k?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"留言列表"}),(0,b.jsx)("button",{onClick:()=>l("message-categories"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${"message-categories"===k?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"留言分类"})]}),"messages"===k&&(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"留言列表"})}),0!==m.length||q?(0,b.jsx)("div",{className:"bg-gray-50 rounded-lg border border-gray-200 max-h-96 overflow-y-auto",children:(0,b.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,b.jsx)("thead",{className:"bg-gray-100",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"时间"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"用户"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"分类"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"状态"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),(0,b.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map(a=>(0,b.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,b.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:new Date(a.created_at).toLocaleString()}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-gray-900",children:a.name}),(0,b.jsx)("div",{className:"text-sm text-gray-500",children:a.contact}),(0,b.jsx)("div",{className:"text-xs text-gray-400 font-mono",children:a.ip_address})]})}),(0,b.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:a.MessageCategory?.name||"未分类"}),(0,b.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,b.jsxs)("select",{value:a.status,onChange:b=>C(a.id,b.target.value),className:`text-xs font-medium rounded-full px-2.5 py-0.5 ${(a=>{switch(a){case"pending":return"bg-yellow-100 text-yellow-800";case"read":return"bg-blue-100 text-blue-800";case"replied":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}})(a.status)} border-0 focus:ring-0`,children:[(0,b.jsx)("option",{value:"pending",children:"待处理"}),(0,b.jsx)("option",{value:"read",children:"已读"}),(0,b.jsx)("option",{value:"replied",children:"已回复"})]})}),(0,b.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:(0,b.jsxs)("div",{className:"flex space-x-2",children:[(0,b.jsx)("button",{onClick:()=>t(a),className:"text-blue-600 hover:text-blue-900 text-sm",children:"查看"}),(0,b.jsx)("button",{onClick:()=>D(a.id),className:"text-red-600 hover:text-red-900 text-sm",children:"删除"})]})})]},a.id))})]})}):(0,b.jsx)("div",{className:"text-center py-8 text-gray-500",children:"暂无留言"}),s&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[99999]",children:(0,b.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"留言详情"}),(0,b.jsx)("button",{onClick:()=>t(null),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"用户称呼"}),(0,b.jsx)("div",{className:"bg-gray-50 p-3 rounded",children:s.name})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"联系方式"}),(0,b.jsx)("div",{className:"bg-gray-50 p-3 rounded",children:s.contact})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"留言分类"}),(0,b.jsx)("div",{className:"bg-gray-50 p-3 rounded",children:s.MessageCategory?.name||"未分类"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"留言内容"}),(0,b.jsx)("div",{className:"bg-gray-50 p-3 rounded whitespace-pre-wrap",children:s.content})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"IP地址"}),(0,b.jsx)("div",{className:"bg-gray-50 p-3 rounded font-mono",children:s.ip_address})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"提交时间"}),(0,b.jsx)("div",{className:"bg-gray-50 p-3 rounded",children:new Date(s.created_at).toLocaleString()})]})]})]})})]}),"message-categories"===k&&(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"留言分类管理"}),(0,b.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[(0,b.jsx)("h3",{className:"text-md font-medium text-blue-900 mb-2",children:"添加新分类"}),(0,b.jsxs)("div",{className:"flex space-x-2",children:[(0,b.jsx)("input",{type:"text",value:u,onChange:a=>v(a.target.value),placeholder:"输入分类名称",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,b.jsx)("button",{onClick:E,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"添加"})]})]}),0===o.length?(0,b.jsx)("div",{className:"text-center py-8 text-gray-500",children:"暂无分类"}):(0,b.jsx)("div",{className:"bg-gray-50 rounded-lg border border-gray-200",children:(0,b.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,b.jsx)("thead",{className:"bg-gray-100",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"分类名称"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"排序"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),(0,b.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(a=>(0,b.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,b.jsx)("td",{className:"px-4 py-3",children:w?.id===a.id?(0,b.jsx)("input",{type:"text",value:w.name,onChange:a=>x({...w,name:a.target.value}),className:"px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}):(0,b.jsx)("span",{className:"text-sm text-gray-900",children:a.name})}),(0,b.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:w?.id===a.id?(0,b.jsx)("input",{type:"number",value:w.sort_order,onChange:a=>x({...w,sort_order:parseInt(a.target.value)||0}),className:"w-20 px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0"}):(0,b.jsx)("span",{children:a.sort_order})}),(0,b.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:(0,b.jsx)("div",{className:"flex space-x-2",children:w?.id===a.id?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:()=>F(w),className:"text-green-600 hover:text-green-900 text-sm",children:"保存"}),(0,b.jsx)("button",{onClick:()=>x(null),className:"text-gray-600 hover:text-gray-900 text-sm",children:"取消"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:()=>x(a),className:"text-blue-600 hover:text-blue-900 text-sm",children:"编辑"}),(0,b.jsx)("button",{onClick:()=>G(a.id),className:"text-red-600 hover:text-red-900 text-sm",children:"删除"})]})})})]},a.id))})]})})]})]})})})]})}a.s(["default",()=>i])}];

//# sourceMappingURL=_cd479d76._.js.map