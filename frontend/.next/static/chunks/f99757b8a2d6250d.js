(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,738750,(e,t,r)=>{t.exports=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then}},87201,(e,t,r)=>{let n,s=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];r.getSymbolSize=function(e){if(!e)throw Error('"version" cannot be null or undefined');if(e<1||e>40)throw Error('"version" should be in range from 1 to 40');return 4*e+17},r.getSymbolTotalCodewords=function(e){return s[e]},r.getBCHDigit=function(e){let t=0;for(;0!==e;)t++,e>>>=1;return t},r.setToSJISFunction=function(e){if("function"!=typeof e)throw Error('"toSJISFunc" is not a valid function.');n=e},r.isKanjiModeEnabled=function(){return void 0!==n},r.toSJIS=function(e){return n(e)}},473133,(e,t,r)=>{r.L={bit:1},r.M={bit:0},r.Q={bit:3},r.H={bit:2},r.isValid=function(e){return e&&void 0!==e.bit&&e.bit>=0&&e.bit<4},r.from=function(e,t){if(r.isValid(e))return e;try{if("string"!=typeof e)throw Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return r.L;case"m":case"medium":return r.M;case"q":case"quartile":return r.Q;case"h":case"high":return r.H;default:throw Error("Unknown EC Level: "+e)}}catch(e){return t}}},173666,(e,t,r)=>{function n(){this.buffer=[],this.length=0}n.prototype={get:function(e){let t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)==1},put:function(e,t){for(let r=0;r<t;r++)this.putBit((e>>>t-r-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(e){let t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},t.exports=n},811421,(e,t,r)=>{function n(e){if(!e||e<1)throw Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}n.prototype.set=function(e,t,r,n){let s=e*this.size+t;this.data[s]=r,n&&(this.reservedBit[s]=!0)},n.prototype.get=function(e,t){return this.data[e*this.size+t]},n.prototype.xor=function(e,t,r){this.data[e*this.size+t]^=r},n.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]},t.exports=n},720637,(e,t,r)=>{let n=e.r(87201).getSymbolSize;r.getRowColCoords=function(e){if(1===e)return[];let t=Math.floor(e/7)+2,r=n(e),s=145===r?26:2*Math.ceil((r-13)/(2*t-2)),i=[r-7];for(let e=1;e<t-1;e++)i[e]=i[e-1]-s;return i.push(6),i.reverse()},r.getPositions=function(e){let t=[],n=r.getRowColCoords(e),s=n.length;for(let e=0;e<s;e++)for(let r=0;r<s;r++)(0!==e||0!==r)&&(0!==e||r!==s-1)&&(e!==s-1||0!==r)&&t.push([n[e],n[r]]);return t}},814002,(e,t,r)=>{let n=e.r(87201).getSymbolSize;r.getPositions=function(e){let t=n(e);return[[0,0],[t-7,0],[0,t-7]]}},237692,(e,t,r)=>{r.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};r.isValid=function(e){return null!=e&&""!==e&&!isNaN(e)&&e>=0&&e<=7},r.from=function(e){return r.isValid(e)?parseInt(e,10):void 0},r.getPenaltyN1=function(e){let t=e.size,r=0,n=0,s=0,i=null,a=null;for(let o=0;o<t;o++){n=s=0,i=a=null;for(let l=0;l<t;l++){let t=e.get(o,l);t===i?n++:(n>=5&&(r+=3+(n-5)),i=t,n=1),(t=e.get(l,o))===a?s++:(s>=5&&(r+=3+(s-5)),a=t,s=1)}n>=5&&(r+=3+(n-5)),s>=5&&(r+=3+(s-5))}return r},r.getPenaltyN2=function(e){let t=e.size,r=0;for(let n=0;n<t-1;n++)for(let s=0;s<t-1;s++){let t=e.get(n,s)+e.get(n,s+1)+e.get(n+1,s)+e.get(n+1,s+1);(4===t||0===t)&&r++}return 3*r},r.getPenaltyN3=function(e){let t=e.size,r=0,n=0,s=0;for(let i=0;i<t;i++){n=s=0;for(let a=0;a<t;a++)n=n<<1&2047|e.get(i,a),a>=10&&(1488===n||93===n)&&r++,s=s<<1&2047|e.get(a,i),a>=10&&(1488===s||93===s)&&r++}return 40*r},r.getPenaltyN4=function(e){let t=0,r=e.data.length;for(let n=0;n<r;n++)t+=e.data[n];return 10*Math.abs(Math.ceil(100*t/r/5)-10)},r.applyMask=function(e,t){let n=t.size;for(let s=0;s<n;s++)for(let i=0;i<n;i++)t.isReserved(i,s)||t.xor(i,s,function(e,t,n){switch(e){case r.Patterns.PATTERN000:return(t+n)%2==0;case r.Patterns.PATTERN001:return t%2==0;case r.Patterns.PATTERN010:return n%3==0;case r.Patterns.PATTERN011:return(t+n)%3==0;case r.Patterns.PATTERN100:return(Math.floor(t/2)+Math.floor(n/3))%2==0;case r.Patterns.PATTERN101:return t*n%2+t*n%3==0;case r.Patterns.PATTERN110:return(t*n%2+t*n%3)%2==0;case r.Patterns.PATTERN111:return(t*n%3+(t+n)%2)%2==0;default:throw Error("bad maskPattern:"+e)}}(e,i,s))},r.getBestMask=function(e,t){let n=Object.keys(r.Patterns).length,s=0,i=1/0;for(let a=0;a<n;a++){t(a),r.applyMask(a,e);let n=r.getPenaltyN1(e)+r.getPenaltyN2(e)+r.getPenaltyN3(e)+r.getPenaltyN4(e);r.applyMask(a,e),n<i&&(i=n,s=a)}return s}},848125,(e,t,r)=>{let n=e.r(473133),s=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],i=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];r.getBlocksCount=function(e,t){switch(t){case n.L:return s[(e-1)*4+0];case n.M:return s[(e-1)*4+1];case n.Q:return s[(e-1)*4+2];case n.H:return s[(e-1)*4+3];default:return}},r.getTotalCodewordsCount=function(e,t){switch(t){case n.L:return i[(e-1)*4+0];case n.M:return i[(e-1)*4+1];case n.Q:return i[(e-1)*4+2];case n.H:return i[(e-1)*4+3];default:return}}},654232,(e,t,r)=>{let n=new Uint8Array(512),s=new Uint8Array(256),i=1;for(let e=0;e<255;e++)n[e]=i,s[i]=e,256&(i<<=1)&&(i^=285);for(let e=255;e<512;e++)n[e]=n[e-255];r.log=function(e){if(e<1)throw Error("log("+e+")");return s[e]},r.exp=function(e){return n[e]},r.mul=function(e,t){return 0===e||0===t?0:n[s[e]+s[t]]}},950677,(e,t,r)=>{let n=e.r(654232);r.mul=function(e,t){let r=new Uint8Array(e.length+t.length-1);for(let s=0;s<e.length;s++)for(let i=0;i<t.length;i++)r[s+i]^=n.mul(e[s],t[i]);return r},r.mod=function(e,t){let r=new Uint8Array(e);for(;r.length-t.length>=0;){let e=r[0];for(let s=0;s<t.length;s++)r[s]^=n.mul(t[s],e);let s=0;for(;s<r.length&&0===r[s];)s++;r=r.slice(s)}return r},r.generateECPolynomial=function(e){let t=new Uint8Array([1]);for(let s=0;s<e;s++)t=r.mul(t,new Uint8Array([1,n.exp(s)]));return t}},962458,(e,t,r)=>{let n=e.r(950677);function s(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}s.prototype.initialize=function(e){this.degree=e,this.genPoly=n.generateECPolynomial(this.degree)},s.prototype.encode=function(e){if(!this.genPoly)throw Error("Encoder not initialized");let t=new Uint8Array(e.length+this.degree);t.set(e);let r=n.mod(t,this.genPoly),s=this.degree-r.length;if(s>0){let e=new Uint8Array(this.degree);return e.set(r,s),e}return r},t.exports=s},67483,(e,t,r)=>{r.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}},396592,(e,t,r)=>{let n="[0-9]+",s="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+",i="(?:(?![A-Z0-9 $%*+\\-./:]|"+(s=s.replace(/u/g,"\\u"))+")(?:.|[\r\n]))+";r.KANJI=RegExp(s,"g"),r.BYTE_KANJI=RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),r.BYTE=RegExp(i,"g"),r.NUMERIC=RegExp(n,"g"),r.ALPHANUMERIC=RegExp("[A-Z $%*+\\-./:]+","g");let a=RegExp("^"+s+"$"),o=RegExp("^"+n+"$"),l=RegExp("^[A-Z0-9 $%*+\\-./:]+$");r.testKanji=function(e){return a.test(e)},r.testNumeric=function(e){return o.test(e)},r.testAlphanumeric=function(e){return l.test(e)}},150882,(e,t,r)=>{let n=e.r(67483),s=e.r(396592);r.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},r.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},r.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},r.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},r.MIXED={bit:-1},r.getCharCountIndicator=function(e,t){if(!e.ccBits)throw Error("Invalid mode: "+e);if(!n.isValid(t))throw Error("Invalid version: "+t);return t>=1&&t<10?e.ccBits[0]:t<27?e.ccBits[1]:e.ccBits[2]},r.getBestModeForData=function(e){return s.testNumeric(e)?r.NUMERIC:s.testAlphanumeric(e)?r.ALPHANUMERIC:s.testKanji(e)?r.KANJI:r.BYTE},r.toString=function(e){if(e&&e.id)return e.id;throw Error("Invalid mode")},r.isValid=function(e){return e&&e.bit&&e.ccBits},r.from=function(e,t){if(r.isValid(e))return e;try{if("string"!=typeof e)throw Error("Param is not a string");switch(e.toLowerCase()){case"numeric":return r.NUMERIC;case"alphanumeric":return r.ALPHANUMERIC;case"kanji":return r.KANJI;case"byte":return r.BYTE;default:throw Error("Unknown mode: "+e)}}catch(e){return t}}},93547,(e,t,r)=>{let n=e.r(87201),s=e.r(848125),i=e.r(473133),a=e.r(150882),o=e.r(67483),l=n.getBCHDigit(7973);function c(e,t){return a.getCharCountIndicator(e,t)+4}r.from=function(e,t){return o.isValid(e)?parseInt(e,10):t},r.getCapacity=function(e,t,r){if(!o.isValid(e))throw Error("Invalid QR Code version");void 0===r&&(r=a.BYTE);let i=(n.getSymbolTotalCodewords(e)-s.getTotalCodewordsCount(e,t))*8;if(r===a.MIXED)return i;let l=i-c(r,e);switch(r){case a.NUMERIC:return Math.floor(l/10*3);case a.ALPHANUMERIC:return Math.floor(l/11*2);case a.KANJI:return Math.floor(l/13);case a.BYTE:default:return Math.floor(l/8)}},r.getBestVersionForData=function(e,t){let n,s=i.from(t,i.M);if(Array.isArray(e)){if(e.length>1){for(let t=1;t<=40;t++)if(function(e,t){let r=0;return e.forEach(function(e){let n=c(e.mode,t);r+=n+e.getBitsLength()}),r}(e,t)<=r.getCapacity(t,s,a.MIXED))return t;return}if(0===e.length)return 1;n=e[0]}else n=e;return function(e,t,n){for(let s=1;s<=40;s++)if(t<=r.getCapacity(s,n,e))return s}(n.mode,n.getLength(),s)},r.getEncodedBits=function(e){if(!o.isValid(e)||e<7)throw Error("Invalid QR Code version");let t=e<<12;for(;n.getBCHDigit(t)-l>=0;)t^=7973<<n.getBCHDigit(t)-l;return e<<12|t}},857655,(e,t,r)=>{let n=e.r(87201),s=n.getBCHDigit(1335);r.getEncodedBits=function(e,t){let r=e.bit<<3|t,i=r<<10;for(;n.getBCHDigit(i)-s>=0;)i^=1335<<n.getBCHDigit(i)-s;return(r<<10|i)^21522}},494097,(e,t,r)=>{let n=e.r(150882);function s(e){this.mode=n.NUMERIC,this.data=e.toString()}s.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)},s.prototype.getLength=function(){return this.data.length},s.prototype.getBitsLength=function(){return s.getBitsLength(this.data.length)},s.prototype.write=function(e){let t,r;for(t=0;t+3<=this.data.length;t+=3)r=parseInt(this.data.substr(t,3),10),e.put(r,10);let n=this.data.length-t;n>0&&(r=parseInt(this.data.substr(t),10),e.put(r,3*n+1))},t.exports=s},112553,(e,t,r)=>{let n=e.r(150882),s=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function i(e){this.mode=n.ALPHANUMERIC,this.data=e}i.getBitsLength=function(e){return 11*Math.floor(e/2)+e%2*6},i.prototype.getLength=function(){return this.data.length},i.prototype.getBitsLength=function(){return i.getBitsLength(this.data.length)},i.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let r=45*s.indexOf(this.data[t]);r+=s.indexOf(this.data[t+1]),e.put(r,11)}this.data.length%2&&e.put(s.indexOf(this.data[t]),6)},t.exports=i},882257,(e,t,r)=>{let n=e.r(150882);function s(e){this.mode=n.BYTE,"string"==typeof e?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}s.getBitsLength=function(e){return 8*e},s.prototype.getLength=function(){return this.data.length},s.prototype.getBitsLength=function(){return s.getBitsLength(this.data.length)},s.prototype.write=function(e){for(let t=0,r=this.data.length;t<r;t++)e.put(this.data[t],8)},t.exports=s},422644,(e,t,r)=>{let n=e.r(150882),s=e.r(87201);function i(e){this.mode=n.KANJI,this.data=e}i.getBitsLength=function(e){return 13*e},i.prototype.getLength=function(){return this.data.length},i.prototype.getBitsLength=function(){return i.getBitsLength(this.data.length)},i.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let r=s.toSJIS(this.data[t]);if(r>=33088&&r<=40956)r-=33088;else if(r>=57408&&r<=60351)r-=49472;else throw Error("Invalid SJIS character: "+this.data[t]+"\nMake sure your charset is UTF-8");r=(r>>>8&255)*192+(255&r),e.put(r,13)}},t.exports=i},245953,(e,t,r)=>{"use strict";var n={single_source_shortest_paths:function(e,t,r){var s,i,a,o,l,c,d,u={},h={};h[t]=0;var f=n.PriorityQueue.make();for(f.push(t,0);!f.empty();)for(a in i=(s=f.pop()).value,o=s.cost,l=e[i]||{})l.hasOwnProperty(a)&&(c=o+l[a],d=h[a],(void 0===h[a]||d>c)&&(h[a]=c,f.push(a,c),u[a]=i));if(void 0!==r&&void 0===h[r])throw Error("Could not find a path from "+t+" to "+r+".");return u},extract_shortest_path_from_predecessor_list:function(e,t){for(var r=[],n=t;n;)r.push(n),e[n],n=e[n];return r.reverse(),r},find_path:function(e,t,r){var s=n.single_source_shortest_paths(e,t,r);return n.extract_shortest_path_from_predecessor_list(s,r)},PriorityQueue:{make:function(e){var t,r=n.PriorityQueue,s={};for(t in e=e||{},r)r.hasOwnProperty(t)&&(s[t]=r[t]);return s.queue=[],s.sorter=e.sorter||r.default_sorter,s},default_sorter:function(e,t){return e.cost-t.cost},push:function(e,t){this.queue.push({value:e,cost:t}),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};t.exports=n},297930,(e,t,r)=>{let n=e.r(150882),s=e.r(494097),i=e.r(112553),a=e.r(882257),o=e.r(422644),l=e.r(396592),c=e.r(87201),d=e.r(245953);function u(e){return unescape(encodeURIComponent(e)).length}function h(e,t,r){let n,s=[];for(;null!==(n=e.exec(r));)s.push({data:n[0],index:n.index,mode:t,length:n[0].length});return s}function f(e){let t,r,s=h(l.NUMERIC,n.NUMERIC,e),i=h(l.ALPHANUMERIC,n.ALPHANUMERIC,e);return c.isKanjiModeEnabled()?(t=h(l.BYTE,n.BYTE,e),r=h(l.KANJI,n.KANJI,e)):(t=h(l.BYTE_KANJI,n.BYTE,e),r=[]),s.concat(i,t,r).sort(function(e,t){return e.index-t.index}).map(function(e){return{data:e.data,mode:e.mode,length:e.length}})}function m(e,t){switch(t){case n.NUMERIC:return s.getBitsLength(e);case n.ALPHANUMERIC:return i.getBitsLength(e);case n.KANJI:return o.getBitsLength(e);case n.BYTE:return a.getBitsLength(e)}}function g(e,t){let r,l=n.getBestModeForData(e);if((r=n.from(t,l))!==n.BYTE&&r.bit<l.bit)throw Error('"'+e+'" cannot be encoded with mode '+n.toString(r)+".\n Suggested mode is: "+n.toString(l));switch(r===n.KANJI&&!c.isKanjiModeEnabled()&&(r=n.BYTE),r){case n.NUMERIC:return new s(e);case n.ALPHANUMERIC:return new i(e);case n.KANJI:return new o(e);case n.BYTE:return new a(e)}}r.fromArray=function(e){return e.reduce(function(e,t){return"string"==typeof t?e.push(g(t,null)):t.data&&e.push(g(t.data,t.mode)),e},[])},r.fromString=function(e,t){let s=function(e,t){let r={},s={start:{}},i=["start"];for(let a=0;a<e.length;a++){let o=e[a],l=[];for(let e=0;e<o.length;e++){let c=o[e],d=""+a+e;l.push(d),r[d]={node:c,lastCount:0},s[d]={};for(let e=0;e<i.length;e++){let a=i[e];r[a]&&r[a].node.mode===c.mode?(s[a][d]=m(r[a].lastCount+c.length,c.mode)-m(r[a].lastCount,c.mode),r[a].lastCount+=c.length):(r[a]&&(r[a].lastCount=c.length),s[a][d]=m(c.length,c.mode)+4+n.getCharCountIndicator(c.mode,t))}}i=l}for(let e=0;e<i.length;e++)s[i[e]].end=0;return{map:s,table:r}}(function(e){let t=[];for(let r=0;r<e.length;r++){let s=e[r];switch(s.mode){case n.NUMERIC:t.push([s,{data:s.data,mode:n.ALPHANUMERIC,length:s.length},{data:s.data,mode:n.BYTE,length:s.length}]);break;case n.ALPHANUMERIC:t.push([s,{data:s.data,mode:n.BYTE,length:s.length}]);break;case n.KANJI:t.push([s,{data:s.data,mode:n.BYTE,length:u(s.data)}]);break;case n.BYTE:t.push([{data:s.data,mode:n.BYTE,length:u(s.data)}])}}return t}(f(e,c.isKanjiModeEnabled())),t),i=d.find_path(s.map,"start","end"),a=[];for(let e=1;e<i.length-1;e++)a.push(s.table[i[e]].node);return r.fromArray(a.reduce(function(e,t){let r=e.length-1>=0?e[e.length-1]:null;return r&&r.mode===t.mode?e[e.length-1].data+=t.data:e.push(t),e},[]))},r.rawSplit=function(e){return r.fromArray(f(e,c.isKanjiModeEnabled()))}},30671,(e,t,r)=>{let n=e.r(87201),s=e.r(473133),i=e.r(173666),a=e.r(811421),o=e.r(720637),l=e.r(814002),c=e.r(237692),d=e.r(848125),u=e.r(962458),h=e.r(93547),f=e.r(857655),m=e.r(150882),g=e.r(297930);function p(e,t,r){let n,s,i=e.size,a=f.getEncodedBits(t,r);for(n=0;n<15;n++)s=(a>>n&1)==1,n<6?e.set(n,8,s,!0):n<8?e.set(n+1,8,s,!0):e.set(i-15+n,8,s,!0),n<8?e.set(8,i-n-1,s,!0):n<9?e.set(8,15-n-1+1,s,!0):e.set(8,15-n-1,s,!0);e.set(i-8,8,1,!0)}r.create=function(e,t){let r,f;if(void 0===e||""===e)throw Error("No input text");let x=s.M;return void 0!==t&&(x=s.from(t.errorCorrectionLevel,s.M),r=h.from(t.version),f=c.from(t.maskPattern),t.toSJISFunc&&n.setToSJISFunction(t.toSJISFunc)),function(e,t,r,s){let f;if(Array.isArray(e))f=g.fromArray(e);else if("string"==typeof e){let n=t;if(!n){let t=g.rawSplit(e);n=h.getBestVersionForData(t,r)}f=g.fromString(e,n||40)}else throw Error("Invalid data");let x=h.getBestVersionForData(f,r);if(!x)throw Error("The amount of data is too big to be stored in a QR Code");if(t){if(t<x)throw Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+x+".\n")}else t=x;let y=function(e,t,r){let s=new i;r.forEach(function(t){s.put(t.mode.bit,4),s.put(t.getLength(),m.getCharCountIndicator(t.mode,e)),t.write(s)});let a=(n.getSymbolTotalCodewords(e)-d.getTotalCodewordsCount(e,t))*8;for(s.getLengthInBits()+4<=a&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(0);let o=(a-s.getLengthInBits())/8;for(let e=0;e<o;e++)s.put(e%2?17:236,8);return function(e,t,r){let s,i,a=n.getSymbolTotalCodewords(t),o=a-d.getTotalCodewordsCount(t,r),l=d.getBlocksCount(t,r),c=a%l,h=l-c,f=Math.floor(a/l),m=Math.floor(o/l),g=m+1,p=f-m,x=new u(p),y=0,b=Array(l),w=Array(l),v=0,j=new Uint8Array(e.buffer);for(let e=0;e<l;e++){let t=e<h?m:g;b[e]=j.slice(y,y+t),w[e]=x.encode(b[e]),y+=t,v=Math.max(v,t)}let N=new Uint8Array(a),E=0;for(s=0;s<v;s++)for(i=0;i<l;i++)s<b[i].length&&(N[E++]=b[i][s]);for(s=0;s<p;s++)for(i=0;i<l;i++)N[E++]=w[i][s];return N}(s,e,t)}(t,r,f),b=new a(n.getSymbolSize(t));!function(e,t){let r=e.size,n=l.getPositions(t);for(let t=0;t<n.length;t++){let s=n[t][0],i=n[t][1];for(let t=-1;t<=7;t++)if(!(s+t<=-1)&&!(r<=s+t))for(let n=-1;n<=7;n++)i+n<=-1||r<=i+n||(t>=0&&t<=6&&(0===n||6===n)||n>=0&&n<=6&&(0===t||6===t)||t>=2&&t<=4&&n>=2&&n<=4?e.set(s+t,i+n,!0,!0):e.set(s+t,i+n,!1,!0))}}(b,t);let w=b.size;for(let e=8;e<w-8;e++){let t=e%2==0;b.set(e,6,t,!0),b.set(6,e,t,!0)}return!function(e,t){let r=o.getPositions(t);for(let t=0;t<r.length;t++){let n=r[t][0],s=r[t][1];for(let t=-2;t<=2;t++)for(let r=-2;r<=2;r++)-2===t||2===t||-2===r||2===r||0===t&&0===r?e.set(n+t,s+r,!0,!0):e.set(n+t,s+r,!1,!0)}}(b,t),p(b,r,0),t>=7&&function(e,t){let r,n,s,i=e.size,a=h.getEncodedBits(t);for(let t=0;t<18;t++)r=Math.floor(t/3),n=t%3+i-8-3,s=(a>>t&1)==1,e.set(r,n,s,!0),e.set(n,r,s,!0)}(b,t),!function(e,t){let r=e.size,n=-1,s=r-1,i=7,a=0;for(let o=r-1;o>0;o-=2)for(6===o&&o--;;){for(let r=0;r<2;r++)if(!e.isReserved(s,o-r)){let n=!1;a<t.length&&(n=(t[a]>>>i&1)==1),e.set(s,o-r,n),-1==--i&&(a++,i=7)}if((s+=n)<0||r<=s){s-=n,n=-n;break}}}(b,y),isNaN(s)&&(s=c.getBestMask(b,p.bind(null,b,r))),c.applyMask(s,b),p(b,r,s),{modules:b,version:t,errorCorrectionLevel:r,maskPattern:s,segments:f}}(e,r,x,f)}},125950,(e,t,r)=>{function n(e){if("number"==typeof e&&(e=e.toString()),"string"!=typeof e)throw Error("Color should be defined as hex string");let t=e.slice().replace("#","").split("");if(t.length<3||5===t.length||t.length>8)throw Error("Invalid hex color: "+e);(3===t.length||4===t.length)&&(t=Array.prototype.concat.apply([],t.map(function(e){return[e,e]}))),6===t.length&&t.push("F","F");let r=parseInt(t.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:255&r,hex:"#"+t.slice(0,6).join("")}}r.getOptions=function(e){e||(e={}),e.color||(e.color={});let t=void 0===e.margin||null===e.margin||e.margin<0?4:e.margin,r=e.width&&e.width>=21?e.width:void 0,s=e.scale||4;return{width:r,scale:r?4:s,margin:t,color:{dark:n(e.color.dark||"#000000ff"),light:n(e.color.light||"#ffffffff")},type:e.type,rendererOpts:e.rendererOpts||{}}},r.getScale=function(e,t){return t.width&&t.width>=e+2*t.margin?t.width/(e+2*t.margin):t.scale},r.getImageWidth=function(e,t){let n=r.getScale(e,t);return Math.floor((e+2*t.margin)*n)},r.qrToImageData=function(e,t,n){let s=t.modules.size,i=t.modules.data,a=r.getScale(s,n),o=Math.floor((s+2*n.margin)*a),l=n.margin*a,c=[n.color.light,n.color.dark];for(let t=0;t<o;t++)for(let r=0;r<o;r++){let d=(t*o+r)*4,u=n.color.light;t>=l&&r>=l&&t<o-l&&r<o-l&&(u=c[+!!i[Math.floor((t-l)/a)*s+Math.floor((r-l)/a)]]),e[d++]=u.r,e[d++]=u.g,e[d++]=u.b,e[d]=u.a}}},563037,(e,t,r)=>{let n=e.r(125950);r.render=function(e,t,r){var s;let i=r,a=t;void 0!==i||t&&t.getContext||(i=t,t=void 0),t||(a=function(){try{return document.createElement("canvas")}catch(e){throw Error("You need to specify a canvas element")}}()),i=n.getOptions(i);let o=n.getImageWidth(e.modules.size,i),l=a.getContext("2d"),c=l.createImageData(o,o);return n.qrToImageData(c.data,e,i),s=a,l.clearRect(0,0,s.width,s.height),s.style||(s.style={}),s.height=o,s.width=o,s.style.height=o+"px",s.style.width=o+"px",l.putImageData(c,0,0),a},r.renderToDataURL=function(e,t,n){let s=n;void 0!==s||t&&t.getContext||(s=t,t=void 0),s||(s={});let i=r.render(e,t,s),a=s.type||"image/png",o=s.rendererOpts||{};return i.toDataURL(a,o.quality)}},310891,(e,t,r)=>{let n=e.r(125950);function s(e,t){let r=e.a/255,n=t+'="'+e.hex+'"';return r<1?n+" "+t+'-opacity="'+r.toFixed(2).slice(1)+'"':n}function i(e,t,r){let n=e+t;return void 0!==r&&(n+=" "+r),n}r.render=function(e,t,r){let a=n.getOptions(t),o=e.modules.size,l=e.modules.data,c=o+2*a.margin,d=a.color.light.a?"<path "+s(a.color.light,"fill")+' d="M0 0h'+c+"v"+c+'H0z"/>':"",u="<path "+s(a.color.dark,"stroke")+' d="'+function(e,t,r){let n="",s=0,a=!1,o=0;for(let l=0;l<e.length;l++){let c=Math.floor(l%t),d=Math.floor(l/t);c||a||(a=!0),e[l]?(o++,l>0&&c>0&&e[l-1]||(n+=a?i("M",c+r,.5+d+r):i("m",s,0),s=0,a=!1),c+1<t&&e[l+1]||(n+=i("h",o),o=0)):s++}return n}(l,o,a.margin)+'"/>',h='<svg xmlns="http://www.w3.org/2000/svg" '+(a.width?'width="'+a.width+'" height="'+a.width+'" ':"")+('viewBox="0 0 '+c+" ")+c+'" shape-rendering="crispEdges">'+d+u+"</svg>\n";return"function"==typeof r&&r(null,h),h}},973134,(e,t,r)=>{let n=e.r(738750),s=e.r(30671),i=e.r(563037),a=e.r(310891);function o(e,t,r,i,a){let o=[].slice.call(arguments,1),l=o.length,c="function"==typeof o[l-1];if(!c&&!n())throw Error("Callback required as last argument");if(c){if(l<2)throw Error("Too few arguments provided");2===l?(a=r,r=t,t=i=void 0):3===l&&(t.getContext&&void 0===a?(a=i,i=void 0):(a=i,i=r,r=t,t=void 0))}else{if(l<1)throw Error("Too few arguments provided");return 1===l?(r=t,t=i=void 0):2!==l||t.getContext||(i=r,r=t,t=void 0),new Promise(function(n,a){try{let a=s.create(r,i);n(e(a,t,i))}catch(e){a(e)}})}try{let n=s.create(r,i);a(null,e(n,t,i))}catch(e){a(e)}}r.create=s.create,r.toCanvas=o.bind(null,i.render),r.toDataURL=o.bind(null,i.renderToDataURL),r.toString=o.bind(null,function(e,t,r){return a.render(e,r)})},253304,e=>{"use strict";var t=e.i(843476),r=e.i(271645),n=e.i(618566),s=e.i(846932),i=e.i(503116),a=e.i(871689),o=e.i(751975),l=e.i(75505);let c=(0,e.i(475254).default)("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);var d=e.i(440160),u=e.i(778917),h=e.i(209165),f=e.i(918789),m=e.i(742531),g=e.i(472450),p=e.i(130562),x=e.i(930380),y=e.i(975157),b=e.i(973134);function w({noteId:e,title:n,password:s,onClose:i}){let a=(0,r.useRef)(null),[o,l]=(0,r.useState)(""),[c,d]=(0,r.useState)(""),[u,h]=(0,r.useState)(!0);(0,r.useEffect)(()=>{f()},[]);let f=async()=>{let e="",t="";try{let r=await (0,y.safeFetch)("/api/profile"),n=await r.json();n.success&&n.data?.avatar&&(e=n.data.avatar.startsWith("http")?n.data.avatar:`${window.location.origin}${n.data.avatar}`,l(e));let s=await (0,y.safeFetch)("/api/settings"),i=await s.json();i.success&&i.data&&(t=i.data.find(e=>"siteTitle"===e.key)?.value||"",d(t))}catch(e){console.error("Failed to load data:",e)}await m(e,t)},m=async(t=o,r=c)=>{let i=a.current;if(!i)return;let l=i.getContext("2d");if(!l)return;i.width=600,i.height=800;let d=l.createLinearGradient(0,0,0,800);if(d.addColorStop(0,"#667eea"),d.addColorStop(1,"#764ba2"),l.fillStyle=d,l.fillRect(0,0,600,800),l.fillStyle="#ffffff",l.roundRect(40,60,520,680,20),l.fill(),t)try{let e=new Image;e.crossOrigin="anonymous",e.src=t,await new Promise(t=>{e.onload=t,e.onerror=t}),l.save(),l.beginPath(),l.arc(300,140,50,0,2*Math.PI),l.closePath(),l.clip(),l.drawImage(e,250,90,100,100),l.restore()}catch(e){l.fillStyle="#667eea",l.beginPath(),l.arc(300,140,50,0,2*Math.PI),l.fill()}l.fillStyle="#1a202c",l.font="bold 24px sans-serif",l.textAlign="center",l.fillText(r||"",300,230),l.font="20px sans-serif",l.fillStyle="#4a5568";let u=n;if(l.measureText(n).width>460){for(;l.measureText(u+"...").width>460;)u=u.slice(0,-1);u+="..."}l.fillText(u,300,280);let f=window.location.origin,m=`${f}/note/${e}`;s&&(m+=`?pwd=${encodeURIComponent(s)}`);let g=await b.default.toDataURL(m,{width:280,margin:2,color:{dark:"#000000",light:"#ffffff"}}),p=new Image;p.src=g,await new Promise(e=>{p.onload=e}),l.drawImage(p,160,320,280,280),l.font="16px sans-serif",l.fillStyle="#718096",l.fillText(f.replace(/^https?:\/\//,""),300,650),l.font="14px sans-serif",l.fillStyle="#a0aec0",l.fillText("扫描二维码查看笔记",300,690),h(!1)};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[10000]",onClick:i,children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl p-6 max-w-sm w-full mx-4",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,t.jsx)("button",{onClick:i,className:"text-gray-400 hover:text-gray-600",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})}),(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[u&&(0,t.jsx)("div",{className:"text-gray-500 mb-4",children:"生成中..."}),(0,t.jsx)("canvas",{ref:a,className:"max-w-full h-auto rounded-lg shadow-lg",style:{width:"300px",height:"400px"}}),(0,t.jsx)("button",{onClick:()=>{let t=a.current;t&&t.toBlob(t=>{if(!t)return;let r=URL.createObjectURL(t),n=document.createElement("a");n.href=r,n.download=`note-${e}-share.png`,n.click(),URL.revokeObjectURL(r)})},disabled:u,className:"mt-6 px-6 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-lg hover:from-purple-700 hover:to-indigo-700 disabled:opacity-50 transition-all",children:"下载分享图片"})]})]})})}var v=e.i(201513),j=e.i(649484),N=e.i(814984),E=e.i(153951),C=e.i(426261),k=e.i(996433),A=e.i(174080),S=e.i(88653),T=e.i(37727),M=e.i(373375),I=e.i(463059),P=e.i(554212),B=e.i(520354);function R({images:e,currentIndex:n,isOpen:i,onClose:a,onIndexChange:o}){let[l,c]=(0,r.useState)(n),[u,h]=(0,r.useState)(1),[f,m]=(0,r.useState)({x:0,y:0}),[g,p]=(0,r.useState)(!1),[x,y]=(0,r.useState)(!1),b=(0,r.useRef)({x:0,y:0}),[w,v]=(0,r.useState)(null),[j,N]=(0,r.useState)(1),[E,C]=(0,r.useState)(null),[k,R]=(0,r.useState)(null),[L,U]=(0,r.useState)(!1);(0,r.useEffect)(()=>{c(n)},[n]),(0,r.useEffect)(()=>{let e=()=>{y(window.innerWidth<768||"ontouchstart"in window)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{if(i){let e=window.scrollY,t=window.scrollX;document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.top=`-${e}px`,document.body.style.left=`-${t}px`,document.body.style.width="100%",document.body.style.height="100%",document.body.dataset.scrollY=String(e),document.body.dataset.scrollX=String(t)}else{let e=parseInt(document.body.dataset.scrollY||"0",10),t=parseInt(document.body.dataset.scrollX||"0",10);document.body.style.overflow="",document.body.style.position="",document.body.style.top="",document.body.style.left="",document.body.style.width="",document.body.style.height="",window.scrollTo(t,e)}return()=>{let e=parseInt(document.body.dataset.scrollY||"0",10),t=parseInt(document.body.dataset.scrollX||"0",10);document.body.style.overflow="",document.body.style.position="",document.body.style.top="",document.body.style.left="",document.body.style.width="",document.body.style.height="",window.scrollTo(t,e)}},[i]),(0,r.useEffect)(()=>{if(!i)return;let e=e=>{"Escape"===e.key?a():"ArrowLeft"===e.key?H():"ArrowRight"===e.key?_():"+"===e.key||"="===e.key?O():"-"===e.key&&J()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[i,l,u,e]);let $=(0,r.useCallback)(e=>{if(x)return;e.preventDefault();let t=e.deltaY>0?-.1:.1;h(e=>{let r=Math.min(Math.max(e+t,.5),3);return r<=1&&m({x:0,y:0}),r})},[x]),F=(0,r.useCallback)(e=>{x||u<=1||(e.preventDefault(),p(!0),b.current={x:e.clientX-f.x,y:e.clientY-f.y})},[x,u,f]),Y=(0,r.useCallback)(e=>{!g||x||m({x:e.clientX-b.current.x,y:e.clientY-b.current.y})},[g,x]),z=(0,r.useCallback)(()=>{p(!1)},[]),D=e=>{if(e.length<2)return 0;let t=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(t*t+r*r)},_=()=>{if(e.length<=1)return;let t=(l+1)%e.length;c(t),o?.(t),K()},H=()=>{if(e.length<=1)return;let t=(l-1+e.length)%e.length;c(t),o?.(t),K()},K=()=>{h(1),m({x:0,y:0})},O=()=>{h(e=>Math.min(e+.25,3))},J=()=>{h(e=>{let t=Math.max(e-.25,.5);return t<=1&&m({x:0,y:0}),t})},q=()=>{h(1),m({x:0,y:0}),a()};if(!i)return null;let V=(0,t.jsx)(S.AnimatePresence,{children:(0,t.jsx)(s.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[99999] flex items-center justify-center bg-black/90 backdrop-blur-sm",onClick:q,children:(0,t.jsxs)("div",{className:"relative w-full h-full flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("div",{className:"absolute top-0 left-0 right-0 z-10 bg-gradient-to-b from-black/80 to-transparent p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between max-w-7xl mx-auto",children:[(0,t.jsx)("div",{className:"w-10"}),(0,t.jsx)("div",{className:"flex-1 flex justify-center",children:e.length>1&&(0,t.jsx)("div",{className:"bg-black/50 backdrop-blur-sm rounded-full px-4 py-2",children:(0,t.jsxs)("span",{className:"text-white text-sm font-medium",children:[l+1," / ",e.length]})})}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>{let t=e[l],r=document.createElement("a");r.href=t,r.download=`image-${l+1}`,r.target="_blank",document.body.appendChild(r),r.click(),document.body.removeChild(r)},className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors",title:"下载图片",children:(0,t.jsx)(d.Download,{className:"w-5 h-5 text-white"})}),(0,t.jsx)("button",{onClick:q,className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors",title:"关闭",children:(0,t.jsx)(T.X,{className:"w-5 h-5 text-white"})})]})]})}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center",children:[(0,t.jsx)("div",{className:"h-20"}),(0,t.jsxs)("div",{className:"relative flex-shrink-0 px-4 lg:px-24",onWheel:$,onMouseDown:F,onMouseMove:Y,onMouseUp:z,onMouseLeave:z,onTouchStart:e=>{if(2===e.touches.length)v(D(e.touches)),N(u),U(!1);else if(1===e.touches.length){let t=e.touches[0];u>1?(p(!0),b.current={x:t.clientX-f.x,y:t.clientY-f.y}):(C({x:t.clientX,y:t.clientY}),R(null),U(!0))}},onTouchMove:e=>{if(2===e.touches.length&&w){let t=Math.min(Math.max(j*(D(e.touches)/w),.5),3);h(t),t<=1&&m({x:0,y:0})}else if(1===e.touches.length){let t=e.touches[0];g&&u>1?m({x:t.clientX-b.current.x,y:t.clientY-b.current.y}):L&&u<=1&&R({x:t.clientX,y:t.clientY})}},onTouchEnd:()=>{if(v(null),p(!1),L&&E&&k&&u<=1){let e=E.x-k.x;Math.abs(e)>Math.abs(E.y-k.y)&&Math.abs(e)>50&&(e>0?_():H())}U(!1),C(null),R(null)},style:{cursor:u>1?g?"grabbing":"grab":"default"},children:[(0,t.jsx)(s.motion.img,{src:e[l],alt:`图片 ${l+1}`,className:"max-w-full object-contain mx-auto select-none",draggable:!1,style:{transform:`scale(${u}) translate(${f.x/u}px, ${f.y/u}px)`,transition:g?"none":"transform 0.2s ease-out",maxHeight:"calc(100vh - 200px)",maxWidth:"100%",touchAction:"none"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}},l),e.length>1&&!x&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:H,className:"absolute -left-16 top-1/2 -translate-y-1/2 p-3 bg-black/20 hover:bg-black/40 rounded-full transition-colors backdrop-blur-sm",title:"上一张 (←)",children:(0,t.jsx)(M.ChevronLeft,{className:"w-6 h-6 text-white/60"})}),(0,t.jsx)("button",{onClick:_,className:"absolute -right-16 top-1/2 -translate-y-1/2 p-3 bg-black/20 hover:bg-black/40 rounded-full transition-colors backdrop-blur-sm",title:"下一张 (→)",children:(0,t.jsx)(I.ChevronRight,{className:"w-6 h-6 text-white/60"})})]})]}),(0,t.jsx)("div",{className:"h-20"})]}),(0,t.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 z-10",children:[!x&&(0,t.jsx)("div",{className:"flex justify-center pb-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-1.5 bg-black/50 backdrop-blur-sm rounded-full px-3 py-1.5",children:[(0,t.jsx)("button",{onClick:J,className:"p-1 hover:bg-white/10 rounded-full transition-colors",title:"缩小",children:(0,t.jsx)(B.ZoomOut,{className:"w-4 h-4 text-white"})}),(0,t.jsxs)("span",{className:"text-white text-xs min-w-[50px] text-center font-medium",children:[Math.round(100*u),"%"]}),(0,t.jsx)("button",{onClick:O,className:"p-1 hover:bg-white/10 rounded-full transition-colors",title:"放大",children:(0,t.jsx)(P.ZoomIn,{className:"w-4 h-4 text-white"})})]})}),e.length>1&&(0,t.jsx)("div",{className:"bg-gradient-to-t from-black/80 to-transparent p-4",children:(0,t.jsx)("div",{className:"flex justify-center max-w-7xl mx-auto",children:(0,t.jsx)("div",{className:"flex gap-2 overflow-x-auto hide-scrollbar",style:{scrollbarWidth:"none",msOverflowStyle:"none",WebkitOverflowScrolling:"touch"},children:e.map((e,r)=>(0,t.jsx)("button",{onClick:()=>{c(r),o?.(r),K()},className:`flex-shrink-0 w-16 h-16 rounded-lg overflow-hidden border-2 transition-all ${r===l?"border-primary-500 opacity-100":"border-white/20 opacity-50 hover:opacity-75"}`,children:(0,t.jsx)("img",{src:e,alt:`缩略图 ${r+1}`,className:"w-full h-full object-cover",draggable:!1})},r))})})})]})]})})});return(0,A.createPortal)(V,document.body)}let L=(0,y.getApiBaseUrl)();function U(){let e,y,b,A,S,T,M=(0,n.useParams)(),I=(0,n.useRouter)(),P=(0,n.useSearchParams)(),[B,U]=(0,r.useState)(null),[$,F]=(0,r.useState)(!0),[Y,z]=(0,r.useState)(!1),[D,_]=(0,r.useState)(!1),[H,K]=(0,r.useState)(""),[O,J]=(0,r.useState)(""),[q,V]=(0,r.useState)(!1),[X,Q]=(0,r.useState)(0),[W,Z]=(0,r.useState)(3),[G,ee]=(0,r.useState)(!1),[et,er]=(0,r.useState)(!1),[en,es]=(0,r.useState)(!1),[ei,ea]=(0,r.useState)(""),[eo,el]=(0,r.useState)(!1),[ec,ed]=(0,r.useState)([]),[eu,eh]=(0,r.useState)(0),[ef,em]=(0,r.useState)({browserTitle:"笔记详情",browserSubtitle:""}),[eg,ep]=(0,r.useState)("");(0,r.useEffect)(()=>{let e=async()=>{try{let e=P.get("password");if(e){let t=await h.default.get(`/notes/${M.id}?password=${encodeURIComponent(e)}`);if(t.data?.success&&t.data?.data){let r=t.data.data;U(r),r.requiresPassword?(_(!0),J("URL中的密码不正确，请重新输入")):(_(!1),ea(e))}else z(!0)}else{let e=await h.default.get(`/notes/${M.id}`);if(e.data?.success&&e.data?.data){let t=e.data.data;U(t),t.requiresPassword&&_(!0)}else z(!0)}}catch(e){console.error("Failed to fetch note:",e),z(!0)}finally{F(!1)}};M.id&&e()},[M.id,P]),(0,r.useEffect)(()=>{(async()=>{try{let[e,t]=await Promise.all([(0,h.getSettings)(),(0,h.getPageText)("note")]);if(e.success&&e.data){let t={};e.data.forEach(e=>{t[e.key]=e.value}),ep(t.siteTitle||"")}t.success&&t.data&&em({browserTitle:t.data.browserTitle||"笔记详情",browserSubtitle:t.data.browserSubtitle||""})}catch(e){console.error("加载页面配置失败:",e)}})()},[]),(0,r.useEffect)(()=>{if(B&&!B.requiresPassword){let e=B.title||"无标题";eg?document.title=`${e} - ${eg}`:document.title=e}else $?document.title="加载中...":Y&&(document.title="笔记不存在")},[B,$,Y,ei,eg]),(0,r.useEffect)(()=>{B&&!B.requiresPassword&&ex()},[B,ei]),(0,r.useEffect)(()=>{let e=async()=>{try{let e=await h.default.get("/notes/password-status");e.data?.success&&(Q(e.data.errorCount||0),Z(e.data.remaining??3))}catch{}};D&&e()},[D]);let ex=async()=>{try{let e=ei?`?password=${encodeURIComponent(ei)}`:"",t=await h.default.get(`/notes/${M.id}/disks${e}`);t.data?.success&&t.data?.data&&es(t.data.data.length>0)}catch(e){es(!1)}},ey=async e=>{e.preventDefault(),J(""),V(!0);try{let e=await h.default.post(`/notes/${M.id}/verify`,{password:H});e.data?.success&&e.data?.data&&(U(e.data.data),_(!1),ea(H),K(""),Q(0),Z(3))}catch(t){let e=t.response?.data;e?.errorCount!==void 0&&(Q(e.errorCount),Z(e.remaining)),t.response?.status===429?J("密码错误次数过多，请1小时后重试！"):t.response?.status===401?J(e?.remaining>0?"密码错误":"密码错误次数过多，请1小时后重试！"):J("验证失败，请稍后重试")}finally{V(!1)}},eb=()=>{I.push("/")},ew=e=>{I.push(`/notes?tag=${encodeURIComponent(e)}`)};return $?(0,t.jsx)("div",{className:"min-h-screen bg-bg-primary flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-10 h-10 border-3 border-primary-500 border-t-transparent rounded-full animate-spin mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-text-tertiary text-sm",children:"加载中..."})]})}):Y||!B?(0,t.jsx)("div",{className:"min-h-screen bg-bg-primary flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-text-primary mb-3",children:"404"}),(0,t.jsx)("p",{className:"text-text-tertiary text-sm mb-4",children:"笔记不存在或已被删除"}),(0,t.jsx)("button",{onClick:eb,className:"px-4 py-2 bg-primary-500 text-white text-sm rounded-lg hover:bg-primary-600 transition-colors",children:"返回首页"})]})}):(0,t.jsxs)("div",{className:"min-h-screen bg-bg-primary hide-scrollbar relative",children:[(0,t.jsx)(C.default,{}),(0,t.jsx)(k.default,{}),(0,t.jsx)("nav",{className:"sticky top-0 z-50 bg-bg-primary/95 backdrop-blur-md border-b border-border-primary shadow-sm",children:(0,t.jsx)("div",{className:"max-w-6xl mx-auto px-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0 overflow-hidden",children:[(0,t.jsxs)("button",{onClick:eb,className:"flex items-center gap-1 sm:gap-2 text-text-secondary hover:text-text-primary transition-colors text-sm font-medium flex-shrink-0",children:[(0,t.jsx)(a.ArrowLeft,{className:"w-4 h-4 sm:w-5 sm:h-5"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"返回"})]}),(0,t.jsx)("span",{className:"text-text-tertiary hidden sm:inline",children:"|"}),(0,t.jsx)("h1",{className:"text-sm sm:text-base font-semibold text-text-primary truncate flex-1 min-w-0",children:B.title||"无标题"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-shrink-0",children:[en&&(0,t.jsxs)("button",{onClick:()=>er(!0),className:"flex items-center gap-1.5 px-3 py-2 text-sm text-primary-600 hover:bg-primary-50 rounded-lg transition-colors font-medium",children:[(0,t.jsx)(d.Download,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"下载资源"})]}),(0,t.jsxs)("button",{onClick:()=>ee(!0),className:"flex items-center gap-1.5 px-3 py-2 text-sm text-primary-600 hover:bg-primary-50 rounded-lg transition-colors font-medium",children:[(0,t.jsx)(c,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"分享笔记"})]})]})]})})}),(0,t.jsx)("main",{className:"py-0 sm:py-6",children:(0,t.jsxs)("div",{className:"max-w-6xl mx-auto px-0 sm:px-4",children:[(0,t.jsxs)(s.motion.article,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:"sm:rounded-xl sm:border sm:border-border-primary sm:shadow-sm bg-bg-secondary",children:[(0,t.jsx)("div",{className:"px-4 sm:px-6 py-5",children:(0,t.jsx)("div",{className:"note-content",children:(0,t.jsx)(f.default,{remarkPlugins:[m.default,g.default],rehypePlugins:[p.default,x.default],components:{img:({src:e,alt:n,className:s,style:i,...a})=>{let o=e;"string"==typeof e&&e.startsWith("/uploads/")&&(o=`${L}${e}`);let l=s?.includes("blur-image")||"true"===a["data-blur"],[c,d]=r.default.useState(!1),u=s?.includes("img-align-"),h={};return"string"==typeof i?i.split(";").forEach(e=>{let[t,r]=e.split(":").map(e=>e.trim());t&&r&&(h[t]=r)}):i&&(h=i),(0,t.jsx)("div",{className:`my-4 ${s?.includes("img-align-right")?"text-right":s?.includes("img-align-left")?"text-left":"text-center"} ${l?"blur-image-container":""} ${c?"revealed":""}`,children:(0,t.jsx)("img",{src:o,alt:n||"",className:`max-w-full h-auto rounded-lg shadow-sm cursor-pointer hover:shadow-md transition-shadow ${s||""} ${u?"":"img-align-center"} ${l&&!c?"blur-image":""} ${c?"revealed":""}`,style:{maxHeight:"360px",objectFit:"contain",...h},loading:"lazy",onClick:()=>{l&&!c?d(!0):o&&(ed([o]),eh(0),el(!0))},onError:e=>{e.target.style.display="none"},...a})})},iframe:({node:e,...r})=>(0,t.jsx)("div",{className:"iframe-container my-4",children:(0,t.jsx)("iframe",{...r})}),pre:({node:e,children:n,...s})=>{let i=e=>"string"==typeof e?e:Array.isArray(e)?e.map(i).join(""):r.default.isValidElement(e)?i(e.props.children||""):"",a=i(n),o=(e=>{if(r.default.isValidElement(e)){let t=e.props,r=t?.className||"",n=/language-(\w+)/.exec(r);return n?n[1]:""}return""})(n);return"mermaid"===o?(0,t.jsx)(E.default,{chart:a}):(0,t.jsxs)("div",{className:"relative my-4 group code-block-wrapper",children:[o&&(0,t.jsx)("span",{className:"code-language-label",children:o}),(0,t.jsx)(N.default,{text:a}),(0,t.jsx)("pre",{className:"code-block",...s,children:n})]})},code:({node:e,className:r,children:n,...s})=>r&&r.includes("language-")?(0,t.jsx)("code",{className:`block-code ${r||""}`,...s,children:n}):(0,t.jsx)("code",{className:"inline-code",...s,children:n}),table:({node:e,children:r,...n})=>(0,t.jsx)("div",{className:"overflow-x-auto my-4",children:(0,t.jsx)("table",{...n,children:r})}),blockquote:({node:e,children:r,...n})=>(0,t.jsx)("blockquote",{className:"note-blockquote",...n,children:r}),a:({node:e,href:r,children:n,...s})=>(0,t.jsx)("a",{href:r,className:"text-primary-600 hover:text-primary-700 hover:underline",target:"_blank",rel:"noopener noreferrer",...s,children:n}),p:({node:e,children:n,...s})=>r.default.Children.toArray(n).some(e=>"string"==typeof e&&e.includes("\n"))?(0,t.jsx)("p",{...s,children:r.default.Children.map(n,(e,n)=>{if("string"==typeof e){let s=e.split("\n");return(0,t.jsx)(r.default.Fragment,{children:s.map((e,n)=>(0,t.jsxs)(r.default.Fragment,{children:[e,n<s.length-1&&(0,t.jsx)("br",{})]},n))},n)}return e})}):(0,t.jsx)("p",{...s,children:n}),h1:({node:e,children:r,...n})=>(0,t.jsx)("h1",{...n,children:r}),h2:({node:e,children:r,...n})=>(0,t.jsx)("h2",{...n,children:r}),h3:({node:e,children:r,...n})=>(0,t.jsx)("h3",{...n,children:r}),h4:({node:e,children:r,...n})=>(0,t.jsx)("h4",{...n,children:r}),h5:({node:e,children:r,...n})=>(0,t.jsx)("h5",{...n,children:r}),h6:({node:e,children:r,...n})=>(0,t.jsx)("h6",{...n,children:r}),ul:({node:e,children:r,...n})=>(0,t.jsx)("ul",{...n,children:r}),ol:({node:e,children:r,...n})=>(0,t.jsx)("ol",{...n,children:r}),li:({node:e,children:r,...n})=>(0,t.jsx)("li",{...n,children:r}),hr:({node:e,...r})=>(0,t.jsx)("hr",{...r}),strong:({node:e,children:r,...n})=>(0,t.jsx)("strong",{...n,children:r}),em:({node:e,children:r,...n})=>(0,t.jsx)("em",{...n,children:r}),del:({node:e,children:r,...n})=>(0,t.jsx)("del",{...n,children:r})},children:B.content})})}),(0,t.jsxs)("footer",{className:"bg-bg-tertiary px-4 sm:px-6 py-4 border-t border-border-primary",children:["reprint"===B.source_type&&B.source_text&&(0,t.jsxs)("div",{className:"flex items-start gap-2 text-xs text-text-tertiary mb-3 pb-3 border-b border-border-primary",children:[(0,t.jsx)(u.ExternalLink,{className:"w-3.5 h-3.5 mt-0.5 flex-shrink-0"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-text-tertiary",children:"来源："}),(0,t.jsx)("span",{children:B.source_text})]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-y-3",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1.5 text-xs text-text-tertiary",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(i.Clock,{className:"w-3 h-3"}),(0,t.jsx)("time",{dateTime:B.published_at||B.created_at,children:(y=(e=new Date(B.published_at||B.created_at)).getFullYear(),b=String(e.getMonth()+1).padStart(2,"0"),A=String(e.getDate()).padStart(2,"0"),S=String(e.getHours()).padStart(2,"0"),T=String(e.getMinutes()).padStart(2,"0"),`${y}-${b}-${A} ${S}:${T}`)})]}),B.category&&(0,t.jsxs)("button",{onClick:()=>{B?.category&&I.push(`/notes?category=${encodeURIComponent(B.category)}`)},className:"flex items-center gap-1 hover:text-primary-600 transition-colors",children:[(0,t.jsx)(l.FolderOpen,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:B.category})]}),B.Tags&&B.Tags.length>0&&B.Tags.map(e=>(0,t.jsxs)("button",{onClick:()=>ew(e.name),className:"flex items-center gap-1 hover:opacity-70 transition-opacity",style:{color:e.color||"var(--text-tertiary)"},children:[(0,t.jsx)(o.Tag,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:e.name})]},e.id)),(!B.Tags||0===B.Tags.length)&&B.tags&&B.tags.split(",").map((e,r)=>(0,t.jsxs)("button",{onClick:()=>ew(e.trim()),className:"flex items-center gap-1 hover:text-primary-600 transition-colors",children:[(0,t.jsx)(o.Tag,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:e.trim()})]},r)),"original"===B.source_type&&(0,t.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 bg-primary-100 text-primary-700 text-[10px] font-medium rounded",children:"原创"}),"reprint"===B.source_type&&(0,t.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 bg-primary-100 text-primary-600 text-[10px] font-medium rounded",children:"转载"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[en&&(0,t.jsxs)("button",{onClick:()=>er(!0),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs bg-primary-100 text-primary-600 rounded-md hover:bg-primary-200 transition-colors",children:[(0,t.jsx)(d.Download,{className:"w-3.5 h-3.5"}),(0,t.jsx)("span",{children:"下载资源"})]}),(0,t.jsxs)("button",{onClick:()=>ee(!0),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs bg-primary-100 text-primary-600 rounded-md hover:bg-primary-200 transition-colors",children:[(0,t.jsx)(c,{className:"w-3.5 h-3.5"}),(0,t.jsx)("span",{children:"分享笔记"})]})]})]})]})]}),(0,t.jsxs)("footer",{className:"mt-6 border-t border-border-primary py-6 text-center text-sm text-text-tertiary",children:[(0,t.jsxs)("p",{children:["© ",new Date().getFullYear()," Xs-blog. All rights reserved."]}),(0,t.jsx)(j.default,{})]})]})}),D&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",children:(0,t.jsxs)(s.motion.div,{className:"bg-bg-secondary rounded-xl max-w-sm w-full p-5 shadow-xl border border-border-primary",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.2},children:[(0,t.jsxs)("div",{className:"text-center mb-5",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,t.jsx)("svg",{className:"w-6 h-6 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,t.jsx)("h3",{className:"text-base font-bold text-text-primary mb-1",children:"需要密码访问"}),(0,t.jsx)("p",{className:"text-xs text-text-tertiary",children:"请输入密码查看笔记内容"})]}),(0,t.jsxs)("form",{onSubmit:ey,className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("input",{type:"password",name:"note-access-password",value:H,onChange:e=>K(e.target.value),placeholder:"请输入密码",className:"w-full px-3 py-2.5 text-sm border border-border-primary rounded-lg bg-bg-tertiary text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",autoFocus:!0,autoComplete:"off",disabled:q}),O&&(0,t.jsx)("p",{className:"mt-1.5 text-xs",style:{color:"var(--error-text)"},children:O}),X>0&&W>0&&(0,t.jsxs)("p",{className:"mt-1.5 text-xs text-text-tertiary",children:["当前已输入错误",X,"次，还可以重试",W,"次"]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>I.push("/notes"),className:"flex-1 px-3 py-2 text-sm bg-bg-tertiary text-text-secondary rounded-lg hover:bg-border-primary transition-colors",disabled:q,children:"返回"}),(0,t.jsx)("button",{type:"submit",className:`flex-1 px-3 py-2 text-sm rounded-lg transition-colors ${0===W?"bg-gray-400 cursor-not-allowed":"bg-primary-500 hover:bg-primary-600 disabled:opacity-50"} text-white`,disabled:q||!H||0===W,children:q?"验证中...":0===W?"暂不可用":"确认"})]})]})]})}),G&&B&&(0,t.jsx)(w,{noteId:B.id,title:B.title,password:B.password,onClose:()=>ee(!1)}),B&&(0,t.jsx)(v.default,{isOpen:et,onClose:()=>er(!1),noteId:B.id,isAdmin:!1,password:ei}),(0,t.jsx)(R,{images:ec,currentIndex:eu,isOpen:eo,onClose:()=>el(!1),onIndexChange:eh})]})}e.s(["default",()=>U],253304)}]);