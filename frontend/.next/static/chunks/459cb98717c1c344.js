(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,38750,(e,t,r)=>{t.exports=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then}},87201,(e,t,r)=>{let n,s=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];r.getSymbolSize=function(e){if(!e)throw Error('"version" cannot be null or undefined');if(e<1||e>40)throw Error('"version" should be in range from 1 to 40');return 4*e+17},r.getSymbolTotalCodewords=function(e){return s[e]},r.getBCHDigit=function(e){let t=0;for(;0!==e;)t++,e>>>=1;return t},r.setToSJISFunction=function(e){if("function"!=typeof e)throw Error('"toSJISFunc" is not a valid function.');n=e},r.isKanjiModeEnabled=function(){return void 0!==n},r.toSJIS=function(e){return n(e)}},73133,(e,t,r)=>{r.L={bit:1},r.M={bit:0},r.Q={bit:3},r.H={bit:2},r.isValid=function(e){return e&&void 0!==e.bit&&e.bit>=0&&e.bit<4},r.from=function(e,t){if(r.isValid(e))return e;try{if("string"!=typeof e)throw Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return r.L;case"m":case"medium":return r.M;case"q":case"quartile":return r.Q;case"h":case"high":return r.H;default:throw Error("Unknown EC Level: "+e)}}catch(e){return t}}},73666,(e,t,r)=>{function n(){this.buffer=[],this.length=0}n.prototype={get:function(e){let t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)==1},put:function(e,t){for(let r=0;r<t;r++)this.putBit((e>>>t-r-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(e){let t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},t.exports=n},11421,(e,t,r)=>{function n(e){if(!e||e<1)throw Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}n.prototype.set=function(e,t,r,n){let s=e*this.size+t;this.data[s]=r,n&&(this.reservedBit[s]=!0)},n.prototype.get=function(e,t){return this.data[e*this.size+t]},n.prototype.xor=function(e,t,r){this.data[e*this.size+t]^=r},n.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]},t.exports=n},20637,(e,t,r)=>{let n=e.r(87201).getSymbolSize;r.getRowColCoords=function(e){if(1===e)return[];let t=Math.floor(e/7)+2,r=n(e),s=145===r?26:2*Math.ceil((r-13)/(2*t-2)),a=[r-7];for(let e=1;e<t-1;e++)a[e]=a[e-1]-s;return a.push(6),a.reverse()},r.getPositions=function(e){let t=[],n=r.getRowColCoords(e),s=n.length;for(let e=0;e<s;e++)for(let r=0;r<s;r++)(0!==e||0!==r)&&(0!==e||r!==s-1)&&(e!==s-1||0!==r)&&t.push([n[e],n[r]]);return t}},14002,(e,t,r)=>{let n=e.r(87201).getSymbolSize;r.getPositions=function(e){let t=n(e);return[[0,0],[t-7,0],[0,t-7]]}},37692,(e,t,r)=>{r.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};r.isValid=function(e){return null!=e&&""!==e&&!isNaN(e)&&e>=0&&e<=7},r.from=function(e){return r.isValid(e)?parseInt(e,10):void 0},r.getPenaltyN1=function(e){let t=e.size,r=0,n=0,s=0,a=null,i=null;for(let o=0;o<t;o++){n=s=0,a=i=null;for(let l=0;l<t;l++){let t=e.get(o,l);t===a?n++:(n>=5&&(r+=3+(n-5)),a=t,n=1),(t=e.get(l,o))===i?s++:(s>=5&&(r+=3+(s-5)),i=t,s=1)}n>=5&&(r+=3+(n-5)),s>=5&&(r+=3+(s-5))}return r},r.getPenaltyN2=function(e){let t=e.size,r=0;for(let n=0;n<t-1;n++)for(let s=0;s<t-1;s++){let t=e.get(n,s)+e.get(n,s+1)+e.get(n+1,s)+e.get(n+1,s+1);(4===t||0===t)&&r++}return 3*r},r.getPenaltyN3=function(e){let t=e.size,r=0,n=0,s=0;for(let a=0;a<t;a++){n=s=0;for(let i=0;i<t;i++)n=n<<1&2047|e.get(a,i),i>=10&&(1488===n||93===n)&&r++,s=s<<1&2047|e.get(i,a),i>=10&&(1488===s||93===s)&&r++}return 40*r},r.getPenaltyN4=function(e){let t=0,r=e.data.length;for(let n=0;n<r;n++)t+=e.data[n];return 10*Math.abs(Math.ceil(100*t/r/5)-10)},r.applyMask=function(e,t){let n=t.size;for(let s=0;s<n;s++)for(let a=0;a<n;a++)t.isReserved(a,s)||t.xor(a,s,function(e,t,n){switch(e){case r.Patterns.PATTERN000:return(t+n)%2==0;case r.Patterns.PATTERN001:return t%2==0;case r.Patterns.PATTERN010:return n%3==0;case r.Patterns.PATTERN011:return(t+n)%3==0;case r.Patterns.PATTERN100:return(Math.floor(t/2)+Math.floor(n/3))%2==0;case r.Patterns.PATTERN101:return t*n%2+t*n%3==0;case r.Patterns.PATTERN110:return(t*n%2+t*n%3)%2==0;case r.Patterns.PATTERN111:return(t*n%3+(t+n)%2)%2==0;default:throw Error("bad maskPattern:"+e)}}(e,a,s))},r.getBestMask=function(e,t){let n=Object.keys(r.Patterns).length,s=0,a=1/0;for(let i=0;i<n;i++){t(i),r.applyMask(i,e);let n=r.getPenaltyN1(e)+r.getPenaltyN2(e)+r.getPenaltyN3(e)+r.getPenaltyN4(e);r.applyMask(i,e),n<a&&(a=n,s=i)}return s}},48125,(e,t,r)=>{let n=e.r(73133),s=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],a=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];r.getBlocksCount=function(e,t){switch(t){case n.L:return s[(e-1)*4+0];case n.M:return s[(e-1)*4+1];case n.Q:return s[(e-1)*4+2];case n.H:return s[(e-1)*4+3];default:return}},r.getTotalCodewordsCount=function(e,t){switch(t){case n.L:return a[(e-1)*4+0];case n.M:return a[(e-1)*4+1];case n.Q:return a[(e-1)*4+2];case n.H:return a[(e-1)*4+3];default:return}}},54232,(e,t,r)=>{let n=new Uint8Array(512),s=new Uint8Array(256),a=1;for(let e=0;e<255;e++)n[e]=a,s[a]=e,256&(a<<=1)&&(a^=285);for(let e=255;e<512;e++)n[e]=n[e-255];r.log=function(e){if(e<1)throw Error("log("+e+")");return s[e]},r.exp=function(e){return n[e]},r.mul=function(e,t){return 0===e||0===t?0:n[s[e]+s[t]]}},50677,(e,t,r)=>{let n=e.r(54232);r.mul=function(e,t){let r=new Uint8Array(e.length+t.length-1);for(let s=0;s<e.length;s++)for(let a=0;a<t.length;a++)r[s+a]^=n.mul(e[s],t[a]);return r},r.mod=function(e,t){let r=new Uint8Array(e);for(;r.length-t.length>=0;){let e=r[0];for(let s=0;s<t.length;s++)r[s]^=n.mul(t[s],e);let s=0;for(;s<r.length&&0===r[s];)s++;r=r.slice(s)}return r},r.generateECPolynomial=function(e){let t=new Uint8Array([1]);for(let s=0;s<e;s++)t=r.mul(t,new Uint8Array([1,n.exp(s)]));return t}},62458,(e,t,r)=>{let n=e.r(50677);function s(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}s.prototype.initialize=function(e){this.degree=e,this.genPoly=n.generateECPolynomial(this.degree)},s.prototype.encode=function(e){if(!this.genPoly)throw Error("Encoder not initialized");let t=new Uint8Array(e.length+this.degree);t.set(e);let r=n.mod(t,this.genPoly),s=this.degree-r.length;if(s>0){let e=new Uint8Array(this.degree);return e.set(r,s),e}return r},t.exports=s},67483,(e,t,r)=>{r.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}},96592,(e,t,r)=>{let n="[0-9]+",s="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+",a="(?:(?![A-Z0-9 $%*+\\-./:]|"+(s=s.replace(/u/g,"\\u"))+")(?:.|[\r\n]))+";r.KANJI=RegExp(s,"g"),r.BYTE_KANJI=RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),r.BYTE=RegExp(a,"g"),r.NUMERIC=RegExp(n,"g"),r.ALPHANUMERIC=RegExp("[A-Z $%*+\\-./:]+","g");let i=RegExp("^"+s+"$"),o=RegExp("^"+n+"$"),l=RegExp("^[A-Z0-9 $%*+\\-./:]+$");r.testKanji=function(e){return i.test(e)},r.testNumeric=function(e){return o.test(e)},r.testAlphanumeric=function(e){return l.test(e)}},50882,(e,t,r)=>{let n=e.r(67483),s=e.r(96592);r.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},r.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},r.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},r.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},r.MIXED={bit:-1},r.getCharCountIndicator=function(e,t){if(!e.ccBits)throw Error("Invalid mode: "+e);if(!n.isValid(t))throw Error("Invalid version: "+t);return t>=1&&t<10?e.ccBits[0]:t<27?e.ccBits[1]:e.ccBits[2]},r.getBestModeForData=function(e){return s.testNumeric(e)?r.NUMERIC:s.testAlphanumeric(e)?r.ALPHANUMERIC:s.testKanji(e)?r.KANJI:r.BYTE},r.toString=function(e){if(e&&e.id)return e.id;throw Error("Invalid mode")},r.isValid=function(e){return e&&e.bit&&e.ccBits},r.from=function(e,t){if(r.isValid(e))return e;try{if("string"!=typeof e)throw Error("Param is not a string");switch(e.toLowerCase()){case"numeric":return r.NUMERIC;case"alphanumeric":return r.ALPHANUMERIC;case"kanji":return r.KANJI;case"byte":return r.BYTE;default:throw Error("Unknown mode: "+e)}}catch(e){return t}}},93547,(e,t,r)=>{let n=e.r(87201),s=e.r(48125),a=e.r(73133),i=e.r(50882),o=e.r(67483),l=n.getBCHDigit(7973);function c(e,t){return i.getCharCountIndicator(e,t)+4}r.from=function(e,t){return o.isValid(e)?parseInt(e,10):t},r.getCapacity=function(e,t,r){if(!o.isValid(e))throw Error("Invalid QR Code version");void 0===r&&(r=i.BYTE);let a=(n.getSymbolTotalCodewords(e)-s.getTotalCodewordsCount(e,t))*8;if(r===i.MIXED)return a;let l=a-c(r,e);switch(r){case i.NUMERIC:return Math.floor(l/10*3);case i.ALPHANUMERIC:return Math.floor(l/11*2);case i.KANJI:return Math.floor(l/13);case i.BYTE:default:return Math.floor(l/8)}},r.getBestVersionForData=function(e,t){let n,s=a.from(t,a.M);if(Array.isArray(e)){if(e.length>1){for(let t=1;t<=40;t++)if(function(e,t){let r=0;return e.forEach(function(e){let n=c(e.mode,t);r+=n+e.getBitsLength()}),r}(e,t)<=r.getCapacity(t,s,i.MIXED))return t;return}if(0===e.length)return 1;n=e[0]}else n=e;return function(e,t,n){for(let s=1;s<=40;s++)if(t<=r.getCapacity(s,n,e))return s}(n.mode,n.getLength(),s)},r.getEncodedBits=function(e){if(!o.isValid(e)||e<7)throw Error("Invalid QR Code version");let t=e<<12;for(;n.getBCHDigit(t)-l>=0;)t^=7973<<n.getBCHDigit(t)-l;return e<<12|t}},57655,(e,t,r)=>{let n=e.r(87201),s=n.getBCHDigit(1335);r.getEncodedBits=function(e,t){let r=e.bit<<3|t,a=r<<10;for(;n.getBCHDigit(a)-s>=0;)a^=1335<<n.getBCHDigit(a)-s;return(r<<10|a)^21522}},94097,(e,t,r)=>{let n=e.r(50882);function s(e){this.mode=n.NUMERIC,this.data=e.toString()}s.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)},s.prototype.getLength=function(){return this.data.length},s.prototype.getBitsLength=function(){return s.getBitsLength(this.data.length)},s.prototype.write=function(e){let t,r;for(t=0;t+3<=this.data.length;t+=3)r=parseInt(this.data.substr(t,3),10),e.put(r,10);let n=this.data.length-t;n>0&&(r=parseInt(this.data.substr(t),10),e.put(r,3*n+1))},t.exports=s},12553,(e,t,r)=>{let n=e.r(50882),s=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function a(e){this.mode=n.ALPHANUMERIC,this.data=e}a.getBitsLength=function(e){return 11*Math.floor(e/2)+e%2*6},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let r=45*s.indexOf(this.data[t]);r+=s.indexOf(this.data[t+1]),e.put(r,11)}this.data.length%2&&e.put(s.indexOf(this.data[t]),6)},t.exports=a},82257,(e,t,r)=>{let n=e.r(50882);function s(e){this.mode=n.BYTE,"string"==typeof e?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}s.getBitsLength=function(e){return 8*e},s.prototype.getLength=function(){return this.data.length},s.prototype.getBitsLength=function(){return s.getBitsLength(this.data.length)},s.prototype.write=function(e){for(let t=0,r=this.data.length;t<r;t++)e.put(this.data[t],8)},t.exports=s},28822,(e,t,r)=>{let n=e.r(50882),s=e.r(87201);function a(e){this.mode=n.KANJI,this.data=e}a.getBitsLength=function(e){return 13*e},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let r=s.toSJIS(this.data[t]);if(r>=33088&&r<=40956)r-=33088;else if(r>=57408&&r<=60351)r-=49472;else throw Error("Invalid SJIS character: "+this.data[t]+"\nMake sure your charset is UTF-8");r=(r>>>8&255)*192+(255&r),e.put(r,13)}},t.exports=a},45953,(e,t,r)=>{"use strict";var n={single_source_shortest_paths:function(e,t,r){var s,a,i,o,l,c,d,u={},h={};h[t]=0;var f=n.PriorityQueue.make();for(f.push(t,0);!f.empty();)for(i in a=(s=f.pop()).value,o=s.cost,l=e[a]||{})l.hasOwnProperty(i)&&(c=o+l[i],d=h[i],(void 0===h[i]||d>c)&&(h[i]=c,f.push(i,c),u[i]=a));if(void 0!==r&&void 0===h[r])throw Error("Could not find a path from "+t+" to "+r+".");return u},extract_shortest_path_from_predecessor_list:function(e,t){for(var r=[],n=t;n;)r.push(n),e[n],n=e[n];return r.reverse(),r},find_path:function(e,t,r){var s=n.single_source_shortest_paths(e,t,r);return n.extract_shortest_path_from_predecessor_list(s,r)},PriorityQueue:{make:function(e){var t,r=n.PriorityQueue,s={};for(t in e=e||{},r)r.hasOwnProperty(t)&&(s[t]=r[t]);return s.queue=[],s.sorter=e.sorter||r.default_sorter,s},default_sorter:function(e,t){return e.cost-t.cost},push:function(e,t){this.queue.push({value:e,cost:t}),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};t.exports=n},97930,(e,t,r)=>{let n=e.r(50882),s=e.r(94097),a=e.r(12553),i=e.r(82257),o=e.r(28822),l=e.r(96592),c=e.r(87201),d=e.r(45953);function u(e){return unescape(encodeURIComponent(e)).length}function h(e,t,r){let n,s=[];for(;null!==(n=e.exec(r));)s.push({data:n[0],index:n.index,mode:t,length:n[0].length});return s}function f(e){let t,r,s=h(l.NUMERIC,n.NUMERIC,e),a=h(l.ALPHANUMERIC,n.ALPHANUMERIC,e);return c.isKanjiModeEnabled()?(t=h(l.BYTE,n.BYTE,e),r=h(l.KANJI,n.KANJI,e)):(t=h(l.BYTE_KANJI,n.BYTE,e),r=[]),s.concat(a,t,r).sort(function(e,t){return e.index-t.index}).map(function(e){return{data:e.data,mode:e.mode,length:e.length}})}function m(e,t){switch(t){case n.NUMERIC:return s.getBitsLength(e);case n.ALPHANUMERIC:return a.getBitsLength(e);case n.KANJI:return o.getBitsLength(e);case n.BYTE:return i.getBitsLength(e)}}function g(e,t){let r,l=n.getBestModeForData(e);if((r=n.from(t,l))!==n.BYTE&&r.bit<l.bit)throw Error('"'+e+'" cannot be encoded with mode '+n.toString(r)+".\n Suggested mode is: "+n.toString(l));switch(r===n.KANJI&&!c.isKanjiModeEnabled()&&(r=n.BYTE),r){case n.NUMERIC:return new s(e);case n.ALPHANUMERIC:return new a(e);case n.KANJI:return new o(e);case n.BYTE:return new i(e)}}r.fromArray=function(e){return e.reduce(function(e,t){return"string"==typeof t?e.push(g(t,null)):t.data&&e.push(g(t.data,t.mode)),e},[])},r.fromString=function(e,t){let s=function(e,t){let r={},s={start:{}},a=["start"];for(let i=0;i<e.length;i++){let o=e[i],l=[];for(let e=0;e<o.length;e++){let c=o[e],d=""+i+e;l.push(d),r[d]={node:c,lastCount:0},s[d]={};for(let e=0;e<a.length;e++){let i=a[e];r[i]&&r[i].node.mode===c.mode?(s[i][d]=m(r[i].lastCount+c.length,c.mode)-m(r[i].lastCount,c.mode),r[i].lastCount+=c.length):(r[i]&&(r[i].lastCount=c.length),s[i][d]=m(c.length,c.mode)+4+n.getCharCountIndicator(c.mode,t))}}a=l}for(let e=0;e<a.length;e++)s[a[e]].end=0;return{map:s,table:r}}(function(e){let t=[];for(let r=0;r<e.length;r++){let s=e[r];switch(s.mode){case n.NUMERIC:t.push([s,{data:s.data,mode:n.ALPHANUMERIC,length:s.length},{data:s.data,mode:n.BYTE,length:s.length}]);break;case n.ALPHANUMERIC:t.push([s,{data:s.data,mode:n.BYTE,length:s.length}]);break;case n.KANJI:t.push([s,{data:s.data,mode:n.BYTE,length:u(s.data)}]);break;case n.BYTE:t.push([{data:s.data,mode:n.BYTE,length:u(s.data)}])}}return t}(f(e,c.isKanjiModeEnabled())),t),a=d.find_path(s.map,"start","end"),i=[];for(let e=1;e<a.length-1;e++)i.push(s.table[a[e]].node);return r.fromArray(i.reduce(function(e,t){let r=e.length-1>=0?e[e.length-1]:null;return r&&r.mode===t.mode?e[e.length-1].data+=t.data:e.push(t),e},[]))},r.rawSplit=function(e){return r.fromArray(f(e,c.isKanjiModeEnabled()))}},30671,(e,t,r)=>{let n=e.r(87201),s=e.r(73133),a=e.r(73666),i=e.r(11421),o=e.r(20637),l=e.r(14002),c=e.r(37692),d=e.r(48125),u=e.r(62458),h=e.r(93547),f=e.r(57655),m=e.r(50882),g=e.r(97930);function x(e,t,r){let n,s,a=e.size,i=f.getEncodedBits(t,r);for(n=0;n<15;n++)s=(i>>n&1)==1,n<6?e.set(n,8,s,!0):n<8?e.set(n+1,8,s,!0):e.set(a-15+n,8,s,!0),n<8?e.set(8,a-n-1,s,!0):n<9?e.set(8,15-n-1+1,s,!0):e.set(8,15-n-1,s,!0);e.set(a-8,8,1,!0)}r.create=function(e,t){let r,f;if(void 0===e||""===e)throw Error("No input text");let p=s.M;return void 0!==t&&(p=s.from(t.errorCorrectionLevel,s.M),r=h.from(t.version),f=c.from(t.maskPattern),t.toSJISFunc&&n.setToSJISFunction(t.toSJISFunc)),function(e,t,r,s){let f;if(Array.isArray(e))f=g.fromArray(e);else if("string"==typeof e){let n=t;if(!n){let t=g.rawSplit(e);n=h.getBestVersionForData(t,r)}f=g.fromString(e,n||40)}else throw Error("Invalid data");let p=h.getBestVersionForData(f,r);if(!p)throw Error("The amount of data is too big to be stored in a QR Code");if(t){if(t<p)throw Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+p+".\n")}else t=p;let y=function(e,t,r){let s=new a;r.forEach(function(t){s.put(t.mode.bit,4),s.put(t.getLength(),m.getCharCountIndicator(t.mode,e)),t.write(s)});let i=(n.getSymbolTotalCodewords(e)-d.getTotalCodewordsCount(e,t))*8;for(s.getLengthInBits()+4<=i&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(0);let o=(i-s.getLengthInBits())/8;for(let e=0;e<o;e++)s.put(e%2?17:236,8);return function(e,t,r){let s,a,i=n.getSymbolTotalCodewords(t),o=i-d.getTotalCodewordsCount(t,r),l=d.getBlocksCount(t,r),c=i%l,h=l-c,f=Math.floor(i/l),m=Math.floor(o/l),g=m+1,x=f-m,p=new u(x),y=0,b=Array(l),w=Array(l),v=0,j=new Uint8Array(e.buffer);for(let e=0;e<l;e++){let t=e<h?m:g;b[e]=j.slice(y,y+t),w[e]=p.encode(b[e]),y+=t,v=Math.max(v,t)}let N=new Uint8Array(i),E=0;for(s=0;s<v;s++)for(a=0;a<l;a++)s<b[a].length&&(N[E++]=b[a][s]);for(s=0;s<x;s++)for(a=0;a<l;a++)N[E++]=w[a][s];return N}(s,e,t)}(t,r,f),b=new i(n.getSymbolSize(t));!function(e,t){let r=e.size,n=l.getPositions(t);for(let t=0;t<n.length;t++){let s=n[t][0],a=n[t][1];for(let t=-1;t<=7;t++)if(!(s+t<=-1)&&!(r<=s+t))for(let n=-1;n<=7;n++)a+n<=-1||r<=a+n||(t>=0&&t<=6&&(0===n||6===n)||n>=0&&n<=6&&(0===t||6===t)||t>=2&&t<=4&&n>=2&&n<=4?e.set(s+t,a+n,!0,!0):e.set(s+t,a+n,!1,!0))}}(b,t);let w=b.size;for(let e=8;e<w-8;e++){let t=e%2==0;b.set(e,6,t,!0),b.set(6,e,t,!0)}return!function(e,t){let r=o.getPositions(t);for(let t=0;t<r.length;t++){let n=r[t][0],s=r[t][1];for(let t=-2;t<=2;t++)for(let r=-2;r<=2;r++)-2===t||2===t||-2===r||2===r||0===t&&0===r?e.set(n+t,s+r,!0,!0):e.set(n+t,s+r,!1,!0)}}(b,t),x(b,r,0),t>=7&&function(e,t){let r,n,s,a=e.size,i=h.getEncodedBits(t);for(let t=0;t<18;t++)r=Math.floor(t/3),n=t%3+a-8-3,s=(i>>t&1)==1,e.set(r,n,s,!0),e.set(n,r,s,!0)}(b,t),!function(e,t){let r=e.size,n=-1,s=r-1,a=7,i=0;for(let o=r-1;o>0;o-=2)for(6===o&&o--;;){for(let r=0;r<2;r++)if(!e.isReserved(s,o-r)){let n=!1;i<t.length&&(n=(t[i]>>>a&1)==1),e.set(s,o-r,n),-1==--a&&(i++,a=7)}if((s+=n)<0||r<=s){s-=n,n=-n;break}}}(b,y),isNaN(s)&&(s=c.getBestMask(b,x.bind(null,b,r))),c.applyMask(s,b),x(b,r,s),{modules:b,version:t,errorCorrectionLevel:r,maskPattern:s,segments:f}}(e,r,p,f)}},25950,(e,t,r)=>{function n(e){if("number"==typeof e&&(e=e.toString()),"string"!=typeof e)throw Error("Color should be defined as hex string");let t=e.slice().replace("#","").split("");if(t.length<3||5===t.length||t.length>8)throw Error("Invalid hex color: "+e);(3===t.length||4===t.length)&&(t=Array.prototype.concat.apply([],t.map(function(e){return[e,e]}))),6===t.length&&t.push("F","F");let r=parseInt(t.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:255&r,hex:"#"+t.slice(0,6).join("")}}r.getOptions=function(e){e||(e={}),e.color||(e.color={});let t=void 0===e.margin||null===e.margin||e.margin<0?4:e.margin,r=e.width&&e.width>=21?e.width:void 0,s=e.scale||4;return{width:r,scale:r?4:s,margin:t,color:{dark:n(e.color.dark||"#000000ff"),light:n(e.color.light||"#ffffffff")},type:e.type,rendererOpts:e.rendererOpts||{}}},r.getScale=function(e,t){return t.width&&t.width>=e+2*t.margin?t.width/(e+2*t.margin):t.scale},r.getImageWidth=function(e,t){let n=r.getScale(e,t);return Math.floor((e+2*t.margin)*n)},r.qrToImageData=function(e,t,n){let s=t.modules.size,a=t.modules.data,i=r.getScale(s,n),o=Math.floor((s+2*n.margin)*i),l=n.margin*i,c=[n.color.light,n.color.dark];for(let t=0;t<o;t++)for(let r=0;r<o;r++){let d=(t*o+r)*4,u=n.color.light;t>=l&&r>=l&&t<o-l&&r<o-l&&(u=c[+!!a[Math.floor((t-l)/i)*s+Math.floor((r-l)/i)]]),e[d++]=u.r,e[d++]=u.g,e[d++]=u.b,e[d]=u.a}}},63037,(e,t,r)=>{let n=e.r(25950);r.render=function(e,t,r){var s;let a=r,i=t;void 0!==a||t&&t.getContext||(a=t,t=void 0),t||(i=function(){try{return document.createElement("canvas")}catch(e){throw Error("You need to specify a canvas element")}}()),a=n.getOptions(a);let o=n.getImageWidth(e.modules.size,a),l=i.getContext("2d"),c=l.createImageData(o,o);return n.qrToImageData(c.data,e,a),s=i,l.clearRect(0,0,s.width,s.height),s.style||(s.style={}),s.height=o,s.width=o,s.style.height=o+"px",s.style.width=o+"px",l.putImageData(c,0,0),i},r.renderToDataURL=function(e,t,n){let s=n;void 0!==s||t&&t.getContext||(s=t,t=void 0),s||(s={});let a=r.render(e,t,s),i=s.type||"image/png",o=s.rendererOpts||{};return a.toDataURL(i,o.quality)}},10891,(e,t,r)=>{let n=e.r(25950);function s(e,t){let r=e.a/255,n=t+'="'+e.hex+'"';return r<1?n+" "+t+'-opacity="'+r.toFixed(2).slice(1)+'"':n}function a(e,t,r){let n=e+t;return void 0!==r&&(n+=" "+r),n}r.render=function(e,t,r){let i=n.getOptions(t),o=e.modules.size,l=e.modules.data,c=o+2*i.margin,d=i.color.light.a?"<path "+s(i.color.light,"fill")+' d="M0 0h'+c+"v"+c+'H0z"/>':"",u="<path "+s(i.color.dark,"stroke")+' d="'+function(e,t,r){let n="",s=0,i=!1,o=0;for(let l=0;l<e.length;l++){let c=Math.floor(l%t),d=Math.floor(l/t);c||i||(i=!0),e[l]?(o++,l>0&&c>0&&e[l-1]||(n+=i?a("M",c+r,.5+d+r):a("m",s,0),s=0,i=!1),c+1<t&&e[l+1]||(n+=a("h",o),o=0)):s++}return n}(l,o,i.margin)+'"/>',h='<svg xmlns="http://www.w3.org/2000/svg" '+(i.width?'width="'+i.width+'" height="'+i.width+'" ':"")+('viewBox="0 0 '+c+" ")+c+'" shape-rendering="crispEdges">'+d+u+"</svg>\n";return"function"==typeof r&&r(null,h),h}},73134,(e,t,r)=>{let n=e.r(38750),s=e.r(30671),a=e.r(63037),i=e.r(10891);function o(e,t,r,a,i){let o=[].slice.call(arguments,1),l=o.length,c="function"==typeof o[l-1];if(!c&&!n())throw Error("Callback required as last argument");if(c){if(l<2)throw Error("Too few arguments provided");2===l?(i=r,r=t,t=a=void 0):3===l&&(t.getContext&&void 0===i?(i=a,a=void 0):(i=a,a=r,r=t,t=void 0))}else{if(l<1)throw Error("Too few arguments provided");return 1===l?(r=t,t=a=void 0):2!==l||t.getContext||(a=r,r=t,t=void 0),new Promise(function(n,i){try{let i=s.create(r,a);n(e(i,t,a))}catch(e){i(e)}})}try{let n=s.create(r,a);i(null,e(n,t,a))}catch(e){i(e)}}r.create=s.create,r.toCanvas=o.bind(null,a.render),r.toDataURL=o.bind(null,a.renderToDataURL),r.toString=o.bind(null,function(e,t,r){return i.render(e,r)})},53304,e=>{"use strict";var t=e.i(18050),r=e.i(71645),n=e.i(18566),s=e.i(70703),a=e.i(3116),i=e.i(71689),o=e.i(51975),l=e.i(75505);let c=(0,e.i(75254).default)("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);var d=e.i(40160),u=e.i(78917),h=e.i(9165),f=e.i(18789),m=e.i(42531),g=e.i(72450),x=e.i(30562),p=e.i(75157),y=e.i(73134);function b({noteId:e,title:n,password:s,onClose:a}){let i=(0,r.useRef)(null),[o,l]=(0,r.useState)(""),[c,d]=(0,r.useState)(""),[u,h]=(0,r.useState)(!0);(0,r.useEffect)(()=>{f()},[]);let f=async()=>{let e="",t="";try{let r=await (0,p.safeFetch)("/api/profile"),n=await r.json();n.success&&n.data?.avatar&&(e=n.data.avatar.startsWith("http")?n.data.avatar:`${window.location.origin}${n.data.avatar}`,l(e));let s=await (0,p.safeFetch)("/api/settings"),a=await s.json();a.success&&a.data&&(t=a.data.find(e=>"siteTitle"===e.key)?.value||"",d(t))}catch(e){console.error("Failed to load data:",e)}await m(e,t)},m=async(t=o,r=c)=>{let a=i.current;if(!a)return;let l=a.getContext("2d");if(!l)return;a.width=600,a.height=800;let d=l.createLinearGradient(0,0,0,800);if(d.addColorStop(0,"#667eea"),d.addColorStop(1,"#764ba2"),l.fillStyle=d,l.fillRect(0,0,600,800),l.fillStyle="#ffffff",l.roundRect(40,60,520,680,20),l.fill(),t)try{let e=new Image;e.crossOrigin="anonymous",e.src=t,await new Promise(t=>{e.onload=t,e.onerror=t}),l.save(),l.beginPath(),l.arc(300,140,50,0,2*Math.PI),l.closePath(),l.clip(),l.drawImage(e,250,90,100,100),l.restore()}catch(e){l.fillStyle="#667eea",l.beginPath(),l.arc(300,140,50,0,2*Math.PI),l.fill()}l.fillStyle="#1a202c",l.font="bold 24px sans-serif",l.textAlign="center",l.fillText(r||"",300,230),l.font="20px sans-serif",l.fillStyle="#4a5568";let u=n;if(l.measureText(n).width>460){for(;l.measureText(u+"...").width>460;)u=u.slice(0,-1);u+="..."}l.fillText(u,300,280);let f=window.location.origin,m=`${f}/note/${e}`;s&&(m+=`?pwd=${encodeURIComponent(s)}`);let g=await y.default.toDataURL(m,{width:280,margin:2,color:{dark:"#000000",light:"#ffffff"}}),x=new Image;x.src=g,await new Promise(e=>{x.onload=e}),l.drawImage(x,160,320,280,280),l.font="16px sans-serif",l.fillStyle="#718096",l.fillText(f.replace(/^https?:\/\//,""),300,650),l.font="14px sans-serif",l.fillStyle="#a0aec0",l.fillText("扫描二维码查看笔记",300,690),h(!1)};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[10000]",onClick:a,children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl p-6 max-w-sm w-full mx-4",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,t.jsx)("button",{onClick:a,className:"text-gray-400 hover:text-gray-600",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})}),(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[u&&(0,t.jsx)("div",{className:"text-gray-500 mb-4",children:"生成中..."}),(0,t.jsx)("canvas",{ref:i,className:"max-w-full h-auto rounded-lg shadow-lg",style:{width:"300px",height:"400px"}}),(0,t.jsx)("button",{onClick:()=>{let t=i.current;t&&t.toBlob(t=>{if(!t)return;let r=URL.createObjectURL(t),n=document.createElement("a");n.href=r,n.download=`note-${e}-share.png`,n.click(),URL.revokeObjectURL(r)})},disabled:u,className:"mt-6 px-6 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-lg hover:from-purple-700 hover:to-indigo-700 disabled:opacity-50 transition-all",children:"下载分享图片"})]})]})})}var w=e.i(1513),v=e.i(49484),j=e.i(14984),N=e.i(26261),E=e.i(96433),C=e.i(74080),k=e.i(37727),S=e.i(73375),A=e.i(63059),T=e.i(54212),M=e.i(20354);function I({images:e,currentIndex:n,isOpen:s,onClose:a,onIndexChange:i}){let[o,l]=(0,r.useState)(n),[c,u]=(0,r.useState)(1),[h,f]=(0,r.useState)({x:0,y:0}),[m,g]=(0,r.useState)(!1),[x,p]=(0,r.useState)(!1),y=(0,r.useRef)({x:0,y:0}),[b,w]=(0,r.useState)(null),[v,j]=(0,r.useState)(1),[N,E]=(0,r.useState)(null),[I,P]=(0,r.useState)(null),[B,R]=(0,r.useState)(!1);(0,r.useEffect)(()=>{l(n)},[n]),(0,r.useEffect)(()=>{let e=()=>{p(window.innerWidth<768||"ontouchstart"in window)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{if(s){let e=window.scrollY,t=window.scrollX;document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.top=`-${e}px`,document.body.style.left=`-${t}px`,document.body.style.width="100%",document.body.style.height="100%",document.body.dataset.scrollY=String(e),document.body.dataset.scrollX=String(t)}else{let e=parseInt(document.body.dataset.scrollY||"0",10),t=parseInt(document.body.dataset.scrollX||"0",10);document.body.style.overflow="",document.body.style.position="",document.body.style.top="",document.body.style.left="",document.body.style.width="",document.body.style.height="",window.scrollTo(t,e)}return()=>{let e=parseInt(document.body.dataset.scrollY||"0",10),t=parseInt(document.body.dataset.scrollX||"0",10);document.body.style.overflow="",document.body.style.position="",document.body.style.top="",document.body.style.left="",document.body.style.width="",document.body.style.height="",window.scrollTo(t,e)}},[s]),(0,r.useEffect)(()=>{if(!s)return;let e=e=>{"Escape"===e.key?a():"ArrowLeft"===e.key?D():"ArrowRight"===e.key?z():"+"===e.key||"="===e.key?H():"-"===e.key&&K()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[s,o,c,e]);let L=(0,r.useCallback)(e=>{if(x)return;e.preventDefault();let t=e.deltaY>0?-.1:.1;u(e=>{let r=Math.min(Math.max(e+t,.5),3);return r<=1&&f({x:0,y:0}),r})},[x]),U=(0,r.useCallback)(e=>{x||c<=1||(e.preventDefault(),g(!0),y.current={x:e.clientX-h.x,y:e.clientY-h.y})},[x,c,h]),$=(0,r.useCallback)(e=>{!m||x||f({x:e.clientX-y.current.x,y:e.clientY-y.current.y})},[m,x]),F=(0,r.useCallback)(()=>{g(!1)},[]),Y=e=>{if(e.length<2)return 0;let t=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(t*t+r*r)},z=()=>{if(e.length<=1)return;let t=(o+1)%e.length;l(t),i?.(t),_()},D=()=>{if(e.length<=1)return;let t=(o-1+e.length)%e.length;l(t),i?.(t),_()},_=()=>{u(1),f({x:0,y:0})},H=()=>{u(e=>Math.min(e+.25,3))},K=()=>{u(e=>{let t=Math.max(e-.25,.5);return t<=1&&f({x:0,y:0}),t})},O=()=>{u(1),f({x:0,y:0}),a()};if(!s)return null;let J=(0,t.jsx)("div",{className:"fixed inset-0 z-[99999] flex items-center justify-center bg-black/90 backdrop-blur-sm animate-fade-in",onClick:O,children:(0,t.jsxs)("div",{className:"relative w-full h-full flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("div",{className:"absolute top-0 left-0 right-0 z-10 bg-gradient-to-b from-black/80 to-transparent p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between max-w-7xl mx-auto",children:[(0,t.jsx)("div",{className:"w-10"}),(0,t.jsx)("div",{className:"flex-1 flex justify-center",children:e.length>1&&(0,t.jsx)("div",{className:"bg-black/50 backdrop-blur-sm rounded-full px-4 py-2",children:(0,t.jsxs)("span",{className:"text-white text-sm font-medium",children:[o+1," / ",e.length]})})}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>{let t=e[o],r=document.createElement("a");r.href=t,r.download=`image-${o+1}`,r.target="_blank",document.body.appendChild(r),r.click(),document.body.removeChild(r)},className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors",title:"下载图片",children:(0,t.jsx)(d.Download,{className:"w-5 h-5 text-white"})}),(0,t.jsx)("button",{onClick:O,className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors",title:"关闭",children:(0,t.jsx)(k.X,{className:"w-5 h-5 text-white"})})]})]})}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center",children:[(0,t.jsx)("div",{className:"h-20"}),(0,t.jsxs)("div",{className:"relative flex-shrink-0 px-4 lg:px-24",onWheel:L,onMouseDown:U,onMouseMove:$,onMouseUp:F,onMouseLeave:F,onTouchStart:e=>{if(2===e.touches.length)w(Y(e.touches)),j(c),R(!1);else if(1===e.touches.length){let t=e.touches[0];c>1?(g(!0),y.current={x:t.clientX-h.x,y:t.clientY-h.y}):(E({x:t.clientX,y:t.clientY}),P(null),R(!0))}},onTouchMove:e=>{if(2===e.touches.length&&b){let t=Math.min(Math.max(v*(Y(e.touches)/b),.5),3);u(t),t<=1&&f({x:0,y:0})}else if(1===e.touches.length){let t=e.touches[0];m&&c>1?f({x:t.clientX-y.current.x,y:t.clientY-y.current.y}):B&&c<=1&&P({x:t.clientX,y:t.clientY})}},onTouchEnd:()=>{if(w(null),g(!1),B&&N&&I&&c<=1){let e=N.x-I.x;Math.abs(e)>Math.abs(N.y-I.y)&&Math.abs(e)>50&&(e>0?z():D())}R(!1),E(null),P(null)},style:{cursor:c>1?m?"grabbing":"grab":"default"},children:[(0,t.jsx)("img",{src:e[o],alt:`图片 ${o+1}`,className:"max-w-full object-contain mx-auto select-none",draggable:!1,style:{transform:`scale(${c}) translate(${h.x/c}px, ${h.y/c}px)`,transition:m?"none":"transform 0.2s ease-out",maxHeight:"calc(100vh - 200px)",maxWidth:"100%",touchAction:"none"}},o),e.length>1&&!x&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:D,className:"absolute -left-16 top-1/2 -translate-y-1/2 p-3 bg-black/20 hover:bg-black/40 rounded-full transition-colors backdrop-blur-sm",title:"上一张 (←)",children:(0,t.jsx)(S.ChevronLeft,{className:"w-6 h-6 text-white/60"})}),(0,t.jsx)("button",{onClick:z,className:"absolute -right-16 top-1/2 -translate-y-1/2 p-3 bg-black/20 hover:bg-black/40 rounded-full transition-colors backdrop-blur-sm",title:"下一张 (→)",children:(0,t.jsx)(A.ChevronRight,{className:"w-6 h-6 text-white/60"})})]})]}),(0,t.jsx)("div",{className:"h-20"})]}),(0,t.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 z-10",children:[!x&&(0,t.jsx)("div",{className:"flex justify-center pb-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-1.5 bg-black/50 backdrop-blur-sm rounded-full px-3 py-1.5",children:[(0,t.jsx)("button",{onClick:K,className:"p-1 hover:bg-white/10 rounded-full transition-colors",title:"缩小",children:(0,t.jsx)(M.ZoomOut,{className:"w-4 h-4 text-white"})}),(0,t.jsxs)("span",{className:"text-white text-xs min-w-[50px] text-center font-medium",children:[Math.round(100*c),"%"]}),(0,t.jsx)("button",{onClick:H,className:"p-1 hover:bg-white/10 rounded-full transition-colors",title:"放大",children:(0,t.jsx)(T.ZoomIn,{className:"w-4 h-4 text-white"})})]})}),e.length>1&&(0,t.jsx)("div",{className:"bg-gradient-to-t from-black/80 to-transparent p-4",children:(0,t.jsx)("div",{className:"flex justify-center max-w-7xl mx-auto",children:(0,t.jsx)("div",{className:"flex gap-2 overflow-x-auto hide-scrollbar",style:{scrollbarWidth:"none",msOverflowStyle:"none",WebkitOverflowScrolling:"touch"},children:e.map((e,r)=>(0,t.jsx)("button",{onClick:()=>{l(r),i?.(r),_()},className:`flex-shrink-0 w-16 h-16 rounded-lg overflow-hidden border-2 transition-all ${r===o?"border-primary-500 opacity-100":"border-white/20 opacity-50 hover:opacity-75"}`,children:(0,t.jsx)("img",{src:e,alt:`缩略图 ${r+1}`,className:"w-full h-full object-cover",draggable:!1})},r))})})})]})]})});return(0,C.createPortal)(J,document.body)}let P=(0,s.default)(()=>e.A(34563),{loadableGenerated:{modules:[23153]},ssr:!1,loading:()=>(0,t.jsx)("div",{className:"p-4 bg-bg-secondary rounded-lg animate-pulse",children:"加载图表中..."})}),B=(0,p.getApiBaseUrl)();function R(){let s,p,y,C,k,S,A=(0,n.useParams)(),T=(0,n.useRouter)(),M=(0,n.useSearchParams)(),[R,L]=(0,r.useState)(null),[U,$]=(0,r.useState)(!0),[F,Y]=(0,r.useState)(!1),[z,D]=(0,r.useState)(!1),[_,H]=(0,r.useState)(""),[K,O]=(0,r.useState)(""),[J,q]=(0,r.useState)(!1),[X,V]=(0,r.useState)(0),[Q,W]=(0,r.useState)(3),[Z,G]=(0,r.useState)(!1),[ee,et]=(0,r.useState)(!1),[er,en]=(0,r.useState)(!1),[es,ea]=(0,r.useState)(""),[ei,eo]=(0,r.useState)(!1),[el,ec]=(0,r.useState)([]),[ed,eu]=(0,r.useState)(0),[eh,ef]=(0,r.useState)({browserTitle:"笔记详情",browserSubtitle:""}),[em,eg]=(0,r.useState)(""),[ex,ep]=(0,r.useState)(null),[ey,eb]=(0,r.useState)(!1),ew=(0,r.useMemo)(()=>!!R?.content&&/\$\$[\s\S]+?\$\$|\$[^\$\n]+?\$|\\\[[\s\S]+?\\\]|\\\([\s\S]+?\\\)/.test(R.content),[R?.content]);(0,r.useEffect)(()=>{ew&&!ey&&e.A(23587).then(e=>{let t=document.createElement("link");t.rel="stylesheet",t.href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css",document.head.appendChild(t),ep(()=>e.default),eb(!0)}).catch(e=>{console.error("Failed to load KaTeX:",e)})},[ew,ey]),(0,r.useEffect)(()=>{let e=async()=>{try{let e=M.get("password");if(e){let t=await h.default.get(`/notes/${A.id}?password=${encodeURIComponent(e)}`);if(t.data?.success&&t.data?.data){let r=t.data.data;L(r),r.requiresPassword?(D(!0),O("URL中的密码不正确，请重新输入")):(D(!1),ea(e))}else Y(!0)}else{let e=await h.default.get(`/notes/${A.id}`);if(e.data?.success&&e.data?.data){let t=e.data.data;L(t),t.requiresPassword&&D(!0)}else Y(!0)}}catch(e){console.error("Failed to fetch note:",e),Y(!0)}finally{$(!1)}};A.id&&e()},[A.id,M]),(0,r.useEffect)(()=>{(async()=>{try{let[e,t]=await Promise.all([(0,h.getSettings)(),(0,h.getPageText)("note")]);if(e.success&&e.data){let t={};e.data.forEach(e=>{t[e.key]=e.value}),eg(t.siteTitle||"")}t.success&&t.data&&ef({browserTitle:t.data.browserTitle||"笔记详情",browserSubtitle:t.data.browserSubtitle||""})}catch(e){console.error("加载页面配置失败:",e)}})()},[]),(0,r.useEffect)(()=>{if(R&&!R.requiresPassword){let e=R.title||"无标题";em?document.title=`${e} - ${em}`:document.title=e}else U?document.title="加载中...":F&&(document.title="笔记不存在")},[R,U,F,es,em]),(0,r.useEffect)(()=>{R&&!R.requiresPassword&&ev()},[R,es]),(0,r.useEffect)(()=>{let e=async()=>{try{let e=await h.default.get("/notes/password-status");e.data?.success&&(V(e.data.errorCount||0),W(e.data.remaining??3))}catch{}};z&&e()},[z]);let ev=async()=>{try{let e=es?`?password=${encodeURIComponent(es)}`:"",t=await h.default.get(`/notes/${A.id}/disks${e}`);t.data?.success&&t.data?.data&&en(t.data.data.length>0)}catch(e){en(!1)}},ej=async e=>{e.preventDefault(),O(""),q(!0);try{let e=await h.default.post(`/notes/${A.id}/verify`,{password:_});e.data?.success&&e.data?.data&&(L(e.data.data),D(!1),ea(_),H(""),V(0),W(3))}catch(t){let e=t.response?.data;e?.errorCount!==void 0&&(V(e.errorCount),W(e.remaining)),t.response?.status===429?O("密码错误次数过多，请1小时后重试！"):t.response?.status===401?O(e?.remaining>0?"密码错误":"密码错误次数过多，请1小时后重试！"):O("验证失败，请稍后重试")}finally{q(!1)}},eN=()=>{T.push("/")},eE=e=>{T.push(`/notes?tag=${encodeURIComponent(e)}`)};return U?(0,t.jsx)("div",{className:"min-h-screen bg-bg-primary flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-10 h-10 border-3 border-primary-500 border-t-transparent rounded-full animate-spin mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-text-tertiary text-sm",children:"加载中..."})]})}):F||!R?(0,t.jsx)("div",{className:"min-h-screen bg-bg-primary flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-text-primary mb-3",children:"404"}),(0,t.jsx)("p",{className:"text-text-tertiary text-sm mb-4",children:"笔记不存在或已被删除"}),(0,t.jsx)("button",{onClick:eN,className:"px-4 py-2 bg-primary-500 text-white text-sm rounded-lg hover:bg-primary-600 transition-colors",children:"返回首页"})]})}):(0,t.jsxs)("div",{className:"min-h-screen bg-bg-primary hide-scrollbar relative",children:[(0,t.jsx)(N.default,{}),(0,t.jsx)(E.default,{}),(0,t.jsx)("nav",{className:"sticky top-0 z-50 bg-bg-primary/95 backdrop-blur-md border-b border-border-primary shadow-sm",children:(0,t.jsx)("div",{className:"max-w-6xl mx-auto px-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0 overflow-hidden",children:[(0,t.jsxs)("button",{onClick:eN,className:"flex items-center gap-1 sm:gap-2 text-text-secondary hover:text-text-primary transition-colors text-sm font-medium flex-shrink-0",children:[(0,t.jsx)(i.ArrowLeft,{className:"w-4 h-4 sm:w-5 sm:h-5"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"返回"})]}),(0,t.jsx)("span",{className:"text-text-tertiary hidden sm:inline",children:"|"}),(0,t.jsx)("h1",{className:"text-sm sm:text-base font-semibold text-text-primary truncate flex-1 min-w-0",children:R.title||"无标题"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-shrink-0",children:[er&&(0,t.jsxs)("button",{onClick:()=>et(!0),className:"flex items-center gap-1.5 px-3 py-2 text-sm text-primary-600 hover:bg-primary-50 rounded-lg transition-colors font-medium",children:[(0,t.jsx)(d.Download,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"下载资源"})]}),(0,t.jsxs)("button",{onClick:()=>G(!0),className:"flex items-center gap-1.5 px-3 py-2 text-sm text-primary-600 hover:bg-primary-50 rounded-lg transition-colors font-medium",children:[(0,t.jsx)(c,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"分享笔记"})]})]})]})})}),(0,t.jsx)("main",{className:"py-0 sm:py-6",children:(0,t.jsxs)("div",{className:"max-w-6xl mx-auto px-0 sm:px-4",children:[(0,t.jsxs)("article",{className:"sm:rounded-xl sm:border sm:border-border-primary sm:shadow-sm bg-bg-secondary animate-fade-in",children:[(0,t.jsx)("div",{className:"px-4 sm:px-6 py-5",children:(0,t.jsx)("div",{className:"note-content",children:(0,t.jsx)(f.default,{remarkPlugins:[m.default,g.default],rehypePlugins:ew&&ex?[x.default,ex]:[x.default],components:{img:({src:e,alt:n,className:s,style:a,...i})=>{let o=e;"string"==typeof e&&e.startsWith("/uploads/")&&(o=`${B}${e}`);let l=s?.includes("blur-image")||"true"===i["data-blur"],[c,d]=r.default.useState(!1),u=s?.includes("img-align-"),h={};return"string"==typeof a?a.split(";").forEach(e=>{let[t,r]=e.split(":").map(e=>e.trim());t&&r&&(h[t]=r)}):a&&(h=a),(0,t.jsx)("div",{className:`my-4 ${s?.includes("img-align-right")?"text-right":s?.includes("img-align-left")?"text-left":"text-center"} ${l?"blur-image-container":""} ${c?"revealed":""}`,children:(0,t.jsx)("img",{src:o,alt:n||"",className:`max-w-full h-auto rounded-lg shadow-sm cursor-pointer hover:shadow-md transition-shadow ${s||""} ${u?"":"img-align-center"} ${l&&!c?"blur-image":""} ${c?"revealed":""}`,style:{maxHeight:"360px",objectFit:"contain",...h},loading:"lazy",onClick:()=>{l&&!c?d(!0):o&&(ec([o]),eu(0),eo(!0))},onError:e=>{e.target.style.display="none"},...i})})},iframe:({node:e,...r})=>(0,t.jsx)("div",{className:"iframe-container my-4",children:(0,t.jsx)("iframe",{...r})}),pre:({node:e,children:n,...s})=>{let a=e=>"string"==typeof e?e:Array.isArray(e)?e.map(a).join(""):r.default.isValidElement(e)?a(e.props.children||""):"",i=a(n),o=(e=>{if(r.default.isValidElement(e)){let t=e.props,r=t?.className||"",n=/language-(\w+)/.exec(r);return n?n[1]:""}return""})(n);return"mermaid"===o?(0,t.jsx)(P,{chart:i}):(0,t.jsxs)("div",{className:"relative my-4 group code-block-wrapper",children:[o&&(0,t.jsx)("span",{className:"code-language-label",children:o}),(0,t.jsx)(j.default,{text:i}),(0,t.jsx)("pre",{className:"code-block",...s,children:n})]})},code:({node:e,className:r,children:n,...s})=>r&&r.includes("language-")?(0,t.jsx)("code",{className:`block-code ${r||""}`,...s,children:n}):(0,t.jsx)("code",{className:"inline-code",...s,children:n}),table:({node:e,children:r,...n})=>(0,t.jsx)("div",{className:"overflow-x-auto my-4",children:(0,t.jsx)("table",{...n,children:r})}),blockquote:({node:e,children:r,...n})=>(0,t.jsx)("blockquote",{className:"note-blockquote",...n,children:r}),a:({node:e,href:r,children:n,...s})=>(0,t.jsx)("a",{href:r,className:"text-primary-600 hover:text-primary-700 hover:underline",target:"_blank",rel:"noopener noreferrer",...s,children:n}),p:({node:e,children:n,...s})=>r.default.Children.toArray(n).some(e=>"string"==typeof e&&e.includes("\n"))?(0,t.jsx)("p",{...s,children:r.default.Children.map(n,(e,n)=>{if("string"==typeof e){let s=e.split("\n");return(0,t.jsx)(r.default.Fragment,{children:s.map((e,n)=>(0,t.jsxs)(r.default.Fragment,{children:[e,n<s.length-1&&(0,t.jsx)("br",{})]},n))},n)}return e})}):(0,t.jsx)("p",{...s,children:n}),h1:({node:e,children:r,...n})=>(0,t.jsx)("h1",{...n,children:r}),h2:({node:e,children:r,...n})=>(0,t.jsx)("h2",{...n,children:r}),h3:({node:e,children:r,...n})=>(0,t.jsx)("h3",{...n,children:r}),h4:({node:e,children:r,...n})=>(0,t.jsx)("h4",{...n,children:r}),h5:({node:e,children:r,...n})=>(0,t.jsx)("h5",{...n,children:r}),h6:({node:e,children:r,...n})=>(0,t.jsx)("h6",{...n,children:r}),ul:({node:e,children:r,...n})=>(0,t.jsx)("ul",{...n,children:r}),ol:({node:e,children:r,...n})=>(0,t.jsx)("ol",{...n,children:r}),li:({node:e,children:r,...n})=>(0,t.jsx)("li",{...n,children:r}),hr:({node:e,...r})=>(0,t.jsx)("hr",{...r}),strong:({node:e,children:r,...n})=>(0,t.jsx)("strong",{...n,children:r}),em:({node:e,children:r,...n})=>(0,t.jsx)("em",{...n,children:r}),del:({node:e,children:r,...n})=>(0,t.jsx)("del",{...n,children:r})},children:R.content})})}),(0,t.jsxs)("footer",{className:"bg-bg-tertiary px-4 sm:px-6 py-4 border-t border-border-primary",children:["reprint"===R.source_type&&R.source_text&&(0,t.jsxs)("div",{className:"flex items-start gap-2 text-xs text-text-tertiary mb-3 pb-3 border-b border-border-primary",children:[(0,t.jsx)(u.ExternalLink,{className:"w-3.5 h-3.5 mt-0.5 flex-shrink-0"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-text-tertiary",children:"来源："}),(0,t.jsx)("span",{children:R.source_text})]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-y-3",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1.5 text-xs text-text-tertiary",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(a.Clock,{className:"w-3 h-3"}),(0,t.jsx)("time",{dateTime:R.published_at||R.created_at,children:(p=(s=new Date(R.published_at||R.created_at)).getFullYear(),y=String(s.getMonth()+1).padStart(2,"0"),C=String(s.getDate()).padStart(2,"0"),k=String(s.getHours()).padStart(2,"0"),S=String(s.getMinutes()).padStart(2,"0"),`${p}-${y}-${C} ${k}:${S}`)})]}),R.category&&(0,t.jsxs)("button",{onClick:()=>{R?.category&&T.push(`/notes?category=${encodeURIComponent(R.category)}`)},className:"flex items-center gap-1 hover:text-primary-600 transition-colors",children:[(0,t.jsx)(l.FolderOpen,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:R.category})]}),R.Tags&&R.Tags.length>0&&R.Tags.map(e=>(0,t.jsxs)("button",{onClick:()=>eE(e.name),className:"flex items-center gap-1 hover:opacity-70 transition-opacity",style:{color:e.color||"var(--text-tertiary)"},children:[(0,t.jsx)(o.Tag,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:e.name})]},e.id)),(!R.Tags||0===R.Tags.length)&&R.tags&&R.tags.split(",").map((e,r)=>(0,t.jsxs)("button",{onClick:()=>eE(e.trim()),className:"flex items-center gap-1 hover:text-primary-600 transition-colors",children:[(0,t.jsx)(o.Tag,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:e.trim()})]},r)),"original"===R.source_type&&(0,t.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 bg-primary-100 text-primary-700 text-[10px] font-medium rounded",children:"原创"}),"reprint"===R.source_type&&(0,t.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 bg-primary-100 text-primary-600 text-[10px] font-medium rounded",children:"转载"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[er&&(0,t.jsxs)("button",{onClick:()=>et(!0),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs bg-primary-100 text-primary-600 rounded-md hover:bg-primary-200 transition-colors",children:[(0,t.jsx)(d.Download,{className:"w-3.5 h-3.5"}),(0,t.jsx)("span",{children:"下载资源"})]}),(0,t.jsxs)("button",{onClick:()=>G(!0),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs bg-primary-100 text-primary-600 rounded-md hover:bg-primary-200 transition-colors",children:[(0,t.jsx)(c,{className:"w-3.5 h-3.5"}),(0,t.jsx)("span",{children:"分享笔记"})]})]})]})]})]}),(0,t.jsxs)("footer",{className:"mt-6 border-t border-border-primary py-6 text-center text-sm text-text-tertiary",children:[(0,t.jsxs)("p",{children:["© ",new Date().getFullYear()," Xs-blog. All rights reserved."]}),(0,t.jsx)(v.default,{})]})]})}),z&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",children:(0,t.jsxs)("div",{className:"bg-bg-secondary rounded-xl max-w-sm w-full p-5 shadow-xl border border-border-primary",children:[(0,t.jsxs)("div",{className:"text-center mb-5",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,t.jsx)("svg",{className:"w-6 h-6 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,t.jsx)("h3",{className:"text-base font-bold text-text-primary mb-1",children:"需要密码访问"}),(0,t.jsx)("p",{className:"text-xs text-text-tertiary",children:"请输入密码查看笔记内容"})]}),(0,t.jsxs)("form",{onSubmit:ej,className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("input",{type:"password",name:"note-access-password",value:_,onChange:e=>H(e.target.value),placeholder:"请输入密码",className:"w-full px-3 py-2.5 text-sm border border-border-primary rounded-lg bg-bg-tertiary text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",autoFocus:!0,autoComplete:"off",disabled:J}),K&&(0,t.jsx)("p",{className:"mt-1.5 text-xs",style:{color:"var(--error-text)"},children:K}),X>0&&Q>0&&(0,t.jsxs)("p",{className:"mt-1.5 text-xs text-text-tertiary",children:["当前已输入错误",X,"次，还可以重试",Q,"次"]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>T.push("/notes"),className:"flex-1 px-3 py-2 text-sm bg-bg-tertiary text-text-secondary rounded-lg hover:bg-border-primary transition-colors",disabled:J,children:"返回"}),(0,t.jsx)("button",{type:"submit",className:`flex-1 px-3 py-2 text-sm rounded-lg transition-colors ${0===Q?"bg-gray-400 cursor-not-allowed":"bg-primary-500 hover:bg-primary-600 disabled:opacity-50"} text-white`,disabled:J||!_||0===Q,children:J?"验证中...":0===Q?"暂不可用":"确认"})]})]})]})}),Z&&R&&(0,t.jsx)(b,{noteId:R.id,title:R.title,password:R.password,onClose:()=>G(!1)}),R&&(0,t.jsx)(w.default,{isOpen:ee,onClose:()=>et(!1),noteId:R.id,isAdmin:!1,password:es}),(0,t.jsx)(I,{images:el,currentIndex:ed,isOpen:ei,onClose:()=>eo(!1),onIndexChange:eu})]})}e.s(["default",()=>R],53304)}]);