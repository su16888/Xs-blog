(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,64740,e=>{"use strict";var t=e.i(71645),s=e.i(90499);let a=null;function r(e,l=!1){let[i,n]=(0,t.useState)(a||""),o=(0,s.useOptionalPageTitleContext)();(0,t.useEffect)(()=>{l&&o&&o.setTitle(e)},[e,l,o]),(0,t.useEffect)(()=>{a?n(a):(async()=>{try{let e=await fetch("/api/settings");if(e.ok){let t=await e.json();if(t.success&&t.data){let e={};t.data.forEach(t=>{e[t.key]=t.value});let s=e.siteTitle||"";a=s,n(s)}}}catch(e){console.error("Failed to fetch site title:",e)}})()},[]),(0,t.useEffect)(()=>{let t=document.title;return l?"仪表盘"===e?document.title=`${i} - 后台管理系统`:document.title=`${e} - ${i}后台管理系统`:document.title=`${e} - ${i}`,()=>{document.title=t}},[e,i,l])}e.s(["usePageTitle",()=>r])},40803,e=>{"use strict";var t=e.i(18050),s=e.i(71645),a=e.i(75254);let r=(0,a.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),l=(0,a.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var i=e.i(37727);function n({show:e,message:a,type:n,duration:o=3e3,onClose:c}){let[d,m]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(e){m(!0);let e=setTimeout(()=>{m(!1)},o);return()=>clearTimeout(e)}m(!1)},[e,o]),(0,s.useEffect)(()=>{if(!d&&e){let e=setTimeout(c,300);return()=>clearTimeout(e)}},[d,e,c]);let u=(()=>{switch(n){case"success":return{bg:"bg-green-50 border-green-200",text:"text-green-800",icon:(0,t.jsx)(r,{className:"w-5 h-5 text-green-500"})};case"error":return{bg:"bg-red-50 border-red-200",text:"text-red-800",icon:(0,t.jsx)(l,{className:"w-5 h-5 text-red-500"})};default:return{bg:"bg-blue-50 border-blue-200",text:"text-blue-800",icon:(0,t.jsx)(r,{className:"w-5 h-5 text-blue-500"})}}})();return(0,t.jsx)(t.Fragment,{children:d&&(0,t.jsx)("div",{className:"fixed top-4 right-4 z-[999999] min-w-[300px] max-w-md animate-slide-down",children:(0,t.jsxs)("div",{className:`${u.bg} border rounded-lg shadow-lg p-4 flex items-start gap-3`,children:[(0,t.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:u.icon}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)("p",{className:`${u.text} text-sm font-medium`,children:a})}),(0,t.jsx)("button",{onClick:()=>{m(!1)},className:"flex-shrink-0 text-gray-400 hover:text-gray-600 transition-colors",children:(0,t.jsx)(i.X,{className:"w-4 h-4"})})]})})})}e.s(["default",()=>n],40803)},81858,e=>{"use strict";var t=e.i(18050),s=e.i(71645),a=e.i(18566),r=e.i(98348),l=e.i(9165),i=e.i(64740),n=e.i(40803),o=e.i(75157);function c(){(0,i.usePageTitle)("社交链接管理"),(0,a.useRouter)();let{user:e}=(0,r.useAuth)(),[c,d]=(0,s.useState)([]),[m,u]=(0,s.useState)(!0),[x,h]=(0,s.useState)(null),[p,g]=(0,s.useState)(!1),[f,b]=(0,s.useState)({platform:"",account:"",link:"",icon:"",qrcode:"",show_in_profile:!1}),[y,j]=(0,s.useState)({show:!1,type:"success",message:""}),[w,N]=(0,s.useState)(!1),[v,k]=(0,s.useState)(!1);(0,s.useEffect)(()=>{C()},[]);let C=async()=>{try{let e=await (0,l.getAdminSocialLinks)();if(e.success){let t=Array.isArray(e.data)?e.data:[];d(t)}}catch(e){console.error("加载社交链接失败:",e),d([])}finally{u(!1)}},S=e=>{b({...f,[e.target.name]:e.target.value})},_=async e=>{e.preventDefault();try{x?.id?(await (0,l.updateAdminSocialLink)(x.id,f)).success&&(j({show:!0,type:"success",message:"社交链接更新成功"}),await C(),T()):(await (0,l.createAdminSocialLink)(f)).success&&(j({show:!0,type:"success",message:"社交链接添加成功"}),await C(),T())}catch(e){j({show:!0,type:"error",message:e.response?.data?.message||"操作失败"})}},q=async e=>{if(confirm("确定要删除这个社交链接吗？"))try{(await (0,l.deleteAdminSocialLink)(e)).success&&(j({show:!0,type:"success",message:"社交链接删除成功"}),await C())}catch(e){j({show:!0,type:"error",message:e.response?.data?.message||"删除失败"})}},T=()=>{b({platform:"",account:"",link:"",icon:"",qrcode:"",show_in_profile:!1}),h(null),g(!1)},F=async e=>{let t=e.target.files?.[0];if(t){N(!0);try{let s=await (0,l.uploadAdminSocialLinkIcon)(t);s.success&&(b({...f,icon:s.data.url}),j({show:!0,type:"success",message:"图标上传成功"}),e.target.value="")}catch(e){j({show:!0,type:"error",message:e.response?.data?.message||"图标上传失败"})}finally{N(!1)}}},L=async e=>{let t=e.target.files?.[0];if(t){k(!0);try{let s=await (0,l.uploadAdminSocialLinkQRCode)(t);s.success&&(b({...f,qrcode:s.data.url}),j({show:!0,type:"success",message:"二维码上传成功"}),e.target.value="")}catch(e){j({show:!0,type:"error",message:e.response?.data?.message||"二维码上传失败"})}finally{k(!1)}}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.default,{show:y.show,message:y.message,type:y.type,onClose:()=>j({...y,show:!1})}),(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsx)("button",{onClick:()=>g(!p),className:"btn btn-primary",children:p?"取消":"+ 添加社交链接"})}),p&&(0,t.jsxs)("div",{className:"card mb-6",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-4",children:x?"编辑社交链接":"添加社交链接"}),(0,t.jsxs)("form",{onSubmit:_,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"platform",className:"block text-sm font-medium text-gray-700 mb-2",children:"平台名称"}),(0,t.jsx)("input",{id:"platform",name:"platform",type:"text",required:!0,value:f.platform,onChange:S,className:"input",placeholder:"例如：GitHub, Twitter, LinkedIn"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"account",className:"block text-sm font-medium text-gray-700 mb-2",children:"账号/用户名"}),(0,t.jsx)("input",{id:"account",name:"account",type:"text",required:!0,value:f.account,onChange:S,className:"input",placeholder:"例如：yourusername"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"link",className:"block text-sm font-medium text-gray-700 mb-2",children:"链接地址 (可选)"}),(0,t.jsx)("input",{id:"link",name:"link",type:"text",value:f.link,onChange:S,className:"input",placeholder:"https://... 或 /path 或 #anchor"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"支持完整URL、相对路径（如 /about）或锚点链接（如 #contact）"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"icon",className:"block text-sm font-medium text-gray-700 mb-2",children:"图标 (可选)"}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[f.icon&&(0,t.jsx)("div",{className:"flex-shrink-0 w-16 h-16 flex items-center justify-center bg-gray-50 rounded border border-gray-200",children:(0,t.jsx)("img",{src:f.icon,alt:"图标",className:"max-w-full max-h-full object-contain"})}),(0,t.jsxs)("div",{className:"flex-1 flex items-center gap-3",children:[!f.icon&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{type:"file",id:"iconInput",accept:".jpg,.jpeg,.png,.gif,.webp,.svg",onChange:F,disabled:w,className:"hidden"}),(0,t.jsx)("label",{htmlFor:"iconInput",className:`px-4 py-2 bg-blue-500 text-white rounded-lg font-medium transition-all duration-300 hover:bg-blue-600 hover:shadow-md text-xs cursor-pointer whitespace-nowrap ${w?"opacity-50 cursor-not-allowed":""}`,children:w?"上传中...":"选择文件"})]}),(0,t.jsx)("input",{id:"icon",name:"icon",type:"text",value:f.icon,onChange:S,placeholder:"图标 URL",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white placeholder-gray-400"})]}),f.icon&&(0,t.jsx)("button",{type:"button",onClick:()=>{b({...f,icon:""}),j({show:!0,type:"success",message:"图标删除成功"})},className:"flex-shrink-0 px-3 py-2 bg-red-500 text-white rounded-lg font-medium transition-all duration-300 hover:bg-red-600 hover:shadow-md text-xs whitespace-nowrap",children:"删除"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"支持 jpg、png、gif、webp、svg 格式"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"qrcode",className:"block text-sm font-medium text-gray-700 mb-2",children:"二维码图片 (可选)"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mb-3",children:"上传二维码后，前台点击社交链接将显示二维码弹窗，不会跳转URL"}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[f.qrcode&&(0,t.jsx)("div",{className:"flex-shrink-0 w-20 h-20 flex items-center justify-center bg-gray-50 rounded border border-gray-200",children:(0,t.jsx)("img",{src:f.qrcode,alt:"二维码",className:"w-full h-full object-contain"})}),(0,t.jsxs)("div",{className:"flex-1 flex items-center gap-3",children:[!f.qrcode&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{type:"file",id:"qrcodeInput",accept:".jpg,.jpeg,.png,.gif,.webp,.svg",onChange:L,disabled:v,className:"hidden"}),(0,t.jsx)("label",{htmlFor:"qrcodeInput",className:`px-4 py-2 bg-blue-500 text-white rounded-lg font-medium transition-all duration-300 hover:bg-blue-600 hover:shadow-md text-xs cursor-pointer whitespace-nowrap ${v?"opacity-50 cursor-not-allowed":""}`,children:v?"上传中...":"选择文件"})]}),(0,t.jsx)("input",{id:"qrcode",name:"qrcode",type:"text",value:f.qrcode,onChange:S,placeholder:"二维码图片 URL",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white placeholder-gray-400"})]}),f.qrcode&&(0,t.jsx)("button",{type:"button",onClick:()=>{b({...f,qrcode:""}),j({show:!0,type:"success",message:"二维码删除成功"})},className:"flex-shrink-0 px-3 py-2 bg-red-500 text-white rounded-lg font-medium transition-all duration-300 hover:bg-red-600 hover:shadow-md text-xs whitespace-nowrap",children:"删除"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"支持 jpg、png、gif、webp、svg 格式"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",id:"show_in_profile",name:"show_in_profile",checked:f.show_in_profile||!1,onChange:e=>b({...f,show_in_profile:e.target.checked}),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"在个人资料卡片中显示（最多显示6个），博客模式下建议只选择4个！"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1 ml-6",children:"勾选后，此社交链接将显示在博客主题的个人资料卡片下方，图标会根据数量自动调整大小和间距"})]}),(0,t.jsxs)("div",{className:"flex space-x-4",children:[(0,t.jsx)("button",{type:"submit",className:"btn btn-primary",children:x?"更新":"添加"}),(0,t.jsx)("button",{type:"button",onClick:T,className:"btn btn-secondary",children:"取消"})]})]})]}),(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"已添加的社交链接"}),0===c.length?(0,t.jsx)("p",{className:"text-gray-500 text-center py-8",children:"还没有添加任何社交链接"}):(0,t.jsx)("div",{className:"divide-y divide-gray-200",children:c.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center justify-between py-4 first:pt-0 last:pb-0",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1 mr-3",children:[(0,t.jsx)("button",{onClick:async()=>{if(0===s)return;let e=[...c],t=e[s];e[s]=e[s-1],e[s-1]=t,d(e);try{let t=e.map((e,t)=>({id:e.id,sort_order:t}));await (0,o.safeFetch)("/api/admin/social-links/sort/update",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({sortData:t})})}catch(e){console.error("Failed to update sort order:",e)}},disabled:0===s,className:"p-1 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"上移",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),(0,t.jsx)("button",{onClick:async()=>{if(s===c.length-1)return;let e=[...c],t=e[s];e[s]=e[s+1],e[s+1]=t,d(e);try{let t=e.map((e,t)=>({id:e.id,sort_order:t}));await (0,o.safeFetch)("/api/admin/social-links/sort/update",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({sortData:t})})}catch(e){console.error("Failed to update sort order:",e)}},disabled:s===c.length-1,className:"p-1 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"下移",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("h3",{className:"font-medium text-gray-900",children:e.platform}),e.show_in_profile&&(0,t.jsx)("span",{className:"px-2 py-0.5 text-xs bg-primary-100 text-primary-700 rounded-full",children:"显示在资料卡"})]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["账号：",e.account]}),e.link&&(0,t.jsx)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary-600 hover:underline",children:e.link})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{onClick:()=>{h(e),b({platform:e.platform,account:e.account,link:e.link||"",icon:e.icon||"",qrcode:e.qrcode||"",show_in_profile:e.show_in_profile||!1}),g(!0)},className:"btn btn-secondary text-sm",children:"编辑"}),(0,t.jsx)("button",{onClick:()=>e.id&&q(e.id),className:"btn bg-red-600 hover:bg-red-700 text-white text-sm",children:"删除"})]})]},e.id))})]})]})})]})}e.s(["default",()=>c])}]);