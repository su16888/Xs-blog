(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,340803,e=>{"use strict";var t=e.i(843476),s=e.i(271645),r=e.i(846932),a=e.i(88653),l=e.i(475254);let i=(0,l.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),n=(0,l.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var c=e.i(37727);function o({show:e,message:l,type:o,duration:d=3e3,onClose:m}){let[u,x]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(e){x(!0);let e=setTimeout(()=>{x(!1)},d);return()=>clearTimeout(e)}x(!1)},[e,d]),(0,s.useEffect)(()=>{if(!u&&e){let e=setTimeout(m,300);return()=>clearTimeout(e)}},[u,e,m]);let p=(()=>{switch(o){case"success":return{bg:"bg-green-50 border-green-200",text:"text-green-800",icon:(0,t.jsx)(i,{className:"w-5 h-5 text-green-500"})};case"error":return{bg:"bg-red-50 border-red-200",text:"text-red-800",icon:(0,t.jsx)(n,{className:"w-5 h-5 text-red-500"})};default:return{bg:"bg-blue-50 border-blue-200",text:"text-blue-800",icon:(0,t.jsx)(i,{className:"w-5 h-5 text-blue-500"})}}})();return(0,t.jsx)(a.AnimatePresence,{children:u&&(0,t.jsx)(r.motion.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.9},transition:{duration:.2},className:"fixed top-4 right-4 z-[999999] min-w-[300px] max-w-md",children:(0,t.jsxs)("div",{className:`${p.bg} border rounded-lg shadow-lg p-4 flex items-start gap-3`,children:[(0,t.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:p.icon}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)("p",{className:`${p.text} text-sm font-medium`,children:l})}),(0,t.jsx)("button",{onClick:()=>{x(!1)},className:"flex-shrink-0 text-gray-400 hover:text-gray-600 transition-colors",children:(0,t.jsx)(c.X,{className:"w-4 h-4"})})]})})})}e.s(["default",()=>o],340803)},88653,e=>{"use strict";e.i(247167);var t=e.i(843476),s=e.i(271645),r=e.i(231178),a=e.i(947414),l=e.i(674008),i=e.i(821476),n=e.i(772846),c=s,o=e.i(737806);function d(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}class m extends c.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,s=(0,n.isHTMLElement)(e)&&e.offsetWidth||0,r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft,r.right=s-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function u({children:e,isPresent:r,anchorX:a,root:l}){let i=(0,c.useId)(),n=(0,c.useRef)(null),u=(0,c.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:x}=(0,c.useContext)(o.MotionConfigContext),p=function(...e){return s.useCallback(function(...e){return t=>{let s=!1,r=e.map(e=>{let r=d(e,t);return s||"function"!=typeof r||(s=!0),r});if(s)return()=>{for(let t=0;t<r.length;t++){let s=r[t];"function"==typeof s?s():d(e[t],null)}}}}(...e),e)}(n,e?.ref);return(0,c.useInsertionEffect)(()=>{let{width:e,height:t,top:s,left:c,right:o}=u.current;if(r||!n.current||!e||!t)return;let d="left"===a?`left: ${c}`:`right: ${o}`;n.current.dataset.motionPopId=i;let m=document.createElement("style");x&&(m.nonce=x);let p=l??document.head;return p.appendChild(m),m.sheet&&m.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${t}px !important;
            ${d}px !important;
            top: ${s}px !important;
          }
        `),()=>{p.contains(m)&&p.removeChild(m)}},[r]),(0,t.jsx)(m,{isPresent:r,childRef:n,sizeRef:u,children:c.cloneElement(e,{ref:p})})}let x=({children:e,initial:r,isPresent:l,onExitComplete:n,custom:c,presenceAffectsLayout:o,mode:d,anchorX:m,root:x})=>{let h=(0,a.useConstant)(p),g=(0,s.useId)(),f=!0,y=(0,s.useMemo)(()=>(f=!1,{id:g,initial:r,isPresent:l,custom:c,onExitComplete:e=>{for(let t of(h.set(e,!0),h.values()))if(!t)return;n&&n()},register:e=>(h.set(e,!1),()=>h.delete(e))}),[l,h,n]);return o&&f&&(y={...y}),(0,s.useMemo)(()=>{h.forEach((e,t)=>h.set(t,!1))},[l]),s.useEffect(()=>{l||h.size||!n||n()},[l]),"popLayout"===d&&(e=(0,t.jsx)(u,{isPresent:l,anchorX:m,root:x,children:e})),(0,t.jsx)(i.PresenceContext.Provider,{value:y,children:e})};function p(){return new Map}var h=e.i(464978);let g=e=>e.key||"";function f(e){let t=[];return s.Children.forEach(e,e=>{(0,s.isValidElement)(e)&&t.push(e)}),t}let y=({children:e,custom:i,initial:n=!0,onExitComplete:c,presenceAffectsLayout:o=!0,mode:d="sync",propagate:m=!1,anchorX:u="left",root:p})=>{let[y,b]=(0,h.usePresence)(m),j=(0,s.useMemo)(()=>f(e),[e]),v=m&&!y?[]:j.map(g),N=(0,s.useRef)(!0),w=(0,s.useRef)(j),k=(0,a.useConstant)(()=>new Map),[C,_]=(0,s.useState)(j),[S,E]=(0,s.useState)(j);(0,l.useIsomorphicLayoutEffect)(()=>{N.current=!1,w.current=j;for(let e=0;e<S.length;e++){let t=g(S[e]);v.includes(t)?k.delete(t):!0!==k.get(t)&&k.set(t,!1)}},[S,v.length,v.join("-")]);let P=[];if(j!==C){let e=[...j];for(let t=0;t<S.length;t++){let s=S[t],r=g(s);v.includes(r)||(e.splice(t,0,s),P.push(s))}return"wait"===d&&P.length&&(e=P),E(f(e)),_(j),null}let{forceRender:M}=(0,s.useContext)(r.LayoutGroupContext);return(0,t.jsx)(t.Fragment,{children:S.map(e=>{let s=g(e),r=(!m||!!y)&&(j===S||v.includes(s));return(0,t.jsx)(x,{isPresent:r,initial:(!N.current||!!n)&&void 0,custom:i,presenceAffectsLayout:o,mode:d,root:p,onExitComplete:r?void 0:()=>{if(!k.has(s))return;k.set(s,!0);let e=!0;k.forEach(t=>{t||(e=!1)}),e&&(M?.(),E(w.current),m&&b?.(),c&&c())},anchorX:u,children:e},s)})})};e.s(["AnimatePresence",()=>y],88653)},964740,e=>{"use strict";var t=e.i(271645),s=e.i(690499);let r=null;function a(e,l=!1){let[i,n]=(0,t.useState)(r||""),c=(0,s.useOptionalPageTitleContext)();(0,t.useEffect)(()=>{l&&c&&c.setTitle(e)},[e,l,c]),(0,t.useEffect)(()=>{r?n(r):(async()=>{try{let e=await fetch("/api/settings");if(e.ok){let t=await e.json();if(t.success&&t.data){let e={};t.data.forEach(t=>{e[t.key]=t.value});let s=e.siteTitle||"";r=s,n(s)}}}catch(e){console.error("Failed to fetch site title:",e)}})()},[]),(0,t.useEffect)(()=>{let t=document.title;return l?"仪表盘"===e?document.title=`${i} - 后台管理系统`:document.title=`${e} - ${i}后台管理系统`:document.title=`${e} - ${i}`,()=>{document.title=t}},[e,i,l])}e.s(["usePageTitle",()=>a])},286536,77705,e=>{"use strict";var t=e.i(475254);let s=(0,t.default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>s],286536);let r=(0,t.default)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);e.s(["EyeOff",()=>r],77705)},270756,e=>{"use strict";let t=(0,e.i(475254).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["Lock",()=>t],270756)},107233,569074,e=>{"use strict";var t=e.i(475254);let s=(0,t.default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>s],107233);let r=(0,t.default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);e.s(["Upload",()=>r],569074)},903769,e=>{"use strict";var t=e.i(843476),s=e.i(271645),r=e.i(618566),a=e.i(557951),l=e.i(209165),i=e.i(964740),n=e.i(340803),c=e.i(473708),o=e.i(107233),d=e.i(475254);let m=(0,d.default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var u=e.i(727612),x=e.i(569074),p=e.i(286536),h=e.i(77705),g=e.i(270756);let f=(0,d.default)("folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);function y(){(0,i.usePageTitle)("图库管理",!0),(0,r.useRouter)();let{user:e}=(0,a.useAuth)(),[d,y]=(0,s.useState)([]),[b,j]=(0,s.useState)([]),[v,N]=(0,s.useState)(!0),[w,k]=(0,s.useState)("galleries"),[C,_]=(0,s.useState)(1),[S]=(0,s.useState)(20),[E,P]=(0,s.useState)(!0),[M,$]=(0,s.useState)(!1),[T,I]=(0,s.useState)(null),[z,L]=(0,s.useState)(!1),[G,R]=(0,s.useState)({title:"",description:"",category_id:null,password:"",is_visible:!0,sort_order:0}),[A,F]=(0,s.useState)(!1),[O,U]=(0,s.useState)(null),[D,H]=(0,s.useState)(!1),[B,q]=(0,s.useState)({name:"",description:"",icon:"",sort_order:0,is_visible:!0}),[V,W]=(0,s.useState)(!1),[X,K]=(0,s.useState)(null),[Z,J]=(0,s.useState)(!1),[Q,Y]=(0,s.useState)(null),[ee,et]=(0,s.useState)(null),[es,er]=(0,s.useState)(null),[ea,el]=(0,s.useState)({show:!1,type:"success",message:""});(0,s.useEffect)(()=>{ei()},[]);let ei=async()=>{N(!0),_(1);try{await Promise.all([en(1,!0),eo()])}catch(e){console.error("Failed to load data:",e)}finally{N(!1)}},en=async(e=C,t=!1)=>{try{let s=await (0,l.getAdminGalleries)();if(s.success){let r=s.data,a=(e-1)*S,l=a+S,i=r.slice(a,l);t?y(i):y(e=>{let t=new Set(e.map(e=>e.id)),s=i.filter(e=>!t.has(e.id));return[...e,...s]}),P(l<r.length)}}catch(e){console.error("Failed to fetch galleries:",e)}},ec=async()=>{if(M||!E)return;$(!0);let e=C+1;_(e);try{await en(e,!1)}catch(e){console.error("Failed to load more galleries:",e)}finally{$(!1)}},eo=async()=>{try{let e=await (0,l.getAdminGalleryCategories)();e.success&&j(e.data)}catch(e){console.error("Failed to fetch categories:",e)}},ed=(e,t)=>{el({show:!0,type:e,message:t})},em=async()=>{if(!G.title.trim())return void ed("error","请输入图册标题");try{T?.id?(await (0,l.updateGallery)(T.id,G)).success&&(ed("success","图册更新成功"),await en(1,!0),L(!1)):(await (0,l.createGallery)(G)).success&&(ed("success","图册创建成功"),await en(1,!0),L(!1))}catch(e){ed("error",e.response?.data?.message||"操作失败")}},eu=async e=>{if(confirm("确定要删除这个图册吗？这将同时删除图册中的所有图片！"))try{(await (0,l.deleteGallery)(e)).success&&(ed("success","图册删除成功"),await en(1,!0))}catch(e){ed("error",e.response?.data?.message||"删除失败")}},ex=async(e,t)=>{if(t&&0!==t.length){W(!0),K(e);try{let s=new FormData;Array.from(t).forEach(e=>{s.append("images",e)}),(await (0,l.uploadGalleryImages)(e,s)).success&&(ed("success",`成功上传 ${t.length} 张图片`),await en(1,!0),Q?.id===e&&setTimeout(()=>{y(t=>{let s=t.find(t=>t.id===e);return s&&Y(s),t})},100))}catch(e){ed("error",e.response?.data?.message||"上传失败")}finally{W(!1),K(null)}}},ep=()=>{if(null===ee||null===es||!Q?.images||ee===es){et(null),er(null);return}let e=[...Q.images],[t]=e.splice(ee,1);e.splice(es,0,t);let s=e.map((e,t)=>({...e,sort_order:t}));Y({...Q,images:s}),eh(Q.id,s),et(null),er(null)},eh=async(e,t)=>{try{let s=t.map((e,t)=>({id:e.id,sort_order:t}));if((await (0,l.updateGalleryImageOrder)(e,s)).success){ed("success","排序已保存");let s=t.length>0?t[0].path:null;y(t=>t.map(t=>t.id===e?{...t,cover_image:s||void 0}:t)),Q?.id===e&&Y(e=>e?{...e,cover_image:s||void 0}:null)}}catch(e){ed("error",e.response?.data?.message||"排序保存失败")}},eg=async(e,t)=>{if(confirm("确定要删除这张图片吗？"))try{if((await (0,l.deleteGalleryImage)(e,t)).success)if(ed("success","图片删除成功"),Q?.id===e&&Q.images){let s=Q.images.filter(e=>e.id!==t),r=s.length,a=s.length>0?s[0].path:null;Y({...Q,images:s,image_count:r,cover_image:a||void 0}),y(t=>t.map(t=>t.id===e?{...t,image_count:r,cover_image:a||void 0}:t))}else await en(1,!0)}catch(e){ed("error",e.response?.data?.message||"删除失败")}},ef=async()=>{if(!B.name.trim())return void ed("error","请输入分类名称");try{O?.id?(await (0,l.updateGalleryCategory)(O.id,B)).success&&(ed("success","分类更新成功"),await eo(),H(!1)):(await (0,l.createGalleryCategory)(B)).success&&(ed("success","分类创建成功"),await eo(),H(!1))}catch(e){ed("error",e.response?.data?.message||"操作失败")}},ey=async e=>{if(confirm("确定要删除这个分类吗？"))try{(await (0,l.deleteGalleryCategory)(e)).success&&(ed("success","分类删除成功"),await eo())}catch(e){ed("error",e.response?.data?.message||"删除失败")}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.default,{show:ea.show,message:ea.message,type:ea.type,onClose:()=>el({...ea,show:!1})}),(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[(0,t.jsxs)("div",{className:"flex space-x-4 border-b border-gray-200",children:[(0,t.jsx)("button",{onClick:()=>k("galleries"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${"galleries"===w?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"图册管理"}),(0,t.jsx)("button",{onClick:()=>k("categories"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${"categories"===w?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"分类管理"})]}),"galleries"===w&&(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:["共 ",d.length," 个图册"]}),(0,t.jsxs)("button",{onClick:()=>{I(null),R({title:"",description:"",category_id:null,password:"",is_visible:!0,sort_order:0}),L(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[(0,t.jsx)(o.Plus,{className:"w-4 h-4"}),"创建图册"]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[d.map(e=>(0,t.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-md transition-shadow",children:(0,t.jsxs)("div",{className:"flex items-center gap-4 p-4",children:[(0,t.jsxs)("div",{className:"relative w-24 h-24 flex-shrink-0 bg-gradient-to-br from-blue-100 to-blue-200 rounded-lg overflow-hidden",children:[e.cover_image?(0,t.jsx)("img",{src:(0,l.getImageUrl)(e.cover_image),alt:e.title,className:"w-full h-full object-cover"}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,t.jsx)(c.Image,{className:"w-8 h-8 text-blue-400"})}),e.hasPassword&&(0,t.jsx)("div",{className:"absolute top-1 right-1 bg-black/50 backdrop-blur-sm rounded-full p-1",children:(0,t.jsx)(g.Lock,{className:"w-3 h-3 text-white"})}),!e.is_visible&&(0,t.jsx)("div",{className:"absolute top-1 left-1 bg-black/50 backdrop-blur-sm rounded-full px-2 py-0.5 text-xs text-white",children:"未发布"})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h3",{className:"font-medium text-gray-900 mb-1 truncate",children:e.title}),e.description&&(0,t.jsx)("p",{className:"text-sm text-gray-500 line-clamp-2 mb-2",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(c.Image,{className:"w-3 h-3"}),e.image_count||0," 张图片"]}),e.category_id&&b.find(t=>t.id===e.category_id)&&(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(f,{className:"w-3 h-3"}),b.find(t=>t.id===e.category_id)?.name]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[(0,t.jsxs)("label",{className:"cursor-pointer",children:[(0,t.jsx)("input",{type:"file",multiple:!0,accept:"image/*",className:"hidden",onChange:t=>ex(e.id,t.target.files),disabled:V&&X===e.id}),(0,t.jsxs)("div",{className:"flex items-center justify-center gap-1 px-3 py-2 bg-green-600 hover:bg-green-700 text-white rounded text-sm transition-colors whitespace-nowrap",children:[(0,t.jsx)(x.Upload,{className:"w-4 h-4"}),V&&X===e.id?"上传中...":"上传"]})]}),(0,t.jsxs)("button",{onClick:()=>{Y(e),J(!0)},className:"flex items-center justify-center gap-1 px-3 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded text-sm transition-colors whitespace-nowrap",title:"管理图片",children:[(0,t.jsx)(c.Image,{className:"w-4 h-4"}),"管理"]}),(0,t.jsx)("button",{onClick:()=>{I(e),R({title:e.title,description:e.description||"",category_id:e.category_id||null,password:e.password||"",is_visible:!1!==e.is_visible,sort_order:e.sort_order||0}),L(!0)},className:"flex items-center justify-center gap-1 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm transition-colors",title:"编辑",children:(0,t.jsx)(m,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>eu(e.id),className:"flex items-center justify-center gap-1 px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded text-sm transition-colors",title:"删除",children:(0,t.jsx)(u.Trash2,{className:"w-4 h-4"})})]})]})},e.id)),0===d.length&&!v&&(0,t.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,t.jsx)(c.Image,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),(0,t.jsx)("p",{children:"暂无图册"})]}),E&&d.length>0&&(0,t.jsx)("div",{className:"text-center pt-4",children:(0,t.jsx)("button",{onClick:ec,disabled:M,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:M?(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"加载中..."]}):"加载更多"})})]})]}),"categories"===w&&(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:["共 ",b.length," 个分类"]}),(0,t.jsxs)("button",{onClick:()=>{U(null),q({name:"",description:"",icon:"",sort_order:0,is_visible:!0}),H(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[(0,t.jsx)(o.Plus,{className:"w-4 h-4"}),"添加分类"]})]}),0===b.length?(0,t.jsx)("div",{className:"text-center py-8 text-gray-500",children:"暂无分类"}):(0,t.jsx)("div",{className:"bg-gray-50 rounded-lg border border-gray-200 max-h-96 overflow-y-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-100",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"分类名称"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"描述"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"图册数"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"排序"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"状态"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"px-4 py-3",children:(0,t.jsx)("div",{className:"font-medium text-gray-900",children:e.name})}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-gray-500 max-w-xs truncate",children:e.description||"-"}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:e.galleryCount||0}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:e.sort_order}),(0,t.jsx)("td",{className:"px-4 py-3",children:e.is_visible?(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium bg-green-100 text-green-700 rounded",children:[(0,t.jsx)(p.Eye,{className:"w-3 h-3"}),"可见"]}):(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium bg-gray-100 text-gray-700 rounded",children:[(0,t.jsx)(h.EyeOff,{className:"w-3 h-3"}),"隐藏"]})}),(0,t.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{onClick:()=>{U(e),q({name:e.name,description:e.description||"",icon:e.icon||"",sort_order:e.sort_order||0,is_visible:!1!==e.is_visible}),H(!0)},className:"text-blue-600 hover:text-blue-900 text-sm",children:"编辑"}),(0,t.jsx)("button",{onClick:()=>ey(e.id),className:"text-red-600 hover:text-red-900 text-sm",children:"删除"})]})})]},e.id))})]})})]})]})})}),z&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[99999] p-4",children:(0,t.jsx)("div",{className:"bg-white rounded-lg max-w-xl w-full max-h-[90vh] overflow-y-auto",children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),em()},className:"p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-6",children:T?"编辑图册":"创建图册"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["图册标题 ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"text",value:G.title,onChange:e=>R({...G,title:e.target.value}),className:"w-full px-4 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"请输入图册标题"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"图册描述"}),(0,t.jsx)("textarea",{value:G.description,onChange:e=>R({...G,description:e.target.value}),rows:3,className:"w-full px-4 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"请输入图册描述"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"所属分类"}),(0,t.jsxs)("select",{value:G.category_id||"",onChange:e=>R({...G,category_id:e.target.value?Number(e.target.value):null}),className:"w-full px-4 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,t.jsx)("option",{value:"",children:"无分类"}),b.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"访问密码"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:A?"text":"password",name:"gallery-password",autoComplete:"off",value:G.password,onChange:e=>R({...G,password:e.target.value}),className:"w-full px-4 py-2 pr-10 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:T?.hasPassword?"已设置密码，留空则不修改":"留空则无需密码"}),(0,t.jsx)("button",{type:"button",onClick:()=>F(!A),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-tertiary hover:text-text-primary",children:A?(0,t.jsx)(h.EyeOff,{className:"w-4 h-4"}):(0,t.jsx)(p.Eye,{className:"w-4 h-4"})})]}),(0,t.jsx)("p",{className:"text-xs text-text-tertiary mt-1",children:"设置密码后，用户需要输入密码才能查看图片"})]}),(0,t.jsx)("div",{className:"flex items-center gap-4",children:(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:G.is_visible,onChange:e=>R({...G,is_visible:e.target.checked}),className:"w-4 h-4 text-primary-600 border-border-primary rounded focus:ring-2 focus:ring-primary-500"}),(0,t.jsx)("span",{className:"text-sm text-text-primary",children:"前台可见"})]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"排序"}),(0,t.jsx)("input",{type:"number",value:G.sort_order,onChange:e=>R({...G,sort_order:Number(e.target.value)}),className:"w-full px-4 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"数字越小越靠前"})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,t.jsx)("button",{type:"button",onClick:()=>L(!1),className:"flex-1 px-4 py-2 border border-border-primary rounded-lg hover:bg-bg-secondary transition-colors",children:"取消"}),(0,t.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition-colors",children:"保存"})]})]})})}),D&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[99999] p-4",children:(0,t.jsx)("div",{className:"bg-white rounded-lg max-w-md w-full",children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-6",children:O?"编辑分类":"创建分类"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["分类名称 ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"text",value:B.name,onChange:e=>q({...B,name:e.target.value}),className:"w-full px-4 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"请输入分类名称"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"分类描述"}),(0,t.jsx)("textarea",{value:B.description,onChange:e=>q({...B,description:e.target.value}),rows:2,className:"w-full px-4 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"请输入分类描述"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"排序"}),(0,t.jsx)("input",{type:"number",value:B.sort_order,onChange:e=>q({...B,sort_order:Number(e.target.value)}),className:"w-full px-4 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"数字越小越靠前"})]}),(0,t.jsx)("div",{className:"flex items-center gap-4",children:(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:B.is_visible,onChange:e=>q({...B,is_visible:e.target.checked}),className:"w-4 h-4 text-primary-600 border-border-primary rounded focus:ring-2 focus:ring-primary-500"}),(0,t.jsx)("span",{className:"text-sm text-text-primary",children:"前台可见"})]})})]}),(0,t.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,t.jsx)("button",{onClick:()=>H(!1),className:"flex-1 px-4 py-2 border border-border-primary rounded-lg hover:bg-bg-secondary transition-colors",children:"取消"}),(0,t.jsx)("button",{onClick:ef,className:"flex-1 px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition-colors",children:"保存"})]})]})})}),Z&&Q&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[99999] p-4",children:(0,t.jsx)("div",{className:"bg-white rounded-lg max-w-5xl w-full max-h-[90vh] overflow-y-auto",children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-xl font-bold",children:[Q.title," - 图片管理"]}),(0,t.jsxs)("p",{className:"text-sm text-text-tertiary mt-1",children:["共 ",Q.images?.length||0," 张图片 • 拖拽图片可调整排序 • 第一张为封面"]})]}),(0,t.jsx)("button",{onClick:()=>J(!1),className:"p-2 hover:bg-bg-secondary rounded-lg transition-colors",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Q.images&&Q.images.length>0?(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:Q.images.map((e,s)=>(0,t.jsxs)("div",{draggable:!0,onDragStart:()=>{et(s)},onDragOver:e=>{e.preventDefault(),er(s)},onDragEnd:ep,className:`relative group bg-bg-secondary rounded-lg overflow-hidden cursor-move ${ee===s?"opacity-50":""} ${es===s?"ring-2 ring-primary-600":""}`,children:[(0,t.jsxs)("div",{className:"relative w-full pt-[100%]",children:[(0,t.jsx)("img",{src:(0,l.getImageUrl)(e.path),alt:e.filename,className:"absolute inset-0 w-full h-full object-cover"}),(0,t.jsxs)("div",{className:"absolute top-2 left-2 bg-black/70 backdrop-blur-sm text-white px-2 py-1 rounded text-xs font-medium",children:["#",s+1,0===s&&(0,t.jsx)("span",{className:"ml-1",children:"封面"})]}),(0,t.jsx)("button",{onClick:()=>eg(Q.id,e.id),className:"absolute top-2 right-2 bg-red-600 hover:bg-red-700 text-white p-1.5 rounded opacity-0 group-hover:opacity-100 transition-opacity",title:"删除图片",children:(0,t.jsx)(u.Trash2,{className:"w-4 h-4"})})]}),(0,t.jsx)("div",{className:"p-2",children:(0,t.jsx)("p",{className:"text-xs text-text-tertiary truncate",title:e.filename,children:e.filename})})]},e.id))}):(0,t.jsxs)("div",{className:"text-center py-12 text-text-tertiary",children:[(0,t.jsx)(c.Image,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),(0,t.jsx)("p",{children:"暂无图片，请先上传图片"})]}),(0,t.jsx)("div",{className:"flex gap-3 mt-6",children:(0,t.jsx)("button",{onClick:()=>J(!1),className:"flex-1 px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition-colors",children:"完成"})})]})})})]})}e.s(["default",()=>y],903769)}]);