(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,64740,e=>{"use strict";var t=e.i(71645),s=e.i(90499);let a=null;function r(e,l=!1){let[i,c]=(0,t.useState)(a||""),o=(0,s.useOptionalPageTitleContext)();(0,t.useEffect)(()=>{l&&o&&o.setTitle(e)},[e,l,o]),(0,t.useEffect)(()=>{a?c(a):(async()=>{try{let e=await fetch("/api/settings");if(e.ok){let t=await e.json();if(t.success&&t.data){let e={};t.data.forEach(t=>{e[t.key]=t.value});let s=e.siteTitle||"";a=s,c(s)}}}catch(e){console.error("Failed to fetch site title:",e)}})()},[]),(0,t.useEffect)(()=>{let t=document.title;return l?"仪表盘"===e?document.title=`${i} - 后台管理系统`:document.title=`${e} - ${i}后台管理系统`:document.title=`${e} - ${i}`,()=>{document.title=t}},[e,i,l])}e.s(["usePageTitle",()=>r])},40803,e=>{"use strict";var t=e.i(18050),s=e.i(71645),a=e.i(75254);let r=(0,a.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),l=(0,a.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var i=e.i(37727);function c({show:e,message:a,type:c,duration:o=3e3,onClose:n}){let[d,m]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(e){m(!0);let e=setTimeout(()=>{m(!1)},o);return()=>clearTimeout(e)}m(!1)},[e,o]),(0,s.useEffect)(()=>{if(!d&&e){let e=setTimeout(n,300);return()=>clearTimeout(e)}},[d,e,n]);let u=(()=>{switch(c){case"success":return{bg:"bg-green-50 border-green-200",text:"text-green-800",icon:(0,t.jsx)(r,{className:"w-5 h-5 text-green-500"})};case"error":return{bg:"bg-red-50 border-red-200",text:"text-red-800",icon:(0,t.jsx)(l,{className:"w-5 h-5 text-red-500"})};default:return{bg:"bg-blue-50 border-blue-200",text:"text-blue-800",icon:(0,t.jsx)(r,{className:"w-5 h-5 text-blue-500"})}}})();return(0,t.jsx)(t.Fragment,{children:d&&(0,t.jsx)("div",{className:"fixed top-4 right-4 z-[999999] min-w-[300px] max-w-md animate-slide-down",children:(0,t.jsxs)("div",{className:`${u.bg} border rounded-lg shadow-lg p-4 flex items-start gap-3`,children:[(0,t.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:u.icon}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)("p",{className:`${u.text} text-sm font-medium`,children:a})}),(0,t.jsx)("button",{onClick:()=>{m(!1)},className:"flex-shrink-0 text-gray-400 hover:text-gray-600 transition-colors",children:(0,t.jsx)(i.X,{className:"w-4 h-4"})})]})})})}e.s(["default",()=>c],40803)},83171,e=>{"use strict";var t=e.i(18050),s=e.i(71645),a=e.i(18566),r=e.i(98348),l=e.i(9165),i=e.i(64740),c=e.i(40803);let o=[{name:"黄色",value:"#fef68a"},{name:"绿色",value:"#d1fae5"},{name:"蓝色",value:"#bfdbfe"},{name:"粉色",value:"#fce7f3"},{name:"橙色",value:"#fed7aa"},{name:"紫色",value:"#e9d5ff"}];function n(){(0,i.usePageTitle)("便签管理",!0),(0,a.useRouter)();let{user:e}=(0,r.useAuth)(),[n,d]=(0,s.useState)([]),[m,u]=(0,s.useState)([]),[x,h]=(0,s.useState)(!0),[g,p]=(0,s.useState)(null),[y,b]=(0,s.useState)(!1),[f,j]=(0,s.useState)({title:"",content:"",category:"",color:"#fef68a",sort_order:0}),[v,N]=(0,s.useState)({show:!1,type:"success",message:""}),[w,k]=(0,s.useState)(""),[C,S]=(0,s.useState)(""),_=(0,s.useMemo)(()=>n.filter(e=>{let t=w.toLowerCase(),s=e.title.toLowerCase().includes(t)||e.content.toLowerCase().includes(t),a=!C||e.category===C;return s&&a}),[n,w,C]);(0,s.useEffect)(()=>{T()},[]);let T=async()=>{try{let e=await (0,l.getAdminStickyNotes)();if(e.success){let t=Array.isArray(e.data)?e.data:[];d(t)}let t=await (0,l.getAdminStickyNoteCategories)();t.success&&u(t.data||[])}catch(e){N({show:!0,type:"error",message:"加载便签失败"}),d([])}finally{h(!1)}},A=e=>{j({...f,[e.target.name]:e.target.value})},$=async e=>{e.preventDefault();try{g?.id?(await (0,l.updateAdminStickyNote)(g.id,f)).success&&(N({show:!0,type:"success",message:"便签更新成功"}),await T(),E()):(await (0,l.createAdminStickyNote)(f)).success&&(N({show:!0,type:"success",message:"便签添加成功"}),await T(),E())}catch(e){N({show:!0,type:"error",message:e.response?.data?.message||"操作失败"})}},F=async e=>{if(confirm("确定要删除这个便签吗？"))try{(await (0,l.deleteAdminStickyNote)(e)).success&&(N({show:!0,type:"success",message:"便签删除成功"}),await T())}catch(e){N({show:!0,type:"error",message:e.response?.data?.message||"删除失败"})}},E=()=>{j({title:"",content:"",category:"",color:"#fef68a",sort_order:0}),p(null),b(!1)},z=e=>new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.default,{show:v.show,message:v.message,type:v.type,onClose:()=>N({...v,show:!1})}),(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,t.jsxs)("div",{className:"mb-6 space-y-4",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[(0,t.jsx)("button",{onClick:()=>b(!y),className:"btn btn-primary",children:y?"取消":"+ 添加便签"}),(0,t.jsx)("div",{className:"w-full sm:w-auto sm:flex-1 sm:max-w-md",children:(0,t.jsx)("input",{type:"text",placeholder:"搜索便签标题或内容...",value:w,onChange:e=>k(e.target.value),className:"input w-full"})})]}),m.length>0&&(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 items-center",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"分类筛选："}),(0,t.jsx)("button",{onClick:()=>S(""),className:`px-3 py-1 rounded-full text-sm transition-colors ${""===C?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"全部"}),m.map(e=>(0,t.jsx)("button",{onClick:()=>S(e),className:`px-3 py-1 rounded-full text-sm transition-colors ${C===e?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:e},e))]})]}),y&&(0,t.jsxs)("div",{className:"card mb-6",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-4",children:g?"编辑便签":"添加便签"}),(0,t.jsxs)("form",{onSubmit:$,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-2",children:"便签标题"}),(0,t.jsx)("input",{id:"title",name:"title",type:"text",required:!0,value:f.title,onChange:A,className:"input",placeholder:"输入便签标题..."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 mb-2",children:"便签内容"}),(0,t.jsx)("textarea",{id:"content",name:"content",rows:5,required:!0,value:f.content,onChange:A,className:"input",placeholder:"输入便签内容..."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-2",children:"便签分类 (可选)"}),(0,t.jsx)("input",{id:"category",name:"category",type:"text",value:f.category,onChange:A,className:"input",placeholder:"输入分类，如：工作、学习、生活...",list:"category-suggestions"}),m.length>0&&(0,t.jsx)("datalist",{id:"category-suggestions",children:m.map(e=>(0,t.jsx)("option",{value:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"color",className:"block text-sm font-medium text-gray-700 mb-2",children:"便签颜色"}),(0,t.jsx)("div",{className:"flex gap-2",children:o.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>j({...f,color:e.value}),className:`w-12 h-12 rounded-lg border-2 transition-all ${f.color===e.value?"border-gray-800 scale-110 shadow-lg":"border-gray-300 hover:border-gray-500"}`,style:{backgroundColor:e.value},title:e.name},e.value))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"sort_order",className:"block text-sm font-medium text-gray-700 mb-2",children:"排序 (可选)"}),(0,t.jsx)("input",{id:"sort_order",name:"sort_order",type:"number",value:f.sort_order,onChange:A,className:"input",placeholder:"0"})]}),(0,t.jsxs)("div",{className:"flex space-x-4",children:[(0,t.jsx)("button",{type:"submit",className:"btn btn-primary",children:g?"更新":"添加"}),(0,t.jsx)("button",{type:"button",onClick:E,className:"btn btn-secondary",children:"取消"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-lg font-semibold mb-4",children:["便签列表 ",w&&`(找到 ${_.length} 个结果)`]}),0===_.length?(0,t.jsx)("div",{className:"card text-center py-12",children:(0,t.jsx)("p",{className:"text-gray-500",children:w?"没有找到匹配的便签":"还没有添加任何便签"})}):(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:_.map(e=>(0,t.jsxs)("div",{className:"rounded-lg shadow-md p-5 relative transition-transform hover:scale-105",style:{backgroundColor:e.color},children:[(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-800 text-lg mb-2",children:e.title}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[e.category&&(0,t.jsx)("span",{className:"text-xs px-2 py-1 bg-blue-500/70 text-white rounded",children:e.category}),void 0!==e.sort_order&&e.sort_order>0&&(0,t.jsxs)("span",{className:"text-xs px-2 py-1 bg-white/70 text-gray-700 rounded",children:["排序: ",e.sort_order]})]})]}),(0,t.jsx)("p",{className:"text-gray-700 whitespace-pre-wrap mb-4 min-h-[60px]",children:e.content}),(0,t.jsxs)("div",{className:"text-xs text-gray-600 mb-3 space-y-1",children:[e.created_at&&(0,t.jsxs)("div",{children:["创建: ",z(e.created_at)]}),e.updated_at&&e.updated_at!==e.created_at&&(0,t.jsxs)("div",{children:["修改: ",z(e.updated_at)]})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{onClick:()=>{p(e),j({title:e.title,content:e.content,category:e.category||"",color:e.color||"#fef68a",sort_order:e.sort_order||0}),b(!0)},className:"flex-1 px-3 py-1.5 bg-white/80 hover:bg-white text-gray-800 rounded text-sm font-medium transition-colors",children:"编辑"}),(0,t.jsx)("button",{onClick:()=>e.id&&F(e.id),className:"flex-1 px-3 py-1.5 bg-red-500/80 hover:bg-red-500 text-white rounded text-sm font-medium transition-colors",children:"删除"})]})]},e.id))})]})]})})]})}e.s(["default",()=>n])}]);