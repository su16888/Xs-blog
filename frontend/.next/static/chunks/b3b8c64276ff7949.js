(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,64740,e=>{"use strict";var t=e.i(71645),s=e.i(90499);let r=null;function a(e,l=!1){let[i,c]=(0,t.useState)(r||""),n=(0,s.useOptionalPageTitleContext)();(0,t.useEffect)(()=>{l&&n&&n.setTitle(e)},[e,l,n]),(0,t.useEffect)(()=>{r?c(r):(async()=>{try{let e=await fetch("/api/settings");if(e.ok){let t=await e.json();if(t.success&&t.data){let e={};t.data.forEach(t=>{e[t.key]=t.value});let s=e.siteTitle||"";r=s,c(s)}}}catch(e){console.error("Failed to fetch site title:",e)}})()},[]),(0,t.useEffect)(()=>{let t=document.title;return l?"仪表盘"===e?document.title=`${i} - 后台管理系统`:document.title=`${e} - ${i}后台管理系统`:document.title=`${e} - ${i}`,()=>{document.title=t}},[e,i,l])}e.s(["usePageTitle",()=>a])},40803,e=>{"use strict";var t=e.i(18050),s=e.i(71645),r=e.i(75254);let a=(0,r.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),l=(0,r.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var i=e.i(37727);function c({show:e,message:r,type:c,duration:n=3e3,onClose:d}){let[o,m]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(e){m(!0);let e=setTimeout(()=>{m(!1)},n);return()=>clearTimeout(e)}m(!1)},[e,n]),(0,s.useEffect)(()=>{if(!o&&e){let e=setTimeout(d,300);return()=>clearTimeout(e)}},[o,e,d]);let x=(()=>{switch(c){case"success":return{bg:"bg-green-50 border-green-200",text:"text-green-800",icon:(0,t.jsx)(a,{className:"w-5 h-5 text-green-500"})};case"error":return{bg:"bg-red-50 border-red-200",text:"text-red-800",icon:(0,t.jsx)(l,{className:"w-5 h-5 text-red-500"})};default:return{bg:"bg-blue-50 border-blue-200",text:"text-blue-800",icon:(0,t.jsx)(a,{className:"w-5 h-5 text-blue-500"})}}})();return(0,t.jsx)(t.Fragment,{children:o&&(0,t.jsx)("div",{className:"fixed top-4 right-4 z-[999999] min-w-[300px] max-w-md animate-slide-down",children:(0,t.jsxs)("div",{className:`${x.bg} border rounded-lg shadow-lg p-4 flex items-start gap-3`,children:[(0,t.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:x.icon}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)("p",{className:`${x.text} text-sm font-medium`,children:r})}),(0,t.jsx)("button",{onClick:()=>{m(!1)},className:"flex-shrink-0 text-gray-400 hover:text-gray-600 transition-colors",children:(0,t.jsx)(i.X,{className:"w-4 h-4"})})]})})})}e.s(["default",()=>c],40803)},70756,e=>{"use strict";let t=(0,e.i(75254).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["Lock",()=>t],70756)},86536,77705,e=>{"use strict";var t=e.i(75254);let s=(0,t.default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>s],86536);let r=(0,t.default)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);e.s(["EyeOff",()=>r],77705)},7233,69074,e=>{"use strict";var t=e.i(75254);let s=(0,t.default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>s],7233);let r=(0,t.default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);e.s(["Upload",()=>r],69074)},3769,e=>{"use strict";var t=e.i(18050),s=e.i(71645),r=e.i(18566),a=e.i(98348),l=e.i(9165),i=e.i(64740),c=e.i(40803),n=e.i(73708),d=e.i(7233),o=e.i(75254);let m=(0,o.default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var x=e.i(27612),u=e.i(69074),h=e.i(86536),p=e.i(77705),g=e.i(70756);let y=(0,o.default)("folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);function b(){(0,i.usePageTitle)("图库管理",!0),(0,r.useRouter)();let{user:e}=(0,a.useAuth)(),[o,b]=(0,s.useState)([]),[f,j]=(0,s.useState)([]),[v,N]=(0,s.useState)(!0),[w,k]=(0,s.useState)("galleries"),[_,C]=(0,s.useState)(1),[S]=(0,s.useState)(20),[T,E]=(0,s.useState)(!0),[M,$]=(0,s.useState)(!1),[G,P]=(0,s.useState)(null),[z,I]=(0,s.useState)(!1),[A,F]=(0,s.useState)({title:"",description:"",category_id:null,password:"",is_visible:!0,sort_order:0}),[O,L]=(0,s.useState)(!1),[D,U]=(0,s.useState)(null),[q,B]=(0,s.useState)(!1),[H,R]=(0,s.useState)({name:"",description:"",icon:"",sort_order:0,is_visible:!0}),[K,V]=(0,s.useState)(!1),[W,X]=(0,s.useState)(null),[Z,J]=(0,s.useState)(!1),[Q,Y]=(0,s.useState)(null),[ee,et]=(0,s.useState)(null),[es,er]=(0,s.useState)(null),[ea,el]=(0,s.useState)({show:!1,type:"success",message:""});(0,s.useEffect)(()=>{ei()},[]);let ei=async()=>{N(!0),C(1);try{await Promise.all([ec(1,!0),ed()])}catch(e){console.error("Failed to load data:",e)}finally{N(!1)}},ec=async(e=_,t=!1)=>{try{let s=await (0,l.getAdminGalleries)();if(s.success){let r=s.data,a=(e-1)*S,l=a+S,i=r.slice(a,l);t?b(i):b(e=>{let t=new Set(e.map(e=>e.id)),s=i.filter(e=>!t.has(e.id));return[...e,...s]}),E(l<r.length)}}catch(e){console.error("Failed to fetch galleries:",e)}},en=async()=>{if(M||!T)return;$(!0);let e=_+1;C(e);try{await ec(e,!1)}catch(e){console.error("Failed to load more galleries:",e)}finally{$(!1)}},ed=async()=>{try{let e=await (0,l.getAdminGalleryCategories)();e.success&&j(e.data)}catch(e){console.error("Failed to fetch categories:",e)}},eo=(e,t)=>{el({show:!0,type:e,message:t})},em=async()=>{if(!A.title.trim())return void eo("error","请输入图册标题");try{G?.id?(await (0,l.updateGallery)(G.id,A)).success&&(eo("success","图册更新成功"),await ec(1,!0),I(!1)):(await (0,l.createGallery)(A)).success&&(eo("success","图册创建成功"),await ec(1,!0),I(!1))}catch(e){eo("error",e.response?.data?.message||"操作失败")}},ex=async e=>{if(confirm("确定要删除这个图册吗？这将同时删除图册中的所有图片！"))try{(await (0,l.deleteGallery)(e)).success&&(eo("success","图册删除成功"),await ec(1,!0))}catch(e){eo("error",e.response?.data?.message||"删除失败")}},eu=async(e,t)=>{if(t&&0!==t.length){V(!0),X(e);try{let s=new FormData;Array.from(t).forEach(e=>{s.append("images",e)}),(await (0,l.uploadGalleryImages)(e,s)).success&&(eo("success",`成功上传 ${t.length} 张图片`),await ec(1,!0),Q?.id===e&&setTimeout(()=>{b(t=>{let s=t.find(t=>t.id===e);return s&&Y(s),t})},100))}catch(e){eo("error",e.response?.data?.message||"上传失败")}finally{V(!1),X(null)}}},eh=()=>{if(null===ee||null===es||!Q?.images||ee===es){et(null),er(null);return}let e=[...Q.images],[t]=e.splice(ee,1);e.splice(es,0,t);let s=e.map((e,t)=>({...e,sort_order:t}));Y({...Q,images:s}),ep(Q.id,s),et(null),er(null)},ep=async(e,t)=>{try{let s=t.map((e,t)=>({id:e.id,sort_order:t}));if((await (0,l.updateGalleryImageOrder)(e,s)).success){eo("success","排序已保存");let s=t.length>0?t[0].path:null;b(t=>t.map(t=>t.id===e?{...t,cover_image:s||void 0}:t)),Q?.id===e&&Y(e=>e?{...e,cover_image:s||void 0}:null)}}catch(e){eo("error",e.response?.data?.message||"排序保存失败")}},eg=async(e,t)=>{if(confirm("确定要删除这张图片吗？"))try{if((await (0,l.deleteGalleryImage)(e,t)).success)if(eo("success","图片删除成功"),Q?.id===e&&Q.images){let s=Q.images.filter(e=>e.id!==t),r=s.length,a=s.length>0?s[0].path:null;Y({...Q,images:s,image_count:r,cover_image:a||void 0}),b(t=>t.map(t=>t.id===e?{...t,image_count:r,cover_image:a||void 0}:t))}else await ec(1,!0)}catch(e){eo("error",e.response?.data?.message||"删除失败")}},ey=async()=>{if(!H.name.trim())return void eo("error","请输入分类名称");try{D?.id?(await (0,l.updateGalleryCategory)(D.id,H)).success&&(eo("success","分类更新成功"),await ed(),B(!1)):(await (0,l.createGalleryCategory)(H)).success&&(eo("success","分类创建成功"),await ed(),B(!1))}catch(e){eo("error",e.response?.data?.message||"操作失败")}},eb=async e=>{if(confirm("确定要删除这个分类吗？"))try{(await (0,l.deleteGalleryCategory)(e)).success&&(eo("success","分类删除成功"),await ed())}catch(e){eo("error",e.response?.data?.message||"删除失败")}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.default,{show:ea.show,message:ea.message,type:ea.type,onClose:()=>el({...ea,show:!1})}),(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[(0,t.jsxs)("div",{className:"flex space-x-4 border-b border-gray-200",children:[(0,t.jsx)("button",{onClick:()=>k("galleries"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${"galleries"===w?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"图册管理"}),(0,t.jsx)("button",{onClick:()=>k("categories"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${"categories"===w?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"分类管理"})]}),"galleries"===w&&(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:["共 ",o.length," 个图册"]}),(0,t.jsxs)("button",{onClick:()=>{P(null),F({title:"",description:"",category_id:null,password:"",is_visible:!0,sort_order:0}),I(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[(0,t.jsx)(d.Plus,{className:"w-4 h-4"}),"创建图册"]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[o.map(e=>(0,t.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-md transition-shadow",children:(0,t.jsxs)("div",{className:"flex items-center gap-4 p-4",children:[(0,t.jsxs)("div",{className:"relative w-24 h-24 flex-shrink-0 bg-gradient-to-br from-blue-100 to-blue-200 rounded-lg overflow-hidden",children:[e.cover_image?(0,t.jsx)("img",{src:(0,l.getImageUrl)(e.cover_image),alt:e.title,className:"w-full h-full object-cover"}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,t.jsx)(n.Image,{className:"w-8 h-8 text-blue-400"})}),e.hasPassword&&(0,t.jsx)("div",{className:"absolute top-1 right-1 bg-black/50 backdrop-blur-sm rounded-full p-1",children:(0,t.jsx)(g.Lock,{className:"w-3 h-3 text-white"})}),!e.is_visible&&(0,t.jsx)("div",{className:"absolute top-1 left-1 bg-black/50 backdrop-blur-sm rounded-full px-2 py-0.5 text-xs text-white",children:"未发布"})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h3",{className:"font-medium text-gray-900 mb-1 truncate",children:e.title}),e.description&&(0,t.jsx)("p",{className:"text-sm text-gray-500 line-clamp-2 mb-2",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(n.Image,{className:"w-3 h-3"}),e.image_count||0," 张图片"]}),e.category_id&&f.find(t=>t.id===e.category_id)&&(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(y,{className:"w-3 h-3"}),f.find(t=>t.id===e.category_id)?.name]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[(0,t.jsxs)("label",{className:"cursor-pointer",children:[(0,t.jsx)("input",{type:"file",multiple:!0,accept:"image/*",className:"hidden",onChange:t=>eu(e.id,t.target.files),disabled:K&&W===e.id}),(0,t.jsxs)("div",{className:"flex items-center justify-center gap-1 px-3 py-2 bg-green-600 hover:bg-green-700 text-white rounded text-sm transition-colors whitespace-nowrap",children:[(0,t.jsx)(u.Upload,{className:"w-4 h-4"}),K&&W===e.id?"上传中...":"上传"]})]}),(0,t.jsxs)("button",{onClick:()=>{Y(e),J(!0)},className:"flex items-center justify-center gap-1 px-3 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded text-sm transition-colors whitespace-nowrap",title:"管理图片",children:[(0,t.jsx)(n.Image,{className:"w-4 h-4"}),"管理"]}),(0,t.jsx)("button",{onClick:()=>{P(e),F({title:e.title,description:e.description||"",category_id:e.category_id||null,password:e.password||"",is_visible:!1!==e.is_visible,sort_order:e.sort_order||0}),I(!0)},className:"flex items-center justify-center gap-1 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm transition-colors",title:"编辑",children:(0,t.jsx)(m,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>ex(e.id),className:"flex items-center justify-center gap-1 px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded text-sm transition-colors",title:"删除",children:(0,t.jsx)(x.Trash2,{className:"w-4 h-4"})})]})]})},e.id)),0===o.length&&!v&&(0,t.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,t.jsx)(n.Image,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),(0,t.jsx)("p",{children:"暂无图册"})]}),T&&o.length>0&&(0,t.jsx)("div",{className:"text-center pt-4",children:(0,t.jsx)("button",{onClick:en,disabled:M,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:M?(0,t.jsx)("span",{className:"flex items-center gap-2",children:(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"})}):"加载更多"})})]})]}),"categories"===w&&(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:["共 ",f.length," 个分类"]}),(0,t.jsxs)("button",{onClick:()=>{U(null),R({name:"",description:"",icon:"",sort_order:0,is_visible:!0}),B(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[(0,t.jsx)(d.Plus,{className:"w-4 h-4"}),"添加分类"]})]}),0===f.length?(0,t.jsx)("div",{className:"text-center py-8 text-gray-500",children:"暂无分类"}):(0,t.jsx)("div",{className:"bg-gray-50 rounded-lg border border-gray-200 max-h-96 overflow-y-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-100",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"分类名称"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"描述"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"图册数"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"排序"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"状态"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:f.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"px-4 py-3",children:(0,t.jsx)("div",{className:"font-medium text-gray-900",children:e.name})}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-gray-500 max-w-xs truncate",children:e.description||"-"}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:e.galleryCount||0}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:e.sort_order}),(0,t.jsx)("td",{className:"px-4 py-3",children:e.is_visible?(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium bg-green-100 text-green-700 rounded",children:[(0,t.jsx)(h.Eye,{className:"w-3 h-3"}),"可见"]}):(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium bg-gray-100 text-gray-700 rounded",children:[(0,t.jsx)(p.EyeOff,{className:"w-3 h-3"}),"隐藏"]})}),(0,t.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{onClick:()=>{U(e),R({name:e.name,description:e.description||"",icon:e.icon||"",sort_order:e.sort_order||0,is_visible:!1!==e.is_visible}),B(!0)},className:"text-blue-600 hover:text-blue-900 text-sm",children:"编辑"}),(0,t.jsx)("button",{onClick:()=>eb(e.id),className:"text-red-600 hover:text-red-900 text-sm",children:"删除"})]})})]},e.id))})]})})]})]})})}),z&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[99999] p-4",children:(0,t.jsx)("div",{className:"bg-white rounded-lg max-w-xl w-full max-h-[90vh] overflow-y-auto",children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),em()},className:"p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-6",children:G?"编辑图册":"创建图册"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["图册标题 ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"text",value:A.title,onChange:e=>F({...A,title:e.target.value}),className:"w-full px-4 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"请输入图册标题"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"图册描述"}),(0,t.jsx)("textarea",{value:A.description,onChange:e=>F({...A,description:e.target.value}),rows:3,className:"w-full px-4 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"请输入图册描述"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"所属分类"}),(0,t.jsxs)("select",{value:A.category_id||"",onChange:e=>F({...A,category_id:e.target.value?Number(e.target.value):null}),className:"w-full px-4 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,t.jsx)("option",{value:"",children:"无分类"}),f.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"访问密码"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:O?"text":"password",name:"gallery-password",autoComplete:"off",value:A.password,onChange:e=>F({...A,password:e.target.value}),className:"w-full px-4 py-2 pr-10 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:G?.hasPassword?"已设置密码，留空则不修改":"留空则无需密码"}),(0,t.jsx)("button",{type:"button",onClick:()=>L(!O),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-tertiary hover:text-text-primary",children:O?(0,t.jsx)(p.EyeOff,{className:"w-4 h-4"}):(0,t.jsx)(h.Eye,{className:"w-4 h-4"})})]}),(0,t.jsx)("p",{className:"text-xs text-text-tertiary mt-1",children:"设置密码后，用户需要输入密码才能查看图片"})]}),(0,t.jsx)("div",{className:"flex items-center gap-4",children:(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:A.is_visible,onChange:e=>F({...A,is_visible:e.target.checked}),className:"w-4 h-4 text-primary-600 border-border-primary rounded focus:ring-2 focus:ring-primary-500"}),(0,t.jsx)("span",{className:"text-sm text-text-primary",children:"前台可见"})]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"排序"}),(0,t.jsx)("input",{type:"number",value:A.sort_order,onChange:e=>F({...A,sort_order:Number(e.target.value)}),className:"w-full px-4 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"数字越小越靠前"})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,t.jsx)("button",{type:"button",onClick:()=>I(!1),className:"flex-1 px-4 py-2 border border-border-primary rounded-lg hover:bg-bg-secondary transition-colors",children:"取消"}),(0,t.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition-colors",children:"保存"})]})]})})}),q&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[99999] p-4",children:(0,t.jsx)("div",{className:"bg-white rounded-lg max-w-md w-full",children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-6",children:D?"编辑分类":"创建分类"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["分类名称 ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"text",value:H.name,onChange:e=>R({...H,name:e.target.value}),className:"w-full px-4 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"请输入分类名称"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"分类描述"}),(0,t.jsx)("textarea",{value:H.description,onChange:e=>R({...H,description:e.target.value}),rows:2,className:"w-full px-4 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"请输入分类描述"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"排序"}),(0,t.jsx)("input",{type:"number",value:H.sort_order,onChange:e=>R({...H,sort_order:Number(e.target.value)}),className:"w-full px-4 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"数字越小越靠前"})]}),(0,t.jsx)("div",{className:"flex items-center gap-4",children:(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:H.is_visible,onChange:e=>R({...H,is_visible:e.target.checked}),className:"w-4 h-4 text-primary-600 border-border-primary rounded focus:ring-2 focus:ring-primary-500"}),(0,t.jsx)("span",{className:"text-sm text-text-primary",children:"前台可见"})]})})]}),(0,t.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,t.jsx)("button",{onClick:()=>B(!1),className:"flex-1 px-4 py-2 border border-border-primary rounded-lg hover:bg-bg-secondary transition-colors",children:"取消"}),(0,t.jsx)("button",{onClick:ey,className:"flex-1 px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition-colors",children:"保存"})]})]})})}),Z&&Q&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[99999] p-4",children:(0,t.jsx)("div",{className:"bg-white rounded-lg max-w-5xl w-full max-h-[90vh] overflow-y-auto",children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-xl font-bold",children:[Q.title," - 图片管理"]}),(0,t.jsxs)("p",{className:"text-sm text-text-tertiary mt-1",children:["共 ",Q.images?.length||0," 张图片 • 拖拽图片可调整排序 • 第一张为封面"]})]}),(0,t.jsx)("button",{onClick:()=>J(!1),className:"p-2 hover:bg-bg-secondary rounded-lg transition-colors",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Q.images&&Q.images.length>0?(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:Q.images.map((e,s)=>(0,t.jsxs)("div",{draggable:!0,onDragStart:()=>{et(s)},onDragOver:e=>{e.preventDefault(),er(s)},onDragEnd:eh,className:`relative group bg-bg-secondary rounded-lg overflow-hidden cursor-move ${ee===s?"opacity-50":""} ${es===s?"ring-2 ring-primary-600":""}`,children:[(0,t.jsxs)("div",{className:"relative w-full pt-[100%]",children:[(0,t.jsx)("img",{src:(0,l.getImageUrl)(e.path),alt:e.filename,className:"absolute inset-0 w-full h-full object-cover"}),(0,t.jsxs)("div",{className:"absolute top-2 left-2 bg-black/70 backdrop-blur-sm text-white px-2 py-1 rounded text-xs font-medium",children:["#",s+1,0===s&&(0,t.jsx)("span",{className:"ml-1",children:"封面"})]}),(0,t.jsx)("button",{onClick:()=>eg(Q.id,e.id),className:"absolute top-2 right-2 bg-red-600 hover:bg-red-700 text-white p-1.5 rounded opacity-0 group-hover:opacity-100 transition-opacity",title:"删除图片",children:(0,t.jsx)(x.Trash2,{className:"w-4 h-4"})})]}),(0,t.jsx)("div",{className:"p-2",children:(0,t.jsx)("p",{className:"text-xs text-text-tertiary truncate",title:e.filename,children:e.filename})})]},e.id))}):(0,t.jsxs)("div",{className:"text-center py-12 text-text-tertiary",children:[(0,t.jsx)(n.Image,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),(0,t.jsx)("p",{children:"暂无图片，请先上传图片"})]}),(0,t.jsx)("div",{className:"flex gap-3 mt-6",children:(0,t.jsx)("button",{onClick:()=>J(!1),className:"flex-1 px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition-colors",children:"完成"})})]})})})]})}e.s(["default",()=>b],3769)}]);