(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,340803,e=>{"use strict";var t=e.i(843476),s=e.i(271645),r=e.i(846932),a=e.i(88653),l=e.i(475254);let i=(0,l.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),n=(0,l.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var o=e.i(37727);function c({show:e,message:l,type:c,duration:d=3e3,onClose:u}){let[m,h]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(e){h(!0);let e=setTimeout(()=>{h(!1)},d);return()=>clearTimeout(e)}h(!1)},[e,d]),(0,s.useEffect)(()=>{if(!m&&e){let e=setTimeout(u,300);return()=>clearTimeout(e)}},[m,e,u]);let x=(()=>{switch(c){case"success":return{bg:"bg-green-50 border-green-200",text:"text-green-800",icon:(0,t.jsx)(i,{className:"w-5 h-5 text-green-500"})};case"error":return{bg:"bg-red-50 border-red-200",text:"text-red-800",icon:(0,t.jsx)(n,{className:"w-5 h-5 text-red-500"})};default:return{bg:"bg-blue-50 border-blue-200",text:"text-blue-800",icon:(0,t.jsx)(i,{className:"w-5 h-5 text-blue-500"})}}})();return(0,t.jsx)(a.AnimatePresence,{children:m&&(0,t.jsx)(r.motion.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.9},transition:{duration:.2},className:"fixed top-4 right-4 z-[999999] min-w-[300px] max-w-md",children:(0,t.jsxs)("div",{className:`${x.bg} border rounded-lg shadow-lg p-4 flex items-start gap-3`,children:[(0,t.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:x.icon}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)("p",{className:`${x.text} text-sm font-medium`,children:l})}),(0,t.jsx)("button",{onClick:()=>{h(!1)},className:"flex-shrink-0 text-gray-400 hover:text-gray-600 transition-colors",children:(0,t.jsx)(o.X,{className:"w-4 h-4"})})]})})})}e.s(["default",()=>c],340803)},88653,e=>{"use strict";e.i(247167);var t=e.i(843476),s=e.i(271645),r=e.i(231178),a=e.i(947414),l=e.i(674008),i=e.i(821476),n=e.i(772846),o=s,c=e.i(737806);function d(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}class u extends o.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,s=(0,n.isHTMLElement)(e)&&e.offsetWidth||0,r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft,r.right=s-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function m({children:e,isPresent:r,anchorX:a,root:l}){let i=(0,o.useId)(),n=(0,o.useRef)(null),m=(0,o.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:h}=(0,o.useContext)(c.MotionConfigContext),x=function(...e){return s.useCallback(function(...e){return t=>{let s=!1,r=e.map(e=>{let r=d(e,t);return s||"function"!=typeof r||(s=!0),r});if(s)return()=>{for(let t=0;t<r.length;t++){let s=r[t];"function"==typeof s?s():d(e[t],null)}}}}(...e),e)}(n,e?.ref);return(0,o.useInsertionEffect)(()=>{let{width:e,height:t,top:s,left:o,right:c}=m.current;if(r||!n.current||!e||!t)return;let d="left"===a?`left: ${o}`:`right: ${c}`;n.current.dataset.motionPopId=i;let u=document.createElement("style");h&&(u.nonce=h);let x=l??document.head;return x.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${t}px !important;
            ${d}px !important;
            top: ${s}px !important;
          }
        `),()=>{x.contains(u)&&x.removeChild(u)}},[r]),(0,t.jsx)(u,{isPresent:r,childRef:n,sizeRef:m,children:o.cloneElement(e,{ref:x})})}let h=({children:e,initial:r,isPresent:l,onExitComplete:n,custom:o,presenceAffectsLayout:c,mode:d,anchorX:u,root:h})=>{let f=(0,a.useConstant)(x),p=(0,s.useId)(),g=!0,y=(0,s.useMemo)(()=>(g=!1,{id:p,initial:r,isPresent:l,custom:o,onExitComplete:e=>{for(let t of(f.set(e,!0),f.values()))if(!t)return;n&&n()},register:e=>(f.set(e,!1),()=>f.delete(e))}),[l,f,n]);return c&&g&&(y={...y}),(0,s.useMemo)(()=>{f.forEach((e,t)=>f.set(t,!1))},[l]),s.useEffect(()=>{l||f.size||!n||n()},[l]),"popLayout"===d&&(e=(0,t.jsx)(m,{isPresent:l,anchorX:u,root:h,children:e})),(0,t.jsx)(i.PresenceContext.Provider,{value:y,children:e})};function x(){return new Map}var f=e.i(464978);let p=e=>e.key||"";function g(e){let t=[];return s.Children.forEach(e,e=>{(0,s.isValidElement)(e)&&t.push(e)}),t}let y=({children:e,custom:i,initial:n=!0,onExitComplete:o,presenceAffectsLayout:c=!0,mode:d="sync",propagate:u=!1,anchorX:m="left",root:x})=>{let[y,b]=(0,f.usePresence)(u),j=(0,s.useMemo)(()=>g(e),[e]),v=u&&!y?[]:j.map(p),w=(0,s.useRef)(!0),N=(0,s.useRef)(j),C=(0,a.useConstant)(()=>new Map),[k,S]=(0,s.useState)(j),[E,$]=(0,s.useState)(j);(0,l.useIsomorphicLayoutEffect)(()=>{w.current=!1,N.current=j;for(let e=0;e<E.length;e++){let t=p(E[e]);v.includes(t)?C.delete(t):!0!==C.get(t)&&C.set(t,!1)}},[E,v.length,v.join("-")]);let P=[];if(j!==k){let e=[...j];for(let t=0;t<E.length;t++){let s=E[t],r=p(s);v.includes(r)||(e.splice(t,0,s),P.push(s))}return"wait"===d&&P.length&&(e=P),$(g(e)),S(j),null}let{forceRender:_}=(0,s.useContext)(r.LayoutGroupContext);return(0,t.jsx)(t.Fragment,{children:E.map(e=>{let s=p(e),r=(!u||!!y)&&(j===E||v.includes(s));return(0,t.jsx)(h,{isPresent:r,initial:(!w.current||!!n)&&void 0,custom:i,presenceAffectsLayout:c,mode:d,root:x,onExitComplete:r?void 0:()=>{if(!C.has(s))return;C.set(s,!0);let e=!0;C.forEach(t=>{t||(e=!1)}),e&&(_?.(),$(N.current),u&&b?.(),o&&o())},anchorX:m,children:e},s)})})};e.s(["AnimatePresence",()=>y],88653)},964740,e=>{"use strict";var t=e.i(271645),s=e.i(690499);let r=null;function a(e,l=!1){let[i,n]=(0,t.useState)(r||""),o=(0,s.useOptionalPageTitleContext)();(0,t.useEffect)(()=>{l&&o&&o.setTitle(e)},[e,l,o]),(0,t.useEffect)(()=>{r?n(r):(async()=>{try{let e=await fetch("/api/settings");if(e.ok){let t=await e.json();if(t.success&&t.data){let e={};t.data.forEach(t=>{e[t.key]=t.value});let s=e.siteTitle||"";r=s,n(s)}}}catch(e){console.error("Failed to fetch site title:",e)}})()},[]),(0,t.useEffect)(()=>{let t=document.title;return l?"仪表盘"===e?document.title=`${i} - 后台管理系统`:document.title=`${e} - ${i}后台管理系统`:document.title=`${e} - ${i}`,()=>{document.title=t}},[e,i,l])}e.s(["usePageTitle",()=>a])},983171,e=>{"use strict";var t=e.i(843476),s=e.i(271645),r=e.i(618566),a=e.i(557951),l=e.i(209165),i=e.i(964740),n=e.i(340803);let o=[{name:"黄色",value:"#fef68a"},{name:"绿色",value:"#d1fae5"},{name:"蓝色",value:"#bfdbfe"},{name:"粉色",value:"#fce7f3"},{name:"橙色",value:"#fed7aa"},{name:"紫色",value:"#e9d5ff"}];function c(){(0,i.usePageTitle)("便签管理",!0),(0,r.useRouter)();let{user:e}=(0,a.useAuth)(),[c,d]=(0,s.useState)([]),[u,m]=(0,s.useState)([]),[h,x]=(0,s.useState)(!0),[f,p]=(0,s.useState)(null),[g,y]=(0,s.useState)(!1),[b,j]=(0,s.useState)({title:"",content:"",category:"",color:"#fef68a",sort_order:0}),[v,w]=(0,s.useState)({show:!1,type:"success",message:""}),[N,C]=(0,s.useState)(""),[k,S]=(0,s.useState)(""),E=(0,s.useMemo)(()=>c.filter(e=>{let t=N.toLowerCase(),s=e.title.toLowerCase().includes(t)||e.content.toLowerCase().includes(t),r=!k||e.category===k;return s&&r}),[c,N,k]);(0,s.useEffect)(()=>{$()},[]);let $=async()=>{try{let e=await (0,l.getAdminStickyNotes)();if(e.success){let t=Array.isArray(e.data)?e.data:[];d(t)}let t=await (0,l.getAdminStickyNoteCategories)();t.success&&m(t.data||[])}catch(e){w({show:!0,type:"error",message:"加载便签失败"}),d([])}finally{x(!1)}},P=e=>{j({...b,[e.target.name]:e.target.value})},_=async e=>{e.preventDefault();try{f?.id?(await (0,l.updateAdminStickyNote)(f.id,b)).success&&(w({show:!0,type:"success",message:"便签更新成功"}),await $(),A()):(await (0,l.createAdminStickyNote)(b)).success&&(w({show:!0,type:"success",message:"便签添加成功"}),await $(),A())}catch(e){w({show:!0,type:"error",message:e.response?.data?.message||"操作失败"})}},T=async e=>{if(confirm("确定要删除这个便签吗？"))try{(await (0,l.deleteAdminStickyNote)(e)).success&&(w({show:!0,type:"success",message:"便签删除成功"}),await $())}catch(e){w({show:!0,type:"error",message:e.response?.data?.message||"删除失败"})}},A=()=>{j({title:"",content:"",category:"",color:"#fef68a",sort_order:0}),p(null),y(!1)},R=e=>new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.default,{show:v.show,message:v.message,type:v.type,onClose:()=>w({...v,show:!1})}),(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,t.jsxs)("div",{className:"mb-6 space-y-4",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[(0,t.jsx)("button",{onClick:()=>y(!g),className:"btn btn-primary",children:g?"取消":"+ 添加便签"}),(0,t.jsx)("div",{className:"w-full sm:w-auto sm:flex-1 sm:max-w-md",children:(0,t.jsx)("input",{type:"text",placeholder:"搜索便签标题或内容...",value:N,onChange:e=>C(e.target.value),className:"input w-full"})})]}),u.length>0&&(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 items-center",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"分类筛选："}),(0,t.jsx)("button",{onClick:()=>S(""),className:`px-3 py-1 rounded-full text-sm transition-colors ${""===k?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"全部"}),u.map(e=>(0,t.jsx)("button",{onClick:()=>S(e),className:`px-3 py-1 rounded-full text-sm transition-colors ${k===e?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:e},e))]})]}),g&&(0,t.jsxs)("div",{className:"card mb-6",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-4",children:f?"编辑便签":"添加便签"}),(0,t.jsxs)("form",{onSubmit:_,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-2",children:"便签标题"}),(0,t.jsx)("input",{id:"title",name:"title",type:"text",required:!0,value:b.title,onChange:P,className:"input",placeholder:"输入便签标题..."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 mb-2",children:"便签内容"}),(0,t.jsx)("textarea",{id:"content",name:"content",rows:5,required:!0,value:b.content,onChange:P,className:"input",placeholder:"输入便签内容..."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-2",children:"便签分类 (可选)"}),(0,t.jsx)("input",{id:"category",name:"category",type:"text",value:b.category,onChange:P,className:"input",placeholder:"输入分类，如：工作、学习、生活...",list:"category-suggestions"}),u.length>0&&(0,t.jsx)("datalist",{id:"category-suggestions",children:u.map(e=>(0,t.jsx)("option",{value:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"color",className:"block text-sm font-medium text-gray-700 mb-2",children:"便签颜色"}),(0,t.jsx)("div",{className:"flex gap-2",children:o.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>j({...b,color:e.value}),className:`w-12 h-12 rounded-lg border-2 transition-all ${b.color===e.value?"border-gray-800 scale-110 shadow-lg":"border-gray-300 hover:border-gray-500"}`,style:{backgroundColor:e.value},title:e.name},e.value))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"sort_order",className:"block text-sm font-medium text-gray-700 mb-2",children:"排序 (可选)"}),(0,t.jsx)("input",{id:"sort_order",name:"sort_order",type:"number",value:b.sort_order,onChange:P,className:"input",placeholder:"0"})]}),(0,t.jsxs)("div",{className:"flex space-x-4",children:[(0,t.jsx)("button",{type:"submit",className:"btn btn-primary",children:f?"更新":"添加"}),(0,t.jsx)("button",{type:"button",onClick:A,className:"btn btn-secondary",children:"取消"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-lg font-semibold mb-4",children:["便签列表 ",N&&`(找到 ${E.length} 个结果)`]}),0===E.length?(0,t.jsx)("div",{className:"card text-center py-12",children:(0,t.jsx)("p",{className:"text-gray-500",children:N?"没有找到匹配的便签":"还没有添加任何便签"})}):(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:E.map(e=>(0,t.jsxs)("div",{className:"rounded-lg shadow-md p-5 relative transition-transform hover:scale-105",style:{backgroundColor:e.color},children:[(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-800 text-lg mb-2",children:e.title}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[e.category&&(0,t.jsx)("span",{className:"text-xs px-2 py-1 bg-blue-500/70 text-white rounded",children:e.category}),void 0!==e.sort_order&&e.sort_order>0&&(0,t.jsxs)("span",{className:"text-xs px-2 py-1 bg-white/70 text-gray-700 rounded",children:["排序: ",e.sort_order]})]})]}),(0,t.jsx)("p",{className:"text-gray-700 whitespace-pre-wrap mb-4 min-h-[60px]",children:e.content}),(0,t.jsxs)("div",{className:"text-xs text-gray-600 mb-3 space-y-1",children:[e.created_at&&(0,t.jsxs)("div",{children:["创建: ",R(e.created_at)]}),e.updated_at&&e.updated_at!==e.created_at&&(0,t.jsxs)("div",{children:["修改: ",R(e.updated_at)]})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{onClick:()=>{p(e),j({title:e.title,content:e.content,category:e.category||"",color:e.color||"#fef68a",sort_order:e.sort_order||0}),y(!0)},className:"flex-1 px-3 py-1.5 bg-white/80 hover:bg-white text-gray-800 rounded text-sm font-medium transition-colors",children:"编辑"}),(0,t.jsx)("button",{onClick:()=>e.id&&T(e.id),className:"flex-1 px-3 py-1.5 bg-red-500/80 hover:bg-red-500 text-white rounded text-sm font-medium transition-colors",children:"删除"})]})]},e.id))})]})]})})]})}e.s(["default",()=>c])}]);