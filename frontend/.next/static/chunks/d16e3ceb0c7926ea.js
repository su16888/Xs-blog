(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,472450,930380,814984,153951,e=>{"use strict";var t=e.i(420061),r=e.i(436484),n=e.i(204108),a=e.i(997803);let o={tokenize:function(e,t,r){let o=this,l=o.events[o.events.length-1],s=l&&"linePrefix"===l[1].type?l[2].sliceSerialize(l[1],!0).length:0,c=0;return function(t){return e.enter("mathFlow"),e.enter("mathFlowFence"),e.enter("mathFlowFenceSequence"),function t(a){return 36===a?(e.consume(a),c++,t):c<2?r(a):(e.exit("mathFlowFenceSequence"),(0,n.factorySpace)(e,u,"whitespace")(a))}(t)};function u(t){return null===t||(0,a.markdownLineEnding)(t)?d(t):(e.enter("mathFlowFenceMeta"),e.enter("chunkString",{contentType:"string"}),function t(n){return null===n||(0,a.markdownLineEnding)(n)?(e.exit("chunkString"),e.exit("mathFlowFenceMeta"),d(n)):36===n?r(n):(e.consume(n),t)}(t))}function d(r){return(e.exit("mathFlowFence"),o.interrupt)?t(r):e.attempt(i,h,f)(r)}function h(t){return e.attempt({tokenize:g,partial:!0},f,m)(t)}function m(t){return(s?(0,n.factorySpace)(e,p,"linePrefix",s+1):p)(t)}function p(t){return null===t?f(t):(0,a.markdownLineEnding)(t)?e.attempt(i,h,f)(t):(e.enter("mathFlowValue"),function t(r){return null===r||(0,a.markdownLineEnding)(r)?(e.exit("mathFlowValue"),p(r)):(e.consume(r),t)}(t))}function f(r){return e.exit("mathFlow"),t(r)}function g(e,t,r){let i=0;return(0,n.factorySpace)(e,function(t){return e.enter("mathFlowFence"),e.enter("mathFlowFenceSequence"),function t(a){return 36===a?(i++,e.consume(a),t):i<c?r(a):(e.exit("mathFlowFenceSequence"),(0,n.factorySpace)(e,l,"whitespace")(a))}(t)},"linePrefix",o.parser.constructs.disable.null.includes("codeIndented")?void 0:4);function l(n){return null===n||(0,a.markdownLineEnding)(n)?(e.exit("mathFlowFence"),t(n)):r(n)}}},concrete:!0,name:"mathFlow"},i={tokenize:function(e,t,r){let n=this;return function(r){return null===r?t(r):(e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),a)};function a(e){return n.parser.lazy[n.now().line]?r(e):t(e)}},partial:!0};function l(e){let t,r,n=e.length-4,a=3;if(("lineEnding"===e[3][1].type||"space"===e[a][1].type)&&("lineEnding"===e[n][1].type||"space"===e[n][1].type)){for(t=a;++t<n;)if("mathTextData"===e[t][1].type){e[n][1].type="mathTextPadding",e[a][1].type="mathTextPadding",a+=2,n-=2;break}}for(t=a-1,n++;++t<=n;)void 0===r?t!==n&&"lineEnding"!==e[t][1].type&&(r=t):(t===n||"lineEnding"===e[t][1].type)&&(e[r][1].type="mathTextData",t!==r+2&&(e[r][1].end=e[t-1][1].end,e.splice(r+2,t-r-2),n-=t-r-2,t=r+2),r=void 0);return e}function s(e){return 36!==e||"characterEscape"===this.events[this.events.length-1][1].type}let c={};function u(e){let n,i=e||c,u=this.data(),d=u.micromarkExtensions||(u.micromarkExtensions=[]),h=u.fromMarkdownExtensions||(u.fromMarkdownExtensions=[]),m=u.toMarkdownExtensions||(u.toMarkdownExtensions=[]);d.push({flow:{36:o},text:{36:(null==(n=(i||{}).singleDollarTextMath)&&(n=!0),{tokenize:function(e,t,r){let o,i,l=0;return function(t){return e.enter("mathText"),e.enter("mathTextSequence"),function t(a){return 36===a?(e.consume(a),l++,t):l<2&&!n?r(a):(e.exit("mathTextSequence"),s(a))}(t)};function s(n){return null===n?r(n):36===n?(i=e.enter("mathTextSequence"),o=0,function r(n){return 36===n?(e.consume(n),o++,r):o===l?(e.exit("mathTextSequence"),e.exit("mathText"),t(n)):(i.type="mathTextData",c(n))}(n)):32===n?(e.enter("space"),e.consume(n),e.exit("space"),s):(0,a.markdownLineEnding)(n)?(e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),s):(e.enter("mathTextData"),c(n))}function c(t){return null===t||32===t||36===t||(0,a.markdownLineEnding)(t)?(e.exit("mathTextData"),s(t)):(e.consume(t),c)}},resolve:l,previous:s,name:"mathText"})}}),h.push(function(){return{enter:{mathFlow:function(e){this.enter({type:"math",meta:null,value:"",data:{hName:"pre",hChildren:[{type:"element",tagName:"code",properties:{className:["language-math","math-display"]},children:[]}]}},e)},mathFlowFenceMeta:function(){this.buffer()},mathText:function(e){this.enter({type:"inlineMath",value:"",data:{hName:"code",hProperties:{className:["language-math","math-inline"]},hChildren:[]}},e),this.buffer()}},exit:{mathFlow:function(e){let r=this.resume().replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),n=this.stack[this.stack.length-1];(0,t.ok)("math"===n.type),this.exit(e),n.value=r;let a=n.data.hChildren[0];(0,t.ok)("element"===a.type),(0,t.ok)("code"===a.tagName),a.children.push({type:"text",value:r}),this.data.mathFlowInside=void 0},mathFlowFence:function(){this.data.mathFlowInside||(this.buffer(),this.data.mathFlowInside=!0)},mathFlowFenceMeta:function(){let e=this.resume(),r=this.stack[this.stack.length-1];(0,t.ok)("math"===r.type),r.meta=e},mathFlowValue:e,mathText:function(e){let r=this.resume(),n=this.stack[this.stack.length-1];(0,t.ok)("inlineMath"===n.type),this.exit(e),n.value=r,n.data.hChildren.push({type:"text",value:r})},mathTextData:e}};function e(e){this.config.enter.data.call(this,e),this.config.exit.data.call(this,e)}}()),m.push(function(e){let t=(e||{}).singleDollarTextMath;return null==t&&(t=!0),n.peek=function(){return"$"},{unsafe:[{character:"\r",inConstruct:"mathFlowMeta"},{character:"\n",inConstruct:"mathFlowMeta"},{character:"$",after:t?void 0:"\\$",inConstruct:"phrasing"},{character:"$",inConstruct:"mathFlowMeta"},{atBreak:!0,character:"$",after:"\\$"}],handlers:{math:function(e,t,n,a){let o=e.value||"",i=n.createTracker(a),l="$".repeat(Math.max((0,r.longestStreak)(o,"$")+1,2)),s=n.enter("mathFlow"),c=i.move(l);if(e.meta){let t=n.enter("mathFlowMeta");c+=i.move(n.safe(e.meta,{after:"\n",before:c,encode:["$"],...i.current()})),t()}return c+=i.move("\n"),o&&(c+=i.move(o+"\n")),c+=i.move(l),s(),c},inlineMath:n}};function n(e,r,n){let a=e.value||"",o=1;for(!t&&o++;RegExp("(^|[^$])"+"\\$".repeat(o)+"([^$]|$)").test(a);)o++;let i="$".repeat(o);/[^ \r\n]/.test(a)&&(/^[ \r\n]/.test(a)&&/[ \r\n]$/.test(a)||/^\$|\$$/.test(a))&&(a=" "+a+" ");let l=-1;for(;++l<n.unsafe.length;){let e,t=n.unsafe[l];if(!t.atBreak)continue;let r=n.compilePattern(t);for(;e=r.exec(a);){let t=e.index;10===a.codePointAt(t)&&13===a.codePointAt(t-1)&&t--,a=a.slice(0,t)+" "+a.slice(e.index+1)}}return i+a+i}}(i))}e.s(["default",()=>u],472450);var d=e.i(346367),h=e.i(676044);function m(e,t){let r=function(e,t){switch(e.nodeType){case 1:return function(e,t){let r=e.namespaceURI,n=r===h.webNamespaces.svg?d.s:d.h,a=r===h.webNamespaces.html?e.tagName.toLowerCase():e.tagName,o=r===h.webNamespaces.html&&"template"===a?e.content:e,i=e.getAttributeNames(),l={},s=-1;for(;++s<i.length;)l[i[s]]=e.getAttribute(i[s])||"";return n(a,l,p(o,t))}(e,t);case 3:return{type:"text",value:e.nodeValue||""};case 8:return{type:"comment",value:e.nodeValue||""};case 9:case 11:return function(e,t){return{type:"root",children:p(e,t)}}(e,t);case 10:return{type:"doctype"};default:return}}(e,t);return r&&t.afterTransform&&t.afterTransform(e,r),r}function p(e,t){let r=e.childNodes,n=[],a=-1;for(;++a<r.length;){let e=m(r[a],t);void 0!==e&&n.push(e)}return n}let f=new DOMParser;var g=e.i(457579);let x=function(e,t,r){let n=(0,g.convert)(r);if(!e||!e.type||!e.children)throw Error("Expected parent node");if("number"==typeof t){if(t<0||t===1/0)throw Error("Expected positive finite number as index")}else if((t=e.children.indexOf(t))<0)throw Error("Expected child node or index");for(;++t<e.children.length;)if(n(e.children[t],t,e))return e.children[t]},y=function(e){if(null==e)return v;if("string"==typeof e){var t;return t=e,b(function(e){return e.tagName===t})}if("object"==typeof e){var r=e;let t=[],n=-1;for(;++n<r.length;)t[n]=y(r[n]);return b(function(...e){let r=-1;for(;++r<t.length;)if(t[r].apply(this,e))return!0;return!1})}if("function"==typeof e)return b(e);throw Error("Expected function, string, or array as `test`")};function b(e){return function(t,r,n){var a;return!!(null!==(a=t)&&"object"==typeof a&&"type"in a&&"tagName"in a&&e.call(this,t,"number"==typeof r?r:void 0,n||void 0))}}function v(e){return!!(e&&"object"==typeof e&&"type"in e&&"element"===e.type&&"tagName"in e&&"string"==typeof e.tagName)}let w=/\n/g,k=/[\t ]+/g,C=y("br"),N=y(function(e){return"td"===e.tagName||"th"===e.tagName}),M=y("p"),E=y("tr"),j=y(["datalist","head","noembed","noframes","noscript","rp","script","style","template","title",function(e){return!!(e.properties||{}).hidden},function(e){return"dialog"===e.tagName&&!(e.properties||{}).open}]),L=y(["address","article","aside","blockquote","body","caption","center","dd","dialog","dir","dl","dt","div","figure","figcaption","footer","form,","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","legend","li","listing","main","menu","nav","ol","p","plaintext","pre","section","ul","xmp"]);function T(e,t){let r,n=String(e.value),a=[],o=[],i=0;for(;i<=n.length;){w.lastIndex=i;let e=w.exec(n),r=e&&"index"in e?e.index:n.length;a.push(function(e,t,r){let n,a=[],o=0;for(;o<e.length;){k.lastIndex=o;let r=k.exec(e);n=r?r.index:e.length,o||n||!r||t||a.push(""),o!==n&&a.push(e.slice(o,n)),o=r?n+r[0].length:n}return o===n||r||a.push(""),a.join(" ")}(n.slice(i,r).replace(/[\u061C\u200E\u200F\u202A-\u202E\u2066-\u2069]/g,""),0!==i||t.breakBefore,r!==n.length||t.breakAfter)),i=r+1}let l=-1;for(;++l<a.length;)8203===a[l].charCodeAt(a[l].length-1)||l<a.length-1&&8203===a[l+1].charCodeAt(0)?(o.push(a[l]),r=void 0):a[l]?("number"==typeof r&&o.push(r),o.push(a[l]),r=0):(0===l||l===a.length-1)&&o.push(0);return o}function S(e,t){if("element"===e.type){let r=e.properties||{};switch(e.tagName){case"listing":case"plaintext":case"xmp":return"pre";case"nobr":return"nowrap";case"pre":return r.wrap?"pre-wrap":"pre";case"td":case"th":return r.noWrap?"nowrap":t.whitespace;case"textarea":return"pre-wrap"}}return t.whitespace}var F=e.i(716400),$=e.i(733644);let A={},B=[];function R(e){let t=e||A;return function(e,r){(0,$.visitParents)(e,"element",function(e,n){let a,o=Array.isArray(e.properties.className)?e.properties.className:B,i=o.includes("language-math"),l=o.includes("math-display"),s=o.includes("math-inline"),c=l;if(!i&&!l&&!s)return;let u=n[n.length-1],d=e;if("code"===e.tagName&&i&&u&&"element"===u.type&&"pre"===u.tagName&&(d=u,u=n[n.length-2],c=!0),!u)return;let h=function(e,t){let r,n="children"in e?e.children:[],a=L(e),o=S(e,{whitespace:(t||{}).whitespace||"normal",breakBefore:!1,breakAfter:!1}),i=[];("text"===e.type||"comment"===e.type)&&i.push(...T(e,{whitespace:o,breakBefore:!0,breakAfter:!0}));let l=-1;for(;++l<n.length;)i.push(...function e(t,r,n){return"element"===t.type?function(t,r,n){let a,o,i=S(t,n),l=t.children||[],s=-1,c=[];if(j(t))return c;for(C(t)||E(t)&&x(r,t,E)?o="\n":M(t)?(a=2,o=2):L(t)&&(a=1,o=1);++s<l.length;)c=c.concat(e(l[s],t,{whitespace:i,breakBefore:s?void 0:a,breakAfter:s<l.length-1?C(l[s+1]):o}));return N(t)&&x(r,t,N)&&c.push("	"),a&&c.unshift(a),o&&c.push(o),c}(t,r,n):"text"===t.type?"normal"===n.whitespace?T(t,n):[String(t.value)]:[]}(n[l],e,{whitespace:o,breakBefore:l?void 0:a,breakAfter:l<n.length-1?C(n[l+1]):a}));let s=[];for(l=-1;++l<i.length;){let e=i[l];"number"==typeof e?void 0!==r&&e>r&&(r=e):e&&(void 0!==r&&r>-1&&s.push("\n".repeat(r)||" "),r=-1,s.push(e))}return s.join("")}(d,{whitespace:"pre"});try{a=F.default.renderToString(h,{...t,displayMode:c,throwOnError:!0})}catch(i){let o=i.name.toLowerCase();r.message("Could not render math with KaTeX",{ancestors:[...n,e],cause:i,place:e.position,ruleId:o,source:"rehype-katex"});try{a=F.default.renderToString(h,{...t,displayMode:c,strict:"ignore",throwOnError:!1})}catch{a=[{type:"element",tagName:"span",properties:{className:["katex-error"],style:"color:"+(t.errorColor||"#cc0000"),title:String(i)},children:[{type:"text",value:h}]}]}}if("string"==typeof a){var p,g,y;let e;a=(p=a,g={fragment:!0},m(g?.fragment?(y=p,(e=document.createElement("template")).innerHTML=y,e.content):f.parseFromString(p,"text/html"),{})||{type:"root",children:[]}).children}let b=u.children.indexOf(d);return u.children.splice(b,1,...a),$.SKIP})}}e.s(["default",()=>R],930380);var D=e.i(843476),P=e.i(271645);function W({text:e,className:t=""}){let[r,n]=(0,P.useState)(!1),a=async()=>{try{await navigator.clipboard.writeText(e),n(!0),setTimeout(()=>n(!1),2e3)}catch(e){console.error("Failed to copy text: ",e)}};return(0,D.jsx)("button",{onClick:a,className:`
        copy-button
        absolute top-2 right-2
        px-2 py-1 text-[9px]
        backdrop-blur-sm
        rounded
        transition-all duration-200
        opacity-100 sm:opacity-0 sm:group-hover:opacity-100
        shadow-lg
        z-10
        ${t}
      `,title:"复制代码",children:r?(0,D.jsxs)("span",{className:"flex items-center gap-0.5",children:[(0,D.jsx)("svg",{className:"w-3 h-3 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,D.jsx)("span",{className:"text-emerald-400 font-medium",children:"已复制"})]}):(0,D.jsxs)("span",{className:"flex items-center gap-0.5",children:[(0,D.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),(0,D.jsx)("span",{className:"font-medium",children:"复制"})]})})}e.s(["default",()=>W],814984);var q=e.i(475254);let z=(0,q.default)("maximize-2",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]]);var O=e.i(440160),U=e.i(37727),X=e.i(554212),I=e.i(520354);let Y=(0,q.default)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var H=e.i(174080);let V=null;function K({chart:t,className:r=""}){let n=(0,P.useRef)(null),a=(0,P.useRef)(null),[o,i]=(0,P.useState)(""),[l,s]=(0,P.useState)(null),[c,u]=(0,P.useState)(!1),[d,h]=(0,P.useState)(1),[m,p]=(0,P.useState)({x:0,y:0}),[f,g]=(0,P.useState)(!1),x=(0,P.useRef)(null),y=(0,P.useRef)(null),b=(0,P.useRef)(!1),v=(0,P.useRef)({x:0,y:0}),w=(0,P.useRef)({x:0,y:0}),k=(0,P.useRef)(1),C=(0,P.useRef)(0),N=(0,P.useRef)({x:0,y:0}),M=(0,P.useRef)(!1),E=(0,P.useRef)({x:0,y:0,scrollLeft:0});(0,P.useEffect)(()=>{w.current=m},[m]),(0,P.useEffect)(()=>{k.current=d},[d]),(0,P.useEffect)(()=>{g(!0)},[]),(0,P.useEffect)(()=>{let r=async()=>{try{V||(V=await e.A(695802));let r=V.default;r.initialize({startOnLoad:!1,theme:"base",securityLevel:"loose",fontFamily:"system-ui, -apple-system, sans-serif",themeVariables:{primaryTextColor:"#54697b",secondaryTextColor:"#54697b",tertiaryTextColor:"#54697b",textColor:"#54697b",nodeTextColor:"#54697b",primaryColor:"#e8f4fc",primaryBorderColor:"#9ecbea",secondaryColor:"#fff5e6",secondaryBorderColor:"#f5c77e",tertiaryColor:"#f0f0f0",tertiaryBorderColor:"#cccccc",lineColor:"#54697b",labelTextColor:"#54697b",actorTextColor:"#54697b",signalTextColor:"#54697b",labelBoxBkgColor:"#e8f4fc",labelBoxBorderColor:"#9ecbea",noteBkgColor:"#fff5e6",noteTextColor:"#54697b",noteBorderColor:"#f5c77e",pieTextColor:"#54697b",taskTextColor:"#54697b",taskTextOutsideColor:"#54697b",sectionBkgColor:"#e8f4fc",classText:"#54697b"},flowchart:{useMaxWidth:!1,htmlLabels:!0,curve:"basis",padding:20,nodeSpacing:50,rankSpacing:50},sequence:{useMaxWidth:!1,wrap:!1,width:180,height:60,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35},gantt:{useMaxWidth:!1,leftPadding:75,rightPadding:20,barHeight:20,barGap:4},mindmap:{useMaxWidth:!1,padding:20},pie:{useMaxWidth:!1},er:{useMaxWidth:!1},journey:{useMaxWidth:!1},gitGraph:{useMaxWidth:!1},class:{useMaxWidth:!1},state:{useMaxWidth:!1}});let n=`mermaid-${Math.random().toString(36).substr(2,9)}`,a=document.createElement("div");a.id=n,a.style.cssText="position:fixed;left:-9999px;top:0;width:3000px;visibility:hidden;",document.body.appendChild(a);try{let{svg:e}=await r.render(`${n}-svg`,t.trim(),a),o=document.createElement("div");o.innerHTML=e;let l=o.querySelector("svg");if(l){let e=l.getAttribute("viewBox"),t=0,r=0;if(e){let n=e.split(/[\s,]+/).map(Number);n.length>=4&&n[2]>0&&n[3]>0&&(t=n[2],r=n[3])}if(!t||!r){let e=l.getAttribute("width"),n=l.getAttribute("height");e&&(t=parseFloat(e)||0),n&&(r=parseFloat(n)||0)}t=Math.max(t,300),r=Math.max(r,200),l.removeAttribute("style"),l.setAttribute("width",String(t)),l.setAttribute("height",String(r)),l.style.cssText=`width:${t}px;height:${r}px;min-width:${t}px;max-width:none;display:block;`}i(o.innerHTML),s(null)}finally{document.body.removeChild(a)}}catch(e){console.error("Mermaid render error:",e),s(e instanceof Error?e.message:"图表渲染失败")}};t&&f&&r()},[t,f]);let j=(0,P.useCallback)(async()=>{if(o&&n.current)try{let e=n.current.querySelector("svg");if(!e)return;let t=e.cloneNode(!0);t.style.maxWidth="none",t.querySelectorAll("*").forEach(e=>{(e instanceof HTMLElement||e instanceof SVGElement)&&(e.style.maxWidth="none")});let r=800,a=600,o=e.getAttribute("viewBox");if(o){let e=o.split(/\s+|,/).map(Number);!(e.length>=4)||isNaN(e[2])||isNaN(e[3])||(r=e[2],a=e[3])}if(r<=0||a<=0){let t=e.getBBox?.();t&&(r=t.width+2*t.x,a=t.height+2*t.y)}r=Math.max(r,400),a=Math.max(a,300),t.setAttribute("width",String(r)),t.setAttribute("height",String(a)),t.setAttribute("viewBox",`0 0 ${r} ${a}`),t.style.width=`${r}px`,t.style.height=`${a}px`;let i=new XMLSerializer().serializeToString(t);i.includes("xmlns")||(i=i.replace("<svg",'<svg xmlns="http://www.w3.org/2000/svg"'));let l=document.createElement("canvas");l.width=2*r,l.height=2*a;let s=l.getContext("2d");if(!s)return;s.fillStyle="#ffffff",s.fillRect(0,0,l.width,l.height);let c=new Blob([i],{type:"image/svg+xml;charset=utf-8"}),u=URL.createObjectURL(c),d=new Image;d.onload=()=>{s.drawImage(d,0,0,l.width,l.height),URL.revokeObjectURL(u);let e=document.createElement("a");e.download=`mermaid-chart-${Date.now()}.png`,e.href=l.toDataURL("image/png",1),e.click()},d.onerror=()=>{URL.revokeObjectURL(u);let e=document.createElement("a");e.download=`mermaid-chart-${Date.now()}.svg`,e.href=URL.createObjectURL(c),e.click(),URL.revokeObjectURL(e.href)},d.src=u}catch(e){console.error("Download error:",e)}},[o]),L=(0,P.useCallback)(e=>{e.preventDefault(),e.stopPropagation();let t=n.current?.querySelector("svg");if(t){let e=t.getBoundingClientRect().width||parseFloat(t.getAttribute("width")||"800"),r=t.getBoundingClientRect().height||parseFloat(t.getAttribute("height")||"600");h(Math.min((window.innerWidth-160)/e,(window.innerHeight-160)/r,1))}else h(1);p({x:0,y:0}),u(!0)},[]),T=(0,P.useCallback)(()=>{u(!1)},[]),S=(0,P.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),h(e=>Math.min(e+.25,5))},[]),F=(0,P.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),h(e=>Math.max(e-.25,.25))},[]),$=(0,P.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),h(1),p({x:0,y:0})},[]),A=(0,P.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),j()},[j]),B=(0,P.useCallback)(e=>{e.preventDefault(),e.stopPropagation();let t=e.deltaY>0?-.1:.1;h(e=>Math.max(.25,Math.min(5,e+t)))},[]),R=(0,P.useCallback)(e=>{0===e.button&&(e.preventDefault(),b.current=!0,v.current={x:e.clientX-w.current.x,y:e.clientY-w.current.y})},[]),W=(0,P.useCallback)(e=>{if(!b.current||!x.current)return;e.preventDefault();let t={x:e.clientX-v.current.x,y:e.clientY-v.current.y};w.current=t,x.current.style.transform=`translate(${t.x}px, ${t.y}px) scale(${k.current})`},[]),q=(0,P.useCallback)(()=>{b.current&&(b.current=!1,p({...w.current}))},[]),K=e=>{if(e.length<2)return 0;let t=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(t*t+r*r)},_=e=>e.length<2?{x:e[0].clientX,y:e[0].clientY}:{x:(e[0].clientX+e[1].clientX)/2,y:(e[0].clientY+e[1].clientY)/2},G=(0,P.useCallback)(e=>{1===e.touches.length?(b.current=!0,v.current={x:e.touches[0].clientX-w.current.x,y:e.touches[0].clientY-w.current.y}):2===e.touches.length&&(b.current=!1,C.current=K(e.touches),N.current=_(e.touches))},[]),Z=(0,P.useCallback)(e=>{if(e.preventDefault(),e.stopPropagation(),1===e.touches.length&&b.current&&x.current){let t={x:e.touches[0].clientX-v.current.x,y:e.touches[0].clientY-v.current.y};w.current=t,x.current.style.transform=`translate(${t.x}px, ${t.y}px) scale(${k.current})`}else if(2===e.touches.length&&x.current){let t=K(e.touches),r=_(e.touches);if(C.current>0){let e=t/C.current,r=Math.max(.25,Math.min(5,k.current*e));k.current=r}let n=r.x-N.current.x,a=r.y-N.current.y,o={x:w.current.x+n,y:w.current.y+a};w.current=o,x.current.style.transform=`translate(${o.x}px, ${o.y}px) scale(${k.current})`,C.current=t,N.current=r}},[]),J=(0,P.useCallback)(()=>{b.current=!1,C.current=0,p({...w.current}),h(k.current)},[]),Q=(0,P.useCallback)(e=>{0===e.button&&a.current&&(e.preventDefault(),M.current=!0,E.current={x:e.clientX,y:e.clientY,scrollLeft:a.current.scrollLeft},a.current.style.cursor="grabbing",a.current.style.userSelect="none")},[]),ee=(0,P.useCallback)(e=>{if(!M.current||!a.current)return;e.preventDefault();let t=e.clientX-E.current.x;a.current.scrollLeft=E.current.scrollLeft-t},[]),et=(0,P.useCallback)(()=>{a.current&&(M.current=!1,a.current.style.cursor="grab",a.current.style.userSelect="")},[]),er=(0,P.useCallback)(()=>{a.current&&(M.current=!1,a.current.style.cursor="grab",a.current.style.userSelect="")},[]),en=(0,P.useCallback)(e=>{a.current&&1===e.touches.length&&(M.current=!0,E.current={x:e.touches[0].clientX,y:e.touches[0].clientY,scrollLeft:a.current.scrollLeft})},[]),ea=(0,P.useCallback)(e=>{if(!M.current||!a.current||1!==e.touches.length)return;let t=e.touches[0].clientX-E.current.x;a.current.scrollLeft=E.current.scrollLeft-t},[]),eo=(0,P.useCallback)(()=>{M.current=!1},[]);(0,P.useEffect)(()=>{let e=a.current;if(e)return e.addEventListener("touchstart",en,{passive:!0}),e.addEventListener("touchmove",ea,{passive:!0}),e.addEventListener("touchend",eo,{passive:!0}),()=>{e.removeEventListener("touchstart",en),e.removeEventListener("touchmove",ea),e.removeEventListener("touchend",eo)}},[en,ea,eo]),(0,P.useEffect)(()=>{if(!o||!a.current)return;let e=setTimeout(()=>{let e=a.current;if(!e)return;let t=e.scrollWidth,r=e.clientWidth;t>r&&(e.scrollLeft=(t-r)/2)},50);return()=>clearTimeout(e)},[o]),(0,P.useEffect)(()=>{if(!c||!y.current)return;let e=y.current;return e.addEventListener("wheel",B,{passive:!1}),e.addEventListener("touchstart",G,{passive:!0}),e.addEventListener("touchmove",Z,{passive:!1}),e.addEventListener("touchend",J,{passive:!0}),()=>{e.removeEventListener("wheel",B),e.removeEventListener("touchstart",G),e.removeEventListener("touchmove",Z),e.removeEventListener("touchend",J)}},[c,B,G,Z,J]),(0,P.useEffect)(()=>{let e=e=>{"Escape"===e.key&&c&&T()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[c,T]),(0,P.useEffect)(()=>(c?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[c]);let ei=(0,P.useCallback)(e=>{e.stopPropagation()},[]),el=(0,P.useCallback)(e=>{e.target===e.currentTarget&&T()},[T]);if(l)return(0,D.jsxs)("div",{className:`mermaid-error p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg ${r}`,children:[(0,D.jsxs)("p",{className:"text-red-600 dark:text-red-400 text-sm",children:["Mermaid 图表渲染失败: ",l]}),(0,D.jsx)("pre",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400 overflow-auto",children:t})]});if(!o)return(0,D.jsx)("div",{className:`mermaid-loading p-8 flex items-center justify-center bg-bg-secondary rounded-lg ${r}`,children:(0,D.jsx)("div",{className:"animate-spin w-6 h-6 border-2 border-primary-500 border-t-transparent rounded-full"})});let es=c&&f?(0,H.createPortal)((0,D.jsxs)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/80 backdrop-blur-sm",onClick:el,children:[(0,D.jsx)("button",{onClick:T,className:"absolute top-4 right-4 z-10 p-2 bg-white/95 dark:bg-gray-800/95 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full border border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors shadow-lg",title:"关闭 (ESC)",children:(0,D.jsx)(U.X,{className:"w-6 h-6"})}),(0,D.jsx)("div",{ref:y,className:"absolute inset-0 flex items-center justify-center overflow-hidden",style:{touchAction:"none"},children:(0,D.jsxs)("div",{ref:x,className:"relative select-none",style:{transform:`translate(${m.x}px, ${m.y}px) scale(${d})`,transformOrigin:"center center"},children:[(0,D.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-2xl mermaid-preview-svg pointer-events-none",style:{userSelect:"none"},dangerouslySetInnerHTML:{__html:o}}),(0,D.jsx)("div",{className:"absolute inset-0 cursor-grab active:cursor-grabbing",onClick:ei,onMouseDown:R,onMouseMove:W,onMouseUp:q,onMouseLeave:q})]})}),(0,D.jsxs)("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-10 flex items-center gap-2 px-4 py-2 bg-white/95 dark:bg-gray-800/95 rounded-full border border-gray-200 dark:border-gray-700 shadow-lg",children:[(0,D.jsx)("button",{onClick:F,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors",title:"缩小",children:(0,D.jsx)(I.ZoomOut,{className:"w-5 h-5"})}),(0,D.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-300 min-w-[60px] text-center font-medium",children:[Math.round(100*d),"%"]}),(0,D.jsx)("button",{onClick:S,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors",title:"放大",children:(0,D.jsx)(X.ZoomIn,{className:"w-5 h-5"})}),(0,D.jsx)("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600"}),(0,D.jsx)("button",{onClick:$,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors",title:"重置",children:(0,D.jsx)(Y,{className:"w-5 h-5"})}),(0,D.jsx)("button",{onClick:A,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors",title:"下载",children:(0,D.jsx)(O.Download,{className:"w-5 h-5"})})]})]}),document.body):null;return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)("div",{className:`mermaid-container relative my-4 ${r}`,children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,D.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-gray-500 dark:text-gray-400",children:[(0,D.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:(0,D.jsx)("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"})}),(0,D.jsx)("span",{className:"font-medium",children:"Mermaid"})]}),(0,D.jsxs)("div",{className:"flex items-center gap-1",children:[(0,D.jsx)("button",{type:"button",onClick:L,className:"p-1.5 bg-bg-primary hover:bg-bg-secondary border border-border-primary rounded-lg text-text-secondary hover:text-primary-500 transition-colors shadow-sm",title:"放大预览",children:(0,D.jsx)(z,{className:"w-4 h-4"})}),(0,D.jsx)("button",{type:"button",onClick:A,className:"p-1.5 bg-bg-primary hover:bg-bg-secondary border border-border-primary rounded-lg text-text-secondary hover:text-primary-500 transition-colors shadow-sm",title:"下载图片",children:(0,D.jsx)(O.Download,{className:"w-4 h-4"})})]})]}),(0,D.jsx)("div",{ref:a,className:"mermaid-scroll-container rounded-lg border border-border-primary p-4 cursor-grab",onMouseDown:Q,onMouseMove:ee,onMouseUp:et,onMouseLeave:er,children:(0,D.jsx)("div",{ref:n,className:"mermaid-svg-wrapper inline-block",dangerouslySetInnerHTML:{__html:o}})})]}),es]})}e.s(["default",()=>K],153951)}]);