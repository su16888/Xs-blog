(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15570,e=>{"use strict";var r=e.i(18050),t=e.i(71645),a=e.i(9165),s=e.i(32423),o=e.i(44739),i=e.i(26261),l=e.i(96433);function c(){let[e,c]=(0,t.useState)([]),[n,d]=(0,t.useState)(null),[m,u]=(0,t.useState)(!1),[x,b]=(0,t.useState)(""),[p,g]=(0,t.useState)("success"),[h,y]=(0,t.useState)(!1),[f,v]=(0,t.useState)(!1),j={themeType:"default",footerCopyright:`\xa9 ${new Date().getFullYear()} 个人主页. All rights reserved.`,showTopNavbar:"true",showWapSidebar:"true"},[w,N]=(0,t.useState)(j),[C,S]=(0,t.useState)({title:"联系我们",description:"有任何问题都可以通过这里进行提交你的想法！",browserTitle:"留言板",browserSubtitle:""}),[T,k]=(0,t.useState)(!1),[_,F]=(0,t.useState)({name:"",contact:"",category_id:"",content:"",captcha:""});(0,t.useEffect)(()=>{W(),P()},[]),(0,t.useEffect)(()=>{document.title=C.browserTitle},[C.browserTitle]);let P=async()=>{try{let[e,r]=await Promise.all([(0,a.getSettings)(),(0,a.getPageText)("messages")]);if(e.success&&e.data){let r={};e.data.forEach(e=>{r[e.key]=e.value}),N({themeType:r.themeType||"default",footerCopyright:r.footerCopyright||`\xa9 ${new Date().getFullYear()} 个人主页. All rights reserved.`,showTopNavbar:r.showTopNavbar||"true",showWapSidebar:r.showWapSidebar||"true"})}r.success&&r.data&&(S({title:r.data.title||"联系我们",description:r.data.description||"有任何问题都可以通过这里进行提交你的想法！",browserTitle:r.data.browserTitle||"留言板",browserSubtitle:r.data.browserSubtitle||""}),k(!0))}catch(e){console.error("Failed to load settings:",e),k(!0)}},W=async()=>{try{let e=await (0,a.getMessageCategories)();e.success&&c(e.data)}catch(e){console.error("加载数据失败:",e)}},A=async()=>{try{let e=await (0,a.getCaptcha)();if(e.success&&e.data){let r=e.data.image||e.data.svg,t=r.startsWith("data:")?r:`data:image/svg+xml;utf8,${encodeURIComponent(r)}`;d({id:e.data.id,image:t})}}catch(e){console.error("加载验证码失败:",e)}},E=async e=>{if(e.preventDefault(),b(""),!_.name.trim()){b("请输入您的称呼"),g("error"),setTimeout(()=>b(""),3e3);return}if(!_.contact.trim()){b("请输入联系方式"),g("error"),setTimeout(()=>b(""),3e3);return}if(!_.content.trim()){b("请输入留言内容"),g("error"),setTimeout(()=>b(""),3e3);return}await A(),y(!0)},q=async()=>{if(!_.captcha.trim()){b("请输入验证码"),g("error"),setTimeout(()=>b(""),3e3);return}try{v(!0);let e={..._,category_id:_.category_id?parseInt(_.category_id):null,captcha:{id:n?.id,text:_.captcha}},r=await (0,a.submitMessage)(e);r.success?(b("留言提交成功，我们会尽快处理！"),g("success"),F({name:"",contact:"",category_id:"",content:"",captcha:""}),y(!1)):(b(r.message||"提交失败，请重试"),g("error"),A())}catch(e){console.error("提交留言失败:",e),b(e.response?.data?.message||e.message||"提交失败，请重试"),g("error"),A()}finally{v(!1),setTimeout(()=>b(""),3e3)}},z=e=>{let{name:r,value:t}=e.target;F(e=>({...e,[r]:t}))},D=w?.showWapSidebar!=="false";return(0,r.jsxs)("main",{className:"min-h-screen bg-bg-primary relative flex flex-col hide-scrollbar",children:[(0,r.jsx)(i.default,{}),(0,r.jsx)(l.default,{}),(0,r.jsx)(s.default,{showWapSidebar:D}),(0,r.jsxs)("div",{className:"relative z-0 flex-1 flex flex-col",children:[(0,r.jsx)("div",{className:"h-16"}),(0,r.jsxs)("div",{className:"container mx-auto px-4 max-w-6xl py-8",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-text-primary mb-2",children:C.title}),(0,r.jsx)("p",{className:"text-text-secondary",children:C.description})]}),(0,r.jsxs)("div",{className:"bg-bg-secondary rounded-lg shadow-lg p-6 max-w-2xl mx-auto",children:[x&&(0,r.jsx)("div",{className:"mb-6 p-4 rounded-lg border",style:"success"===p?{backgroundColor:"var(--success-bg)",color:"var(--success-text)",borderColor:"var(--success-border)"}:{backgroundColor:"var(--error-bg)",color:"var(--error-text)",borderColor:"var(--error-border)"},children:x}),(0,r.jsxs)("form",{onSubmit:E,className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-text-primary mb-2",children:"用户称呼 *"}),(0,r.jsx)("input",{type:"text",id:"name",name:"name",value:_.name,onChange:z,required:!0,className:"w-full px-3 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-0 focus:border-border-primary bg-bg-primary text-text-primary",placeholder:"请输入您的称呼"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"contact",className:"block text-sm font-medium text-text-primary mb-2",children:"联系方式 *"}),(0,r.jsx)("input",{type:"text",id:"contact",name:"contact",value:_.contact,onChange:z,required:!0,className:"w-full px-3 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-0 focus:border-border-primary bg-bg-primary text-text-primary",placeholder:"请输入您的联系方式（邮箱、微信、电话等）"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"category_id",className:"block text-sm font-medium text-text-primary mb-2",children:"留言分类"}),(0,r.jsxs)("select",{id:"category_id",name:"category_id",value:_.category_id,onChange:z,className:"w-full px-3 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-0 focus:border-border-primary bg-bg-primary text-text-primary",children:[(0,r.jsx)("option",{value:"",children:"请选择分类"}),e.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"content",className:"block text-sm font-medium text-text-primary mb-2",children:"留言内容 *"}),(0,r.jsx)("textarea",{id:"content",name:"content",value:_.content,onChange:z,required:!0,rows:6,className:"w-full px-3 py-2 border border-border-primary rounded-lg focus:outline-none focus:ring-0 focus:border-border-primary bg-bg-primary text-text-primary resize-none",placeholder:"请输入您的留言内容..."})]}),(0,r.jsx)("div",{className:"pt-4",children:(0,r.jsx)("button",{type:"submit",disabled:m,className:"w-full bg-primary-500 hover:bg-primary-600 disabled:bg-primary-300 text-white font-medium py-3 px-4 rounded-lg transition-colors focus:outline-none focus:ring-0",children:m?"提交中...":"提交留言"})})]})]})]}),(0,r.jsxs)("footer",{className:"mt-auto border-t border-border-primary py-6 text-center text-sm text-text-tertiary",children:[(0,r.jsx)("p",{children:w.footerCopyright}),(0,r.jsx)(o.default,{})]})]}),h&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",onClick:()=>{y(!1),F({..._,captcha:""})},children:(0,r.jsxs)("div",{className:"bg-bg-secondary rounded-xl max-w-md w-full p-6 shadow-2xl border border-border-primary relative",onClick:e=>e.stopPropagation(),children:[(0,r.jsx)("button",{onClick:()=>{y(!1),F({..._,captcha:""})},className:"absolute top-4 right-4 text-text-tertiary hover:text-text-primary transition-colors text-2xl w-8 h-8 flex items-center justify-center rounded-full hover:bg-bg-tertiary",children:"×"}),(0,r.jsx)("h3",{className:"text-xl font-bold text-text-primary mb-6 text-center",children:"请输入验证码"}),(0,r.jsx)("div",{className:"flex justify-center mb-6",children:n&&(0,r.jsx)("div",{onClick:A,className:"cursor-pointer border-2 border-border-primary rounded-lg overflow-hidden bg-bg-primary hover:border-primary-500 transition-colors",title:"点击刷新验证码",children:(0,r.jsx)("img",{src:n.image,alt:"验证码",className:"h-[50px] w-[150px] object-contain"})})}),(0,r.jsx)("p",{className:"text-text-secondary text-sm text-center mb-4",children:"点击图片可刷新验证码"}),(0,r.jsx)("input",{type:"text",value:_.captcha,onChange:e=>F({..._,captcha:e.target.value}),placeholder:"请输入验证码",className:"w-full px-4 py-3 border border-border-primary rounded-lg bg-bg-primary text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent mb-6 text-center text-lg tracking-wider",autoFocus:!0,onKeyPress:e=>{"Enter"===e.key&&q()}}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("button",{onClick:()=>{y(!1),F({..._,captcha:""})},className:"flex-1 px-4 py-2.5 bg-bg-tertiary text-text-primary rounded-lg hover:bg-border-primary transition-colors font-medium",children:"取消"}),(0,r.jsx)("button",{onClick:q,disabled:f,className:"flex-1 px-4 py-2.5 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:f?"提交中...":"确认提交"})]})]})})]})}e.s(["default",()=>c])}]);