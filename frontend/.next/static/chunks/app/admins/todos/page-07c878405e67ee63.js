(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[255],{98398:function(e,s,t){Promise.resolve().then(t.bind(t,65873))},65873:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return m}});var r=t(57437),a=t(2265),l=t(99376),i=t(71837),o=t(20441),d=t(99950),n=t(69853);let c=e=>{if(!e)return"";try{let s=new Date(e);if(isNaN(s.getTime()))return"";let t=s.getFullYear(),r=String(s.getMonth()+1).padStart(2,"0"),a=String(s.getDate()).padStart(2,"0"),l=String(s.getHours()).padStart(2,"0"),i=String(s.getMinutes()).padStart(2,"0");return"".concat(t,"-").concat(r,"-").concat(a,"T").concat(l,":").concat(i)}catch(e){return""}};function m(){(0,o.T)("待办事项管理");let e=(0,l.useRouter)(),[s,t]=(0,a.useState)(null),[m,u]=(0,a.useState)([]),[x,g]=(0,a.useState)(!0),[p,h]=(0,a.useState)(null),[b,y]=(0,a.useState)(!1),[j,f]=(0,a.useState)({title:"",description:"",due_date:"",reminder_enabled:!1,reminder_time:"",is_completed:!1,progress:0,priority:"medium",status:"todo",category:"",estimated_hours:void 0,actual_hours:void 0,start_date:"",time_logs:[]}),[v,N]=(0,a.useState)(""),[_,w]=(0,a.useState)("all"),[D,k]=(0,a.useState)(!1),[C,S]=(0,a.useState)(!1),[F,E]=(0,a.useState)(null),[L,M]=(0,a.useState)({title:"",description:"",due_date:"",reminder_enabled:!1,reminder_time:"",is_completed:!1,progress:0,priority:"medium",status:"todo",category:"",estimated_hours:void 0,actual_hours:void 0,start_date:"",time_logs:[]}),[B,H]=(0,a.useState)({time:"",description:""}),[I,T]=(0,a.useState)({show:!1,type:"success",message:""});(0,a.useEffect)(()=>{V()},[]);let V=async()=>{try{if(!localStorage.getItem("token")){e.push((0,n.V9)("login"));return}let s=await (0,i.tse)();t(s),await A()}catch(s){localStorage.removeItem("token"),localStorage.removeItem("user"),e.push((0,n.V9)("login"))}finally{g(!1)}},A=async()=>{try{let e=await (0,i.ao2)();if(e.success){let s=Array.isArray(e.data)?e.data:[];u(s)}}catch(e){T({show:!0,type:"error",message:"加载待办事项失败"}),u([])}},O=e=>{let{name:s,type:t,value:r}=e.target,a=r;"checkbox"===t&&(a=e.target.checked),f({...j,[s]:a})},z=async e=>{e.preventDefault();try{let e={...j,due_date:j.due_date||void 0,reminder_time:j.reminder_time||void 0,start_date:j.start_date||void 0,progress:D?j.progress:0,priority:D?j.priority:"medium",status:D?j.status:"todo",category:D?j.category:null,estimated_hours:D?j.estimated_hours:null,actual_hours:D?j.actual_hours:null,time_logs:D?j.time_logs:[]};if(null==p?void 0:p.id){if(!m.find(e=>e.id===p.id)){T({show:!0,type:"error",message:"待办事项不存在，可能已被删除"}),K();return}(await (0,i.SVw)(p.id,e)).success&&(T({show:!0,type:"success",message:"待办事项更新成功"}),await A(),K())}else(await (0,i.rAx)(e)).success&&(T({show:!0,type:"success",message:"待办事项创建成功"}),await A(),K())}catch(e){var s,t,r;(null===(s=e.response)||void 0===s?void 0:s.status)===404?(T({show:!0,type:"error",message:"待办事项不存在，可能已被删除"}),K()):T({show:!0,type:"error",message:(null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.message)||"操作失败"})}},W=e=>{h(e),f({title:e.title,description:e.description||"",due_date:c(e.due_date),reminder_enabled:e.reminder_enabled,reminder_time:c(e.reminder_time),is_completed:e.is_completed,progress:e.progress||0,priority:e.priority||"medium",status:e.status||"todo",category:e.category||"",estimated_hours:e.estimated_hours,actual_hours:e.actual_hours,start_date:c(e.start_date),time_logs:e.time_logs||[]}),k(!!(e.progress&&e.progress>0||e.priority&&"medium"!==e.priority||e.status&&"todo"!==e.status||e.category||e.estimated_hours||e.actual_hours||e.start_date||e.time_logs&&e.time_logs.length>0)),y(!0)},P=async e=>{if(confirm("确定要删除这个待办事项吗？"))try{(await (0,i.$j6)(e)).success&&(T({show:!0,type:"success",message:"待办事项删除成功"}),(null==p?void 0:p.id)===e&&K(),await A())}catch(e){var s,t;T({show:!0,type:"error",message:(null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"删除失败"})}},q=async(e,s)=>{try{(await (0,i.SVw)(e,{is_completed:!s})).success&&(T({show:!0,type:"success",message:s?"标记为未完成":"标记为已完成"}),await A())}catch(e){var t,r;T({show:!0,type:"error",message:(null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.message)||"操作失败"})}},K=()=>{f({title:"",description:"",due_date:"",reminder_enabled:!1,reminder_time:"",is_completed:!1,progress:0,priority:"medium",status:"todo",category:"",estimated_hours:void 0,actual_hours:void 0,start_date:"",time_logs:[]}),h(null),y(!1),k(!1)},R=e=>{E(e),M({...e,time_logs:e.time_logs||[]}),S(!0)},Y=()=>{S(!1),E(null),H({time:"",description:""})},Z=e=>{let{name:s,type:t,value:r}=e.target,a=r;"checkbox"===t?a=e.target.checked:"progress"===s?a=parseInt(r):("estimated_hours"===s||"actual_hours"===s)&&(a=""===r?void 0:parseFloat(r)),M({...L,[s]:a})},$=()=>{if(!B.time||!B.description.trim()){T({show:!0,type:"error",message:"请填写完整的时间点和描述"});return}let e={id:Date.now(),time:B.time,description:B.description.trim()};M({...L,time_logs:[...L.time_logs||[],e]}),H({time:"",description:""}),T({show:!0,type:"success",message:"时间点记录已添加"})},G=e=>{M({...L,time_logs:(L.time_logs||[]).filter(s=>s.id!==e)}),T({show:!0,type:"success",message:"时间点记录已删除"})},J=(e,s,t)=>{M({...L,time_logs:(L.time_logs||[]).map(r=>r.id===e?{...r,[s]:t}:r)})},Q=async()=>{if(null==F?void 0:F.id)try{let e={...L,due_date:L.due_date||void 0,reminder_time:L.reminder_time||void 0,start_date:L.start_date||void 0};(await (0,i.SVw)(F.id,e)).success&&(T({show:!0,type:"success",message:"项目进度更新成功"}),await A(),Y())}catch(t){var e,s;T({show:!0,type:"error",message:(null===(s=t.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||"保存失败"})}},U=e=>new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),X=m.filter(e=>{var s;let t=e.title.toLowerCase().includes(v.toLowerCase())||(null===(s=e.description)||void 0===s?void 0:s.toLowerCase().includes(v.toLowerCase())),r="all"===_||"pending"===_&&!e.is_completed||"completed"===_&&e.is_completed;return t&&r});return x?null:(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[I.show&&(0,r.jsx)(d.Z,{message:I.message,type:I.type,onClose:()=>T({...I,show:!1})}),(0,r.jsx)("nav",{className:"bg-white shadow-sm",children:(0,r.jsx)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6",children:(0,r.jsx)("div",{className:"flex items-center justify-between h-16",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("button",{onClick:()=>e.push((0,n.V9)("dashboard")),className:"text-gray-600 hover:text-gray-900",children:"← 返回"}),(0,r.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"待办事项管理"})]})})})}),(0,r.jsxs)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 py-6 sm:py-8",children:[(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)("input",{type:"text",placeholder:"搜索待办事项...",value:v,onChange:e=>N(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),(0,r.jsxs)("select",{value:_,onChange:e=>w(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,r.jsx)("option",{value:"all",children:"全部状态"}),(0,r.jsx)("option",{value:"pending",children:"未完成"}),(0,r.jsx)("option",{value:"completed",children:"已完成"})]})]})}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("button",{onClick:()=>{b?K():y(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:b?"取消":"+ 添加待办事项"})}),b&&(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4",children:p?"编辑待办事项":"添加待办事项"}),(0,r.jsxs)("form",{onSubmit:z,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-2",children:["标题 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{id:"title",name:"title",type:"text",required:!0,value:j.title,onChange:O,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"待办事项标题"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"描述"}),(0,r.jsx)("textarea",{id:"description",name:"description",rows:3,value:j.description,onChange:O,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"详细描述..."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"due_date",className:"block text-sm font-medium text-gray-700 mb-2",children:"截止日期"}),(0,r.jsx)("input",{id:"due_date",name:"due_date",type:"datetime-local",value:j.due_date,onChange:O,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("input",{id:"reminder_enabled",name:"reminder_enabled",type:"checkbox",checked:j.reminder_enabled,onChange:O,className:"w-4 h-4 mt-1 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("label",{htmlFor:"reminder_enabled",className:"font-medium text-gray-900",children:"启用提醒功能"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"开启后，将在设定的时间通过弹窗提醒您处理此待办事项"})]})]}),j.reminder_enabled&&(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"reminder_time",className:"block text-sm font-medium text-gray-700 mb-2",children:"提醒时间"}),(0,r.jsx)("input",{id:"reminder_time",name:"reminder_time",type:"datetime-local",value:j.reminder_time,onChange:O,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg p-3 border border-blue-200",children:[(0,r.jsx)("p",{className:"text-xs font-medium text-gray-700 mb-2",children:"快速设置："}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{let e=new Date;e.setHours(e.getHours()+1),f({...j,reminder_time:c(e.toISOString())})},className:"px-3 py-1 text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 rounded transition-colors",children:"1小时后"}),(0,r.jsx)("button",{type:"button",onClick:()=>{let e=new Date;e.setHours(e.getHours()+3),f({...j,reminder_time:c(e.toISOString())})},className:"px-3 py-1 text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 rounded transition-colors",children:"3小时后"}),(0,r.jsx)("button",{type:"button",onClick:()=>{let e=new Date;e.setDate(e.getDate()+1),e.setHours(9,0,0,0),f({...j,reminder_time:c(e.toISOString())})},className:"px-3 py-1 text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 rounded transition-colors",children:"明天上午9点"}),(0,r.jsx)("button",{type:"button",onClick:()=>{let e=new Date;e.setDate(e.getDate()+1),e.setHours(14,0,0,0),f({...j,reminder_time:c(e.toISOString())})},className:"px-3 py-1 text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 rounded transition-colors",children:"明天下午2点"})]})]})]})]}),(0,r.jsxs)("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("input",{id:"progress_management_enabled",name:"progress_management_enabled",type:"checkbox",checked:D,onChange:e=>k(e.target.checked),className:"w-4 h-4 mt-1 text-purple-600 bg-gray-100 border-gray-300 rounded focus:ring-purple-500 focus:ring-2"}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("label",{htmlFor:"progress_management_enabled",className:"font-medium text-gray-900",children:"启用项目进度管理"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"开启后，可以设置优先级、状态、进度、工时等详细的项目管理信息"})]})]}),D&&(0,r.jsx)("div",{className:"space-y-4 pt-3 border-t border-purple-200",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"priority",className:"block text-sm font-medium text-gray-700 mb-2",children:"优先级"}),(0,r.jsxs)("select",{id:"priority",name:"priority",value:j.priority,onChange:O,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[(0,r.jsx)("option",{value:"low",children:"\uD83D\uDFE2 低"}),(0,r.jsx)("option",{value:"medium",children:"\uD83D\uDFE1 中"}),(0,r.jsx)("option",{value:"high",children:"\uD83D\uDFE0 高"}),(0,r.jsx)("option",{value:"urgent",children:"\uD83D\uDD34 紧急"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-2",children:"任务状态"}),(0,r.jsxs)("select",{id:"status",name:"status",value:j.status,onChange:O,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[(0,r.jsx)("option",{value:"todo",children:"\uD83D\uDCCB 待开始"}),(0,r.jsx)("option",{value:"in_progress",children:"⚙️ 进行中"}),(0,r.jsx)("option",{value:"completed",children:"✅ 已完成"}),(0,r.jsx)("option",{value:"cancelled",children:"❌ 已取消"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-2",children:"分类标签"}),(0,r.jsx)("input",{id:"category",name:"category",type:"text",value:j.category||"",onChange:O,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"如：前端开发"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"progress",className:"block text-sm font-medium text-gray-700 mb-2",children:["完成进度 (",j.progress,"%)"]}),(0,r.jsx)("input",{id:"progress",name:"progress",type:"range",min:"0",max:"100",value:j.progress||0,onChange:O,className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"estimated_hours",className:"block text-sm font-medium text-gray-700 mb-2",children:"预计工时 (小时)"}),(0,r.jsx)("input",{id:"estimated_hours",name:"estimated_hours",type:"number",step:"0.5",min:"0",value:j.estimated_hours||"",onChange:O,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"如：8"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"actual_hours",className:"block text-sm font-medium text-gray-700 mb-2",children:"实际工时 (小时)"}),(0,r.jsx)("input",{id:"actual_hours",name:"actual_hours",type:"number",step:"0.5",min:"0",value:j.actual_hours||"",onChange:O,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"如：10"})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{htmlFor:"start_date",className:"block text-sm font-medium text-gray-700 mb-2",children:"开始日期"}),(0,r.jsx)("input",{id:"start_date",name:"start_date",type:"datetime-local",value:j.start_date||"",onChange:O,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{id:"is_completed",name:"is_completed",type:"checkbox",checked:j.is_completed,onChange:O,className:"w-4 h-4 text-green-600 bg-gray-100 border-gray-300 rounded focus:ring-green-500 focus:ring-2"}),(0,r.jsx)("label",{htmlFor:"is_completed",className:"ml-2 text-sm font-medium text-gray-700",children:"标记为已完成"})]}),(0,r.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,r.jsx)("button",{type:"submit",className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:p?"更新":"添加"}),(0,r.jsx)("button",{type:"button",onClick:K,className:"px-6 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors",children:"取消"})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4 sm:p-6",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold mb-4",children:["待办事项列表 (",X.length,")"]}),0===X.length?(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,r.jsx)("svg",{className:"w-12 h-12 mx-auto mb-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),(0,r.jsx)("p",{className:"text-sm",children:v||"all"!==_?"没有找到匹配的待办事项":"还没有添加任何待办事项"})]}):(0,r.jsx)("div",{className:"space-y-2",children:X.map(e=>{let s=e.progress&&e.progress>0||e.priority&&"medium"!==e.priority||e.status&&"todo"!==e.status||e.category||e.estimated_hours||e.actual_hours||e.start_date||e.time_logs&&e.time_logs.length>0;return(0,r.jsx)("div",{className:"p-3 sm:p-4 rounded-lg border transition-colors ".concat(e.is_completed?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200 hover:border-gray-300"),children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[(0,r.jsx)("button",{onClick:()=>e.id&&q(e.id,e.is_completed),className:"w-5 h-5 rounded-full border-2 flex items-center justify-center flex-shrink-0 transition-colors ".concat(e.is_completed?"bg-green-500 border-green-500 text-white":"border-gray-300 hover:border-green-500"),children:e.is_completed&&(0,r.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),(0,r.jsx)("h3",{className:"font-medium break-words ".concat(e.is_completed?"text-gray-500 line-through":"text-gray-900"),children:e.title}),e.priority&&"medium"!==e.priority&&(0,r.jsx)("span",{className:"text-xs px-2 py-0.5 rounded flex-shrink-0 ".concat("urgent"===e.priority?"bg-red-100 text-red-700":"high"===e.priority?"bg-orange-100 text-orange-700":"bg-green-100 text-green-700"),children:"urgent"===e.priority?"\uD83D\uDD34 紧急":"high"===e.priority?"\uD83D\uDFE0 高":"\uD83D\uDFE2 低"}),e.status&&"todo"!==e.status&&(0,r.jsx)("span",{className:"text-xs px-2 py-0.5 rounded flex-shrink-0 ".concat("completed"===e.status?"bg-green-100 text-green-700":"in_progress"===e.status?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:"completed"===e.status?"✅ 已完成":"in_progress"===e.status?"⚙️ 进行中":"❌ 已取消"}),e.category&&(0,r.jsxs)("span",{className:"text-xs px-2 py-0.5 bg-indigo-100 text-indigo-700 rounded flex-shrink-0",children:["\uD83C\uDFF7️ ",e.category]}),e.reminder_enabled&&(0,r.jsx)("span",{className:"text-xs px-2 py-0.5 bg-blue-100 text-blue-700 rounded flex-shrink-0",children:"\uD83D\uDD14 提醒"})]}),void 0!==e.progress&&e.progress>0&&(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-600 mb-1",children:[(0,r.jsx)("span",{children:"进度"}),(0,r.jsxs)("span",{className:"font-semibold",children:[e.progress,"%"]})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:(0,r.jsx)("div",{className:"h-1.5 rounded-full transition-all ".concat(100===e.progress?"bg-green-500":e.progress>=75?"bg-blue-500":e.progress>=50?"bg-yellow-500":"bg-orange-500"),style:{width:"".concat(e.progress,"%")}})})]}),e.description&&(0,r.jsx)("p",{className:"text-sm mb-1.5 break-words ".concat(e.is_completed?"text-gray-400":"text-gray-600"),children:e.description}),(e.estimated_hours||e.actual_hours||e.start_date||e.due_date||e.reminder_enabled&&e.reminder_time)&&(0,r.jsxs)("div",{className:"text-xs text-gray-500 space-y-0.5",children:[(e.estimated_hours||e.actual_hours)&&(0,r.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:[e.estimated_hours&&(0,r.jsxs)("span",{children:["⏱️ 预计: ",e.estimated_hours,"h"]}),e.actual_hours&&(0,r.jsxs)("span",{children:["⏰ 实际: ",e.actual_hours,"h"]}),e.estimated_hours&&e.actual_hours&&(0,r.jsxs)("span",{className:"font-semibold ".concat(e.actual_hours>e.estimated_hours?"text-red-600":"text-green-600"),children:["(",e.actual_hours>e.estimated_hours?"+":"",(e.actual_hours-e.estimated_hours).toFixed(1),"h)"]})]}),e.start_date&&(0,r.jsxs)("div",{children:["\uD83D\uDCC5 开始: ",U(e.start_date)]}),e.due_date&&(0,r.jsxs)("div",{children:["⏰ 截止: ",U(e.due_date)]}),e.reminder_enabled&&e.reminder_time&&(0,r.jsxs)("div",{children:["\uD83D\uDD14 提醒: ",U(e.reminder_time)]})]})]}),(0,r.jsxs)("div",{className:"flex sm:flex-col gap-2 flex-shrink-0",children:[s&&(0,r.jsx)("button",{onClick:()=>R(e),className:"flex-1 sm:flex-initial px-3 py-1.5 bg-purple-600 hover:bg-purple-700 text-white text-sm rounded transition-colors whitespace-nowrap",children:"\uD83D\uDCCA 进度记录"}),(0,r.jsx)("button",{onClick:()=>W(e),className:"flex-1 sm:flex-initial px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded transition-colors",children:"编辑"}),(0,r.jsx)("button",{onClick:()=>e.id&&P(e.id),className:"flex-1 sm:flex-initial px-3 py-1.5 bg-red-600 hover:bg-red-700 text-white text-sm rounded transition-colors",children:"删除"})]})]})},e.id)})})]})]}),C&&F&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-5xl w-full max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-4 sm:px-6 py-3 z-10",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:["\uD83D\uDCCA 项目进度管理 - ",F.title]}),(0,r.jsx)("p",{className:"text-xs sm:text-sm text-gray-600 mt-0.5",children:"管理项目进度、时间点记录和项目信息"})]}),(0,r.jsx)("button",{onClick:Y,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,r.jsxs)("div",{className:"p-4 sm:p-6 space-y-4",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg p-3 border border-purple-200",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"\uD83D\uDCCA 项目信息总览"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg p-2 text-center",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"优先级"}),(0,r.jsx)("div",{className:"text-sm font-semibold mt-0.5",children:"urgent"===L.priority?"\uD83D\uDD34 紧急":"high"===L.priority?"\uD83D\uDFE0 高":"low"===L.priority?"\uD83D\uDFE2 低":"\uD83D\uDFE1 中"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg p-2 text-center",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"状态"}),(0,r.jsx)("div",{className:"text-sm font-semibold mt-0.5",children:"completed"===L.status?"✅ 已完成":"in_progress"===L.status?"⚙️ 进行中":"cancelled"===L.status?"❌ 已取消":"\uD83D\uDCCB 待开始"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg p-2 text-center",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"进度"}),(0,r.jsxs)("div",{className:"text-sm font-semibold mt-0.5 text-purple-600",children:[L.progress,"%"]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg p-2 text-center",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"分类"}),(0,r.jsx)("div",{className:"text-sm font-semibold mt-0.5 truncate",children:L.category||"未分类"})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[(0,r.jsx)("h3",{className:"text-base font-semibold text-gray-900 mb-4",children:"\uD83D\uDCCB 基础信息"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"优先级"}),(0,r.jsxs)("select",{name:"priority",value:L.priority,onChange:Z,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[(0,r.jsx)("option",{value:"low",children:"\uD83D\uDFE2 低"}),(0,r.jsx)("option",{value:"medium",children:"\uD83D\uDFE1 中"}),(0,r.jsx)("option",{value:"high",children:"\uD83D\uDFE0 高"}),(0,r.jsx)("option",{value:"urgent",children:"\uD83D\uDD34 紧急"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"任务状态"}),(0,r.jsxs)("select",{name:"status",value:L.status,onChange:Z,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[(0,r.jsx)("option",{value:"todo",children:"\uD83D\uDCCB 待开始"}),(0,r.jsx)("option",{value:"in_progress",children:"⚙️ 进行中"}),(0,r.jsx)("option",{value:"completed",children:"✅ 已完成"}),(0,r.jsx)("option",{value:"cancelled",children:"❌ 已取消"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"分类标签"}),(0,r.jsx)("input",{name:"category",type:"text",value:L.category||"",onChange:Z,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"如：前端开发"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"开始日期"}),(0,r.jsx)("input",{name:"start_date",type:"datetime-local",value:L.start_date||"",onChange:Z,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[(0,r.jsx)("h3",{className:"text-base font-semibold text-gray-900 mb-4",children:"\uD83D\uDCC8 进度跟踪"}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["完成进度: ",L.progress,"%"]}),(0,r.jsx)("input",{name:"progress",type:"range",min:"0",max:"100",step:"5",value:L.progress,onChange:Z,className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-2",children:[(0,r.jsx)("span",{children:"0%"}),(0,r.jsx)("span",{children:"25%"}),(0,r.jsx)("span",{children:"50%"}),(0,r.jsx)("span",{children:"75%"}),(0,r.jsx)("span",{children:"100%"})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-3 sm:p-4",children:[(0,r.jsx)("h3",{className:"text-base font-semibold text-gray-900 mb-3",children:"⏱️ 工时统计"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"预计工时 (小时)"}),(0,r.jsx)("input",{name:"estimated_hours",type:"number",min:"0",step:"0.5",value:L.estimated_hours||"",onChange:Z,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"如：8"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"实际工时 (小时)"}),(0,r.jsx)("input",{name:"actual_hours",type:"number",min:"0",step:"0.5",value:L.actual_hours||"",onChange:Z,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"如：10"})]})]}),L.estimated_hours&&L.actual_hours&&(0,r.jsx)("div",{className:"mt-3 text-xs sm:text-sm p-2 sm:p-3 rounded-lg ".concat(L.actual_hours>L.estimated_hours?"bg-red-50 text-red-700 border border-red-200":"bg-green-50 text-green-700 border border-green-200"),children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"font-semibold",children:L.actual_hours>L.estimated_hours?"⚠️ 超时":"✅ 提前完成"}),(0,r.jsxs)("span",{children:["偏差: ",L.actual_hours>L.estimated_hours?"+":"",(L.actual_hours-L.estimated_hours).toFixed(1),"h (",((L.actual_hours-L.estimated_hours)/L.estimated_hours*100).toFixed(1),"%)"]})]})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-3 sm:p-4",children:[(0,r.jsx)("h3",{className:"text-base font-semibold text-gray-900 mb-3",children:"\uD83D\uDD50 时间点记录"}),(0,r.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 mb-3",children:[(0,r.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"添加时间点"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["时间点 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"datetime-local",value:B.time,onChange:e=>H({...B,time:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["工作内容 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{type:"text",value:B.description,onChange:e=>H({...B,description:e.target.value}),onKeyPress:e=>"Enter"===e.key&&$(),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"如：完成了用户登录模块"}),(0,r.jsx)("button",{type:"button",onClick:$,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors whitespace-nowrap",children:"添加"})]})]})]})]}),L.time_logs&&L.time_logs.length>0?(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:["已记录 ",L.time_logs.length," 个时间点"]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"序号"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"时间点"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"工作内容"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:[...L.time_logs].sort((e,s)=>new Date(e.time).getTime()-new Date(s.time).getTime()).map((e,s)=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:s+1}),(0,r.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:(0,r.jsx)("input",{type:"datetime-local",value:e.time,onChange:s=>J(e.id,"time",s.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-transparent"})}),(0,r.jsx)("td",{className:"px-4 py-3 text-sm",children:(0,r.jsx)("input",{type:"text",value:e.description,onChange:s=>J(e.id,"description",s.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-transparent"})}),(0,r.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:(0,r.jsx)("button",{type:"button",onClick:()=>G(e.id),className:"text-red-600 hover:text-red-900",children:"删除"})})]},e.id))})]})}),(0,r.jsxs)("div",{className:"mt-4 bg-gradient-to-r from-green-50 to-teal-50 rounded-lg p-4",children:[(0,r.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"时间轴预览"}),(0,r.jsx)("div",{className:"space-y-3",children:[...L.time_logs].sort((e,s)=>new Date(e.time).getTime()-new Date(s.time).getTime()).map((e,s)=>(0,r.jsxs)("div",{className:"flex items-start bg-white rounded-lg p-3 shadow-sm",children:[(0,r.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold",children:s+1}),(0,r.jsxs)("div",{className:"ml-3 flex-1",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500",children:U(e.time)}),(0,r.jsx)("div",{className:"text-sm text-gray-900 mt-1",children:e.description})]})]},e.id))})]})]}):(0,r.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-8 text-center",children:[(0,r.jsx)("svg",{className:"w-12 h-12 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsx)("h4",{className:"text-base font-medium text-gray-900 mb-2",children:"暂无时间点记录"}),(0,r.jsx)("p",{className:"text-gray-500",children:"请添加第一个时间点记录来跟踪任务进度"})]})]})]}),(0,r.jsxs)("div",{className:"sticky bottom-0 bg-white border-t border-gray-200 px-4 sm:px-6 py-3 flex justify-end gap-3",children:[(0,r.jsx)("button",{onClick:Y,className:"px-4 sm:px-6 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"取消"}),(0,r.jsx)("button",{onClick:Q,className:"px-4 sm:px-6 py-2 text-white bg-purple-600 hover:bg-purple-700 rounded-lg transition-colors",children:"保存更改"})]})]})})]})}}},function(e){e.O(0,[660,278,833,543,811,351,744],function(){return e(e.s=98398)}),_N_E=e.O()}]);