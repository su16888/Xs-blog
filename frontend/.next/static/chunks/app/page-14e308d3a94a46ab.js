(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{68586:function(e,t,a){Promise.resolve().then(a.bind(a,9303))},9303:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return X}});var r=a(57437),s=a(2265),l=a(71837),o=a(33182);function i(){var e;let[t,a]=(0,s.useState)(null),[i,n]=(0,s.useState)(!0),[c,d]=(0,s.useState)("circle"),[m,x]=(0,s.useState)("white");(0,s.useEffect)(()=>{p(),u()},[]);let p=async()=>{try{let e=await (0,l.AiP)();a(e)}catch(e){}finally{n(!1)}},u=async()=>{try{let e=await (0,l.Gw4)();if(e.success){let t=e.data.find(e=>"avatarShape"===e.key);t&&d(t.value);let a=e.data.find(e=>"themeColor"===e.key);a&&x(a.value)}}catch(e){}},h=()=>"rounded"===c?"rounded-xl":"rounded-full",g=()=>"black"===m?"0 0 0 3px rgba(255, 255, 255, 0.15), 0 4px 14px 0 rgba(255, 255, 255, 0.1)":"0 0 0 3px rgba(0, 0, 0, 0.08), 0 4px 14px 0 rgba(0, 0, 0, 0.15)";return i?(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("div",{className:"w-32 h-32 ".concat(h()," bg-gray-200 animate-pulse mb-4")}),(0,r.jsx)("div",{className:"h-8 w-48 bg-gray-200 animate-pulse mb-2"}),(0,r.jsx)("div",{className:"h-4 w-64 bg-gray-200 animate-pulse"})]}):(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("div",{className:"relative mb-6",children:(null==t?void 0:t.avatar)?(0,r.jsx)("img",{src:(0,o.qm)(t.avatar),alt:t.name||"头像",className:"w-24 h-24 ".concat(h()," object-cover"),style:{boxShadow:g()}}):(0,r.jsx)("div",{className:"w-24 h-24 ".concat(h()," bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center text-white text-4xl font-bold"),style:{boxShadow:g()},children:(null==t?void 0:null===(e=t.name)||void 0===e?void 0:e[0])||"U"})}),(0,r.jsx)("h1",{className:"text-4xl font-bold text-text-primary mb-2",children:(null==t?void 0:t.name)||"Xs-Blog"}),(null==t?void 0:t.title)&&(0,r.jsx)("p",{className:"text-xl text-text-secondary mb-4",children:t.title}),(null==t?void 0:t.bio)&&(0,r.jsx)("p",{className:"text-lg text-text-secondary max-w-2xl text-center mb-4",children:t.bio}),(0,r.jsxs)("div",{className:"flex items-center gap-4 text-sm text-text-tertiary",children:[(null==t?void 0:t.location)&&(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,r.jsx)("span",{children:t.location})]}),(null==t?void 0:t.website)&&(0,r.jsxs)("a",{href:t.website,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 hover:text-primary-500 transition-colors",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})}),(0,r.jsx)("span",{children:t.website_title||"个人网站"})]})]})]})}var n=a(77906),c=a(57586),d=a(75135),m=a(44743),x=a(89345),p=a(82718),u=a(13041),h=a(32489);let g={github:d.Z,telegram:m.Z,email:x.Z,gmail:x.Z,qq:p.Z,wechat:p.Z};function b(e){let{className:t}=e,[a,i]=(0,s.useState)([]),[d,m]=(0,s.useState)(!0),[x,p]=(0,s.useState)({}),[b,y]=(0,s.useState)(!1),[f,v]=(0,s.useState)(null),[j,N]=(0,s.useState)(!1),[w,k]=(0,s.useState)(null),[C,S]=(0,s.useState)(!1),[T,L]=(0,s.useState)({}),_=e=>e&&e.toLowerCase().endsWith(".svg");(0,s.useEffect)(()=>{(async()=>{try{var e;let t=await l.ZPm.get("/social-links?visible=true"),a=null===(e=t.data)||void 0===e?void 0:e.data,r=Array.isArray(a)?a:[];i(r),r.length>0&&r.forEach(e=>{if(e.icon&&""!==e.icon.trim()){let t=new Image;t.onload=()=>{L(t=>({...t,[e.platform]:!0}))},t.onerror=()=>{p(t=>({...t,[e.platform]:!0}))},t.src=(0,o.qm)(e.icon)}})}catch(e){console.error("Failed to fetch social links:",e),i([])}finally{m(!1)}})()},[]);let Z=e=>{p(t=>({...t,[e]:!0}))},E=(e,t)=>{t.qrcode&&""!==t.qrcode.trim()?(e.preventDefault(),v({image:t.qrcode,platform:t.platform}),y(!0)):t.link&&""!==t.link.trim()&&"#"!==t.link||(e.preventDefault(),k({account:t.account,platform:t.platform}),N(!0))},z=()=>{y(!1),setTimeout(()=>v(null),300)},M=()=>{N(!1),S(!1),setTimeout(()=>k(null),300)},P=async()=>{if(w)try{await navigator.clipboard.writeText(w.account),S(!0),setTimeout(()=>S(!1),2e3)}catch(e){console.error("Failed to copy:",e)}};return d?(0,r.jsx)("div",{className:"text-center py-8",children:(0,r.jsx)("div",{className:"inline-block w-8 h-8 border-4 border-t-transparent rounded-full animate-spin",style:{borderColor:"var(--primary-500)"}})}):Array.isArray(a)&&0!==a.length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:(0,o.cn)("flex flex-wrap justify-center gap-4 md:gap-6 max-w-4xl mx-auto",t),children:a.slice(0,6).map((e,t)=>{let a=g[e.platform.toLowerCase()]||u.Z,s=e.icon&&""!==e.icon.trim()&&!x[e.platform],l=!s||T[e.platform];return(0,r.jsxs)(n.E.a,{href:e.link||"#",target:e.link?"_blank":"_self",rel:"noopener noreferrer",onClick:t=>E(t,e),className:"card-glow rounded-xl p-4 flex flex-col items-center justify-center gap-3 group aspect-square cursor-pointer",initial:{opacity:0,y:20},animate:{opacity:l?1:0,y:l?0:20},transition:{delay:l?.1*t:0,duration:.3},whileHover:{scale:1.05},children:[(0,r.jsxs)("div",{className:"relative",children:[s?(0,r.jsx)("div",{className:"relative w-8 h-8",children:(0,r.jsx)("img",{src:(0,o.qm)(e.icon),alt:e.platform,className:(0,o.cn)("w-8 h-8 object-contain transition-all",_(e.icon)?"icon-themed group-hover:brightness-110":"group-hover:brightness-110"),onError:()=>Z(e.platform),loading:"eager"})}):(0,r.jsx)(a,{className:"w-8 h-8 text-primary-500 group-hover:text-primary-600 transition-colors"}),(0,r.jsx)("div",{className:"absolute inset-0 blur-xl opacity-30 group-hover:opacity-50 transition-opacity",style:{backgroundColor:"var(--primary-500)"}})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-sm font-semibold text-text-secondary capitalize",children:e.platform}),(0,r.jsx)("p",{className:"text-xs text-text-tertiary mt-1 truncate max-w-[120px]",children:e.account})]})]},"".concat(e.platform,"-").concat(t))})}),(0,r.jsx)(c.M,{children:b&&f&&(0,r.jsx)(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:z,children:(0,r.jsxs)(n.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",damping:20},className:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6 max-w-sm w-full",onClick:e=>e.stopPropagation(),children:[(0,r.jsx)("button",{onClick:z,className:"absolute top-4 right-4 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"关闭",children:(0,r.jsx)(h.Z,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4 capitalize",children:f.platform}),(0,r.jsx)("div",{className:"bg-white p-4 rounded-xl inline-block",children:(0,r.jsx)("img",{src:(0,o.qm)(f.image),alt:"".concat(f.platform," QR Code"),className:"w-64 h-64 object-contain"})}),(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-4",children:"扫描二维码添加联系方式"})]})]})})}),(0,r.jsx)(c.M,{children:j&&w&&(0,r.jsx)(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:M,children:(0,r.jsxs)(n.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",damping:20},className:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6 max-w-sm w-full",onClick:e=>e.stopPropagation(),children:[(0,r.jsx)("button",{onClick:M,className:"absolute top-4 right-4 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"关闭",children:(0,r.jsx)(h.Z,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4 capitalize",children:w.platform}),(0,r.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-xl mb-4",children:(0,r.jsx)("p",{className:"text-lg font-mono text-gray-900 dark:text-white break-all",children:w.account})}),(0,r.jsx)("button",{onClick:P,className:"w-full py-3 px-4 rounded-lg font-medium transition-colors ".concat(C?"bg-green-500 text-white":"bg-primary-500 hover:bg-primary-600 text-white"),children:C?"✓ 已复制":"复制账号"})]})]})})})]}):null}var y=a(96362),f=a(86595),v=a(24953);function j(e){let{site:t,index:a,onSiteClick:s}=e;return(0,r.jsx)(n.E.button,{onClick:()=>s(t),className:"group block p-3 bg-bg-secondary rounded-lg shadow-sm hover:shadow-lg hover:-translate-y-0.5 border border-border-primary transition-all duration-300 cursor-pointer text-left w-full",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.02*a},children:(0,r.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,r.jsx)("div",{className:"w-10 h-10 mb-2 rounded-md overflow-hidden flex items-center justify-center",children:t.logo?(0,r.jsx)("img",{src:(0,o.qm)(t.logo),alt:t.name,className:"w-full h-full object-cover"}):(0,r.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center text-white font-semibold text-base shadow-sm",children:t.name[0]})}),(0,r.jsxs)("div",{className:"relative flex flex-col items-center mb-1",children:[(0,r.jsx)("h3",{className:"font-medium text-xs text-text-primary group-hover:text-primary-500 transition-colors",children:t.name}),(0,r.jsx)(y.Z,{className:"w-3 h-3 text-primary-500 opacity-0 group-hover:opacity-100 transition-opacity absolute -right-4 top-1/2 transform -translate-y-1/2"})]}),t.description&&(0,r.jsx)("p",{className:"text-[10px] text-text-tertiary line-clamp-2 text-center leading-relaxed",children:t.description})]})})}function N(e){let{searchQuery:t=""}=e,[a,i]=(0,s.useState)(null),[n,c]=(0,s.useState)(!0),[d,m]=(0,s.useState)(!1),[x,p]=(0,s.useState)(null);(0,s.useEffect)(()=>{u()},[]);let u=async()=>{try{let e=await (0,l.YxK)();e.success&&e.data&&i(e.data)}catch(e){console.error("Failed to fetch navigation data:",e),i({showRecommended:!1,recommended:[],categories:[]})}finally{c(!1)}},h=e=>{p(e),m(!0)},g=e=>{if(!t.trim())return e;let a=t.toLowerCase();return e.filter(e=>{var t;let r=e.name.toLowerCase().includes(a),s=null===(t=e.description)||void 0===t?void 0:t.toLowerCase().includes(a);return r||s})};if(n)return(0,r.jsxs)("div",{className:"bg-bg-secondary/40 rounded-2xl p-5",children:[(0,r.jsx)("div",{className:"h-6 w-24 bg-bg-tertiary/50 animate-pulse mb-5 rounded-lg"}),(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:[1,2,3,4].map(e=>(0,r.jsx)("div",{className:"h-28 bg-bg-primary animate-pulse rounded-xl shadow-sm border border-border-primary/20"},e))})]});if(!a)return null;let b=g(a.recommended),y=a.categories.map(e=>({...e,sites:g(e.sites)})).filter(e=>e.sites.length>0),N=b.length>0||y.length>0,w=t.trim()&&N,k=t.trim()&&!N,C=[];return w&&C.push((0,r.jsx)("div",{className:"mb-4 p-3 bg-blue-50/50 rounded-lg border border-blue-200/50",children:(0,r.jsxs)("span",{className:"text-sm text-blue-700",children:["搜索结果: 找到 ",b.length+y.reduce((e,t)=>e+t.sites.length,0)," 个相关网站",(0,r.jsxs)("span",{className:"font-medium ml-1",children:['"',t,'"']})]})},"search-results")),k&&C.push((0,r.jsx)("div",{className:"mb-4 p-3 bg-gray-50/50 rounded-lg border border-gray-200/50 text-center",children:(0,r.jsxs)("span",{className:"text-sm text-gray-600",children:['没有找到包含 "',t,'" 的网站']})},"no-results")),a.showRecommended&&b.length>0&&C.push((0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1.5 mb-4",children:[(0,r.jsx)(f.Z,{className:"w-4 h-4 text-yellow-500 fill-yellow-500"}),(0,r.jsx)("h2",{className:"text-lg font-bold text-text-primary",children:"导航推荐"})]}),(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:b.map((e,t)=>(0,r.jsx)(j,{site:e,index:t,onSiteClick:h},"recommended-".concat(e.id)))})]},"recommended-section")),y.forEach(e=>{C.push((0,r.jsxs)("div",{className:"mb-8 last:mb-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1.5 mb-4",children:[e.category.icon&&(0,r.jsx)("span",{className:"text-lg",children:e.category.icon}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-bold text-text-primary",children:e.category.name}),e.category.description&&(0,r.jsx)("p",{className:"text-xs text-text-secondary mt-0.5",children:e.category.description})]})]}),(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:e.sites.map((t,a)=>(0,r.jsx)(j,{site:t,index:a,onSiteClick:h},"site-".concat(e.category.id,"-").concat(t.id)))})]},"category-".concat(e.category.id)))}),a.showRecommended||0!==a.categories.length||C.push((0,r.jsx)("div",{className:"text-center py-12 text-text-tertiary",children:"暂无导航数据"},"empty-state")),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"bg-bg-secondary/40 rounded-2xl p-5",children:C}),(0,r.jsx)(v.Z,{isOpen:d,onClose:()=>{m(!1),setTimeout(()=>{p(null)},300)},site:x,logoUrl:(null==x?void 0:x.logo)?(0,o.qm)(x.logo):void 0})]})}var w=a(46506),k=a(91723),C=a(99376),S=a(59604),T=a(29377),L=a(87310),_=a(69853),Z=a(16093),E=a(40),z=a(53867);let M=(0,o.bR)(),P=e=>{let t=new Date(e),a=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),l=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return"".concat(a,"-").concat(r,"-").concat(s," ").concat(l,":").concat(o)},F=(e,t)=>e.length<=t?e:e.substring(0,t)+"...",q=e=>{if(!e)return"";let t=e;return(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/!\[([^\]]*)\]\(([^)]+)\)/g,"")).replace(/!\[([^\]]*)\]\[([^\]]+)\]/g,"")).replace(/!\[([^\]]+)\]/g,"")).replace(/!\s*\[/g,"")).replace(/```[\s\S]*?```/g,"")).replace(/`([^`]+)`/g,"$1")).replace(/`/g,"")).replace(/^#{1,6}\s+/gm,"")).replace(/\*\*([^\*]+)\*\*/g,"$1")).replace(/__([^_]+)__/g,"$1")).replace(/\*([^\*]+)\*/g,"$1")).replace(/_([^_]+)_/g,"$1")).replace(/~~([^~]+)~~/g,"$1")).replace(/^[\s]*[-*+]\s+/gm,"")).replace(/^[\s]*\d+\.\s+/gm,"")).replace(/^>\s+/gm,"")).replace(/\[([^\]]+)\]\(([^)]+)\)/g,"$1")).replace(/\|.*\|/g,"")).replace(/^\s*[-*_]{3,}\s*$/gm,"")).replace(/\s+/g," ").replace(/\n{3,}/g,"\n\n").replace(/\n\s*\n/g,"\n\n").trim()};function W(e){let{searchQuery:t=""}=e,a=(0,C.usePathname)();(0,C.useRouter)();let i=!!a&&(0,_.Jh)(a),[c,d]=(0,s.useState)([]),[m,x]=(0,s.useState)([]),[p,u]=(0,s.useState)(!0),[h,g]=(0,s.useState)(1),[b,y]=(0,s.useState)(1),[f,v]=(0,s.useState)(null),[j,N]=(0,s.useState)(!1),[W,D]=(0,s.useState)(!1),[A,B]=(0,s.useState)(""),[R,I]=(0,s.useState)(""),[U,H]=(0,s.useState)(!1),[$,O]=(0,s.useState)({}),[Q,X]=(0,s.useState)({showNoteTags:!0,showNoteCategories:!0,noteDisplayMode:"modal",noteLayoutColumns:"1",showNoteCover:"true",defaultNoteCover:""}),[G,J]=(0,s.useState)({type:null,value:null}),[V,Y]=(0,s.useState)(!1),[K,ee]=(0,s.useState)(!1),[et,ea]=(0,s.useState)(""),[er,es]=(0,s.useState)(!1),el="/"===a;(0,s.useEffect)(()=>{eo(),ei(),ey()},[h,G]);let eo=async()=>{try{var e,t;let a={is_published:!0,page:h,limit:6};G.type&&G.value&&("tag"===G.type?a.tag=G.value:"category"===G.type&&(a.category=G.value));let r=await l.ZPm.get("/notes",{params:a}),s=null===(e=r.data)||void 0===e?void 0:e.data,o=Array.isArray(null==s?void 0:s.notes)?s.notes:[];d(o),y((null==s?void 0:null===(t=s.pagination)||void 0===t?void 0:t.totalPages)||1)}catch(e){console.error("Failed to fetch notes:",e),d([])}finally{u(!1)}},ei=async()=>{try{var e;let t=await l.ZPm.get("/notes/categories/list"),a=null===(e=t.data)||void 0===e?void 0:e.data;x(Array.isArray(a)?a:[])}catch(e){console.error("Failed to fetch categories:",e),x([])}},en=async e=>{if("page"===Q.noteDisplayMode)window.location.href="/note/".concat(e.id);else try{var t,a;let r=await l.ZPm.get("/notes/".concat(e.id));if((null===(t=r.data)||void 0===t?void 0:t.success)&&(null===(a=r.data)||void 0===a?void 0:a.data)){let t=r.data.data;await ec(e.id),t.requiresPassword?(v(t),D(!0)):(v(t),N(!0))}}catch(e){console.error("Failed to fetch note:",e)}},ec=async(e,t)=>{try{var a,r;let s=t?"?password=".concat(encodeURIComponent(t)):"",o=await l.ZPm.get("/notes/".concat(e,"/disks").concat(s));(null===(a=o.data)||void 0===a?void 0:a.success)&&(null===(r=o.data)||void 0===r?void 0:r.data)&&ee(o.data.data.length>0)}catch(e){console.error("Failed to check disks:",e),ee(!1)}},ed=async e=>{var t,a,r;if(e.preventDefault(),f){I(""),H(!0);try{let e=await l.ZPm.post("/notes/".concat(f.id,"/verify"),{password:A});(null===(t=e.data)||void 0===t?void 0:t.success)&&(null===(a=e.data)||void 0===a?void 0:a.data)&&(v(e.data.data),D(!1),N(!0),ea(A),await ec(f.id,A),B(""))}catch(e){(null===(r=e.response)||void 0===r?void 0:r.status)===401?I("密码错误，请重试"):I("验证失败，请稍后重试")}finally{H(!1)}}},em=()=>{N(!1),v(null)},ex=e=>{if(!e)return!1;let t=e.trim();return/^https?:\/\/[\w\-\.]+\.[a-z]{2,}(\/\S*)?$/i.test(t)},ep=e=>{try{return new URL(e).hostname.replace("www.","")}catch(e){return""}},eu=e=>{let t=ep(e);return"https://".concat(t,"/favicon.ico")},eh=async e=>{if($[e])return $[e];try{let t=await (0,o.wz)("/api/metadata?url=".concat(encodeURIComponent(e)));if(t.ok){let a=await t.json();return O(t=>({...t,[e]:{title:a.title||ep(e),description:a.description||"点击卡片访问网站",favicon:a.favicon||eu(e),image:a.image||""}})),a}}catch(e){console.error("Failed to fetch URL metadata:",e)}let t={title:ep(e),description:"点击卡片访问网站",favicon:eu(e),image:""};return O(a=>({...a,[e]:t})),t},eg=e=>{el?window.location.href="/notes?tag=".concat(encodeURIComponent(e)):(J({type:"tag",value:e}),g(1))},eb=e=>{el?window.location.href="/notes?category=".concat(encodeURIComponent(e)):(J({type:"category",value:e}),g(1))},ey=async()=>{try{let e=await l.ZPm.get("/settings");if(e.data.success&&e.data.data){let t=e.data.data,a=t.find(e=>"showNoteTags"===e.key),r=t.find(e=>"showNoteCategories"===e.key),s=t.find(e=>"noteDisplayMode"===e.key),l=t.find(e=>"noteLayoutColumns"===e.key),o=t.find(e=>"showNoteCover"===e.key),i=t.find(e=>"defaultNoteCover"===e.key);X({showNoteTags:(null==a?void 0:a.value)!=="false",showNoteCategories:(null==r?void 0:r.value)!=="false",noteDisplayMode:(null==s?void 0:s.value)||"modal",noteLayoutColumns:(null==l?void 0:l.value)||"1",showNoteCover:(null==o?void 0:o.value)||"true",defaultNoteCover:(null==i?void 0:i.value)||""})}}catch(e){console.error("Failed to load settings:",e)}};(0,s.useEffect)(()=>{let e=async()=>{for(let e of c.filter(e=>ex(e.content)))await eh(e.content.trim())};c.length>0&&e()},[c]);let ef=c.filter(e=>{var a,r,s,l;if(!t.trim())return!0;let o=t.toLowerCase(),i=null===(a=e.title)||void 0===a?void 0:a.toLowerCase().includes(o),n=q(e.content).toLowerCase().includes(o),c=null===(r=e.category)||void 0===r?void 0:r.toLowerCase().includes(o),d=(null===(s=e.Tags)||void 0===s?void 0:s.some(e=>e.name.toLowerCase().includes(o)))||(null===(l=e.tags)||void 0===l?void 0:l.toLowerCase().includes(o));return i||n||c||d}),ev=new Map(m.map(e=>[e.name,e]));if(p)return(0,r.jsx)("div",{className:"space-y-0",children:[1,2,3].map(e=>(0,r.jsxs)("div",{className:"py-4 border-b border-border-primary/30",children:[(0,r.jsx)("div",{className:"h-5 w-3/4 bg-bg-tertiary/50 animate-pulse mb-3 rounded"}),(0,r.jsx)("div",{className:"h-4 w-full bg-bg-tertiary/50 animate-pulse mb-2 rounded"}),(0,r.jsx)("div",{className:"h-4 w-2/3 bg-bg-tertiary/50 animate-pulse mb-3 rounded"}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,r.jsx)("div",{className:"h-3 w-24 bg-bg-tertiary/50 animate-pulse rounded"}),(0,r.jsx)("div",{className:"h-3 w-16 bg-bg-tertiary/50 animate-pulse rounded"})]})]},e))});if(0===c.length)return null;let ej=t.trim()&&ef.length>0,eN=t.trim()&&0===ef.length;return(0,r.jsxs)(r.Fragment,{children:[ej&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-blue-50/50 rounded-lg border border-blue-200/50 flex items-center justify-between",children:(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsxs)("span",{className:"text-sm text-blue-700",children:["搜索结果: 找到 ",ef.length," 条相关笔记",(0,r.jsxs)("span",{className:"font-medium ml-1",children:['"',t,'"']})]})})}),eN&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-bg-tertiary/50 rounded-lg border border-border-primary/50 text-center",children:(0,r.jsxs)("span",{className:"text-sm text-text-tertiary",children:['没有找到包含 "',t,'" 的笔记']})}),G.type&&G.value&&(0,r.jsxs)("div",{className:"mb-4 p-3 bg-bg-secondary/50 rounded-lg border border-border-primary/20 flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsxs)("span",{className:"text-sm text-text-secondary",children:["当前筛选:",(0,r.jsxs)("span",{className:"font-medium text-text-primary ml-1",children:["tag"===G.type?"标签":"分类",": ",G.value]})]})}),(0,r.jsx)("button",{onClick:()=>{J({type:null,value:null}),g(1)},className:"text-xs text-text-tertiary hover:text-text-primary transition-colors px-2 py-1 hover:bg-bg-tertiary/50 rounded",children:"清除筛选"})]}),(0,r.jsx)("div",{className:"grid gap-4 ".concat("1"===Q.noteLayoutColumns?"grid-cols-1":"2"===Q.noteLayoutColumns?"grid-cols-1 md:grid-cols-2":"3"===Q.noteLayoutColumns?"grid-cols-1 md:grid-cols-2 lg:grid-cols-3":"4"===Q.noteLayoutColumns?"grid-cols-1 md:grid-cols-2 lg:grid-cols-4":"grid-cols-1"),children:ef.map((e,t)=>{var a,s,l,o,c,d,m,x,p,u,h,g;return(0,r.jsx)(n.E.div,{className:"rounded-lg hover:-translate-y-1 transition-all duration-300 cursor-pointer relative z-0 min-h-[150px] ".concat(i?"bg-white border border-gray-200 hover:shadow-lg":"bg-bg-secondary border border-border-primary hover:shadow-lg"," ").concat("1"===Q.noteLayoutColumns?"p-4":"p-6"),initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05*t},onClick:()=>en(e),children:"1"===Q.noteLayoutColumns&&(e.cover_image||Q.defaultNoteCover)&&"true"===Q.showNoteCover?(0,r.jsxs)("div",{className:"flex gap-3 items-center h-full",children:[(0,r.jsx)("div",{className:"flex-shrink-0 w-28 h-28 rounded-lg overflow-hidden bg-bg-tertiary",children:(0,r.jsx)("img",{src:(e.cover_image||Q.defaultNoteCover||"").startsWith("http")?e.cover_image||Q.defaultNoteCover:"".concat(M).concat(e.cover_image||Q.defaultNoteCover),alt:e.title||"封面图",className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none"}})}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col justify-center min-h-[112px] py-1",children:[e.title&&(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)("h3",{className:"text-base font-semibold text-text-primary line-clamp-1 flex-1",children:e.title}),e.is_pinned&&(0,r.jsx)("div",{className:"flex items-center gap-1 px-1.5 py-0.5 bg-gradient-to-r from-red-500 to-pink-500 text-white rounded text-xs font-semibold flex-shrink-0",children:(0,r.jsx)(w.Z,{className:"w-3 h-3 fill-current"})})]}),(0,r.jsx)("p",{className:"text-sm text-text-secondary line-clamp-2 mb-2",children:e.summary||(e.content?F(q(e.content),80):"暂无内容")}),(0,r.jsxs)("div",{className:"flex items-center gap-2 flex-wrap text-xs",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 text-text-tertiary",children:[(0,r.jsx)(k.Z,{className:"w-3 h-3"}),(0,r.jsx)("span",{children:P(e.published_at||e.created_at)})]}),Q.showNoteCategories&&e.category&&(0,r.jsxs)("span",{className:"px-2 py-0.5 bg-primary-100 text-primary-700 rounded-full font-medium cursor-pointer hover:bg-primary-200 transition-colors hidden md:inline-block",onClick:t=>{t.stopPropagation(),eb(e.category)},children:[(null===(a=ev.get(e.category))||void 0===a?void 0:a.icon)&&(0,r.jsx)("span",{className:"mr-1",children:null===(s=ev.get(e.category))||void 0===s?void 0:s.icon}),e.category]}),Q.showNoteTags&&e.Tags&&e.Tags.length>0&&(0,r.jsxs)(r.Fragment,{children:[e.Tags.slice(0,el?1:2).map(e=>(0,r.jsx)("span",{className:"px-2 py-0.5 rounded-full font-medium cursor-pointer hover:opacity-80 transition-opacity hidden md:inline-block",style:e.color?{backgroundColor:"".concat(e.color,"20"),color:e.color}:{backgroundColor:"rgb(242 242 242)",color:"rgb(112 112 112)"},onClick:t=>{t.stopPropagation(),eg(e.name)},children:e.name},e.id)),e.Tags.length>(el?1:2)&&(0,r.jsxs)("span",{className:"px-2 py-0.5 rounded-full text-xs hidden md:inline-block",style:{backgroundColor:"rgb(242 242 242)",color:"rgb(112 112 112)"},children:["+",e.Tags.length-(el?1:2)]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1 md:hidden",children:[Q.showNoteCategories&&e.category&&(0,r.jsxs)("span",{className:"px-2 py-0.5 bg-primary-100 text-primary-700 rounded-full font-medium cursor-pointer hover:bg-primary-200 transition-colors",onClick:t=>{t.stopPropagation(),eb(e.category)},children:[(null===(l=ev.get(e.category))||void 0===l?void 0:l.icon)&&(0,r.jsx)("span",{className:"mr-1",children:null===(o=ev.get(e.category))||void 0===o?void 0:o.icon}),e.category]}),Q.showNoteTags&&e.Tags&&e.Tags.length>0&&(0,r.jsx)("span",{className:"px-2 py-0.5 rounded-full font-medium cursor-pointer hover:opacity-80 transition-opacity",style:e.Tags[0].color?{backgroundColor:"".concat(e.Tags[0].color,"20"),color:e.Tags[0].color}:{backgroundColor:"rgb(242 242 242)",color:"rgb(112 112 112)"},onClick:t=>{t.stopPropagation(),eg(e.Tags[0].name)},children:e.Tags[0].name})]})]})]})]}):(0,r.jsxs)("div",{className:"flex flex-col h-full",children:["1"!==Q.noteLayoutColumns&&(e.cover_image||Q.defaultNoteCover)&&"true"===Q.showNoteCover&&(0,r.jsx)("div",{className:"mb-4 -mx-6 -mt-6",children:(0,r.jsx)("div",{className:"relative w-full pt-[100%] overflow-hidden rounded-t-lg",children:(0,r.jsx)("img",{src:(e.cover_image||Q.defaultNoteCover||"").startsWith("http")?e.cover_image||Q.defaultNoteCover:"".concat(M).concat(e.cover_image||Q.defaultNoteCover),alt:e.title||"封面图",className:"absolute inset-0 w-full h-full object-cover",onError:e=>{e.target.style.display="none"}})})}),(0,r.jsx)("div",{className:"mb-2 flex items-start ".concat(e.title?"min-h-[32px]":"min-h-[12px]"),children:e.title&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("h3",{className:"text-base font-semibold text-text-primary line-clamp-2",children:e.title}),e.is_pinned&&(0,r.jsxs)("div",{className:"flex items-center gap-1 px-2 py-0.5 bg-gradient-to-r from-red-500 to-pink-500 text-white rounded text-xs font-semibold flex-shrink-0",children:[(0,r.jsx)(w.Z,{className:"w-3 h-3 fill-current"}),(0,r.jsx)("span",{children:"置顶"})]})]})}),(0,r.jsxs)("div",{className:"flex-1 mb-2",children:[ex(e.content)&&(0,r.jsx)("div",{className:"bg-bg-tertiary rounded-md p-2 hover:bg-bg-tertiary/80 transition-all cursor-pointer",onClick:t=>{t.stopPropagation(),window.open(e.content.trim(),"_blank")},children:(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsxs)("div",{className:"flex-shrink-0",children:[(null===(c=$[e.content.trim()])||void 0===c?void 0:c.favicon)?(0,r.jsx)("img",{src:$[e.content.trim()].favicon,alt:"网站图标",className:"w-8 h-8 rounded-md object-cover",onError:e=>{let t=e.target;t.style.display="none";let a=t.nextElementSibling;a&&(a.style.display="flex")}}):null,(0,r.jsx)("div",{className:"w-8 h-8 rounded-md bg-gradient-to-br from-primary-500 to-purple-500 flex items-center justify-center text-white font-semibold text-sm",style:(null===(d=$[e.content.trim()])||void 0===d?void 0:d.favicon)?{display:"none"}:{},children:ep(e.content.trim()).charAt(0).toUpperCase()})]}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("h4",{className:"font-medium text-text-primary truncate text-sm mb-1",children:(null===(m=$[e.content.trim()])||void 0===m?void 0:m.title)||(()=>{let t=ep(e.content.trim()).replace("www.",""),a=t.split(".");return a.length>1?a[0].charAt(0).toUpperCase()+a[0].slice(1):t})()}),(0,r.jsx)("p",{className:"text-xs text-text-secondary mb-1 line-clamp-2 leading-relaxed",children:(null===(x=$[e.content.trim()])||void 0===x?void 0:x.description)||"点击卡片访问网站"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-xs text-text-tertiary bg-bg-tertiary/50 px-2 py-0.5 rounded",children:(()=>{try{return new URL(e.content.trim()).hostname}catch(t){return ep(e.content.trim())}})()}),(0,r.jsx)("span",{className:"text-xs text-primary-500 font-medium",children:"立即访问 →"})]})]})]})}),!ex(e.content)&&(0,r.jsx)("p",{className:"text-text-secondary leading-relaxed line-clamp-3 ".concat(e.title?"text-sm":"text-base"),children:e.summary||F(q(e.content),150)})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1.5 text-text-tertiary",children:[(0,r.jsx)(k.Z,{className:"w-3 h-3"}),(0,r.jsx)("span",{children:P(e.published_at||e.created_at)})]}),Q.showNoteCategories&&e.category&&(0,r.jsxs)("span",{className:"px-2 py-0.5 bg-primary-100 text-primary-700 rounded-full font-medium cursor-pointer hover:bg-primary-200 transition-colors hidden md:inline-block",onClick:t=>{t.stopPropagation(),eb(e.category)},children:[(null===(p=ev.get(e.category))||void 0===p?void 0:p.icon)&&(0,r.jsx)("span",{className:"mr-1",children:null===(u=ev.get(e.category))||void 0===u?void 0:u.icon}),e.category]}),Q.showNoteTags&&(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[e.Tags&&e.Tags.length>0&&(0,r.jsxs)(r.Fragment,{children:[e.Tags.slice(0,el?1:2).map(e=>(0,r.jsx)("span",{className:"px-2 py-0.5 rounded-full font-medium cursor-pointer hover:bg-bg-tertiary transition-colors hidden md:inline-block",style:e.color?{backgroundColor:"".concat(e.color,"20"),color:e.color}:{backgroundColor:"rgb(242 242 242)",color:"rgb(112 112 112)"},onClick:t=>{t.stopPropagation(),eg(e.name)},children:e.name},e.id)),e.Tags.length>(el?1:2)&&(0,r.jsxs)("span",{className:"px-2 py-0.5 rounded-full hidden md:inline-block",style:{backgroundColor:"rgb(242 242 242)",color:"rgb(112 112 112)"},children:["+",e.Tags.length-(el?1:2)]})]}),(!e.Tags||0===e.Tags.length)&&e.tags&&(0,r.jsxs)(r.Fragment,{children:[e.tags.split(",").slice(0,el?1:2).map((e,t)=>(0,r.jsx)("span",{className:"px-2 py-0.5 rounded-full font-medium cursor-pointer hover:bg-bg-tertiary transition-colors hidden md:inline-block",style:{backgroundColor:"rgb(242 242 242)",color:"rgb(112 112 112)"},onClick:t=>{t.stopPropagation(),eg(e.trim())},children:e.trim()},t)),e.tags.split(",").length>(el?1:2)&&(0,r.jsxs)("span",{className:"px-2 py-0.5 rounded-full hidden md:inline-block",style:{backgroundColor:"rgb(242 242 242)",color:"rgb(112 112 112)"},children:["+",e.tags.split(",").length-(el?1:2)]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1 md:hidden",children:[Q.showNoteCategories&&e.category&&(0,r.jsxs)("span",{className:"px-2 py-0.5 bg-primary-100 text-primary-700 rounded-full font-medium cursor-pointer hover:bg-primary-200 transition-colors",onClick:t=>{t.stopPropagation(),eb(e.category)},children:[(null===(h=ev.get(e.category))||void 0===h?void 0:h.icon)&&(0,r.jsx)("span",{className:"mr-1",children:null===(g=ev.get(e.category))||void 0===g?void 0:g.icon}),e.category]}),Q.showNoteTags&&(0,r.jsxs)(r.Fragment,{children:[e.Tags&&e.Tags.length>0&&(0,r.jsx)("span",{className:"px-2 py-0.5 rounded-full font-medium cursor-pointer hover:bg-bg-tertiary transition-colors",style:e.Tags[0].color?{backgroundColor:"".concat(e.Tags[0].color,"20"),color:e.Tags[0].color}:{backgroundColor:"rgb(242 242 242)",color:"rgb(112 112 112)"},onClick:t=>{t.stopPropagation(),eg(e.Tags[0].name)},children:e.Tags[0].name}),(!e.Tags||0===e.Tags.length)&&e.tags&&(0,r.jsx)("span",{className:"px-2 py-0.5 rounded-full font-medium cursor-pointer hover:bg-bg-tertiary transition-colors",style:{backgroundColor:"rgb(242 242 242)",color:"rgb(112 112 112)"},onClick:t=>{t.stopPropagation(),eg(e.tags.split(",")[0].trim())},children:e.tags.split(",")[0].trim()})]})]})]}),(0,r.jsx)("span",{className:"text-primary-500 font-medium",children:"详情 →"})]})]})},e.id)})}),b>1&&(0,r.jsxs)("div",{className:"flex justify-center gap-2 pt-6 mt-4",children:[(0,r.jsx)("button",{onClick:()=>g(e=>Math.max(1,e-1)),disabled:1===h,className:"px-3 py-1.5 rounded-lg bg-bg-primary text-text-secondary hover:bg-bg-secondary disabled:opacity-30 disabled:cursor-not-allowed transition-all text-sm",children:"上一页"}),(0,r.jsx)("div",{className:"flex items-center gap-1.5",children:Array.from({length:Math.min(b,5)},(e,t)=>{let a;let s=(a=b<=5?t+1:h<=3?t+1:h>=b-2?b-4+t:h-2+t)===h;return(0,r.jsx)("button",{onClick:()=>g(a),className:"w-8 h-8 rounded-lg transition-all text-sm "+(s?"bg-primary-500 text-white":"bg-bg-primary text-text-secondary hover:bg-bg-secondary"),children:a},a)})}),(0,r.jsx)("button",{onClick:()=>g(e=>Math.min(b,e+1)),disabled:h===b,className:"px-3 py-1.5 rounded-lg bg-bg-primary text-text-secondary hover:bg-bg-secondary disabled:opacity-30 disabled:cursor-not-allowed transition-all text-sm",children:"下一页"})]}),W&&f&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",children:(0,r.jsxs)(n.E.div,{className:"bg-bg-secondary rounded-2xl max-w-md w-full p-6 border border-border-primary shadow-2xl",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.2},children:[(0,r.jsxs)("div",{className:"text-center mb-6",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("svg",{className:"w-8 h-8 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,r.jsx)("h3",{className:"text-xl font-bold text-text-primary mb-2",children:"此笔记需要密码"}),(0,r.jsx)("p",{className:"text-sm text-text-secondary",children:"请输入访问密码以查看内容"})]}),(0,r.jsxs)("form",{onSubmit:ed,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"password",value:A,onChange:e=>B(e.target.value),placeholder:"请输入密码",className:"w-full px-4 py-3 border border-border-primary rounded-lg bg-bg-primary text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",autoFocus:!0,autoComplete:"current-password",disabled:U}),R&&(0,r.jsx)("p",{className:"mt-2 text-sm text-red-600",children:R})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{D(!1),v(null),B(""),I("")},className:"flex-1 px-4 py-3 bg-bg-tertiary text-text-secondary rounded-lg hover:bg-bg-tertiary/80 transition-colors",disabled:U,children:"取消"}),(0,r.jsx)("button",{type:"submit",className:"flex-1 px-4 py-3 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:U||!A,children:U?"验证中...":"确认"})]})]})]})}),j&&f&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",children:(0,r.jsxs)(n.E.div,{className:"bg-bg-primary rounded-2xl max-w-4xl w-full max-h-[80vh] overflow-hidden flex flex-col border border-border-primary",style:{boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.15)"},initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.2},children:[(0,r.jsxs)("div",{className:"bg-bg-secondary/50 px-5 pt-6 pb-4 flex items-center justify-between sticky top-0 z-50 backdrop-blur-sm",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1.5",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-text-primary truncate",children:f.title}),"original"===f.source_type&&(0,r.jsxs)("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700/50 rounded text-[10px] font-medium flex-shrink-0",children:[(0,r.jsx)("svg",{className:"w-2.5 h-2.5 text-green-600 dark:text-green-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsx)("span",{className:"text-green-700 dark:text-green-300",children:"原创"})]}),"reprint"===f.source_type&&(0,r.jsxs)("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-700/50 rounded text-[10px] font-medium flex-shrink-0",children:[(0,r.jsx)("svg",{className:"w-2.5 h-2.5 text-orange-600 dark:text-orange-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),(0,r.jsx)("span",{className:"text-orange-700 dark:text-orange-300",children:"转载"})]}),f.content&&f.content.includes("[网盘资源]")&&(0,r.jsxs)("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700/50 rounded text-[10px] font-medium flex-shrink-0",children:[(0,r.jsx)("svg",{className:"w-2.5 h-2.5 text-blue-600 dark:text-blue-400 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{d:"M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"})}),(0,r.jsx)("span",{className:"text-blue-700 dark:text-blue-300",children:"含网盘资源"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 text-xs text-text-tertiary",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(k.Z,{className:"w-3.5 h-3.5"}),(0,r.jsx)("span",{children:P(f.published_at||f.created_at)})]}),Q.showNoteCategories&&f.category&&(0,r.jsx)("span",{className:"px-2 py-0.5 bg-primary-100 text-primary-700 rounded-full font-medium cursor-pointer hover:bg-primary-200 transition-colors",onClick:e=>{e.stopPropagation(),eb(f.category),em()},children:f.category}),Q.showNoteTags&&(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[f.Tags&&f.Tags.length>0&&(0,r.jsx)(r.Fragment,{children:f.Tags.map(e=>(0,r.jsx)("span",{className:"px-2 py-0.5 rounded-full font-medium cursor-pointer hover:bg-gray-200 transition-colors",style:e.color?{backgroundColor:"".concat(e.color,"20"),color:e.color}:{backgroundColor:"rgb(242 242 242)",color:"rgb(112 112 112)"},onClick:t=>{t.stopPropagation(),eg(e.name),em()},children:e.name},e.id))}),(!f.Tags||0===f.Tags.length)&&f.tags&&(0,r.jsx)(r.Fragment,{children:f.tags.split(",").map((e,t)=>(0,r.jsx)("span",{className:"px-2 py-0.5 rounded-full font-medium cursor-pointer hover:bg-gray-200 transition-colors",style:{backgroundColor:"rgb(242 242 242)",color:"rgb(112 112 112)"},onClick:t=>{t.stopPropagation(),eg(e.trim()),em()},children:e.trim()},t))})]})]})]}),(0,r.jsx)("button",{onClick:em,className:"text-text-tertiary hover:text-text-primary transition-colors p-1.5 hover:bg-bg-tertiary/50 rounded-lg flex-shrink-0 ml-3",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsx)("div",{className:"border-t border-border-primary/2 mx-5"}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto p-5 custom-scrollbar bg-bg-primary",children:(0,r.jsxs)("div",{className:"prose prose-lg max-w-none dark:prose-invert prose-headings:text-text-primary prose-headings:font-bold prose-h1:text-2xl prose-h1:mb-4 prose-h2:text-xl prose-h2:mb-3 prose-h2:mt-6 prose-h3:text-lg prose-h3:mb-2 prose-h3:mt-4 prose-h4:text-base prose-h4:mb-2 prose-h4:mt-3 prose-p:text-text-primary prose-p:leading-relaxed prose-p:mb-4 prose-a:text-primary-600 dark:prose-a:text-primary-400 prose-a:no-underline hover:prose-a:underline prose-blockquote:border-l-4 prose-blockquote:border-primary-500 prose-blockquote:bg-bg-tertiary/30 prose-blockquote:py-2 prose-blockquote:px-4 prose-blockquote:rounded-r-lg prose-blockquote:not-italic prose-strong:text-text-primary prose-strong:font-semibold prose-em:text-text-primary prose-em:italic prose-ul:list-disc prose-ul:pl-6 prose-ul:mb-4 prose-ol:list-decimal prose-ol:pl-6 prose-ol:mb-4 prose-li:text-text-primary prose-li:mb-1 prose-table:w-full prose-table:border-collapse prose-table:my-4 prose-th:bg-bg-tertiary prose-th:text-text-primary prose-th:font-semibold prose-th:p-2 prose-th:border prose-th:border-border-primary prose-td:p-2 prose-td:border prose-td:border-border-primary prose-td:text-text-primary prose-img:rounded-lg prose-img:shadow-md prose-img:mx-auto prose-hr:border-hr-color prose-hr:my-6 whitespace-normal ",children:[(0,r.jsx)(S.UG,{remarkPlugins:[T.Z],rehypePlugins:[L.Z],components:{img:e=>{let{src:t,alt:a,...s}=e,l=t;return t&&t.startsWith("/uploads/")&&(l="".concat(M).concat(t)),(0,r.jsx)("div",{className:"flex justify-center my-4",children:(0,r.jsx)("img",{src:l,alt:a||"",className:"max-w-full h-auto rounded-lg shadow-md transition-all duration-300 hover:shadow-lg hover:scale-[1.02]",style:{maxHeight:"400px",objectFit:"contain"},loading:"lazy",onError:e=>{e.target.style.display="none"},...s})})},iframe:e=>{let{node:t,...a}=e;return(0,r.jsx)("div",{className:"my-4 rounded-lg overflow-hidden shadow-md",children:(0,r.jsx)("iframe",{className:"w-full aspect-video",...a})})},pre:e=>{let{node:t,children:a,...l}=e,o=s.Children.toArray(a).join("");return(0,r.jsxs)("div",{className:"relative my-4 group",children:[(0,r.jsx)("pre",{className:"bg-code-block-bg text-code-block-text p-3 rounded-lg overflow-x-auto shadow-sm font-mono text-sm leading-relaxed",...l,children:a}),(0,r.jsx)(z.Z,{text:o})]})},code:e=>{let{node:t,inline:a,className:s,children:l,...o}=e;return a?(0,r.jsx)("code",{...o,children:l}):(0,r.jsx)("code",{className:"text-sm font-mono ".concat(s||""),...o,children:l})},table:e=>{let{node:t,children:a,...s}=e;return(0,r.jsx)("div",{className:"overflow-x-auto my-4 rounded shadow-sm",children:(0,r.jsx)("table",{className:"w-full min-w-full",...s,children:a})})},blockquote:e=>{let{node:t,children:a,...s}=e;return(0,r.jsx)("blockquote",{className:"border-l-4 border-primary-500 bg-bg-tertiary/30 py-2 px-4 rounded-r-lg my-4 text-text-primary italic",...s,children:a})},a:e=>{let{node:t,href:a,children:s,...l}=e;return(0,r.jsx)("a",{href:a,className:"text-primary-600 dark:text-primary-400 no-underline hover:underline transition-colors duration-200 font-medium",target:"_blank",rel:"noopener noreferrer",...l,children:s})},p:e=>{let{node:t,children:a,...l}=e;return s.Children.toArray(a).some(e=>"string"==typeof e&&e.includes("\n"))?(0,r.jsx)("p",{className:"text-text-primary leading-relaxed mb-4 whitespace-normal break-words",...l,children:s.Children.map(a,(e,t)=>{if("string"==typeof e){let a=e.split("\n");return(0,r.jsx)(s.Fragment,{children:a.map((e,t)=>(0,r.jsxs)(s.Fragment,{children:[e,t<a.length-1&&(0,r.jsx)("br",{})]},t))},t)}return e})}):(0,r.jsx)("p",{className:"text-text-primary leading-relaxed mb-4 whitespace-normal break-words",...l,children:a})}},children:f.content}),"reprint"===f.source_type&&f.source_text&&(0,r.jsx)("div",{className:"mt-8 pt-6 border-t border-dashed border-border-primary/15",children:(0,r.jsxs)("div",{className:"text-sm text-text-tertiary",children:[(0,r.jsx)("span",{className:"font-medium",children:"文章来源："}),(0,r.jsx)("span",{className:"ml-1",children:f.source_text})]})})]})}),(0,r.jsxs)("div",{className:"bg-bg-secondary/50 px-5 py-4 flex justify-between items-center sticky bottom-0 z-50 backdrop-blur-sm",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[K&&(0,r.jsxs)("button",{onClick:()=>Y(!0),className:"px-4 py-2 bg-blue-500 text-white text-sm rounded-lg hover:bg-blue-600 transition-all flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{d:"M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"})}),"下载资源"]}),(0,r.jsxs)("button",{onClick:()=>es(!0),className:"px-4 py-2 bg-gradient-to-r from-purple-600 to-indigo-600 text-white text-sm rounded-lg hover:from-purple-700 hover:to-indigo-700 transition-all flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),"分享笔记"]})]}),(0,r.jsx)("button",{onClick:em,className:"px-4 py-2 bg-primary-500 text-white text-sm rounded-lg hover:bg-primary-600 transition-all",children:"关闭"})]})]})}),f&&(0,r.jsx)(Z.Z,{isOpen:V,onClose:()=>Y(!1),noteId:f.id,isAdmin:!1,password:et}),er&&f&&(0,r.jsx)(E.Z,{noteId:f.id,title:f.title,password:f.password,onClose:()=>es(!1)})]})}var D=a(92451),A=a(10407);function B(e){let{defaultTab:t="notes",notesContent:a,sitesContent:l}=e,[o,i]=(0,s.useState)(t),[d,m]=(0,s.useState)(0),[x,p]=(0,s.useState)(0),u=(0,s.useRef)(null);return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("div",{className:"flex items-center justify-center mb-6 gap-3",children:[(0,r.jsx)("button",{onClick:()=>{"sites"===o&&i("notes")},disabled:"notes"===o,className:"p-1.5 rounded-lg transition-all ".concat("notes"===o?"opacity-20 cursor-not-allowed":"hover:bg-bg-secondary opacity-60 hover:opacity-100"),"aria-label":"上一页",children:(0,r.jsx)(D.Z,{className:"w-5 h-5 text-text-primary"})}),(0,r.jsxs)("div",{className:"flex gap-2 bg-bg-secondary rounded-full p-1 border border-border-primary",children:[(0,r.jsx)("button",{onClick:()=>i("notes"),className:"px-5 py-2 rounded-full text-xs font-medium transition-all ".concat("notes"===o?"bg-primary-500 text-white":"text-text-secondary hover:text-text-primary"),children:"文字碎片"}),(0,r.jsx)("button",{onClick:()=>i("sites"),className:"px-5 py-2 rounded-full text-xs font-medium transition-all ".concat("sites"===o?"bg-primary-500 text-white":"text-text-secondary hover:text-text-primary"),children:"常用导航"})]}),(0,r.jsx)("button",{onClick:()=>{"notes"===o&&i("sites")},disabled:"sites"===o,className:"p-1.5 rounded-lg transition-all ".concat("sites"===o?"opacity-20 cursor-not-allowed":"hover:bg-bg-secondary opacity-60 hover:opacity-100"),"aria-label":"下一页",children:(0,r.jsx)(A.Z,{className:"w-5 h-5 text-text-primary"})})]}),(0,r.jsx)("div",{ref:u,className:"relative overflow-hidden",onTouchStart:e=>{m(e.targetTouches[0].clientX)},onTouchMove:e=>{p(e.targetTouches[0].clientX)},onTouchEnd:()=>{if(!d||!x)return;let e=d-x;e>50&&"notes"===o&&i("sites"),e<-50&&"sites"===o&&i("notes"),m(0),p(0)},children:(0,r.jsx)(c.M,{mode:"wait",children:"notes"===o?(0,r.jsx)(n.E.div,{initial:{opacity:0,x:-15},animate:{opacity:1,x:0},exit:{opacity:0,x:15},transition:{duration:.2},children:a},"notes"):(0,r.jsx)(n.E.div,{initial:{opacity:0,x:15},animate:{opacity:1,x:0},exit:{opacity:0,x:-15},transition:{duration:.2},children:l},"sites")})}),(0,r.jsxs)("div",{className:"flex justify-center gap-1.5 mt-5",children:[(0,r.jsx)("div",{className:"w-1.5 h-1.5 rounded-full transition-all ".concat("notes"===o?"bg-primary-500 w-6":"bg-border-secondary")}),(0,r.jsx)("div",{className:"w-1.5 h-1.5 rounded-full transition-all ".concat("sites"===o?"bg-primary-500 w-6":"bg-border-secondary")})]})]})}var R=a(73247);function I(e){let{defaultTab:t="notes",notesContent:a,sitesContent:l,onSearch:o}=e,[i,d]=(0,s.useState)(t),[m,x]=(0,s.useState)(0),[p,u]=(0,s.useState)(0),[g,b]=(0,s.useState)(""),y=(0,s.useRef)(null),f=()=>{"sites"===i&&d("notes")},v=()=>{"notes"===i&&d("sites")};return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"flex md:hidden items-center justify-center gap-3 mb-4",children:[(0,r.jsx)("button",{onClick:f,disabled:"notes"===i,className:"p-1.5 rounded-lg transition-all ".concat("notes"===i?"opacity-20 cursor-not-allowed":"hover:bg-bg-secondary opacity-60 hover:opacity-100"),"aria-label":"上一页",children:(0,r.jsx)(D.Z,{className:"w-5 h-5 text-text-primary"})}),(0,r.jsxs)("div",{className:"flex gap-2 bg-bg-secondary rounded-full p-1 border border-border-primary",children:[(0,r.jsx)("button",{onClick:()=>d("notes"),className:"px-5 py-2 rounded-full text-xs font-medium transition-all ".concat("notes"===i?"bg-primary-500 text-white":"text-text-secondary hover:text-text-primary"),children:"文字碎片"}),(0,r.jsx)("button",{onClick:()=>d("sites"),className:"px-5 py-2 rounded-full text-xs font-medium transition-all ".concat("sites"===i?"bg-primary-500 text-white":"text-text-secondary hover:text-text-primary"),children:"常用导航"})]}),(0,r.jsx)("button",{onClick:v,disabled:"sites"===i,className:"p-1.5 rounded-lg transition-all ".concat("sites"===i?"opacity-20 cursor-not-allowed":"hover:bg-bg-secondary opacity-60 hover:opacity-100"),"aria-label":"下一页",children:(0,r.jsx)(A.Z,{className:"w-5 h-5 text-text-primary"})})]}),(0,r.jsxs)("div",{className:"hidden md:flex items-center justify-between gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("button",{onClick:f,disabled:"notes"===i,className:"p-1.5 rounded-lg transition-all ".concat("notes"===i?"opacity-20 cursor-not-allowed":"hover:bg-bg-secondary opacity-60 hover:opacity-100"),"aria-label":"上一页",children:(0,r.jsx)(D.Z,{className:"w-5 h-5 text-text-primary"})}),(0,r.jsxs)("div",{className:"flex gap-2 bg-bg-secondary rounded-full p-1 border border-border-primary",children:[(0,r.jsx)("button",{onClick:()=>d("notes"),className:"px-5 py-2 rounded-full text-xs font-medium transition-all ".concat("notes"===i?"bg-primary-500 text-white":"text-text-secondary hover:text-text-primary"),children:"文字碎片"}),(0,r.jsx)("button",{onClick:()=>d("sites"),className:"px-5 py-2 rounded-full text-xs font-medium transition-all ".concat("sites"===i?"bg-primary-500 text-white":"text-text-secondary hover:text-text-primary"),children:"常用导航"})]}),(0,r.jsx)("button",{onClick:v,disabled:"sites"===i,className:"p-1.5 rounded-lg transition-all ".concat("sites"===i?"opacity-20 cursor-not-allowed":"hover:bg-bg-secondary opacity-60 hover:opacity-100"),"aria-label":"下一页",children:(0,r.jsx)(A.Z,{className:"w-5 h-5 text-text-primary"})})]}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)("form",{onSubmit:e=>{e.preventDefault(),o&&o(g,i)},className:"w-72",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(R.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-text-tertiary"}),(0,r.jsx)("input",{type:"text",id:"desktop-tabbed-search",name:"search",placeholder:"搜索".concat("notes"===i?"文字碎片":"常用导航","..."),value:g,onChange:e=>{let t=e.target.value;b(t),o&&o(t,i)},className:"w-full pl-10 pr-10 py-2.5 bg-bg-secondary border border-border-primary rounded-lg text-sm text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-0 focus:border-border-primary",autoComplete:"off"}),g&&(0,r.jsx)("button",{type:"button",onClick:()=>{b(""),o&&o("",i)},className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-tertiary hover:text-text-primary transition-colors","aria-label":"清空搜索",children:(0,r.jsx)(h.Z,{className:"w-4 h-4"})})]})})})]})]}),(0,r.jsx)("div",{ref:y,className:"relative overflow-hidden",onTouchStart:e=>{x(e.targetTouches[0].clientX)},onTouchMove:e=>{u(e.targetTouches[0].clientX)},onTouchEnd:()=>{if(!m||!p)return;let e=m-p;e>50&&"notes"===i&&d("sites"),e<-50&&"sites"===i&&d("notes"),x(0),u(0)},children:(0,r.jsx)(c.M,{mode:"wait",children:"notes"===i?(0,r.jsx)(n.E.div,{initial:{opacity:0,x:-15},animate:{opacity:1,x:0},exit:{opacity:0,x:15},transition:{duration:.2},children:a},"notes"):(0,r.jsx)(n.E.div,{initial:{opacity:0,x:15},animate:{opacity:1,x:0},exit:{opacity:0,x:-15},transition:{duration:.2},children:l},"sites")})}),(0,r.jsxs)("div",{className:"flex justify-center gap-1.5 mt-5",children:[(0,r.jsx)("div",{className:"w-1.5 h-1.5 rounded-full transition-all ".concat("notes"===i?"bg-primary-500 w-6":"bg-border-secondary")}),(0,r.jsx)("div",{className:"w-1.5 h-1.5 rounded-full transition-all ".concat("sites"===i?"bg-primary-500 w-6":"bg-border-secondary")})]})]})}var U=a(58326);function H(){let[e,t]=(0,s.useState)([]),[a,o]=(0,s.useState)(0),[i,n]=(0,s.useState)(!0);(0,s.useEffect)(()=>{c()},[]),(0,s.useEffect)(()=>{if(e.length>1){let t=setInterval(()=>{o(t=>(t+1)%e.length)},5e3);return()=>clearInterval(t)}},[e.length]);let c=async()=>{try{let e=await (0,l.Gw4)();if(e.success&&e.data){let a={};e.data.forEach(e=>{a[e.key]=e.value});try{let e=JSON.parse(a.blogCarouselImages||"[]");t(e.filter(e=>e.url))}catch(e){t([])}}}catch(e){console.error("Failed to load carousel settings:",e)}finally{n(!1)}},d=e=>{o(e)};return i?(0,r.jsx)("div",{className:"w-full aspect-video md:h-96 md:aspect-auto bg-bg-tertiary animate-pulse rounded-lg"}):0===e.length?(0,r.jsx)("div",{className:"relative w-full overflow-hidden rounded-lg shadow-sm bg-bg-secondary flex items-center justify-center aspect-video md:h-96 md:aspect-auto",children:(0,r.jsx)("p",{className:"text-text-tertiary text-sm",children:"暂无轮播图，请在后台上传"})}):(0,r.jsxs)("div",{className:"relative w-full overflow-hidden rounded-lg shadow-sm aspect-video md:h-96 md:aspect-auto",children:[(0,r.jsx)("div",{className:"relative w-full h-full",children:e.map((e,t)=>{let s=(0,r.jsx)("img",{src:(0,l.Jn$)(e.url),alt:e.alt,className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none"}});return(0,r.jsx)("div",{className:"absolute inset-0 transition-opacity duration-500 ease-in-out ".concat(t===a?"opacity-100":"opacity-0"),children:e.link?(0,r.jsx)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",className:"block w-full h-full",children:s}):s},t)})}),e.length>1&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>{o(t=>(t-1+e.length)%e.length)},className:"absolute left-4 top-1/2 transform -translate-y-1/2 bg-primary-500/50 hover:bg-primary-600 text-white p-2 rounded-full transition-colors duration-200",children:(0,r.jsx)(D.Z,{className:"h-5 w-5"})}),(0,r.jsx)("button",{onClick:()=>{o(t=>(t+1)%e.length)},className:"absolute right-4 top-1/2 transform -translate-y-1/2 bg-primary-500/50 hover:bg-primary-600 text-white p-2 rounded-full transition-colors duration-200",children:(0,r.jsx)(A.Z,{className:"h-5 w-5"})}),(0,r.jsx)("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2",children:e.map((e,t)=>(0,r.jsx)("button",{onClick:()=>d(t),className:"w-3 h-3 rounded-full transition-colors duration-200 ".concat(t===a?"bg-primary-500":"bg-primary-300")},t))})]})]})}function $(){var e;let[t,a]=(0,s.useState)(null),[i,n]=(0,s.useState)([]),[c,d]=(0,s.useState)(!0),[m,x]=(0,s.useState)(!1),[p,u]=(0,s.useState)(null),[g,b]=(0,s.useState)(!1),[y,f]=(0,s.useState)(null),[v,j]=(0,s.useState)(!1),[N,w]=(0,s.useState)("circle");(0,s.useEffect)(()=>{k(),T(),C()},[]);let k=async()=>{try{let e=await (0,l.AiP)();a(e)}catch(e){console.error("Failed to load profile:",e)}finally{d(!1)}},C=async()=>{try{let e=await (0,l.Gw4)();if(e.success){let t=e.data.find(e=>"avatarShape"===e.key);t&&w(t.value)}}catch(e){console.error("Failed to load settings:",e)}},S=()=>"rounded"===N?"rounded-xl":"rounded-full",T=async()=>{try{var e;let t=await l.ZPm.get("/social-links?visible=true"),a=null===(e=t.data)||void 0===e?void 0:e.data,r=Array.isArray(a)?a.filter(e=>e.show_in_profile).slice(0,4):[];n(r)}catch(e){console.error("Failed to load social links:",e),n([])}},L=(e,t)=>{t.qrcode&&""!==t.qrcode.trim()?(e.preventDefault(),u({image:t.qrcode,platform:t.platform}),x(!0)):t.link&&""!==t.link.trim()&&"#"!==t.link||(e.preventDefault(),f({account:t.account,platform:t.platform}),b(!0))},_=()=>{x(!1),setTimeout(()=>u(null),300)},Z=()=>{b(!1),j(!1),setTimeout(()=>f(null),300)},E=async()=>{if(y)try{await navigator.clipboard.writeText(y.account),j(!0),setTimeout(()=>j(!1),2e3)}catch(e){console.error("Failed to copy:",e)}};return c?(0,r.jsx)("div",{className:"bg-bg-secondary rounded-lg shadow-sm p-6 border border-border-primary h-full",children:(0,r.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,r.jsx)("div",{className:"w-20 h-20 bg-bg-tertiary rounded-full animate-pulse"}),(0,r.jsxs)("div",{className:"w-full space-y-2",children:[(0,r.jsx)("div",{className:"h-6 w-32 bg-bg-tertiary animate-pulse mx-auto"}),(0,r.jsx)("div",{className:"h-4 w-48 bg-bg-tertiary animate-pulse mx-auto"})]})]})}):t?(0,r.jsxs)("div",{className:"bg-bg-secondary rounded-lg shadow-sm hover:shadow-lg transition-all duration-300 p-6 border border-border-primary h-full flex flex-col justify-center",children:[(0,r.jsx)("div",{className:"flex justify-center mb-4",children:t.avatar?(0,r.jsx)("img",{src:(0,l.Jn$)(t.avatar),alt:t.name||"头像",className:"w-20 h-20 ".concat(S()," object-cover shadow-lg"),style:{boxShadow:"0 3px 10px 0 rgba(0, 0, 0, 0.12)"}}):(0,r.jsx)("div",{className:"w-20 h-20 ".concat(S()," bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center text-white text-2xl font-bold shadow-lg"),style:{boxShadow:"0 3px 10px 0 rgba(0, 0, 0, 0.12)"},children:(null===(e=t.name)||void 0===e?void 0:e[0])||"X"})}),(0,r.jsxs)("div",{className:"text-center mb-4",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-text-primary",children:t.name||"Xs-Blog"}),t.title&&(0,r.jsx)("p",{className:"text-sm text-text-secondary mt-2",children:t.title}),t.bio&&(0,r.jsx)("p",{className:"text-sm text-text-tertiary mt-3 line-clamp-3",children:t.bio})]}),(0,r.jsx)("div",{className:"flex flex-wrap justify-center gap-3 mb-4",children:[t.location&&(0,r.jsxs)("div",{className:"flex items-center text-xs text-text-tertiary",children:[(0,r.jsxs)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),t.location]},"location"),t.email&&(0,r.jsxs)("div",{className:"flex items-center text-xs text-text-tertiary",children:[(0,r.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.email]},"email"),t.website&&(0,r.jsxs)("a",{href:t.website,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-xs text-primary-600 hover:text-primary-700 transition-colors",children:[(0,r.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})}),t.website_title||"个人网站"]},"website")].filter(Boolean)}),i.length>0&&(0,r.jsx)("div",{className:"flex items-center pt-5 border-t border-border-primary/20 px-8 ".concat(1===i.length?"justify-center":"justify-between"),children:i.map((e,t)=>(0,r.jsx)("a",{href:e.link||"#",target:e.link?"_blank":"_self",rel:"noopener noreferrer",onClick:t=>L(t,e),className:"group relative flex items-center justify-center transition-all hover:scale-110 hover:opacity-80 cursor-pointer",title:"".concat(e.platform,": ").concat(e.account),children:e.icon&&""!==e.icon.trim()?(0,r.jsx)("div",{className:"flex items-center justify-center ".concat(1===i.length?"w-10 h-10":2===i.length?"w-9 h-9":3===i.length?"w-8 h-8":"w-7 h-7"),children:(0,r.jsx)("img",{src:"".concat((0,o.qm)(e.icon),"?v=").concat(e.updated_at||Date.now()),alt:e.platform,className:"w-full h-full object-contain transition-all group-hover:brightness-110 icon-themed",onError:e=>{e.target.style.display="none"}})}):(0,r.jsx)("div",{className:"rounded-full bg-primary-500/20 flex items-center justify-center text-primary-500 font-bold group-hover:bg-primary-500/30 transition-colors ".concat(1===i.length?"w-10 h-10 text-base":2===i.length?"w-9 h-9 text-sm":3===i.length?"w-8 h-8 text-sm":"w-7 h-7 text-xs"),children:e.platform[0].toUpperCase()})},"social-link-".concat(e.id,"-").concat(t)))}),m&&p&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:_,children:(0,r.jsxs)("div",{className:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6 max-w-sm w-full",onClick:e=>e.stopPropagation(),children:[(0,r.jsx)("button",{onClick:_,className:"absolute top-4 right-4 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"关闭",children:(0,r.jsx)(h.Z,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4 capitalize",children:p.platform}),(0,r.jsx)("div",{className:"bg-white p-4 rounded-xl inline-block",children:(0,r.jsx)("img",{src:(0,o.qm)(p.image),alt:"".concat(p.platform," QR Code"),className:"w-64 h-64 object-contain"})}),(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-4",children:"扫描二维码添加联系方式"})]})]})}),g&&y&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:Z,children:(0,r.jsxs)("div",{className:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6 max-w-sm w-full",onClick:e=>e.stopPropagation(),children:[(0,r.jsx)("button",{onClick:Z,className:"absolute top-4 right-4 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"关闭",children:(0,r.jsx)(h.Z,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4 capitalize",children:y.platform}),(0,r.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-xl mb-4",children:(0,r.jsx)("p",{className:"text-lg font-mono text-gray-900 dark:text-white break-all",children:y.account})}),(0,r.jsx)("button",{onClick:E,className:"w-full py-3 px-4 rounded-lg font-medium transition-colors ".concat(v?"bg-green-500 text-white":"bg-primary-500 hover:bg-primary-600 text-white"),children:v?"✓ 已复制":"复制账号"})]})]})})]}):null}var O=a(45024);let Q={showSiteNav:!0,showNotes:!0,showSocialLinks:!0,themeColor:"white",themeType:"default",footerCopyright:"\xa9 ".concat(new Date().getFullYear()," 个人主页. All rights reserved."),backgroundImage:"",backgroundOpacity:"0.5",defaultDisplaySection:"notes",showTopNavbar:"true",showWapSidebar:"true"};function X(){let[e,t]=(0,s.useState)(Q),[a,n]=(0,s.useState)(""),[c,d]=(0,s.useState)("notes"),[m,x]=(0,s.useState)(!1);(0,s.useEffect)(()=>{(async()=>{try{let a=await (0,l.Gw4)();if(a.success&&a.data){var e;let r={};a.data.forEach(e=>{r[e.key]=e.value});let s={showSiteNav:"false"!==r.showSiteNav,showNotes:"false"!==r.showNotes,showSocialLinks:"false"!==r.showSocialLinks,themeColor:r.themeColor||"white",themeType:r.themeType||"default",footerCopyright:r.footerCopyright||"\xa9 ".concat(new Date().getFullYear()," 个人主页. All rights reserved."),backgroundImage:(e=r.backgroundImage,(0,o.qm)(e)),backgroundOpacity:r.backgroundOpacity||"0.5",defaultDisplaySection:r.defaultDisplaySection||"notes",showTopNavbar:r.showTopNavbar||"true",showWapSidebar:r.showWapSidebar||"true"};t(s)}}catch(e){console.error("Failed to load settings:",e)}})();let e=()=>{x(window.innerWidth>=1024)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let{showSiteNav:p,showNotes:u,showSocialLinks:h,themeColor:g,themeType:y,footerCopyright:f,backgroundImage:v,backgroundOpacity:j,defaultDisplaySection:w}=e,k="blog"===y,C="false"!==e.showTopNavbar,S="false"!==e.showWapSidebar,T=e=>{n(e),d("notes")},L=!u&&!p;return(0,r.jsxs)("main",{className:"min-h-screen bg-bg-primary relative flex flex-col overflow-x-hidden",children:[k?(0,r.jsx)(U.Z,{onSearch:T,isBlogMode:!0,showWapSidebar:S}):C?(0,r.jsx)(U.Z,{onSearch:T,isBlogMode:!1,showWapSidebar:S}):null,v&&(0,r.jsx)("div",{className:"absolute inset-0 z-0",style:{backgroundImage:"url(".concat(v,")"),backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",opacity:parseFloat(j)}}),k&&(0,r.jsxs)("div",{className:"relative z-0",children:[(k||C)&&(0,r.jsx)("div",{className:"h-16"}),(0,r.jsxs)("div",{className:"container mx-auto px-4 max-w-6xl pt-3 pb-4 md:py-8",children:[(0,r.jsxs)("section",{className:"animate-slide-up mb-8",style:{animationDelay:"0.1s"},children:[(0,r.jsxs)("div",{className:"hidden lg:flex gap-6 items-stretch",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)(H,{})}),(0,r.jsx)("div",{className:"w-72 flex-shrink-0 h-96",children:m&&(0,r.jsx)($,{})})]}),(0,r.jsx)("div",{className:"lg:hidden",children:(0,r.jsx)(H,{})})]}),!L&&(0,r.jsxs)("section",{className:"animate-slide-up",style:{animationDelay:"0.2s"},children:[u&&p&&(0,r.jsx)(I,{defaultTab:w,notesContent:(0,r.jsx)(W,{searchQuery:"notes"===c?a:""}),sitesContent:(0,r.jsx)(N,{searchQuery:"sites"===c?a:""}),onSearch:(e,t)=>{n(e),d(t)}}),u&&!p&&(0,r.jsx)(W,{searchQuery:a}),!u&&p&&(0,r.jsx)(N,{searchQuery:a})]})]}),(0,r.jsxs)("footer",{className:"text-center text-sm relative z-10 mt-12 py-6",children:[(0,r.jsx)("div",{className:"text-text-tertiary",dangerouslySetInnerHTML:{__html:f}}),(0,r.jsx)(O.Z,{})]})]}),!k&&(0,r.jsxs)("div",{className:"relative z-0 ".concat(L?"flex-1 flex flex-col":""),children:[C&&(0,r.jsx)("div",{className:"h-16"}),(0,r.jsxs)("div",{className:"container mx-auto px-4 max-w-6xl py-8 ".concat(L?"flex flex-col justify-center flex-1":""),children:[(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,r.jsx)("section",{className:"text-center animate-fade-in mb-6",children:(0,r.jsx)(i,{})}),h&&(0,r.jsx)("section",{className:"animate-slide-up",style:{animationDelay:"0.1s"},children:(0,r.jsx)(b,{className:"gap-4"})})]}),!L&&(0,r.jsxs)("section",{className:"animate-slide-up mt-12",style:{animationDelay:"0.2s"},children:[u&&p&&(0,r.jsx)(B,{defaultTab:w,notesContent:(0,r.jsx)(W,{}),sitesContent:(0,r.jsx)(N,{})}),u&&!p&&(0,r.jsx)(W,{searchQuery:a}),!u&&p&&(0,r.jsx)(N,{searchQuery:a})]})]}),(0,r.jsxs)("footer",{className:"text-center text-sm relative z-10 ".concat(L?"mt-auto py-8":"mt-12 py-6"),children:[(0,r.jsx)("div",{className:"text-text-tertiary",dangerouslySetInnerHTML:{__html:f}}),(0,r.jsx)(O.Z,{})]})]})]})}}},function(e){e.O(0,[660,278,833,543,811,14,715,701,284,268,513,822,557,787,548,174,362,153,565,351,744],function(){return e(e.s=68586)}),_N_E=e.O()}]);