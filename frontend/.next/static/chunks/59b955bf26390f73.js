(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,40160,e=>{"use strict";let t=(0,e.i(75254).default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);e.s(["Download",()=>t],40160)},54212,20354,e=>{"use strict";var t=e.i(75254);let r=(0,t.default)("zoom-in",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);e.s(["ZoomIn",()=>r],54212);let a=(0,t.default)("zoom-out",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);e.s(["ZoomOut",()=>a],20354)},53951,e=>{"use strict";var t=e.i(18050),r=e.i(71645),a=e.i(75254);let n=(0,a.default)("maximize-2",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]]);var s=e.i(40160),l=e.i(37727),o=e.i(54212),c=e.i(20354);let i=(0,a.default)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var u=e.i(74080);let d=null;function h({chart:a,className:h=""}){let x=(0,r.useRef)(null),g=(0,r.useRef)(null),[m,y]=(0,r.useState)(""),[b,f]=(0,r.useState)(null),[v,p]=(0,r.useState)(!1),[k,w]=(0,r.useState)(1),[C,j]=(0,r.useState)({x:0,y:0}),[M,L]=(0,r.useState)(!1),N=(0,r.useRef)(null),E=(0,r.useRef)(null),S=(0,r.useRef)(!1),R=(0,r.useRef)({x:0,y:0}),T=(0,r.useRef)({x:0,y:0}),$=(0,r.useRef)(1),B=(0,r.useRef)(0),D=(0,r.useRef)({x:0,y:0}),A=(0,r.useRef)(!1),U=(0,r.useRef)({x:0,y:0,scrollLeft:0});(0,r.useEffect)(()=>{T.current=C},[C]),(0,r.useEffect)(()=>{$.current=k},[k]),(0,r.useEffect)(()=>{L(!0)},[]),(0,r.useEffect)(()=>{let t=async()=>{try{d||(d=await e.A(95802));let t=d.default;t.initialize({startOnLoad:!1,theme:"base",securityLevel:"loose",fontFamily:"system-ui, -apple-system, sans-serif",themeVariables:{primaryTextColor:"#54697b",secondaryTextColor:"#54697b",tertiaryTextColor:"#54697b",textColor:"#54697b",nodeTextColor:"#54697b",primaryColor:"#e8f4fc",primaryBorderColor:"#9ecbea",secondaryColor:"#fff5e6",secondaryBorderColor:"#f5c77e",tertiaryColor:"#f0f0f0",tertiaryBorderColor:"#cccccc",lineColor:"#54697b",labelTextColor:"#54697b",actorTextColor:"#54697b",signalTextColor:"#54697b",labelBoxBkgColor:"#e8f4fc",labelBoxBorderColor:"#9ecbea",noteBkgColor:"#fff5e6",noteTextColor:"#54697b",noteBorderColor:"#f5c77e",pieTextColor:"#54697b",taskTextColor:"#54697b",taskTextOutsideColor:"#54697b",sectionBkgColor:"#e8f4fc",classText:"#54697b"},flowchart:{useMaxWidth:!1,htmlLabels:!0,curve:"basis",padding:20,nodeSpacing:50,rankSpacing:50},sequence:{useMaxWidth:!1,wrap:!1,width:180,height:60,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35},gantt:{useMaxWidth:!1,leftPadding:75,rightPadding:20,barHeight:20,barGap:4},mindmap:{useMaxWidth:!1,padding:20},pie:{useMaxWidth:!1},er:{useMaxWidth:!1},journey:{useMaxWidth:!1},gitGraph:{useMaxWidth:!1},class:{useMaxWidth:!1},state:{useMaxWidth:!1}});let r=`mermaid-${Math.random().toString(36).substr(2,9)}`,n=document.createElement("div");n.id=r,n.style.cssText="position:fixed;left:-9999px;top:0;width:3000px;visibility:hidden;",document.body.appendChild(n);try{let{svg:e}=await t.render(`${r}-svg`,a.trim(),n),s=document.createElement("div");s.innerHTML=e;let l=s.querySelector("svg");if(l){let e=l.getAttribute("viewBox"),t=0,r=0;if(e){let a=e.split(/[\s,]+/).map(Number);a.length>=4&&a[2]>0&&a[3]>0&&(t=a[2],r=a[3])}if(!t||!r){let e=l.getAttribute("width"),a=l.getAttribute("height");e&&(t=parseFloat(e)||0),a&&(r=parseFloat(a)||0)}t=Math.max(t,300),r=Math.max(r,200),l.removeAttribute("style"),l.setAttribute("width",String(t)),l.setAttribute("height",String(r)),l.style.cssText=`width:${t}px;height:${r}px;min-width:${t}px;max-width:none;display:block;`}y(s.innerHTML),f(null)}finally{document.body.removeChild(n)}}catch(e){console.error("Mermaid render error:",e),f(e instanceof Error?e.message:"图表渲染失败")}};a&&M&&t()},[a,M]);let W=(0,r.useCallback)(async()=>{if(m&&x.current)try{let e=x.current.querySelector("svg");if(!e)return;let t=e.cloneNode(!0);t.style.maxWidth="none",t.querySelectorAll("*").forEach(e=>{(e instanceof HTMLElement||e instanceof SVGElement)&&(e.style.maxWidth="none")});let r=800,a=600,n=e.getAttribute("viewBox");if(n){let e=n.split(/\s+|,/).map(Number);!(e.length>=4)||isNaN(e[2])||isNaN(e[3])||(r=e[2],a=e[3])}if(r<=0||a<=0){let t=e.getBBox?.();t&&(r=t.width+2*t.x,a=t.height+2*t.y)}r=Math.max(r,400),a=Math.max(a,300),t.setAttribute("width",String(r)),t.setAttribute("height",String(a)),t.setAttribute("viewBox",`0 0 ${r} ${a}`),t.style.width=`${r}px`,t.style.height=`${a}px`;let s=new XMLSerializer().serializeToString(t);s.includes("xmlns")||(s=s.replace("<svg",'<svg xmlns="http://www.w3.org/2000/svg"'));let l=document.createElement("canvas");l.width=2*r,l.height=2*a;let o=l.getContext("2d");if(!o)return;o.fillStyle="#ffffff",o.fillRect(0,0,l.width,l.height);let c=new Blob([s],{type:"image/svg+xml;charset=utf-8"}),i=URL.createObjectURL(c),u=new Image;u.onload=()=>{o.drawImage(u,0,0,l.width,l.height),URL.revokeObjectURL(i);let e=document.createElement("a");e.download=`mermaid-chart-${Date.now()}.png`,e.href=l.toDataURL("image/png",1),e.click()},u.onerror=()=>{URL.revokeObjectURL(i);let e=document.createElement("a");e.download=`mermaid-chart-${Date.now()}.svg`,e.href=URL.createObjectURL(c),e.click(),URL.revokeObjectURL(e.href)},u.src=i}catch(e){console.error("Download error:",e)}},[m]),X=(0,r.useCallback)(e=>{e.preventDefault(),e.stopPropagation();let t=x.current?.querySelector("svg");if(t){let e=t.getBoundingClientRect().width||parseFloat(t.getAttribute("width")||"800"),r=t.getBoundingClientRect().height||parseFloat(t.getAttribute("height")||"600");w(Math.min((window.innerWidth-160)/e,(window.innerHeight-160)/r,1))}else w(1);j({x:0,y:0}),p(!0)},[]),P=(0,r.useCallback)(()=>{p(!1)},[]),O=(0,r.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),w(e=>Math.min(e+.25,5))},[]),Y=(0,r.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),w(e=>Math.max(e-.25,.25))},[]),z=(0,r.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),w(1),j({x:0,y:0})},[]),H=(0,r.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),W()},[W]),q=(0,r.useCallback)(e=>{e.preventDefault(),e.stopPropagation();let t=e.deltaY>0?-.1:.1;w(e=>Math.max(.25,Math.min(5,e+t)))},[]),F=(0,r.useCallback)(e=>{0===e.button&&(e.preventDefault(),S.current=!0,R.current={x:e.clientX-T.current.x,y:e.clientY-T.current.y})},[]),I=(0,r.useCallback)(e=>{if(!S.current||!N.current)return;e.preventDefault();let t={x:e.clientX-R.current.x,y:e.clientY-R.current.y};T.current=t,N.current.style.transform=`translate(${t.x}px, ${t.y}px) scale(${$.current})`},[]),Z=(0,r.useCallback)(()=>{S.current&&(S.current=!1,j({...T.current}))},[]),_=e=>{if(e.length<2)return 0;let t=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(t*t+r*r)},G=e=>e.length<2?{x:e[0].clientX,y:e[0].clientY}:{x:(e[0].clientX+e[1].clientX)/2,y:(e[0].clientY+e[1].clientY)/2},V=(0,r.useCallback)(e=>{1===e.touches.length?(S.current=!0,R.current={x:e.touches[0].clientX-T.current.x,y:e.touches[0].clientY-T.current.y}):2===e.touches.length&&(S.current=!1,B.current=_(e.touches),D.current=G(e.touches))},[]),K=(0,r.useCallback)(e=>{if(e.preventDefault(),e.stopPropagation(),1===e.touches.length&&S.current&&N.current){let t={x:e.touches[0].clientX-R.current.x,y:e.touches[0].clientY-R.current.y};T.current=t,N.current.style.transform=`translate(${t.x}px, ${t.y}px) scale(${$.current})`}else if(2===e.touches.length&&N.current){let t=_(e.touches),r=G(e.touches);if(B.current>0){let e=t/B.current,r=Math.max(.25,Math.min(5,$.current*e));$.current=r}let a=r.x-D.current.x,n=r.y-D.current.y,s={x:T.current.x+a,y:T.current.y+n};T.current=s,N.current.style.transform=`translate(${s.x}px, ${s.y}px) scale(${$.current})`,B.current=t,D.current=r}},[]),J=(0,r.useCallback)(()=>{S.current=!1,B.current=0,j({...T.current}),w($.current)},[]),Q=(0,r.useCallback)(e=>{0===e.button&&g.current&&(e.preventDefault(),A.current=!0,U.current={x:e.clientX,y:e.clientY,scrollLeft:g.current.scrollLeft},g.current.style.cursor="grabbing",g.current.style.userSelect="none")},[]),ee=(0,r.useCallback)(e=>{if(!A.current||!g.current)return;e.preventDefault();let t=e.clientX-U.current.x;g.current.scrollLeft=U.current.scrollLeft-t},[]),et=(0,r.useCallback)(()=>{g.current&&(A.current=!1,g.current.style.cursor="grab",g.current.style.userSelect="")},[]),er=(0,r.useCallback)(()=>{g.current&&(A.current=!1,g.current.style.cursor="grab",g.current.style.userSelect="")},[]),ea=(0,r.useCallback)(e=>{g.current&&1===e.touches.length&&(A.current=!0,U.current={x:e.touches[0].clientX,y:e.touches[0].clientY,scrollLeft:g.current.scrollLeft})},[]),en=(0,r.useCallback)(e=>{if(!A.current||!g.current||1!==e.touches.length)return;let t=e.touches[0].clientX-U.current.x;g.current.scrollLeft=U.current.scrollLeft-t},[]),es=(0,r.useCallback)(()=>{A.current=!1},[]);(0,r.useEffect)(()=>{let e=g.current;if(e)return e.addEventListener("touchstart",ea,{passive:!0}),e.addEventListener("touchmove",en,{passive:!0}),e.addEventListener("touchend",es,{passive:!0}),()=>{e.removeEventListener("touchstart",ea),e.removeEventListener("touchmove",en),e.removeEventListener("touchend",es)}},[ea,en,es]),(0,r.useEffect)(()=>{if(!m||!g.current)return;let e=setTimeout(()=>{let e=g.current;if(!e)return;let t=e.scrollWidth,r=e.clientWidth;t>r&&(e.scrollLeft=(t-r)/2)},50);return()=>clearTimeout(e)},[m]),(0,r.useEffect)(()=>{if(!v||!E.current)return;let e=E.current;return e.addEventListener("wheel",q,{passive:!1}),e.addEventListener("touchstart",V,{passive:!0}),e.addEventListener("touchmove",K,{passive:!1}),e.addEventListener("touchend",J,{passive:!0}),()=>{e.removeEventListener("wheel",q),e.removeEventListener("touchstart",V),e.removeEventListener("touchmove",K),e.removeEventListener("touchend",J)}},[v,q,V,K,J]),(0,r.useEffect)(()=>{let e=e=>{"Escape"===e.key&&v&&P()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[v,P]),(0,r.useEffect)(()=>(v?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[v]);let el=(0,r.useCallback)(e=>{e.stopPropagation()},[]),eo=(0,r.useCallback)(e=>{e.target===e.currentTarget&&P()},[P]);if(b)return(0,t.jsxs)("div",{className:`mermaid-error p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg ${h}`,children:[(0,t.jsxs)("p",{className:"text-red-600 dark:text-red-400 text-sm",children:["Mermaid 图表渲染失败: ",b]}),(0,t.jsx)("pre",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400 overflow-auto",children:a})]});if(!m)return(0,t.jsx)("div",{className:`mermaid-loading p-8 flex items-center justify-center bg-bg-secondary rounded-lg ${h}`,children:(0,t.jsx)("div",{className:"animate-spin w-6 h-6 border-2 border-primary-500 border-t-transparent rounded-full"})});let ec=v&&M?(0,u.createPortal)((0,t.jsxs)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/80 backdrop-blur-sm",onClick:eo,children:[(0,t.jsx)("button",{onClick:P,className:"absolute top-4 right-4 z-10 p-2 bg-white/95 dark:bg-gray-800/95 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full border border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors shadow-lg",title:"关闭 (ESC)",children:(0,t.jsx)(l.X,{className:"w-6 h-6"})}),(0,t.jsx)("div",{ref:E,className:"absolute inset-0 flex items-center justify-center overflow-hidden",style:{touchAction:"none"},children:(0,t.jsxs)("div",{ref:N,className:"relative select-none",style:{transform:`translate(${C.x}px, ${C.y}px) scale(${k})`,transformOrigin:"center center"},children:[(0,t.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-2xl mermaid-preview-svg pointer-events-none",style:{userSelect:"none"},dangerouslySetInnerHTML:{__html:m}}),(0,t.jsx)("div",{className:"absolute inset-0 cursor-grab active:cursor-grabbing",onClick:el,onMouseDown:F,onMouseMove:I,onMouseUp:Z,onMouseLeave:Z})]})}),(0,t.jsxs)("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-10 flex items-center gap-2 px-4 py-2 bg-white/95 dark:bg-gray-800/95 rounded-full border border-gray-200 dark:border-gray-700 shadow-lg",children:[(0,t.jsx)("button",{onClick:Y,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors",title:"缩小",children:(0,t.jsx)(c.ZoomOut,{className:"w-5 h-5"})}),(0,t.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-300 min-w-[60px] text-center font-medium",children:[Math.round(100*k),"%"]}),(0,t.jsx)("button",{onClick:O,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors",title:"放大",children:(0,t.jsx)(o.ZoomIn,{className:"w-5 h-5"})}),(0,t.jsx)("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600"}),(0,t.jsx)("button",{onClick:z,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors",title:"重置",children:(0,t.jsx)(i,{className:"w-5 h-5"})}),(0,t.jsx)("button",{onClick:H,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors",title:"下载",children:(0,t.jsx)(s.Download,{className:"w-5 h-5"})})]})]}),document.body):null;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:`mermaid-container relative my-4 ${h}`,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-gray-500 dark:text-gray-400",children:[(0,t.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:(0,t.jsx)("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"})}),(0,t.jsx)("span",{className:"font-medium",children:"Mermaid"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("button",{type:"button",onClick:X,className:"p-1.5 bg-bg-primary hover:bg-bg-secondary border border-border-primary rounded-lg text-text-secondary hover:text-primary-500 transition-colors shadow-sm",title:"放大预览",children:(0,t.jsx)(n,{className:"w-4 h-4"})}),(0,t.jsx)("button",{type:"button",onClick:H,className:"p-1.5 bg-bg-primary hover:bg-bg-secondary border border-border-primary rounded-lg text-text-secondary hover:text-primary-500 transition-colors shadow-sm",title:"下载图片",children:(0,t.jsx)(s.Download,{className:"w-4 h-4"})})]})]}),(0,t.jsx)("div",{ref:g,className:"mermaid-scroll-container rounded-lg border border-border-primary p-4 cursor-grab",onMouseDown:Q,onMouseMove:ee,onMouseUp:et,onMouseLeave:er,children:(0,t.jsx)("div",{ref:x,className:"mermaid-svg-wrapper inline-block",dangerouslySetInnerHTML:{__html:m}})})]}),ec]})}e.s(["default",()=>h],53951)},23153,e=>{e.n(e.i(53951))},95802,e=>{e.v(t=>Promise.all(["static/chunks/4f191bce9ec1252b.js","static/chunks/a4eab16b7dcd4e33.js","static/chunks/5eac621951969859.js","static/chunks/6f4c5a75f38f686b.js","static/chunks/1fee597a28039084.js","static/chunks/de9c5219846f92bb.js","static/chunks/f1f8594d5ec7b93e.js","static/chunks/08041b5dcb24db51.js"].map(t=>e.l(t))).then(()=>t(76913)))}]);