(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,64740,e=>{"use strict";var s=e.i(71645),t=e.i(90499);let a=null;function r(e,l=!1){let[c,i]=(0,s.useState)(a||""),d=(0,t.useOptionalPageTitleContext)();(0,s.useEffect)(()=>{l&&d&&d.setTitle(e)},[e,l,d]),(0,s.useEffect)(()=>{a?i(a):(async()=>{try{let e=await fetch("/api/settings");if(e.ok){let s=await e.json();if(s.success&&s.data){let e={};s.data.forEach(s=>{e[s.key]=s.value});let t=e.siteTitle||"";a=t,i(t)}}}catch(e){console.error("Failed to fetch site title:",e)}})()},[]),(0,s.useEffect)(()=>{let s=document.title;return l?"仪表盘"===e?document.title=`${c} - 后台管理系统`:document.title=`${e} - ${c}后台管理系统`:document.title=`${e} - ${c}`,()=>{document.title=s}},[e,c,l])}e.s(["usePageTitle",()=>r])},40803,e=>{"use strict";var s=e.i(18050),t=e.i(71645),a=e.i(75254);let r=(0,a.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),l=(0,a.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var c=e.i(37727);function i({show:e,message:a,type:i,duration:d=3e3,onClose:n}){let[o,x]=(0,t.useState)(!1);(0,t.useEffect)(()=>{if(e){x(!0);let e=setTimeout(()=>{x(!1)},d);return()=>clearTimeout(e)}x(!1)},[e,d]),(0,t.useEffect)(()=>{if(!o&&e){let e=setTimeout(n,300);return()=>clearTimeout(e)}},[o,e,n]);let m=(()=>{switch(i){case"success":return{bg:"bg-green-50 border-green-200",text:"text-green-800",icon:(0,s.jsx)(r,{className:"w-5 h-5 text-green-500"})};case"error":return{bg:"bg-red-50 border-red-200",text:"text-red-800",icon:(0,s.jsx)(l,{className:"w-5 h-5 text-red-500"})};default:return{bg:"bg-blue-50 border-blue-200",text:"text-blue-800",icon:(0,s.jsx)(r,{className:"w-5 h-5 text-blue-500"})}}})();return(0,s.jsx)(s.Fragment,{children:o&&(0,s.jsx)("div",{className:"fixed top-4 right-4 z-[999999] min-w-[300px] max-w-md animate-slide-down",children:(0,s.jsxs)("div",{className:`${m.bg} border rounded-lg shadow-lg p-4 flex items-start gap-3`,children:[(0,s.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:m.icon}),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)("p",{className:`${m.text} text-sm font-medium`,children:a})}),(0,s.jsx)("button",{onClick:()=>{x(!1)},className:"flex-shrink-0 text-gray-400 hover:text-gray-600 transition-colors",children:(0,s.jsx)(c.X,{className:"w-4 h-4"})})]})})})}e.s(["default",()=>i],40803)},19491,e=>{"use strict";var s=e.i(18050),t=e.i(71645),a=e.i(18566),r=e.i(98348),l=e.i(9165),c=e.i(64740),i=e.i(40803);function d(){(0,c.usePageTitle)("留言管理",!0),(0,a.useRouter)();let{user:e}=(0,r.useAuth)(),[d,n]=(0,t.useState)(!1),[o,x]=(0,t.useState)("messages"),[m,g]=(0,t.useState)([]),[u,h]=(0,t.useState)([]),[p,y]=(0,t.useState)(!1),[b,j]=(0,t.useState)(null),[f,N]=(0,t.useState)(""),[v,w]=(0,t.useState)(null),[k,C]=(0,t.useState)({show:!1,type:"success",message:""});(0,t.useEffect)(()=>{"messages"===o?S():"message-categories"===o&&T()},[o]);let S=async()=>{y(!0);try{let e=await (0,l.getAdminMessages)();e.success&&e.data?g(e.data.messages||[]):g([])}catch(e){console.error("Failed to load messages:",e),g([])}finally{y(!1)}},T=async()=>{try{let e=await (0,l.getAdminMessageCategories)();e.success&&e.data&&h(e.data)}catch(e){console.error("Failed to load message categories:",e),h([])}},A=async(e,s)=>{try{(await (0,l.updateAdminMessageStatus)(e,s)).success&&(C({show:!0,type:"success",message:"状态更新成功"}),S())}catch(e){C({show:!0,type:"error",message:e.response?.data?.message||"更新失败"})}},M=async e=>{if(confirm("确定要删除这条留言吗？此操作不可恢复。"))try{(await (0,l.deleteAdminMessage)(e)).success&&(C({show:!0,type:"success",message:"留言删除成功"}),S())}catch(e){C({show:!0,type:"error",message:e.response?.data?.message||"删除失败"})}},$=async()=>{if(!f.trim())return void C({show:!0,type:"error",message:"分类名称不能为空"});try{(await (0,l.createAdminMessageCategory)({name:f})).success&&(C({show:!0,type:"success",message:"分类创建成功"}),N(""),T())}catch(e){C({show:!0,type:"error",message:e.response?.data?.message||"创建失败"})}},_=async e=>{try{(await (0,l.updateAdminMessageCategory)(e.id,{name:e.name,sort_order:e.sort_order})).success&&(C({show:!0,type:"success",message:"分类更新成功"}),w(null),T())}catch(e){C({show:!0,type:"error",message:e.response?.data?.message||"更新失败"})}},E=async e=>{if(confirm("确定要删除这个分类吗？此操作不可恢复。"))try{(await (0,l.deleteAdminMessageCategory)(e)).success&&(C({show:!0,type:"success",message:"分类删除成功"}),T())}catch(e){C({show:!0,type:"error",message:e.response?.data?.message||"删除失败"})}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.default,{show:k.show,message:k.message,type:k.type,onClose:()=>C({...k,show:!1})}),(0,s.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,s.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100 mb-6",children:[(0,s.jsxs)("div",{className:"flex space-x-4 border-b border-gray-200",children:[(0,s.jsx)("button",{onClick:()=>x("messages"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${"messages"===o?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"留言列表"}),(0,s.jsx)("button",{onClick:()=>x("message-categories"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${"message-categories"===o?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"留言分类"})]}),"messages"===o&&(0,s.jsxs)("div",{className:"mt-6",children:[(0,s.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"留言列表"})}),0!==m.length||p?(0,s.jsx)("div",{className:"bg-gray-50 rounded-lg border border-gray-200 max-h-96 overflow-y-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-100",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"时间"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"用户"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"分类"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"状态"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:new Date(e.created_at).toLocaleString()}),(0,s.jsx)("td",{className:"px-4 py-3",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:e.contact}),(0,s.jsx)("div",{className:"text-xs text-gray-400 font-mono",children:e.ip_address})]})}),(0,s.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:e.MessageCategory?.name||"未分类"}),(0,s.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,s.jsxs)("select",{value:e.status,onChange:s=>A(e.id,s.target.value),className:`text-xs font-medium rounded-full px-2.5 py-0.5 ${(e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"read":return"bg-blue-100 text-blue-800";case"replied":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}})(e.status)} border-0 focus:ring-0`,children:[(0,s.jsx)("option",{value:"pending",children:"待处理"}),(0,s.jsx)("option",{value:"read",children:"已读"}),(0,s.jsx)("option",{value:"replied",children:"已回复"})]})}),(0,s.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{onClick:()=>j(e),className:"text-blue-600 hover:text-blue-900 text-sm",children:"查看"}),(0,s.jsx)("button",{onClick:()=>M(e.id),className:"text-red-600 hover:text-red-900 text-sm",children:"删除"})]})})]},e.id))})]})}):(0,s.jsx)("div",{className:"text-center py-8 text-gray-500",children:"暂无留言"}),b&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[99999]",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"留言详情"}),(0,s.jsx)("button",{onClick:()=>j(null),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"用户称呼"}),(0,s.jsx)("div",{className:"bg-gray-50 p-3 rounded",children:b.name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"联系方式"}),(0,s.jsx)("div",{className:"bg-gray-50 p-3 rounded",children:b.contact})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"留言分类"}),(0,s.jsx)("div",{className:"bg-gray-50 p-3 rounded",children:b.MessageCategory?.name||"未分类"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"留言内容"}),(0,s.jsx)("div",{className:"bg-gray-50 p-3 rounded whitespace-pre-wrap",children:b.content})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"IP地址"}),(0,s.jsx)("div",{className:"bg-gray-50 p-3 rounded font-mono",children:b.ip_address})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"提交时间"}),(0,s.jsx)("div",{className:"bg-gray-50 p-3 rounded",children:new Date(b.created_at).toLocaleString()})]})]})]})})]}),"message-categories"===o&&(0,s.jsxs)("div",{className:"mt-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"留言分类管理"}),(0,s.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[(0,s.jsx)("h3",{className:"text-md font-medium text-blue-900 mb-2",children:"添加新分类"}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("input",{type:"text",value:f,onChange:e=>N(e.target.value),placeholder:"输入分类名称",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,s.jsx)("button",{onClick:$,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"添加"})]})]}),0===u.length?(0,s.jsx)("div",{className:"text-center py-8 text-gray-500",children:"暂无分类"}):(0,s.jsx)("div",{className:"bg-gray-50 rounded-lg border border-gray-200",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-100",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"分类名称"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"排序"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-4 py-3",children:v?.id===e.id?(0,s.jsx)("input",{type:"text",value:v.name,onChange:e=>w({...v,name:e.target.value}),className:"px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}):(0,s.jsx)("span",{className:"text-sm text-gray-900",children:e.name})}),(0,s.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:v?.id===e.id?(0,s.jsx)("input",{type:"number",value:v.sort_order,onChange:e=>w({...v,sort_order:parseInt(e.target.value)||0}),className:"w-20 px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0"}):(0,s.jsx)("span",{children:e.sort_order})}),(0,s.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:(0,s.jsx)("div",{className:"flex space-x-2",children:v?.id===e.id?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:()=>_(v),className:"text-green-600 hover:text-green-900 text-sm",children:"保存"}),(0,s.jsx)("button",{onClick:()=>w(null),className:"text-gray-600 hover:text-gray-900 text-sm",children:"取消"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:()=>w(e),className:"text-blue-600 hover:text-blue-900 text-sm",children:"编辑"}),(0,s.jsx)("button",{onClick:()=>E(e.id),className:"text-red-600 hover:text-red-900 text-sm",children:"删除"})]})})})]},e.id))})]})})]})]})})})]})}e.s(["default",()=>d])}]);