(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,58795,e=>{"use strict";var t=e.i(18050),a=e.i(71645),r=e.i(37902),s=e.i(77624),l=e.i(95987),i=e.i(75157);function o(){let{profile:e,isLoading:o}=(0,s.useProfile)(),{settings:n}=(0,l.useSettings)(),[c,d]=(0,a.useState)(!1),[m,x]=(0,a.useState)(!1),u=(0,a.useRef)(null),h=n.avatarShape||"circle",g=n.themeColor||"white",p=n.themeType||"default",f="true"===n.enableAvatarThemeSwitch,b=sessionStorage.getItem("userThemeType")||p;(0,a.useEffect)(()=>{if(!o&&f&&"default"===b){let e=setTimeout(()=>{d(!0);let e=setTimeout(()=>{d(!1)},2e3);return()=>clearTimeout(e)},500);return()=>clearTimeout(e)}},[f,b,o]);let y=()=>"rounded"===h?"rounded-xl":"rounded-full",j=()=>"black"===g?"0 0 0 3px rgba(255, 255, 255, 0.15), 0 4px 14px 0 rgba(255, 255, 255, 0.1)":"0 0 0 3px rgba(0, 0, 0, 0.08), 0 4px 14px 0 rgba(0, 0, 0, 0.15)",v=async e=>{f&&"default"===b&&!m&&(x(!0),await new Promise(e=>setTimeout(e,500)),sessionStorage.setItem("userThemeType","blog"),sessionStorage.setItem("userShowSiteNav","true"),sessionStorage.setItem("userShowNotes","true"),await new Promise(e=>setTimeout(e,500)),window.location.reload())};return o?(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("div",{className:`w-20 md:w-32 h-20 md:h-32 ${y()} bg-gray-200 animate-pulse mb-3 md:mb-4`}),(0,t.jsx)("div",{className:"h-6 md:h-8 w-36 md:w-48 bg-gray-200 animate-pulse mb-1 md:mb-2"}),(0,t.jsx)("div",{className:"h-4 w-48 md:w-64 bg-gray-200 animate-pulse"})]}):(0,t.jsxs)(t.Fragment,{children:[m&&(0,t.jsx)("div",{style:{backdropFilter:"blur(0px)",animation:"blur-fade 0.5s ease-out forwards"},className:"jsx-90f916ff8d57b529 fixed inset-0 z-[9999] pointer-events-none"}),(0,t.jsxs)("div",{className:"jsx-90f916ff8d57b529 flex flex-col items-center",children:[(0,t.jsxs)("div",{ref:u,onClick:v,className:`jsx-90f916ff8d57b529 relative mb-5 md:mb-6 ${f&&"default"===b?"cursor-pointer hover:scale-105 transition-transform duration-300":""} ${m?"avatar-rotating":""}`,children:[c&&f&&"default"===b&&(0,t.jsx)("div",{style:{animation:"tooltip-fade 2s ease-in-out forwards"},className:"jsx-90f916ff8d57b529 absolute -top-16 left-1/2 transform -translate-x-1/2 animate-fade-in",children:(0,t.jsxs)("div",{className:"jsx-90f916ff8d57b529 bg-gray-800/45 dark:bg-gray-200/45 backdrop-blur-sm text-white/50 dark:text-gray-900/50 px-4 py-2 rounded-2xl relative whitespace-nowrap text-sm",children:["点我开启博客世界！",(0,t.jsx)("div",{className:"jsx-90f916ff8d57b529 absolute -bottom-2 left-1/2 transform -translate-x-1/2 w-0 h-0 arrow-tooltip"})]})}),e?.avatar?(0,t.jsx)("img",{src:(0,i.getFileUrl)(e.avatar),alt:e.name||"头像",style:{boxShadow:j()},className:`jsx-90f916ff8d57b529 w-16 md:w-24 h-16 md:h-24 ${y()} object-cover`}):(0,t.jsx)("div",{style:{boxShadow:j()},className:`jsx-90f916ff8d57b529 w-16 md:w-24 h-16 md:h-24 ${y()} bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center text-white text-2xl md:text-4xl font-bold`,children:e?.name?.[0]||"U"})]}),(0,t.jsx)("h1",{className:"jsx-90f916ff8d57b529 text-2xl md:text-4xl font-bold text-text-primary mb-1.5 md:mb-2",children:e?.name||""}),e?.title&&(0,t.jsx)("p",{className:"jsx-90f916ff8d57b529 text-base md:text-xl text-text-secondary mb-2.5 md:mb-4",children:e.title}),e?.bio&&(0,t.jsx)("p",{className:"jsx-90f916ff8d57b529 text-sm md:text-lg text-text-secondary max-w-md md:max-w-2xl text-center mb-2.5 md:mb-4",children:e.bio}),(0,t.jsxs)("div",{className:"jsx-90f916ff8d57b529 flex items-center gap-3 md:gap-4 text-xs md:text-sm text-text-tertiary",children:[e?.location&&(0,t.jsxs)("div",{className:"jsx-90f916ff8d57b529 flex items-center gap-1",children:[(0,t.jsxs)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-90f916ff8d57b529 w-3 md:w-4 h-3 md:h-4",children:[(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z",className:"jsx-90f916ff8d57b529"}),(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z",className:"jsx-90f916ff8d57b529"})]}),(0,t.jsx)("span",{className:"jsx-90f916ff8d57b529",children:e.location})]}),e?.website&&(0,t.jsxs)("a",{href:e.website,target:"_blank",rel:"noopener noreferrer",className:"jsx-90f916ff8d57b529 flex items-center gap-1 hover:text-primary-500 transition-colors",children:[(0,t.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-90f916ff8d57b529 w-3 md:w-4 h-3 md:h-4",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9",className:"jsx-90f916ff8d57b529"})}),(0,t.jsx)("span",{className:"jsx-90f916ff8d57b529",children:e.website_title||"个人网站"})]})]})]}),(0,t.jsx)(r.default,{id:"90f916ff8d57b529",children:".arrow-tooltip.jsx-90f916ff8d57b529{filter:opacity();border-top:8px solid #1f293773;border-left:8px solid #0000;border-right:8px solid #0000}.dark .arrow-tooltip.jsx-90f916ff8d57b529{border-top-color:#e5e7eb73}.avatar-rotating.jsx-90f916ff8d57b529 img,.avatar-rotating.jsx-90f916ff8d57b529 div{animation:.5s ease-in-out forwards avatar-rotate}@keyframes avatar-rotate{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes blur-fade{0%{-webkit-backdrop-filter:blur();backdrop-filter:blur();opacity:0}50%{opacity:1}to{-webkit-backdrop-filter:blur(30px);backdrop-filter:blur(30px);opacity:1}}@keyframes tooltip-fade{0%{opacity:0;transform:translateY(10px)translate(-50%)}10%{opacity:1;transform:translateY(0)translate(-50%)}90%{opacity:1;transform:translateY(0)translate(-50%)}to{opacity:0;transform:translateY(-10px)translate(-50%)}}"})]})}var n=e.i(75254);let c=(0,n.default)("github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]),d=(0,n.default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),m=(0,n.default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),x=(0,n.default)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]),u=(0,n.default)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]);var h=e.i(37727),g=e.i(31823);let p={github:c,telegram:m,email:d,gmail:d,qq:x,wechat:x};function f({className:e}){let{socialLinks:r,isLoading:s}=(0,g.useSocialLinks)(),[l,o]=(0,a.useState)({}),[n,c]=(0,a.useState)(!1),[d,m]=(0,a.useState)(null),[x,f]=(0,a.useState)(!1),[b,y]=(0,a.useState)(null),[j,v]=(0,a.useState)(!1),[w,N]=(0,a.useState)(!1),[k,C]=(0,a.useState)(null),S=()=>{c(!1),m(null)},T=()=>{f(!1),v(!1),y(null)},$=()=>{N(!1),C(null)},L=async()=>{if(b)try{await navigator.clipboard.writeText(b.account),v(!0),setTimeout(()=>v(!1),2e3)}catch(e){console.error("Failed to copy:",e)}};return s?(0,t.jsx)("div",{className:"text-center py-6 md:py-8",children:(0,t.jsx)("div",{className:"inline-block w-6 md:w-8 h-6 md:h-8 border-3 md:border-4 border-t-transparent rounded-full animate-spin",style:{borderColor:"var(--primary-500)"}})}):Array.isArray(r)&&0!==r.length?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:(0,i.cn)("flex flex-wrap justify-center gap-3 md:gap-6 max-w-4xl mx-auto",e),children:r.slice(0,6).map((e,a)=>{let r,s=p[e.platform.toLowerCase()]||u,n=e.icon&&""!==e.icon.trim()&&!l[e.platform];return(0,t.jsxs)("a",{href:e.link||"#",target:e.link?"_blank":"_self",rel:"noopener noreferrer",onClick:t=>{e.qrcode&&""!==e.qrcode.trim()?(t.preventDefault(),m({image:e.qrcode,platform:e.platform}),c(!0)):e.link&&""!==e.link.trim()&&"#"!==e.link?(t.preventDefault(),C({url:e.link,platform:e.platform}),N(!0)):(t.preventDefault(),y({account:e.account,platform:e.platform}),f(!0))},className:"card-glow rounded-lg md:rounded-xl p-3 md:p-4 items-center justify-center group aspect-square cursor-pointer animate-fade-in hover:scale-105 transition-transform",style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[(0,t.jsxs)("div",{className:"relative",children:[n?(0,t.jsx)("div",{className:"relative w-5 md:w-8 h-5 md:h-8",children:(0,t.jsx)("img",{src:(0,i.getFileUrl)(e.icon),alt:e.platform,className:(0,i.cn)("w-5 md:w-8 h-5 md:h-8 object-contain transition-all",(r=e.icon)&&r.toLowerCase().endsWith(".svg")?"icon-themed group-hover:brightness-110":"group-hover:brightness-110"),onError:()=>{var t;return t=e.platform,void o(e=>({...e,[t]:!0}))},loading:"eager"})}):(0,t.jsx)(s,{className:"w-5 md:w-8 h-5 md:h-8 text-primary-500 group-hover:text-primary-600 transition-colors"}),(0,t.jsx)("div",{className:"absolute inset-0 blur-lg md:blur-xl opacity-30 group-hover:opacity-50 transition-opacity",style:{backgroundColor:"var(--primary-500)"}})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-xs md:text-sm font-semibold text-text-secondary capitalize",children:e.platform}),(0,t.jsx)("p",{className:"text-[10px] md:text-xs text-text-tertiary mt-0.5 md:mt-1 truncate max-w-[80px] md:max-w-[120px]",children:e.account})]})]},`${e.platform}-${a}`)})}),n&&d&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fade-in",onClick:S,children:(0,t.jsxs)("div",{className:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6 max-w-sm w-full",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("button",{onClick:S,className:"absolute top-4 right-4 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"关闭",children:(0,t.jsx)(h.X,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4 capitalize",children:d.platform}),(0,t.jsx)("div",{className:"bg-white p-4 rounded-xl inline-block",children:(0,t.jsx)("img",{src:(0,i.getFileUrl)(d.image),alt:`${d.platform} QR Code`,className:"w-64 h-64 object-contain"})}),(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-4",children:"截图或长按保存上方二维码"})]})]})}),x&&b&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fade-in",onClick:T,children:(0,t.jsxs)("div",{className:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6 max-w-sm w-full",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("button",{onClick:T,className:"absolute top-4 right-4 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"关闭",children:(0,t.jsx)(h.X,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4 capitalize",children:b.platform}),(0,t.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-xl mb-4",children:(0,t.jsx)("p",{className:"text-lg font-mono text-gray-900 dark:text-white break-all",children:b.account})}),(0,t.jsx)("button",{onClick:L,className:`w-full py-3 px-4 rounded-lg font-medium transition-colors ${j?"bg-green-500 text-white":"bg-primary-500 hover:bg-primary-600 text-white"}`,children:j?"✓ 已复制":"复制账号"})]})]})}),w&&k&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fade-in",onClick:$,children:(0,t.jsxs)("div",{className:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6 max-w-sm w-full",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("button",{onClick:$,className:"absolute top-4 right-4 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"关闭",children:(0,t.jsx)(h.X,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4 capitalize",children:k.platform}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"是否跳转到以下链接？"}),(0,t.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 p-3 rounded-xl mb-4",children:(0,t.jsx)("p",{className:"text-sm font-mono text-gray-900 dark:text-white break-all",children:k.url})}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:$,className:"flex-1 py-3 px-4 rounded-lg font-medium transition-colors bg-gray-200 hover:bg-gray-300 dark:bg-gray-600 dark:hover:bg-gray-500 text-gray-800 dark:text-white",children:"取消"}),(0,t.jsx)("button",{onClick:()=>{k&&window.open(k.url,"_blank","noopener,noreferrer"),$()},className:"flex-1 py-3 px-4 rounded-lg font-medium transition-colors bg-primary-500 hover:bg-primary-600 text-white",children:"确认跳转"})]})]})]})})]}):null}var b=e.i(78917),y=e.i(70273),j=e.i(9165),v=e.i(8464);function w({site:e,index:a,onSiteClick:r}){return(0,t.jsx)("button",{onClick:()=>r(e),className:"group block p-3 bg-bg-secondary rounded-lg shadow-sm hover:shadow-lg hover:-translate-y-0.5 border border-border-primary transition-all duration-300 cursor-pointer text-left w-full animate-fade-in",children:(0,t.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,t.jsx)("div",{className:"w-10 h-10 mb-2 rounded-md overflow-hidden flex items-center justify-center",children:e.logo?(0,t.jsx)("img",{src:(0,i.getFileUrl)(e.logo),alt:e.name,className:"w-full h-full object-cover"}):(0,t.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center text-white font-semibold text-base shadow-sm",children:e.name[0]})}),(0,t.jsxs)("div",{className:"relative flex flex-col items-center mb-1",children:[(0,t.jsx)("h3",{className:"font-medium text-xs text-text-primary group-hover:text-primary-500 transition-colors",children:e.name}),(0,t.jsx)(b.ExternalLink,{className:"w-3 h-3 text-primary-500 opacity-0 group-hover:opacity-100 transition-opacity absolute -right-4 top-1/2 transform -translate-y-1/2"})]}),e.description&&(0,t.jsx)("p",{className:"text-[10px] text-text-tertiary line-clamp-2 text-center leading-relaxed",children:e.description})]})})}function N({searchQuery:e=""}){let{settings:r}=(0,l.useSettings)(),[s,o]=(0,a.useState)(null),[n,c]=(0,a.useState)(!0),[d,m]=(0,a.useState)(!1),[x,u]=(0,a.useState)(null),h="default"===(sessionStorage.getItem("userThemeType")||r.themeType||"default");(0,a.useEffect)(()=>{g()},[]);let g=async()=>{try{let e=await (0,j.getSitesGroupedByCategory)();e.success&&e.data&&o(e.data)}catch(e){console.error("Failed to fetch navigation data:",e),o({showRecommended:!1,recommended:[],categories:[]})}finally{c(!1)}},p=e=>{u(e),m(!0)},f=t=>{if(!e.trim())return t;let a=e.toLowerCase();return t.filter(e=>{let t=e.name.toLowerCase().includes(a),r=e.description?.toLowerCase().includes(a);return t||r})};if(n)return(0,t.jsx)("div",{className:"bg-bg-secondary/40 rounded-2xl p-5",children:(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3",children:[...Array(10)].map((e,a)=>(0,t.jsx)("div",{children:(0,t.jsx)("div",{className:"p-3 bg-bg-secondary rounded-lg shadow-sm border border-border-primary animate-pulse",children:(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("div",{className:"w-10 h-10 mb-2 rounded-md bg-bg-tertiary"}),(0,t.jsx)("div",{className:"h-3 bg-bg-tertiary rounded w-16 mb-1"}),(0,t.jsx)("div",{className:"h-2 bg-bg-tertiary rounded w-20"})]})})},a))})});if(!s)return null;let b=f(s.recommended),N=s.categories.map(e=>({...e,sites:f(e.sites)})).filter(e=>e.sites.length>0),k=b.length>0||N.length>0,C=e.trim()&&k,S=e.trim()&&!k,T=[];return C&&T.push((0,t.jsx)("div",{className:"mb-4 p-3 bg-blue-50/50 rounded-lg border border-blue-200/50",children:(0,t.jsxs)("span",{className:"text-sm text-blue-700",children:["搜索结果: 找到 ",b.length+N.reduce((e,t)=>e+t.sites.length,0)," 个相关网站",(0,t.jsxs)("span",{className:"font-medium ml-1",children:['"',e,'"']})]})},"search-results")),S&&T.push((0,t.jsx)("div",{className:"mb-4 p-3 bg-gray-50/50 rounded-lg border border-gray-200/50 text-center",children:(0,t.jsxs)("span",{className:"text-sm text-gray-600",children:['没有找到包含 "',e,'" 的网站']})},"no-results")),s.showRecommended&&b.length>0&&T.push((0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)("div",{className:`flex items-center gap-1.5 mb-4 ${h?"hidden md:hidden":""}`,children:[(0,t.jsx)(y.Star,{className:"w-4 h-4 text-yellow-500 fill-yellow-500"}),(0,t.jsx)("h2",{className:"text-lg font-bold text-text-primary",children:"导航推荐"})]}),(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3",children:b.map((e,a)=>(0,t.jsx)("div",{children:(0,t.jsx)(w,{site:e,index:a,onSiteClick:p})},`recommended-${e.id}`))})]},"recommended-section")),N.forEach(e=>{T.push((0,t.jsxs)("div",{className:"mb-8 last:mb-0",children:[(0,t.jsxs)("div",{className:`flex items-center gap-1.5 mb-4 ${h?"hidden md:hidden":""}`,children:[e.category.icon&&(0,t.jsx)("span",{className:"text-lg",children:e.category.icon}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-bold text-text-primary",children:e.category.name}),e.category.description&&(0,t.jsx)("p",{className:"text-xs text-text-secondary mt-0.5",children:e.category.description})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3",children:e.sites.map((a,r)=>(0,t.jsx)("div",{children:(0,t.jsx)(w,{site:a,index:r,onSiteClick:p})},`site-${e.category.id}-${a.id}`))})]},`category-${e.category.id}`))}),s.showRecommended||0!==s.categories.length||T.push((0,t.jsx)("div",{className:"text-center py-12 text-text-tertiary",children:"暂无导航数据"},"empty-state")),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"bg-bg-secondary/40 rounded-2xl p-5",children:T}),(0,t.jsx)(v.default,{isOpen:d,onClose:()=>{m(!1),setTimeout(()=>{u(null)},300)},site:x,logoUrl:x?.logo?(0,i.getFileUrl)(x.logo):void 0})]})}var k=e.i(3116),C=e.i(40433),S=e.i(18566),T=e.i(86034),$=e.i(51210);let L=(0,i.getApiBaseUrl)(),_=e=>{let t=new Date(e),a=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),l=String(t.getHours()).padStart(2,"0"),i=String(t.getMinutes()).padStart(2,"0");return`${a}-${r}-${s} ${l}:${i}`},E=(e,t)=>e.length<=t?e:e.substring(0,t)+"...";function F({searchQuery:e=""}){let r=(0,S.usePathname)();(0,S.useRouter)();let s=(0,S.useSearchParams)(),l=!!r&&(0,T.isAdminPage)(r),[o,n]=(0,a.useState)([]),[c,d]=(0,a.useState)([]),[m,x]=(0,a.useState)(!0),[u,h]=(0,a.useState)(1),[g,p]=(0,a.useState)(1),[f,b]=(0,a.useState)({}),[y,v]=(0,a.useState)({showNoteTags:!0,showNoteCategories:!0,noteLayoutColumns:"1",showNoteCover:"true",defaultNoteCover:""}),[w,N]=(0,a.useState)({type:null,value:null}),F="/"===r,[I,z]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=()=>{z(window.innerWidth>=768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,a.useEffect)(()=>{P(),M(),W()},[u,w]),(0,a.useEffect)(()=>{let e=s.get("noteId");if(e){let t=parseInt(e,10);isNaN(t)||(window.location.href=`/note/${t}`)}},[s]);let P=async()=>{try{let e={is_published:!0,page:u,limit:6};w.type&&w.value&&("tag"===w.type?e.tag=w.value:"category"===w.type&&(e.category=w.value));let t=await j.default.get("/notes",{params:e}),a=t.data?.data,r=Array.isArray(a?.notes)?a.notes:[];n(r),p(a?.pagination?.totalPages||1)}catch(e){console.error("Failed to fetch notes:",e),n([])}finally{x(!1)}},M=async()=>{try{let e=await j.default.get("/notes/categories/list"),t=e.data?.data;d(Array.isArray(t)?t:[])}catch(e){console.error("Failed to fetch categories:",e),d([])}},A=e=>{try{return new URL(e).hostname.replace("www.","")}catch{return""}},U=e=>{let t=A(e);return[`https://${t}/favicon.ico`,`https://www.${t}/favicon.ico`,`https://icons.duckduckgo.com/ip3/${t}.ico`,`https://favicon.yandex.net/favicon/${t}`][0]},D=async e=>{if(f[e])return f[e];try{let t=await (0,i.safeFetch)(`/api/metadata?url=${encodeURIComponent(e)}`);if(t.ok){let a=await t.json();return b(t=>({...t,[e]:{title:a.title||A(e),description:a.description||"点击卡片访问网站",favicon:a.favicon||U(e),image:a.image||""}})),a}}catch(e){console.error("Failed to fetch URL metadata:",e)}let t={title:A(e),description:"点击卡片访问网站",favicon:U(e),image:""};return b(a=>({...a,[e]:t})),t},R=e=>{F?window.location.href=`/notes?tag=${encodeURIComponent(e)}`:(N({type:"tag",value:e}),h(1))},q=e=>{F?window.location.href=`/notes?category=${encodeURIComponent(e)}`:(N({type:"category",value:e}),h(1))},W=async()=>{try{let e=await j.default.get("/settings");if(e.data.success&&e.data.data){let t=e.data.data,a=t.find(e=>"showNoteTags"===e.key),r=t.find(e=>"showNoteCategories"===e.key),s=t.find(e=>"noteLayoutColumns"===e.key),l=t.find(e=>"showNoteCover"===e.key),i=t.find(e=>"defaultNoteCover"===e.key);v({showNoteTags:!a||"true"===a.value,showNoteCategories:!r||"true"===r.value,noteLayoutColumns:s?.value||"1",showNoteCover:l?.value||"true",defaultNoteCover:i?.value||""})}}catch(e){console.error("Failed to load settings:",e)}};(0,a.useEffect)(()=>{let e=async()=>{for(let e of o.filter(e=>(e=>{if(!e)return!1;let t=e.trim();return/^https?:\/\/[\w\-\.]+\.[a-z]{2,}(\/\S*)?$/i.test(t)})(e.content)))await D(e.content.trim())};o.length>0&&e()},[o]);let B=o.filter(t=>{if(!e.trim())return!0;let a=e.toLowerCase(),r=t.title?.toLowerCase().includes(a),s=(0,$.stripMarkdown)(t.content).toLowerCase().includes(a),l=t.category?.toLowerCase().includes(a),i=t.Tags?.some(e=>e.name.toLowerCase().includes(a))||t.tags?.toLowerCase().includes(a);return r||s||l||i}),O=new Map(c.map(e=>[e.name,e])),X=parseInt(y.noteLayoutColumns)||1,Q=1===X||(2===X||3===X)&&I,H=(!!I||!(X>=2))&&(!I||4!==X)&&(y.showNoteTags||y.showNoteCategories),Y=(!!I||!(X>=2))&&(!I||4!==X);if(m)return(0,t.jsx)("div",{className:"space-y-3",children:[1,2,3].map(e=>(0,t.jsxs)("div",{className:"p-4 bg-bg-secondary/50 rounded-lg",children:[(0,t.jsx)("div",{className:"h-5 w-3/4 bg-bg-tertiary/50 animate-pulse mb-3 rounded"}),(0,t.jsx)("div",{className:"h-4 w-full bg-bg-tertiary/50 animate-pulse mb-2 rounded"}),(0,t.jsx)("div",{className:"h-4 w-2/3 bg-bg-tertiary/50 animate-pulse mb-3 rounded"}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,t.jsx)("div",{className:"h-3 w-24 bg-bg-tertiary/50 animate-pulse rounded"}),(0,t.jsx)("div",{className:"h-3 w-16 bg-bg-tertiary/50 animate-pulse rounded"})]})]},e))});if(0===o.length)return null;let J=e.trim()&&B.length>0,G=e.trim()&&0===B.length;return(0,t.jsxs)(t.Fragment,{children:[J&&(0,t.jsx)("div",{className:"mb-4 p-3 bg-blue-50/50 rounded-lg border border-blue-200/50 flex items-center justify-between",children:(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)("span",{className:"text-sm text-blue-700",children:["搜索结果: 找到 ",B.length," 条相关笔记",(0,t.jsxs)("span",{className:"font-medium ml-1",children:['"',e,'"']})]})})}),G&&(0,t.jsx)("div",{className:"mb-4 p-3 bg-bg-tertiary/50 rounded-lg border border-border-primary/50 text-center",children:(0,t.jsxs)("span",{className:"text-sm text-text-tertiary",children:['没有找到包含 "',e,'" 的笔记']})}),w.type&&w.value&&(0,t.jsxs)("div",{className:"mb-4 p-3 bg-bg-secondary/50 rounded-lg border border-border-primary/20 flex items-center justify-between",children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)("span",{className:"text-sm text-text-secondary",children:["当前筛选:",(0,t.jsxs)("span",{className:"font-medium text-text-primary ml-1",children:["tag"===w.type?"标签":"分类",": ",w.value]})]})}),(0,t.jsx)("button",{onClick:()=>{N({type:null,value:null}),h(1)},className:"text-xs text-text-tertiary hover:text-text-primary transition-colors px-2 py-1 hover:bg-bg-tertiary/50 rounded",children:"清除筛选"})]}),(0,t.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${parseInt(y.noteLayoutColumns)||1}, minmax(0, 1fr))`},children:B.map((e,a)=>(0,t.jsx)("div",{className:`group block rounded-lg shadow-sm hover:shadow-lg hover:-translate-y-0.5 border transition-all duration-300 cursor-pointer overflow-hidden animate-fade-in ${l?"bg-white border-gray-200":"bg-bg-secondary border-border-primary"}`,onClick:()=>{window.location.href=`/note/${e.id}`},children:Q?(0,t.jsxs)("div",{className:"flex gap-3 items-stretch p-3 h-32",children:[(e.cover_image||y.defaultNoteCover)&&"true"===y.showNoteCover&&(0,t.jsx)("div",{className:"flex-shrink-0 w-26 h-26 rounded-md overflow-hidden bg-bg-tertiary",children:(0,t.jsx)("img",{src:(e.cover_image||y.defaultNoteCover||"").startsWith("http")?e.cover_image||y.defaultNoteCover:`${L}${e.cover_image||y.defaultNoteCover}`,alt:e.title||"封面图",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",onError:e=>{e.target.style.display="none"}})}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col justify-between min-w-0 py-1",children:[(0,t.jsxs)("div",{className:"flex items-start gap-2 mb-1.5",children:[e.title&&(0,t.jsx)("h3",{className:"text-base font-semibold text-text-primary line-clamp-2 flex-1 group-hover:text-primary-500 transition-colors leading-snug",children:e.title}),e.is_pinned&&(0,t.jsx)("div",{className:"flex-shrink-0 px-1.5 py-0.5 bg-gradient-to-r from-red-500 to-pink-500 text-white rounded text-[10px] font-semibold flex items-center gap-0.5",children:(0,t.jsx)(C.Pin,{className:"w-2.5 h-2.5 fill-current"})})]}),Y&&(0,t.jsx)("p",{className:"text-xs text-text-secondary line-clamp-2 mb-1.5 leading-relaxed opacity-80",children:e.summary||(e.content?E((0,$.stripMarkdown)(e.content),60):"暂无内容")}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5 flex-wrap text-[10px] mt-auto",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 text-text-tertiary",children:[(0,t.jsx)(k.Clock,{className:"w-3 h-3"}),(0,t.jsx)("span",{className:"text-[10px]",children:_(e.published_at||e.created_at)})]}),H&&y.showNoteCategories&&e.category&&(0,t.jsxs)("span",{className:"px-1.5 py-0.5 bg-primary-100 text-primary-700 rounded-full font-medium cursor-pointer hover:bg-primary-200 transition-colors text-[10px]",onClick:t=>{t.stopPropagation(),q(e.category)},children:[O.get(e.category)?.icon&&(0,t.jsx)("span",{className:"mr-0.5",children:O.get(e.category)?.icon}),e.category]}),H&&y.showNoteTags&&e.Tags&&e.Tags.length>0&&(0,t.jsxs)(t.Fragment,{children:[e.Tags.slice(0,2).map(e=>(0,t.jsx)("span",{className:"px-1.5 py-0.5 rounded-full font-medium cursor-pointer hover:opacity-80 transition-opacity text-[10px]",style:e.color?{backgroundColor:`${e.color}20`,color:e.color}:{backgroundColor:"rgb(242 242 242)",color:"rgb(112 112 112)"},onClick:t=>{t.stopPropagation(),R(e.name)},children:e.name},e.id)),e.Tags.length>2&&(0,t.jsxs)("span",{className:"px-1.5 py-0.5 rounded-full text-[10px]",style:{backgroundColor:"rgb(242 242 242)",color:"rgb(112 112 112)"},children:["+",e.Tags.length-2]})]}),H&&y.showNoteTags&&(!e.Tags||0===e.Tags.length)&&e.tags&&(0,t.jsxs)(t.Fragment,{children:[e.tags.split(",").slice(0,2).map((e,a)=>(0,t.jsx)("span",{className:"px-1.5 py-0.5 rounded-full font-medium cursor-pointer hover:opacity-80 transition-opacity text-[10px]",style:{backgroundColor:"rgb(242 242 242)",color:"rgb(112 112 112)"},onClick:t=>{t.stopPropagation(),R(e.trim())},children:e.trim()},a)),e.tags.split(",").length>2&&(0,t.jsxs)("span",{className:"px-1.5 py-0.5 rounded-full text-[10px]",style:{backgroundColor:"rgb(242 242 242)",color:"rgb(112 112 112)"},children:["+",e.tags.split(",").length-2]})]})]})]})]}):(0,t.jsxs)("div",{className:"flex flex-col h-full",children:[(e.cover_image||y.defaultNoteCover)&&"true"===y.showNoteCover&&(0,t.jsxs)("div",{className:"relative w-full pt-[100%] overflow-hidden bg-gradient-to-br from-primary-100 to-primary-200 flex-shrink-0",children:[(0,t.jsx)("img",{src:(e.cover_image||y.defaultNoteCover||"").startsWith("http")?e.cover_image||y.defaultNoteCover:`${L}${e.cover_image||y.defaultNoteCover}`,alt:e.title||"封面图",className:"absolute inset-0 w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",onError:e=>{e.target.style.display="none"}}),e.is_pinned&&(0,t.jsxs)("div",{className:"absolute top-2 right-2 bg-black/50 backdrop-blur-sm rounded-full px-2 py-1 text-[10px] text-white font-semibold flex items-center gap-1",children:[(0,t.jsx)(C.Pin,{className:"w-2.5 h-2.5 fill-current"}),(0,t.jsx)("span",{children:"置顶"})]})]}),(0,t.jsxs)("div",{className:"p-2.5 flex flex-col flex-1 min-h-0",children:[e.title&&(0,t.jsx)("h3",{className:"font-semibold text-base text-text-primary group-hover:text-primary-500 transition-colors line-clamp-2 mb-1.5 leading-snug",children:e.title}),Y&&(0,t.jsx)("p",{className:"text-xs text-text-secondary line-clamp-2 leading-relaxed mb-2 opacity-80",children:e.summary||(e.content?E((0,$.stripMarkdown)(e.content),60):"暂无内容")}),(0,t.jsxs)("div",{className:"flex items-center justify-between gap-1.5 text-[10px] mt-auto",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 text-text-tertiary",children:[(0,t.jsx)(k.Clock,{className:"w-3 h-3"}),(0,t.jsx)("span",{className:"text-[10px]",children:_(e.published_at||e.created_at)})]}),H&&(0,t.jsxs)("div",{className:"flex items-center gap-1 flex-wrap",children:[y.showNoteCategories&&e.category&&(0,t.jsxs)("span",{className:"px-1.5 py-0.5 bg-primary-100 text-primary-700 rounded-full font-medium cursor-pointer hover:bg-primary-200 transition-colors text-[10px]",onClick:t=>{t.stopPropagation(),q(e.category)},children:[O.get(e.category)?.icon&&(0,t.jsx)("span",{className:"mr-0.5",children:O.get(e.category)?.icon}),e.category]}),y.showNoteTags&&e.Tags&&e.Tags.length>0&&(0,t.jsxs)(t.Fragment,{children:[e.Tags.slice(0,1).map(e=>(0,t.jsx)("span",{className:"px-1.5 py-0.5 rounded-full font-medium cursor-pointer hover:opacity-80 transition-opacity text-[10px]",style:e.color?{backgroundColor:`${e.color}20`,color:e.color}:{backgroundColor:"rgb(242 242 242)",color:"rgb(112 112 112)"},onClick:t=>{t.stopPropagation(),R(e.name)},children:e.name},e.id)),e.Tags.length>1&&(0,t.jsxs)("span",{className:"px-1.5 py-0.5 rounded-full text-[10px]",style:{backgroundColor:"rgb(242 242 242)",color:"rgb(112 112 112)"},children:["+",e.Tags.length-1]})]}),y.showNoteTags&&(!e.Tags||0===e.Tags.length)&&e.tags&&(0,t.jsxs)(t.Fragment,{children:[e.tags.split(",").slice(0,1).map((e,a)=>(0,t.jsx)("span",{className:"px-1.5 py-0.5 rounded-full font-medium cursor-pointer hover:opacity-80 transition-opacity text-[10px]",style:{backgroundColor:"rgb(242 242 242)",color:"rgb(112 112 112)"},onClick:t=>{t.stopPropagation(),R(e.trim())},children:e.trim()},a)),e.tags.split(",").length>1&&(0,t.jsxs)("span",{className:"px-1.5 py-0.5 rounded-full text-[10px]",style:{backgroundColor:"rgb(242 242 242)",color:"rgb(112 112 112)"},children:["+",e.tags.split(",").length-1]})]})]})]})]})]})},e.id))}),g>1&&(0,t.jsxs)("div",{className:"flex justify-center gap-2 pt-6 mt-4",children:[(0,t.jsx)("button",{onClick:()=>h(e=>Math.max(1,e-1)),disabled:1===u,className:"px-3 py-1.5 rounded-lg bg-bg-primary text-text-secondary hover:bg-bg-secondary disabled:opacity-30 disabled:cursor-not-allowed transition-all text-sm",children:"上一页"}),(0,t.jsx)("div",{className:"flex items-center gap-1.5",children:Array.from({length:Math.min(g,5)},(e,a)=>{let r,s=(r=g<=5||u<=3?a+1:u>=g-2?g-4+a:u-2+a)===u;return(0,t.jsx)("button",{onClick:()=>h(r),className:"w-8 h-8 rounded-lg transition-all text-sm "+(s?"bg-primary-500 text-white":"bg-bg-primary text-text-secondary hover:bg-bg-secondary"),children:r},r)})}),(0,t.jsx)("button",{onClick:()=>h(e=>Math.min(g,e+1)),disabled:u===g,className:"px-3 py-1.5 rounded-lg bg-bg-primary text-text-secondary hover:bg-bg-secondary disabled:opacity-30 disabled:cursor-not-allowed transition-all text-sm",children:"下一页"})]})]})}var I=e.i(50965),z=e.i(60862);function P({searchQuery:e=""}){let[r,s]=(0,a.useState)([]),[l,i]=(0,a.useState)(!0),[o,n]=(0,a.useState)(null);(0,a.useEffect)(()=>{c()},[]);let c=async()=>{try{let e=await (0,j.getServices)({});if(e&&e.success&&e.data){let t=e.data.services||[];s(t)}else e&&Array.isArray(e)?s(e):(console.warn("Unexpected services response format:",e),s([]))}catch(e){console.error("Failed to fetch services:",e),s([])}finally{i(!1)}},d=r.filter(t=>{if(!e.trim())return!0;let a=e.toLowerCase(),r=t.name?.toLowerCase().includes(a),s=t.description?.toLowerCase().includes(a),l=t.price?.toLowerCase().includes(a);return r||s||l});return l?(0,t.jsx)("div",{className:"bg-bg-secondary/40 rounded-2xl p-5",children:(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-3",children:[...Array(12)].map((e,a)=>(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:"bg-bg-secondary rounded-xl shadow-sm border border-border-primary overflow-hidden animate-pulse",children:[(0,t.jsx)("div",{className:"aspect-square bg-bg-tertiary"}),(0,t.jsxs)("div",{className:"p-3",children:[(0,t.jsx)("div",{className:"h-4 bg-bg-tertiary rounded w-3/4 mb-2"}),(0,t.jsxs)("div",{className:"flex items-baseline justify-between",children:[(0,t.jsx)("div",{className:"h-5 bg-bg-tertiary rounded w-16"}),(0,t.jsx)("div",{className:"h-4 bg-bg-tertiary rounded w-12"})]})]})]})},a))})}):0===d.length?(0,t.jsxs)("div",{className:"bg-bg-secondary/40 rounded-2xl p-8 text-center",children:[(0,t.jsx)(I.ShoppingBag,{className:"w-12 h-12 text-text-tertiary opacity-30 mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-text-secondary",children:"暂无服务"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"bg-bg-secondary/40 rounded-2xl p-5",children:(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-3",children:d.map((e,a)=>(0,t.jsxs)("div",{onClick:()=>{n(e)},className:"group bg-bg-secondary rounded-xl shadow-sm hover:shadow-xl hover:-translate-y-1 border border-border-primary transition-all duration-300 cursor-pointer overflow-hidden animate-fade-in",children:[(0,t.jsxs)("div",{className:"relative aspect-square bg-bg-tertiary overflow-hidden",children:[e.cover_image?(0,t.jsx)("img",{src:(0,j.getImageUrl)(e.cover_image),alt:e.name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300",onError:e=>{e.target.style.display="none"}}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,t.jsx)(I.ShoppingBag,{className:"w-16 h-16 text-text-tertiary opacity-30"})}),e.is_recommended&&(0,t.jsx)("div",{className:"absolute top-2 right-2 px-2 py-1 rounded text-xs font-semibold",style:{background:"linear-gradient(to right, var(--accent-gradient-from), var(--accent-gradient-to))",color:"var(--accent-text)"},children:"推荐"})]}),(0,t.jsxs)("div",{className:"p-3",children:[(0,t.jsx)("h3",{className:"text-base font-semibold text-text-primary group-hover:text-primary-500 transition-colors mb-2 line-clamp-1",children:e.name}),(0,t.jsxs)("div",{className:"flex items-baseline justify-between",children:[(0,t.jsxs)("span",{className:"text-lg font-bold text-primary-600",children:[(0,t.jsx)("span",{className:"text-base font-normal mr-0.5",children:"¥"}),e.price]}),e.Category&&(0,t.jsxs)("span",{className:"text-xs text-text-tertiary px-2 py-0.5 bg-bg-tertiary rounded",children:[e.Category.icon&&(0,t.jsx)("span",{className:"mr-1",children:e.Category.icon}),e.Category.name]})]})]})]},e.id))})}),(0,t.jsx)(z.default,{service:o,isOpen:!!o,onClose:()=>{n(null)}})]})}var M=e.i(73708),A=e.i(70756),U=e.i(46848);function D({searchQuery:e=""}){let[r,s]=(0,a.useState)([]),[l,o]=(0,a.useState)(!0),[n,c]=(0,a.useState)(!1),[d,m]=(0,a.useState)(null);(0,a.useEffect)(()=>{x()},[]);let x=async()=>{try{let e=await (0,j.getGalleries)({});if(e.success&&e.data){let t=e.data.slice(0,12);s(t)}else console.warn("Unexpected galleries response format:",e),s([])}catch(e){console.error("Failed to fetch galleries:",e),s([])}finally{o(!1)}},u=r.filter(t=>{if(!e.trim())return!0;let a=e.toLowerCase(),r=t.title?.toLowerCase().includes(a),s=t.description?.toLowerCase().includes(a);return r||s});return l?(0,t.jsx)("div",{className:"bg-bg-secondary/40 rounded-2xl p-5",children:(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3",children:[...Array(10)].map((e,a)=>(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:"bg-bg-secondary rounded-lg shadow-sm border border-border-primary overflow-hidden animate-pulse",children:[(0,t.jsx)("div",{className:"w-full pt-[100%] bg-bg-tertiary"}),(0,t.jsxs)("div",{className:"p-3",children:[(0,t.jsx)("div",{className:"h-4 bg-bg-tertiary rounded w-3/4 mb-2"}),(0,t.jsx)("div",{className:"h-3 bg-bg-tertiary rounded w-full"})]})]})},a))})}):0===u.length?(0,t.jsxs)("div",{className:"bg-bg-secondary/40 rounded-2xl p-8 text-center",children:[(0,t.jsx)(M.Image,{className:"w-12 h-12 text-text-tertiary opacity-30 mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-text-secondary",children:"暂无图册"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"bg-bg-secondary/40 rounded-2xl p-5",children:(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3",children:u.map((e,a)=>(0,t.jsxs)("div",{onClick:()=>{m(e.id),c(!0)},className:"group block bg-bg-secondary rounded-lg shadow-sm hover:shadow-lg hover:-translate-y-0.5 border border-border-primary transition-all duration-300 cursor-pointer overflow-hidden animate-fade-in",children:[(0,t.jsxs)("div",{className:"relative w-full pt-[100%] bg-gradient-to-br from-primary-100 to-primary-200 overflow-hidden",children:[e.cover_image?(0,t.jsx)("img",{src:(0,i.getFileUrl)(e.cover_image),alt:e.title,className:`absolute inset-0 w-full h-full object-cover transition-transform duration-300 ${e.hasPassword?"blur-xl scale-110":"group-hover:scale-105"}`,draggable:!1,onContextMenu:e=>e.preventDefault(),loading:"lazy"}):(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsx)(M.Image,{className:"w-12 h-12 text-primary-400"})}),e.hasPassword&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsx)("div",{className:"bg-black/60 backdrop-blur-sm rounded-full p-3",children:(0,t.jsx)(A.Lock,{className:"w-6 h-6 text-white"})})}),(0,t.jsxs)("div",{className:"absolute bottom-2 right-2 bg-black/50 backdrop-blur-sm rounded-full px-3 py-1 text-xs text-white font-medium",children:[e.image_count," 张"]})]}),(0,t.jsxs)("div",{className:"p-3 text-left",children:[(0,t.jsx)("h3",{className:"font-medium text-sm text-text-primary group-hover:text-primary-500 transition-colors line-clamp-1 mb-1",children:e.title}),e.description&&(0,t.jsx)("p",{className:"text-xs text-text-tertiary line-clamp-2 leading-relaxed",children:e.description})]})]},e.id))})}),n&&d&&(0,t.jsx)(U.default,{galleryId:d,isOpen:n,onClose:()=>{c(!1),setTimeout(()=>{m(null)},300)}})]})}var R=e.i(73375),q=e.i(63059),W=e.i(55436);function B({tabs:e,defaultTab:r,onSearch:s,searchPlaceholder:i="搜索内容...",onTabChange:o,externalSearchQuery:n=""}){let{settings:c}=(0,l.useSettings)(),[d,m]=(0,a.useState)(r||e[0]?.key||""),[x,u]=(0,a.useState)(0),[g,p]=(0,a.useState)(0),[f,b]=(0,a.useState)(""),y=(0,a.useRef)(null),j=e[0],v=e[1],w=2===e.length,N=sessionStorage.getItem("userThemeType")||c.themeType||"default";(0,a.useEffect)(()=>{r&&m(r)},[r]),(0,a.useEffect)(()=>{o&&o(d)},[d]),(0,a.useEffect)(()=>{b(n)},[n]);let k=e=>{let t=e.target.value;b(t),s&&s(t,d)},C=()=>{b(""),s&&s("",d)};return(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("div",{className:`flex flex-col md:flex-row items-center md:items-center md:justify-between gap-4 ${"default"===N?"mb-0 md:mb-6":"mb-6"}`,children:[!w&&s?(0,t.jsxs)("div",{className:"relative w-72 flex-shrink-0 hidden md:block",children:[(0,t.jsx)(W.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-text-tertiary"}),(0,t.jsx)("input",{type:"text",placeholder:i,value:f,onChange:k,className:"w-full pl-10 pr-10 py-2 bg-bg-secondary border border-border-primary rounded-xl text-sm text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all",autoComplete:"off"}),f&&(0,t.jsx)("button",{type:"button",onClick:C,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-tertiary hover:text-text-primary transition-colors","aria-label":"清空搜索",children:(0,t.jsx)(h.X,{className:"w-4 h-4"})})]}):(0,t.jsxs)("div",{className:"flex items-center gap-3 mx-auto md:mx-0 md:flex-shrink-0",children:[w&&(0,t.jsx)("button",{onClick:()=>{w&&d===v?.key&&m(j.key)},disabled:d===j.key,className:`p-1.5 rounded-lg transition-all ${d===j.key?"opacity-20 cursor-not-allowed":"hover:bg-bg-secondary opacity-60 hover:opacity-100"}`,"aria-label":"上一页",children:(0,t.jsx)(R.ChevronLeft,{className:"w-5 h-5 text-text-primary"})}),(0,t.jsxs)("div",{className:"flex gap-2 bg-bg-secondary rounded-full p-1 border border-border-primary",children:[(0,t.jsx)("button",{onClick:()=>m(j.key),className:`px-5 py-2 rounded-full text-xs font-medium transition-all ${d===j.key?"bg-primary-500 text-white":"text-text-secondary hover:text-text-primary"}`,children:j.label}),v&&(0,t.jsx)("button",{onClick:()=>m(v.key),className:`px-5 py-2 rounded-full text-xs font-medium transition-all ${d===v.key?"bg-primary-500 text-white":"text-text-secondary hover:text-text-primary"}`,children:v.label})]}),w&&(0,t.jsx)("button",{onClick:()=>{w&&d===j.key&&v&&m(v.key)},disabled:d===v?.key,className:`p-1.5 rounded-lg transition-all ${d===v?.key?"opacity-20 cursor-not-allowed":"hover:bg-bg-secondary opacity-60 hover:opacity-100"}`,"aria-label":"下一页",children:(0,t.jsx)(q.ChevronRight,{className:"w-5 h-5 text-text-primary"})})]}),w&&s&&(0,t.jsxs)("div",{className:"relative w-72 flex-shrink-0 hidden md:block",children:[(0,t.jsx)(W.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-text-tertiary"}),(0,t.jsx)("input",{type:"text",placeholder:i,value:f,onChange:k,className:"w-full pl-10 pr-10 py-2 bg-bg-secondary border border-border-primary rounded-xl text-sm text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all",autoComplete:"off"}),f&&(0,t.jsx)("button",{type:"button",onClick:C,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-tertiary hover:text-text-primary transition-colors","aria-label":"清空搜索",children:(0,t.jsx)(h.X,{className:"w-4 h-4"})})]})]}),(0,t.jsx)("div",{ref:y,className:"relative overflow-hidden",onTouchStart:e=>{u(e.targetTouches[0].clientX)},onTouchMove:e=>{p(e.targetTouches[0].clientX)},onTouchEnd:()=>{if(!x||!g||!w)return;let e=x-g;e>50&&d===j.key&&v&&m(v.key),e<-50&&d===v?.key&&j&&m(j.key),u(0),p(0)},children:d===j.key?(0,t.jsx)("div",{className:"animate-fade-in",children:j.content},j.key):v&&d===v.key?(0,t.jsx)("div",{className:"animate-fade-in",children:v.content},v.key):null}),w&&(0,t.jsxs)("div",{className:"flex justify-center gap-1.5 mt-5",children:[(0,t.jsx)("div",{className:`w-1.5 h-1.5 rounded-full transition-all ${d===j.key?"bg-primary-500 w-6":"bg-border-secondary"}`}),(0,t.jsx)("div",{className:`w-1.5 h-1.5 rounded-full transition-all ${d===v?.key?"bg-primary-500 w-6":"bg-border-secondary"}`})]})]})}var O=e.i(57688);function X(){let[e,r]=(0,a.useState)([]),[s,i]=(0,a.useState)(0),[o,n]=(0,a.useState)(!0),{settings:c,isLoading:d}=(0,l.useSettings)();return((0,a.useEffect)(()=>{if(!d){try{let e=JSON.parse(c.blogCarouselImages||"[]");r(e.filter(e=>e.url))}catch{r([])}n(!1)}},[c.blogCarouselImages,d]),(0,a.useEffect)(()=>{if(e.length>1){let t=null,a=setTimeout(()=>{i(1),t=setInterval(()=>{i(t=>(t+1)%e.length)},1500)},1500);return()=>{clearTimeout(a),t&&clearInterval(t)}}},[e.length]),o)?(0,t.jsx)("div",{className:"w-full aspect-video md:h-96 md:aspect-auto bg-bg-tertiary animate-pulse rounded-lg"}):0===e.length?(0,t.jsx)("div",{className:"relative w-full overflow-hidden rounded-lg shadow-sm bg-bg-secondary flex items-center justify-center aspect-video md:h-96 md:aspect-auto",children:(0,t.jsx)("p",{className:"text-text-tertiary text-sm",children:"暂无轮播图，请在后台上传"})}):(0,t.jsxs)("div",{className:"relative w-full overflow-hidden rounded-lg shadow-sm aspect-video md:h-96 md:aspect-auto",children:[(0,t.jsx)("div",{className:"relative w-full h-full",children:e.map((e,a)=>{let r=(0,t.jsx)(O.default,{src:(0,j.getImageUrl)(e.url),alt:e.alt||"轮播图",fill:!0,sizes:"(max-width: 768px) 100vw, 800px",className:"object-cover",priority:0===a,unoptimized:!0});return(0,t.jsx)("div",{className:`absolute inset-0 transition-opacity duration-500 ease-in-out ${a===s?"opacity-100":"opacity-0"}`,children:e.link?(0,t.jsx)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",className:"block w-full h-full",children:r}):r},a)})}),e.length>1&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>{i(t=>(t-1+e.length)%e.length)},className:"absolute left-4 top-1/2 transform -translate-y-1/2 bg-primary-500/50 hover:bg-primary-600 text-white p-2 rounded-full transition-colors duration-200",children:(0,t.jsx)(R.ChevronLeft,{className:"h-5 w-5"})}),(0,t.jsx)("button",{onClick:()=>{i(t=>(t+1)%e.length)},className:"absolute right-4 top-1/2 transform -translate-y-1/2 bg-primary-500/50 hover:bg-primary-600 text-white p-2 rounded-full transition-colors duration-200",children:(0,t.jsx)(q.ChevronRight,{className:"h-5 w-5"})}),(0,t.jsx)("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2",children:e.map((e,a)=>(0,t.jsx)("button",{onClick:()=>{i(a)},className:`h-1 rounded-full transition-all duration-300 ${a===s?"w-8 bg-white shadow-md":"w-4 bg-white/40 hover:bg-white/60"}`},a))})]})]})}function Q(){let{profile:e,isLoading:r}=(0,s.useProfile)(),{profileSocialLinks:o}=(0,g.useSocialLinks)(),[n,c]=(0,a.useState)(!1),[d,m]=(0,a.useState)(null),[x,u]=(0,a.useState)(!1),[p,f]=(0,a.useState)(null),[b,y]=(0,a.useState)(!1),[v,w]=(0,a.useState)(!1),[N,k]=(0,a.useState)(null),{settings:C}=(0,l.useSettings)(),S=C.avatarShape||"circle",T=()=>"rounded"===S?"rounded-xl":"rounded-full",$=()=>{c(!1),setTimeout(()=>m(null),300)},L=()=>{u(!1),y(!1),setTimeout(()=>f(null),300)},_=()=>{w(!1),setTimeout(()=>k(null),300)},E=async()=>{if(p)try{await navigator.clipboard.writeText(p.account),y(!0),setTimeout(()=>y(!1),2e3)}catch(e){console.error("Failed to copy:",e)}};return r?(0,t.jsx)("div",{className:"bg-bg-secondary rounded-lg shadow-sm p-6 border border-border-primary h-full",children:(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,t.jsx)("div",{className:"w-20 h-20 bg-bg-tertiary rounded-full animate-pulse"}),(0,t.jsxs)("div",{className:"w-full space-y-2",children:[(0,t.jsx)("div",{className:"h-6 w-32 bg-bg-tertiary animate-pulse mx-auto"}),(0,t.jsx)("div",{className:"h-4 w-48 bg-bg-tertiary animate-pulse mx-auto"})]})]})}):e?(0,t.jsxs)("div",{className:"bg-bg-secondary rounded-lg shadow-sm hover:shadow-lg transition-all duration-300 p-6 border border-border-primary h-full flex flex-col justify-center",children:[(0,t.jsx)("div",{className:"flex justify-center mb-4",children:e.avatar?(0,t.jsx)("img",{src:(0,j.getImageUrl)(e.avatar),alt:e.name||"头像",className:`w-20 h-20 ${T()} object-cover shadow-lg`,style:{boxShadow:"0 3px 10px 0 rgba(0, 0, 0, 0.12)"}}):(0,t.jsx)("div",{className:`w-20 h-20 ${T()} bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center text-white text-2xl font-bold shadow-lg`,style:{boxShadow:"0 3px 10px 0 rgba(0, 0, 0, 0.12)"},children:e.name?.[0]||"X"})}),(0,t.jsxs)("div",{className:"text-center mb-4",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-text-primary",children:e.name||""}),e.title&&(0,t.jsx)("p",{className:"text-sm text-text-secondary mt-2",children:e.title}),e.bio&&(0,t.jsx)("p",{className:"text-sm text-text-tertiary mt-3 line-clamp-3",children:e.bio})]}),(0,t.jsx)("div",{className:"flex flex-wrap justify-center gap-3 mb-4",children:[e.location&&(0,t.jsxs)("div",{className:"flex items-center text-xs text-text-tertiary",children:[(0,t.jsxs)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.location]},"location"),e.email&&(0,t.jsxs)("div",{className:"flex items-center text-xs text-text-tertiary",children:[(0,t.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),e.email]},"email"),e.website&&(0,t.jsxs)("a",{href:e.website,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-xs text-primary-600 hover:text-primary-700 transition-colors",children:[(0,t.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})}),e.website_title||"个人网站"]},"website")].filter(Boolean)}),o.length>0&&(0,t.jsx)("div",{className:`flex items-center pt-5 border-t border-border-primary/20 px-8 ${1===o.length?"justify-center":"justify-between"}`,children:o.map((e,a)=>(0,t.jsx)("a",{href:e.link||"#",target:e.link?"_blank":"_self",rel:"noopener noreferrer",onClick:t=>{e.qrcode&&""!==e.qrcode.trim()?(t.preventDefault(),m({image:e.qrcode,platform:e.platform}),c(!0)):e.link&&""!==e.link.trim()&&"#"!==e.link?(t.preventDefault(),k({url:e.link,platform:e.platform}),w(!0)):(t.preventDefault(),f({account:e.account,platform:e.platform}),u(!0))},className:"group relative flex items-center justify-center transition-all hover:scale-110 hover:opacity-80 cursor-pointer",title:`${e.platform}: ${e.account}`,children:e.icon&&""!==e.icon.trim()?(0,t.jsx)("div",{className:`flex items-center justify-center ${1===o.length?"w-10 h-10":2===o.length?"w-9 h-9":3===o.length?"w-8 h-8":"w-7 h-7"}`,children:(0,t.jsx)("img",{src:(0,i.getFileUrl)(e.icon),alt:e.platform,className:"w-full h-full object-contain transition-all group-hover:brightness-110 icon-themed",onError:e=>{e.target.style.display="none"}})}):(0,t.jsx)("div",{className:`rounded-full bg-primary-500/20 flex items-center justify-center text-primary-500 font-bold group-hover:bg-primary-500/30 transition-colors ${1===o.length?"w-10 h-10 text-base":2===o.length?"w-9 h-9 text-sm":3===o.length?"w-8 h-8 text-sm":"w-7 h-7 text-xs"}`,children:e.platform[0].toUpperCase()})},`social-link-${e.id}-${a}`))}),n&&d&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:$,children:(0,t.jsxs)("div",{className:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6 max-w-sm w-full",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("button",{onClick:$,className:"absolute top-4 right-4 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"关闭",children:(0,t.jsx)(h.X,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4 capitalize",children:d.platform}),(0,t.jsx)("div",{className:"bg-white p-4 rounded-xl inline-block",children:(0,t.jsx)("img",{src:(0,i.getFileUrl)(d.image),alt:`${d.platform} QR Code`,className:"w-64 h-64 object-contain"})}),(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-4",children:"截图或长按保存上方二维码"})]})]})}),x&&p&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:L,children:(0,t.jsxs)("div",{className:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6 max-w-sm w-full",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("button",{onClick:L,className:"absolute top-4 right-4 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"关闭",children:(0,t.jsx)(h.X,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4 capitalize",children:p.platform}),(0,t.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-xl mb-4",children:(0,t.jsx)("p",{className:"text-lg font-mono text-gray-900 dark:text-white break-all",children:p.account})}),(0,t.jsx)("button",{onClick:E,className:`w-full py-3 px-4 rounded-lg font-medium transition-colors ${b?"bg-green-500 text-white":"bg-primary-500 hover:bg-primary-600 text-white"}`,children:b?"✓ 已复制":"复制账号"})]})]})}),v&&N&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:_,children:(0,t.jsxs)("div",{className:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6 max-w-sm w-full",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("button",{onClick:_,className:"absolute top-4 right-4 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"关闭",children:(0,t.jsx)(h.X,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4 capitalize",children:N.platform}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"是否跳转到以下链接？"}),(0,t.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 p-3 rounded-xl mb-4",children:(0,t.jsx)("p",{className:"text-sm font-mono text-gray-900 dark:text-white break-all",children:N.url})}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:_,className:"flex-1 py-3 px-4 rounded-lg font-medium transition-colors bg-gray-200 hover:bg-gray-300 dark:bg-gray-600 dark:hover:bg-gray-500 text-gray-800 dark:text-white",children:"取消"}),(0,t.jsx)("button",{onClick:()=>{N&&window.open(N.url,"_blank","noopener,noreferrer"),_()},className:"flex-1 py-3 px-4 rounded-lg font-medium transition-colors bg-primary-500 hover:bg-primary-600 text-white",children:"确认跳转"})]})]})]})})]}):null}function H({announcements:e}){let[s,l]=(0,a.useState)(0),[i,o]=(0,a.useState)(!1),[n,c]=(0,a.useState)(!1),[d,m]=(0,a.useState)(!1),[x,u]=(0,a.useState)(0),h=(0,a.useRef)(null),g=(0,a.useRef)(null),p=(0,a.useRef)(null),f=(0,a.useRef)(null),b=e.filter(e=>e&&e.text&&e.text.trim()),y=b.length>1,j=(0,a.useCallback)(()=>{b.length<=1||(o(!0),m(!1),setTimeout(()=>{l(e=>(e+1)%b.length),o(!1),u(e=>e+1)},300))},[b.length]);if((0,a.useEffect)(()=>{let e=()=>{if(h.current&&g.current){let e=h.current.scrollWidth,t=g.current.clientWidth;c(y&&e>t-20)}},t=setTimeout(e,100);return window.addEventListener("resize",e),()=>{clearTimeout(t),window.removeEventListener("resize",e)}},[s,b,y]),(0,a.useEffect)(()=>y?(f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{m(!0)},1500),()=>{f.current&&clearTimeout(f.current)}):void m(!1),[s,x,y]),(0,a.useEffect)(()=>{if(!(b.length<=1)&&d)return p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{j()},n?15e3:3500),()=>{p.current&&clearTimeout(p.current)}},[b.length,n,d,j]),0===b.length)return null;let v=b[s];return(0,t.jsxs)("div",{onClick:()=>{v.url&&window.open(v.url,"_blank","noopener,noreferrer")},className:r.default.dynamic([["d6910ecd2e201128",[15]]])+" "+`w-full bg-bg-secondary/80 border border-border-primary rounded-xl shadow-sm backdrop-blur-sm overflow-hidden transition-all duration-300 ${v.url?"cursor-pointer hover:bg-bg-tertiary/80 hover:shadow-md":""}`,children:[(0,t.jsxs)("div",{className:r.default.dynamic([["d6910ecd2e201128",[15]]])+" flex items-center px-4 py-3 gap-3",children:[(0,t.jsx)("span",{className:r.default.dynamic([["d6910ecd2e201128",[15]]])+" flex-shrink-0 text-xs font-bold text-white bg-gradient-to-r from-blue-500 to-indigo-500 px-2.5 py-1 rounded-md shadow-sm",children:"公告"}),(0,t.jsx)("div",{ref:g,className:r.default.dynamic([["d6910ecd2e201128",[15]]])+" flex-1 overflow-hidden relative min-w-0",children:(0,t.jsx)("div",{className:r.default.dynamic([["d6910ecd2e201128",[15]]])+" "+`transition-all duration-300 ease-in-out ${i?"opacity-0 -translate-y-3":"opacity-100 translate-y-0"}`,children:(0,t.jsxs)("div",{className:r.default.dynamic([["d6910ecd2e201128",[15]]])+" "+`overflow-hidden ${n&&d?"marquee-container":""}`,children:[(0,t.jsx)("span",{ref:h,className:r.default.dynamic([["d6910ecd2e201128",[15]]])+" "+`text-sm font-medium text-text-primary whitespace-nowrap inline-block ${n&&d?"marquee-text":""}`,children:v.text}),n&&d&&(0,t.jsx)("span",{className:r.default.dynamic([["d6910ecd2e201128",[15]]])+" text-sm font-medium text-text-primary whitespace-nowrap inline-block marquee-text-copy",children:v.text})]})})}),b.length>1&&(0,t.jsx)("div",{className:r.default.dynamic([["d6910ecd2e201128",[15]]])+" flex-shrink-0 flex items-center gap-1.5",children:b.map((e,a)=>(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),a!==s&&(p.current&&clearTimeout(p.current),f.current&&clearTimeout(f.current),o(!0),m(!1),setTimeout(()=>{l(a),o(!1),u(e=>e+1)},300))},className:r.default.dynamic([["d6910ecd2e201128",[15]]])+" "+`h-2 rounded-full transition-all duration-300 ${a===s?"bg-primary w-4":"bg-text-tertiary/40 hover:bg-text-tertiary/60 w-2"}`},a))}),v.url&&(0,t.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:r.default.dynamic([["d6910ecd2e201128",[15]]])+" w-4 h-4 text-text-tertiary flex-shrink-0",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7",className:r.default.dynamic([["d6910ecd2e201128",[15]]])})})]}),(0,t.jsx)(r.default,{id:"d6910ecd2e201128",dynamic:[15],children:".marquee-container.__jsx-style-dynamic-selector{gap:80px;display:flex}.marquee-text.__jsx-style-dynamic-selector,.marquee-text-copy.__jsx-style-dynamic-selector{animation:linear forwards marquee;animation-timeline:15s}@keyframes marquee{0%{transform:translate(0)}to{transform:translate(calc(-100% - 80px))}}"})]})}var Y=e.i(49484);function J({forceThemeType:e,rawSettings:r,isLoading:s}){var l;let[n,c]=(0,a.useState)(""),[d,m]=(0,a.useState)("notes"),[x,u]=(0,a.useState)("notes"),[h,g]=(0,a.useState)(!1),[p,b]=(0,a.useState)(null),[y,j]=(0,a.useState)(null),v=sessionStorage.getItem("userThemeType"),w=sessionStorage.getItem("userShowSiteNav"),k=sessionStorage.getItem("userShowNotes"),C="true"===r.enableAvatarThemeSwitch,S=r.themeType||"default",T=S;e?T=e:"default"===S&&C&&"blog"===v&&(T="blog");let $={showSiteNav:"true"===w||null===w&&"false"!==r.showSiteNav,showNotes:"true"===k||null===k&&"false"!==r.showNotes,showSocialLinks:"false"!==r.showSocialLinks,themeColor:r.themeColor||"white",themeType:T,footerCopyright:r.footerCopyright||`\xa9 ${new Date().getFullYear()} 个人主页. All rights reserved.`,backgroundImage:(l=r.backgroundImage||"",(0,i.getFileUrl)(l)),backgroundOpacity:r.backgroundOpacity||"0.5",defaultDisplaySection:r.defaultDisplaySection||"notes",showTopNavbar:r.showTopNavbar||"true",showWapSidebar:r.showWapSidebar||"true",blogProfileEnabled:r.blogProfileEnabled||"true",blogCarouselEnabled:r.blogCarouselEnabled||"true"};(0,a.useEffect)(()=>{if(r.homeContentSections)try{let e=JSON.parse(r.homeContentSections),t={section1:e.section1||"",section2:e.section2||"",showInDefaultTheme:!1!==e.showInDefaultTheme};b(t);let a=t.section1||t.section2||"notes";u(a),m(a)}catch(e){console.error("Failed to parse homeContentSections:",e),b({section1:"notes",section2:"navigation",showInDefaultTheme:!0}),u("notes"),m("notes")}else b({section1:"notes",section2:"navigation",showInDefaultTheme:!0}),u("notes"),m("notes");if(r.pageTexts)try{let e=JSON.parse(r.pageTexts);j(e)}catch(e){console.error("Failed to parse pageTexts:",e),j(null)}},[r]),(0,a.useEffect)(()=>{let e=()=>{g(window.innerWidth>=1024)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let{showSocialLinks:L,themeType:_,footerCopyright:E,backgroundImage:I,backgroundOpacity:z,blogProfileEnabled:M,blogCarouselEnabled:A}=$,U="blog"===_,R="false"!==$.showTopNavbar;$.showWapSidebar;let q="false"!==A;(0,a.useEffect)(()=>{let e=e=>{c(e.detail),m(x)};return window.addEventListener("globalSearch",e),()=>{window.removeEventListener("globalSearch",e)}},[x]);let W=e=>{u(e),m(e)},O=(e,t)=>{c(e),t&&m(t)},J=(e,a)=>{switch(e){case"notes":default:return(0,t.jsx)(F,{searchQuery:a},`notes-${a}`);case"navigation":return(0,t.jsx)(N,{searchQuery:a},`navigation-${a}`);case"services":return(0,t.jsx)(P,{searchQuery:a},`services-${a}`);case"galleries":return(0,t.jsx)(D,{searchQuery:a},`galleries-${a}`)}},G=e=>y&&y[e]?.title?y[e].title:({notes:"笔记列表",navigation:"导航列表",services:"服务业务",galleries:"图库列表"})[e]||e,K=p&&(U?p.section1||p.section2:p.showInDefaultTheme&&(p.section1||p.section2));return(0,t.jsx)("main",{className:"min-h-screen bg-bg-primary relative flex flex-col overflow-x-hidden hide-scrollbar",children:s?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-text-secondary",children:"加载中..."})]})}):(0,t.jsxs)(t.Fragment,{children:[I&&(0,t.jsx)("div",{className:"absolute inset-0 z-0",style:{backgroundImage:`url(${I})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",opacity:parseFloat(z)}}),U&&(0,t.jsxs)("div",{className:"relative z-0",children:[(U||R)&&(0,t.jsx)("div",{className:"h-16"}),(0,t.jsxs)("div",{className:"container mx-auto px-4 max-w-6xl pt-3 pb-4 md:py-8",children:[(0,t.jsxs)("section",{className:"animate-slide-up mb-8",style:{animationDelay:"0.1s"},children:[(0,t.jsxs)("div",{className:"hidden lg:flex gap-6 items-stretch",children:[q&&(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)(X,{})}),"false"!==M&&(0,t.jsx)("div",{className:`w-72 flex-shrink-0 h-96 ${!q?"mx-auto":""}`,children:h&&(0,t.jsx)(Q,{})})]}),q&&(0,t.jsx)("div",{className:"lg:hidden",children:(0,t.jsx)(X,{})})]}),"true"===r.blogAnnouncementEnabled&&(()=>{let e=[];try{let t=JSON.parse(r.blogAnnouncements||"[]");Array.isArray(t)&&(e=t.map(e=>"string"==typeof e?{text:e,url:""}:e))}catch{e=[]}let a=e.filter(e=>e&&e.text&&e.text.trim());return 0===a.length?null:(0,t.jsx)("section",{className:"animate-slide-up mb-6",style:{animationDelay:"0.15s"},children:(0,t.jsx)(H,{announcements:a})})})(),K&&p&&(0,t.jsx)("section",{className:"animate-slide-up",style:{animationDelay:"0.2s"},children:(0,t.jsx)(B,{tabs:[p.section1&&{key:p.section1,label:G(p.section1),content:J(p.section1,n)},p.section2&&{key:p.section2,label:G(p.section2),content:J(p.section2,n)}].filter(Boolean),defaultTab:p.section1||p.section2,onSearch:O,onTabChange:W,searchPlaceholder:"搜索内容...",externalSearchQuery:n})})]}),(0,t.jsxs)("footer",{className:"mt-auto border-t border-border-primary py-6 text-center text-sm text-text-tertiary",children:[(0,t.jsx)("p",{dangerouslySetInnerHTML:{__html:E}}),(0,t.jsx)(Y.default,{})]})]}),!U&&(0,t.jsxs)("div",{className:"relative z-0 flex flex-col min-h-screen",children:[R&&(0,t.jsx)("div",{className:"h-16"}),(0,t.jsxs)("div",{className:`container mx-auto px-4 max-w-6xl ${K?"py-8":"flex-1 flex items-center justify-center"}`,children:[(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,t.jsx)("section",{className:"text-center animate-fade-in mb-5 md:mb-6",children:(0,t.jsx)(o,{})}),L&&(0,t.jsx)("section",{className:"animate-slide-up",style:{animationDelay:"0.1s"},children:(0,t.jsx)(f,{className:"gap-3 md:gap-4"})})]}),K&&p&&(0,t.jsx)("section",{className:`animate-slide-up md:mt-12 ${U?"mt-8":"mt-0"}`,style:{animationDelay:"0.2s"},children:(0,t.jsx)(B,{tabs:[p.section1&&{key:p.section1,label:G(p.section1),content:J(p.section1,n)},p.section2&&{key:p.section2,label:G(p.section2),content:J(p.section2,n)}].filter(Boolean),defaultTab:p.section1||p.section2,onSearch:O,onTabChange:W,searchPlaceholder:"搜索内容...",externalSearchQuery:n})})]}),(0,t.jsxs)("footer",{className:"mt-auto border-t border-border-primary py-6 text-center text-sm text-text-tertiary",children:[(0,t.jsx)("p",{dangerouslySetInnerHTML:{__html:E}}),(0,t.jsx)(Y.default,{})]})]})]})})}e.s(["default",()=>J],58795)}]);